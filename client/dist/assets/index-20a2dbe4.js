var Ad=(t,e,n)=>{if(!e.has(t))throw TypeError("Cannot "+n)};var K=(t,e,n)=>(Ad(t,e,"read from private field"),n?n.call(t):e.get(t)),we=(t,e,n)=>{if(e.has(t))throw TypeError("Cannot add the same private member more than once");e instanceof WeakSet?e.add(t):e.set(t,n)},me=(t,e,n,i)=>(Ad(t,e,"write to private field"),i?i.call(t,n):e.set(t,n),n);var Yl=(t,e,n,i)=>({set _(r){me(t,e,r,n)},get _(){return K(t,e,i)}}),vt=(t,e,n)=>(Ad(t,e,"access private method"),n);(function(){const e=document.createElement("link").relList;if(e&&e.supports&&e.supports("modulepreload"))return;for(const r of document.querySelectorAll('link[rel="modulepreload"]'))i(r);new MutationObserver(r=>{for(const s of r)if(s.type==="childList")for(const a of s.addedNodes)a.tagName==="LINK"&&a.rel==="modulepreload"&&i(a)}).observe(document,{childList:!0,subtree:!0});function n(r){const s={};return r.integrity&&(s.integrity=r.integrity),r.referrerPolicy&&(s.referrerPolicy=r.referrerPolicy),r.crossOrigin==="use-credentials"?s.credentials="include":r.crossOrigin==="anonymous"?s.credentials="omit":s.credentials="same-origin",s}function i(r){if(r.ep)return;r.ep=!0;const s=n(r);fetch(r.href,s)}})();var tk=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function A_(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var N_={exports:{}},ln={},B_={exports:{}},ve={};/**
 * @license React
 * react.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var Fl=Symbol.for("react.element"),nk=Symbol.for("react.portal"),ik=Symbol.for("react.fragment"),rk=Symbol.for("react.strict_mode"),sk=Symbol.for("react.profiler"),ok=Symbol.for("react.provider"),ak=Symbol.for("react.context"),lk=Symbol.for("react.forward_ref"),ck=Symbol.for("react.suspense"),uk=Symbol.for("react.memo"),dk=Symbol.for("react.lazy"),ag=Symbol.iterator;function hk(t){return t===null||typeof t!="object"?null:(t=ag&&t[ag]||t["@@iterator"],typeof t=="function"?t:null)}var F_={isMounted:function(){return!1},enqueueForceUpdate:function(){},enqueueReplaceState:function(){},enqueueSetState:function(){}},U_=Object.assign,z_={};function sa(t,e,n){this.props=t,this.context=e,this.refs=z_,this.updater=n||F_}sa.prototype.isReactComponent={};sa.prototype.setState=function(t,e){if(typeof t!="object"&&typeof t!="function"&&t!=null)throw Error("setState(...): takes an object of state variables to update or a function which returns an object of state variables.");this.updater.enqueueSetState(this,t,e,"setState")};sa.prototype.forceUpdate=function(t){this.updater.enqueueForceUpdate(this,t,"forceUpdate")};function H_(){}H_.prototype=sa.prototype;function wp(t,e,n){this.props=t,this.context=e,this.refs=z_,this.updater=n||F_}var kp=wp.prototype=new H_;kp.constructor=wp;U_(kp,sa.prototype);kp.isPureReactComponent=!0;var lg=Array.isArray,j_=Object.prototype.hasOwnProperty,Ep={current:null},W_={key:!0,ref:!0,__self:!0,__source:!0};function $_(t,e,n){var i,r={},s=null,a=null;if(e!=null)for(i in e.ref!==void 0&&(a=e.ref),e.key!==void 0&&(s=""+e.key),e)j_.call(e,i)&&!W_.hasOwnProperty(i)&&(r[i]=e[i]);var o=arguments.length-2;if(o===1)r.children=n;else if(1<o){for(var l=Array(o),c=0;c<o;c++)l[c]=arguments[c+2];r.children=l}if(t&&t.defaultProps)for(i in o=t.defaultProps,o)r[i]===void 0&&(r[i]=o[i]);return{$$typeof:Fl,type:t,key:s,ref:a,props:r,_owner:Ep.current}}function fk(t,e){return{$$typeof:Fl,type:t.type,key:e,ref:t.ref,props:t.props,_owner:t._owner}}function Tp(t){return typeof t=="object"&&t!==null&&t.$$typeof===Fl}function pk(t){var e={"=":"=0",":":"=2"};return"$"+t.replace(/[=:]/g,function(n){return e[n]})}var cg=/\/+/g;function Nd(t,e){return typeof t=="object"&&t!==null&&t.key!=null?pk(""+t.key):e.toString(36)}function Ec(t,e,n,i,r){var s=typeof t;(s==="undefined"||s==="boolean")&&(t=null);var a=!1;if(t===null)a=!0;else switch(s){case"string":case"number":a=!0;break;case"object":switch(t.$$typeof){case Fl:case nk:a=!0}}if(a)return a=t,r=r(a),t=i===""?"."+Nd(a,0):i,lg(r)?(n="",t!=null&&(n=t.replace(cg,"$&/")+"/"),Ec(r,e,n,"",function(c){return c})):r!=null&&(Tp(r)&&(r=fk(r,n+(!r.key||a&&a.key===r.key?"":(""+r.key).replace(cg,"$&/")+"/")+t)),e.push(r)),1;if(a=0,i=i===""?".":i+":",lg(t))for(var o=0;o<t.length;o++){s=t[o];var l=i+Nd(s,o);a+=Ec(s,e,n,l,r)}else if(l=hk(t),typeof l=="function")for(t=l.call(t),o=0;!(s=t.next()).done;)s=s.value,l=i+Nd(s,o++),a+=Ec(s,e,n,l,r);else if(s==="object")throw e=String(t),Error("Objects are not valid as a React child (found: "+(e==="[object Object]"?"object with keys {"+Object.keys(t).join(", ")+"}":e)+"). If you meant to render a collection of children, use an array instead.");return a}function Zl(t,e,n){if(t==null)return t;var i=[],r=0;return Ec(t,i,"","",function(s){return e.call(n,s,r++)}),i}function mk(t){if(t._status===-1){var e=t._result;e=e(),e.then(function(n){(t._status===0||t._status===-1)&&(t._status=1,t._result=n)},function(n){(t._status===0||t._status===-1)&&(t._status=2,t._result=n)}),t._status===-1&&(t._status=0,t._result=e)}if(t._status===1)return t._result.default;throw t._result}var At={current:null},Tc={transition:null},gk={ReactCurrentDispatcher:At,ReactCurrentBatchConfig:Tc,ReactCurrentOwner:Ep};function V_(){throw Error("act(...) is not supported in production builds of React.")}ve.Children={map:Zl,forEach:function(t,e,n){Zl(t,function(){e.apply(this,arguments)},n)},count:function(t){var e=0;return Zl(t,function(){e++}),e},toArray:function(t){return Zl(t,function(e){return e})||[]},only:function(t){if(!Tp(t))throw Error("React.Children.only expected to receive a single React element child.");return t}};ve.Component=sa;ve.Fragment=ik;ve.Profiler=sk;ve.PureComponent=wp;ve.StrictMode=rk;ve.Suspense=ck;ve.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=gk;ve.act=V_;ve.cloneElement=function(t,e,n){if(t==null)throw Error("React.cloneElement(...): The argument must be a React element, but you passed "+t+".");var i=U_({},t.props),r=t.key,s=t.ref,a=t._owner;if(e!=null){if(e.ref!==void 0&&(s=e.ref,a=Ep.current),e.key!==void 0&&(r=""+e.key),t.type&&t.type.defaultProps)var o=t.type.defaultProps;for(l in e)j_.call(e,l)&&!W_.hasOwnProperty(l)&&(i[l]=e[l]===void 0&&o!==void 0?o[l]:e[l])}var l=arguments.length-2;if(l===1)i.children=n;else if(1<l){o=Array(l);for(var c=0;c<l;c++)o[c]=arguments[c+2];i.children=o}return{$$typeof:Fl,type:t.type,key:r,ref:s,props:i,_owner:a}};ve.createContext=function(t){return t={$$typeof:ak,_currentValue:t,_currentValue2:t,_threadCount:0,Provider:null,Consumer:null,_defaultValue:null,_globalName:null},t.Provider={$$typeof:ok,_context:t},t.Consumer=t};ve.createElement=$_;ve.createFactory=function(t){var e=$_.bind(null,t);return e.type=t,e};ve.createRef=function(){return{current:null}};ve.forwardRef=function(t){return{$$typeof:lk,render:t}};ve.isValidElement=Tp;ve.lazy=function(t){return{$$typeof:dk,_payload:{_status:-1,_result:t},_init:mk}};ve.memo=function(t,e){return{$$typeof:uk,type:t,compare:e===void 0?null:e}};ve.startTransition=function(t){var e=Tc.transition;Tc.transition={};try{t()}finally{Tc.transition=e}};ve.unstable_act=V_;ve.useCallback=function(t,e){return At.current.useCallback(t,e)};ve.useContext=function(t){return At.current.useContext(t)};ve.useDebugValue=function(){};ve.useDeferredValue=function(t){return At.current.useDeferredValue(t)};ve.useEffect=function(t,e){return At.current.useEffect(t,e)};ve.useId=function(){return At.current.useId()};ve.useImperativeHandle=function(t,e,n){return At.current.useImperativeHandle(t,e,n)};ve.useInsertionEffect=function(t,e){return At.current.useInsertionEffect(t,e)};ve.useLayoutEffect=function(t,e){return At.current.useLayoutEffect(t,e)};ve.useMemo=function(t,e){return At.current.useMemo(t,e)};ve.useReducer=function(t,e,n){return At.current.useReducer(t,e,n)};ve.useRef=function(t){return At.current.useRef(t)};ve.useState=function(t){return At.current.useState(t)};ve.useSyncExternalStore=function(t,e,n){return At.current.useSyncExternalStore(t,e,n)};ve.useTransition=function(){return At.current.useTransition()};ve.version="18.3.1";B_.exports=ve;var T=B_.exports;const te=A_(T);var G_={exports:{}},q_={};/**
 * @license React
 * scheduler.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */(function(t){function e(U,R){var M=U.length;U.push(R);e:for(;0<M;){var D=M-1>>>1,N=U[D];if(0<r(N,R))U[D]=R,U[M]=N,M=D;else break e}}function n(U){return U.length===0?null:U[0]}function i(U){if(U.length===0)return null;var R=U[0],M=U.pop();if(M!==R){U[0]=M;e:for(var D=0,N=U.length,q=N>>>1;D<q;){var ne=2*(D+1)-1,ce=U[ne],de=ne+1,z=U[de];if(0>r(ce,M))de<N&&0>r(z,ce)?(U[D]=z,U[de]=M,D=de):(U[D]=ce,U[ne]=M,D=ne);else if(de<N&&0>r(z,M))U[D]=z,U[de]=M,D=de;else break e}}return R}function r(U,R){var M=U.sortIndex-R.sortIndex;return M!==0?M:U.id-R.id}if(typeof performance=="object"&&typeof performance.now=="function"){var s=performance;t.unstable_now=function(){return s.now()}}else{var a=Date,o=a.now();t.unstable_now=function(){return a.now()-o}}var l=[],c=[],d=1,u=null,m=3,v=!1,y=!1,_=!1,p=typeof setTimeout=="function"?setTimeout:null,f=typeof clearTimeout=="function"?clearTimeout:null,h=typeof setImmediate<"u"?setImmediate:null;typeof navigator<"u"&&navigator.scheduling!==void 0&&navigator.scheduling.isInputPending!==void 0&&navigator.scheduling.isInputPending.bind(navigator.scheduling);function g(U){for(var R=n(c);R!==null;){if(R.callback===null)i(c);else if(R.startTime<=U)i(c),R.sortIndex=R.expirationTime,e(l,R);else break;R=n(c)}}function S(U){if(_=!1,g(U),!y)if(n(l)!==null)y=!0,j(b);else{var R=n(c);R!==null&&X(S,R.startTime-U)}}function b(U,R){y=!1,_&&(_=!1,f(C),C=-1),v=!0;var M=m;try{for(g(R),u=n(l);u!==null&&(!(u.expirationTime>R)||U&&!I());){var D=u.callback;if(typeof D=="function"){u.callback=null,m=u.priorityLevel;var N=D(u.expirationTime<=R);R=t.unstable_now(),typeof N=="function"?u.callback=N:u===n(l)&&i(l),g(R)}else i(l);u=n(l)}if(u!==null)var q=!0;else{var ne=n(c);ne!==null&&X(S,ne.startTime-R),q=!1}return q}finally{u=null,m=M,v=!1}}var w=!1,k=null,C=-1,E=5,x=-1;function I(){return!(t.unstable_now()-x<E)}function A(){if(k!==null){var U=t.unstable_now();x=U;var R=!0;try{R=k(!0,U)}finally{R?P():(w=!1,k=null)}}else w=!1}var P;if(typeof h=="function")P=function(){h(A)};else if(typeof MessageChannel<"u"){var F=new MessageChannel,B=F.port2;F.port1.onmessage=A,P=function(){B.postMessage(null)}}else P=function(){p(A,0)};function j(U){k=U,w||(w=!0,P())}function X(U,R){C=p(function(){U(t.unstable_now())},R)}t.unstable_IdlePriority=5,t.unstable_ImmediatePriority=1,t.unstable_LowPriority=4,t.unstable_NormalPriority=3,t.unstable_Profiling=null,t.unstable_UserBlockingPriority=2,t.unstable_cancelCallback=function(U){U.callback=null},t.unstable_continueExecution=function(){y||v||(y=!0,j(b))},t.unstable_forceFrameRate=function(U){0>U||125<U?console.error("forceFrameRate takes a positive int between 0 and 125, forcing frame rates higher than 125 fps is not supported"):E=0<U?Math.floor(1e3/U):5},t.unstable_getCurrentPriorityLevel=function(){return m},t.unstable_getFirstCallbackNode=function(){return n(l)},t.unstable_next=function(U){switch(m){case 1:case 2:case 3:var R=3;break;default:R=m}var M=m;m=R;try{return U()}finally{m=M}},t.unstable_pauseExecution=function(){},t.unstable_requestPaint=function(){},t.unstable_runWithPriority=function(U,R){switch(U){case 1:case 2:case 3:case 4:case 5:break;default:U=3}var M=m;m=U;try{return R()}finally{m=M}},t.unstable_scheduleCallback=function(U,R,M){var D=t.unstable_now();switch(typeof M=="object"&&M!==null?(M=M.delay,M=typeof M=="number"&&0<M?D+M:D):M=D,U){case 1:var N=-1;break;case 2:N=250;break;case 5:N=1073741823;break;case 4:N=1e4;break;default:N=5e3}return N=M+N,U={id:d++,callback:R,priorityLevel:U,startTime:M,expirationTime:N,sortIndex:-1},M>D?(U.sortIndex=M,e(c,U),n(l)===null&&U===n(c)&&(_?(f(C),C=-1):_=!0,X(S,M-D))):(U.sortIndex=N,e(l,U),y||v||(y=!0,j(b))),U},t.unstable_shouldYield=I,t.unstable_wrapCallback=function(U){var R=m;return function(){var M=m;m=R;try{return U.apply(this,arguments)}finally{m=M}}}})(q_);G_.exports=q_;var vk=G_.exports;/**
 * @license React
 * react-dom.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var _k=T,an=vk;function ee(t){for(var e="https://reactjs.org/docs/error-decoder.html?invariant="+t,n=1;n<arguments.length;n++)e+="&args[]="+encodeURIComponent(arguments[n]);return"Minified React error #"+t+"; visit "+e+" for the full message or use the non-minified dev environment for full errors and additional helpful warnings."}var J_=new Set,ol={};function Ks(t,e){jo(t,e),jo(t+"Capture",e)}function jo(t,e){for(ol[t]=e,t=0;t<e.length;t++)J_.add(e[t])}var pr=!(typeof window>"u"||typeof window.document>"u"||typeof window.document.createElement>"u"),Nh=Object.prototype.hasOwnProperty,yk=/^[:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD][:A-Z_a-z\u00C0-\u00D6\u00D8-\u00F6\u00F8-\u02FF\u0370-\u037D\u037F-\u1FFF\u200C-\u200D\u2070-\u218F\u2C00-\u2FEF\u3001-\uD7FF\uF900-\uFDCF\uFDF0-\uFFFD\-.0-9\u00B7\u0300-\u036F\u203F-\u2040]*$/,ug={},dg={};function Sk(t){return Nh.call(dg,t)?!0:Nh.call(ug,t)?!1:yk.test(t)?dg[t]=!0:(ug[t]=!0,!1)}function Ck(t,e,n,i){if(n!==null&&n.type===0)return!1;switch(typeof e){case"function":case"symbol":return!0;case"boolean":return i?!1:n!==null?!n.acceptsBooleans:(t=t.toLowerCase().slice(0,5),t!=="data-"&&t!=="aria-");default:return!1}}function bk(t,e,n,i){if(e===null||typeof e>"u"||Ck(t,e,n,i))return!0;if(i)return!1;if(n!==null)switch(n.type){case 3:return!e;case 4:return e===!1;case 5:return isNaN(e);case 6:return isNaN(e)||1>e}return!1}function Nt(t,e,n,i,r,s,a){this.acceptsBooleans=e===2||e===3||e===4,this.attributeName=i,this.attributeNamespace=r,this.mustUseProperty=n,this.propertyName=t,this.type=e,this.sanitizeURL=s,this.removeEmptyString=a}var mt={};"children dangerouslySetInnerHTML defaultValue defaultChecked innerHTML suppressContentEditableWarning suppressHydrationWarning style".split(" ").forEach(function(t){mt[t]=new Nt(t,0,!1,t,null,!1,!1)});[["acceptCharset","accept-charset"],["className","class"],["htmlFor","for"],["httpEquiv","http-equiv"]].forEach(function(t){var e=t[0];mt[e]=new Nt(e,1,!1,t[1],null,!1,!1)});["contentEditable","draggable","spellCheck","value"].forEach(function(t){mt[t]=new Nt(t,2,!1,t.toLowerCase(),null,!1,!1)});["autoReverse","externalResourcesRequired","focusable","preserveAlpha"].forEach(function(t){mt[t]=new Nt(t,2,!1,t,null,!1,!1)});"allowFullScreen async autoFocus autoPlay controls default defer disabled disablePictureInPicture disableRemotePlayback formNoValidate hidden loop noModule noValidate open playsInline readOnly required reversed scoped seamless itemScope".split(" ").forEach(function(t){mt[t]=new Nt(t,3,!1,t.toLowerCase(),null,!1,!1)});["checked","multiple","muted","selected"].forEach(function(t){mt[t]=new Nt(t,3,!0,t,null,!1,!1)});["capture","download"].forEach(function(t){mt[t]=new Nt(t,4,!1,t,null,!1,!1)});["cols","rows","size","span"].forEach(function(t){mt[t]=new Nt(t,6,!1,t,null,!1,!1)});["rowSpan","start"].forEach(function(t){mt[t]=new Nt(t,5,!1,t.toLowerCase(),null,!1,!1)});var Rp=/[\-:]([a-z])/g;function xp(t){return t[1].toUpperCase()}"accent-height alignment-baseline arabic-form baseline-shift cap-height clip-path clip-rule color-interpolation color-interpolation-filters color-profile color-rendering dominant-baseline enable-background fill-opacity fill-rule flood-color flood-opacity font-family font-size font-size-adjust font-stretch font-style font-variant font-weight glyph-name glyph-orientation-horizontal glyph-orientation-vertical horiz-adv-x horiz-origin-x image-rendering letter-spacing lighting-color marker-end marker-mid marker-start overline-position overline-thickness paint-order panose-1 pointer-events rendering-intent shape-rendering stop-color stop-opacity strikethrough-position strikethrough-thickness stroke-dasharray stroke-dashoffset stroke-linecap stroke-linejoin stroke-miterlimit stroke-opacity stroke-width text-anchor text-decoration text-rendering underline-position underline-thickness unicode-bidi unicode-range units-per-em v-alphabetic v-hanging v-ideographic v-mathematical vector-effect vert-adv-y vert-origin-x vert-origin-y word-spacing writing-mode xmlns:xlink x-height".split(" ").forEach(function(t){var e=t.replace(Rp,xp);mt[e]=new Nt(e,1,!1,t,null,!1,!1)});"xlink:actuate xlink:arcrole xlink:role xlink:show xlink:title xlink:type".split(" ").forEach(function(t){var e=t.replace(Rp,xp);mt[e]=new Nt(e,1,!1,t,"http://www.w3.org/1999/xlink",!1,!1)});["xml:base","xml:lang","xml:space"].forEach(function(t){var e=t.replace(Rp,xp);mt[e]=new Nt(e,1,!1,t,"http://www.w3.org/XML/1998/namespace",!1,!1)});["tabIndex","crossOrigin"].forEach(function(t){mt[t]=new Nt(t,1,!1,t.toLowerCase(),null,!1,!1)});mt.xlinkHref=new Nt("xlinkHref",1,!1,"xlink:href","http://www.w3.org/1999/xlink",!0,!1);["src","href","action","formAction"].forEach(function(t){mt[t]=new Nt(t,1,!1,t.toLowerCase(),null,!0,!0)});function Pp(t,e,n,i){var r=mt.hasOwnProperty(e)?mt[e]:null;(r!==null?r.type!==0:i||!(2<e.length)||e[0]!=="o"&&e[0]!=="O"||e[1]!=="n"&&e[1]!=="N")&&(bk(e,n,r,i)&&(n=null),i||r===null?Sk(e)&&(n===null?t.removeAttribute(e):t.setAttribute(e,""+n)):r.mustUseProperty?t[r.propertyName]=n===null?r.type===3?!1:"":n:(e=r.attributeName,i=r.attributeNamespace,n===null?t.removeAttribute(e):(r=r.type,n=r===3||r===4&&n===!0?"":""+n,i?t.setAttributeNS(i,e,n):t.setAttribute(e,n))))}var Sr=_k.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED,ec=Symbol.for("react.element"),io=Symbol.for("react.portal"),ro=Symbol.for("react.fragment"),Op=Symbol.for("react.strict_mode"),Bh=Symbol.for("react.profiler"),K_=Symbol.for("react.provider"),Q_=Symbol.for("react.context"),Ip=Symbol.for("react.forward_ref"),Fh=Symbol.for("react.suspense"),Uh=Symbol.for("react.suspense_list"),Lp=Symbol.for("react.memo"),Or=Symbol.for("react.lazy"),X_=Symbol.for("react.offscreen"),hg=Symbol.iterator;function Ca(t){return t===null||typeof t!="object"?null:(t=hg&&t[hg]||t["@@iterator"],typeof t=="function"?t:null)}var Fe=Object.assign,Bd;function Na(t){if(Bd===void 0)try{throw Error()}catch(n){var e=n.stack.trim().match(/\n( *(at )?)/);Bd=e&&e[1]||""}return`
`+Bd+t}var Fd=!1;function Ud(t,e){if(!t||Fd)return"";Fd=!0;var n=Error.prepareStackTrace;Error.prepareStackTrace=void 0;try{if(e)if(e=function(){throw Error()},Object.defineProperty(e.prototype,"props",{set:function(){throw Error()}}),typeof Reflect=="object"&&Reflect.construct){try{Reflect.construct(e,[])}catch(c){var i=c}Reflect.construct(t,[],e)}else{try{e.call()}catch(c){i=c}t.call(e.prototype)}else{try{throw Error()}catch(c){i=c}t()}}catch(c){if(c&&i&&typeof c.stack=="string"){for(var r=c.stack.split(`
`),s=i.stack.split(`
`),a=r.length-1,o=s.length-1;1<=a&&0<=o&&r[a]!==s[o];)o--;for(;1<=a&&0<=o;a--,o--)if(r[a]!==s[o]){if(a!==1||o!==1)do if(a--,o--,0>o||r[a]!==s[o]){var l=`
`+r[a].replace(" at new "," at ");return t.displayName&&l.includes("<anonymous>")&&(l=l.replace("<anonymous>",t.displayName)),l}while(1<=a&&0<=o);break}}}finally{Fd=!1,Error.prepareStackTrace=n}return(t=t?t.displayName||t.name:"")?Na(t):""}function wk(t){switch(t.tag){case 5:return Na(t.type);case 16:return Na("Lazy");case 13:return Na("Suspense");case 19:return Na("SuspenseList");case 0:case 2:case 15:return t=Ud(t.type,!1),t;case 11:return t=Ud(t.type.render,!1),t;case 1:return t=Ud(t.type,!0),t;default:return""}}function zh(t){if(t==null)return null;if(typeof t=="function")return t.displayName||t.name||null;if(typeof t=="string")return t;switch(t){case ro:return"Fragment";case io:return"Portal";case Bh:return"Profiler";case Op:return"StrictMode";case Fh:return"Suspense";case Uh:return"SuspenseList"}if(typeof t=="object")switch(t.$$typeof){case Q_:return(t.displayName||"Context")+".Consumer";case K_:return(t._context.displayName||"Context")+".Provider";case Ip:var e=t.render;return t=t.displayName,t||(t=e.displayName||e.name||"",t=t!==""?"ForwardRef("+t+")":"ForwardRef"),t;case Lp:return e=t.displayName||null,e!==null?e:zh(t.type)||"Memo";case Or:e=t._payload,t=t._init;try{return zh(t(e))}catch{}}return null}function kk(t){var e=t.type;switch(t.tag){case 24:return"Cache";case 9:return(e.displayName||"Context")+".Consumer";case 10:return(e._context.displayName||"Context")+".Provider";case 18:return"DehydratedFragment";case 11:return t=e.render,t=t.displayName||t.name||"",e.displayName||(t!==""?"ForwardRef("+t+")":"ForwardRef");case 7:return"Fragment";case 5:return e;case 4:return"Portal";case 3:return"Root";case 6:return"Text";case 16:return zh(e);case 8:return e===Op?"StrictMode":"Mode";case 22:return"Offscreen";case 12:return"Profiler";case 21:return"Scope";case 13:return"Suspense";case 19:return"SuspenseList";case 25:return"TracingMarker";case 1:case 0:case 17:case 2:case 14:case 15:if(typeof e=="function")return e.displayName||e.name||null;if(typeof e=="string")return e}return null}function as(t){switch(typeof t){case"boolean":case"number":case"string":case"undefined":return t;case"object":return t;default:return""}}function Y_(t){var e=t.type;return(t=t.nodeName)&&t.toLowerCase()==="input"&&(e==="checkbox"||e==="radio")}function Ek(t){var e=Y_(t)?"checked":"value",n=Object.getOwnPropertyDescriptor(t.constructor.prototype,e),i=""+t[e];if(!t.hasOwnProperty(e)&&typeof n<"u"&&typeof n.get=="function"&&typeof n.set=="function"){var r=n.get,s=n.set;return Object.defineProperty(t,e,{configurable:!0,get:function(){return r.call(this)},set:function(a){i=""+a,s.call(this,a)}}),Object.defineProperty(t,e,{enumerable:n.enumerable}),{getValue:function(){return i},setValue:function(a){i=""+a},stopTracking:function(){t._valueTracker=null,delete t[e]}}}}function tc(t){t._valueTracker||(t._valueTracker=Ek(t))}function Z_(t){if(!t)return!1;var e=t._valueTracker;if(!e)return!0;var n=e.getValue(),i="";return t&&(i=Y_(t)?t.checked?"true":"false":t.value),t=i,t!==n?(e.setValue(t),!0):!1}function Zc(t){if(t=t||(typeof document<"u"?document:void 0),typeof t>"u")return null;try{return t.activeElement||t.body}catch{return t.body}}function Hh(t,e){var n=e.checked;return Fe({},e,{defaultChecked:void 0,defaultValue:void 0,value:void 0,checked:n??t._wrapperState.initialChecked})}function fg(t,e){var n=e.defaultValue==null?"":e.defaultValue,i=e.checked!=null?e.checked:e.defaultChecked;n=as(e.value!=null?e.value:n),t._wrapperState={initialChecked:i,initialValue:n,controlled:e.type==="checkbox"||e.type==="radio"?e.checked!=null:e.value!=null}}function ey(t,e){e=e.checked,e!=null&&Pp(t,"checked",e,!1)}function jh(t,e){ey(t,e);var n=as(e.value),i=e.type;if(n!=null)i==="number"?(n===0&&t.value===""||t.value!=n)&&(t.value=""+n):t.value!==""+n&&(t.value=""+n);else if(i==="submit"||i==="reset"){t.removeAttribute("value");return}e.hasOwnProperty("value")?Wh(t,e.type,n):e.hasOwnProperty("defaultValue")&&Wh(t,e.type,as(e.defaultValue)),e.checked==null&&e.defaultChecked!=null&&(t.defaultChecked=!!e.defaultChecked)}function pg(t,e,n){if(e.hasOwnProperty("value")||e.hasOwnProperty("defaultValue")){var i=e.type;if(!(i!=="submit"&&i!=="reset"||e.value!==void 0&&e.value!==null))return;e=""+t._wrapperState.initialValue,n||e===t.value||(t.value=e),t.defaultValue=e}n=t.name,n!==""&&(t.name=""),t.defaultChecked=!!t._wrapperState.initialChecked,n!==""&&(t.name=n)}function Wh(t,e,n){(e!=="number"||Zc(t.ownerDocument)!==t)&&(n==null?t.defaultValue=""+t._wrapperState.initialValue:t.defaultValue!==""+n&&(t.defaultValue=""+n))}var Ba=Array.isArray;function yo(t,e,n,i){if(t=t.options,e){e={};for(var r=0;r<n.length;r++)e["$"+n[r]]=!0;for(n=0;n<t.length;n++)r=e.hasOwnProperty("$"+t[n].value),t[n].selected!==r&&(t[n].selected=r),r&&i&&(t[n].defaultSelected=!0)}else{for(n=""+as(n),e=null,r=0;r<t.length;r++){if(t[r].value===n){t[r].selected=!0,i&&(t[r].defaultSelected=!0);return}e!==null||t[r].disabled||(e=t[r])}e!==null&&(e.selected=!0)}}function $h(t,e){if(e.dangerouslySetInnerHTML!=null)throw Error(ee(91));return Fe({},e,{value:void 0,defaultValue:void 0,children:""+t._wrapperState.initialValue})}function mg(t,e){var n=e.value;if(n==null){if(n=e.children,e=e.defaultValue,n!=null){if(e!=null)throw Error(ee(92));if(Ba(n)){if(1<n.length)throw Error(ee(93));n=n[0]}e=n}e==null&&(e=""),n=e}t._wrapperState={initialValue:as(n)}}function ty(t,e){var n=as(e.value),i=as(e.defaultValue);n!=null&&(n=""+n,n!==t.value&&(t.value=n),e.defaultValue==null&&t.defaultValue!==n&&(t.defaultValue=n)),i!=null&&(t.defaultValue=""+i)}function gg(t){var e=t.textContent;e===t._wrapperState.initialValue&&e!==""&&e!==null&&(t.value=e)}function ny(t){switch(t){case"svg":return"http://www.w3.org/2000/svg";case"math":return"http://www.w3.org/1998/Math/MathML";default:return"http://www.w3.org/1999/xhtml"}}function Vh(t,e){return t==null||t==="http://www.w3.org/1999/xhtml"?ny(e):t==="http://www.w3.org/2000/svg"&&e==="foreignObject"?"http://www.w3.org/1999/xhtml":t}var nc,iy=function(t){return typeof MSApp<"u"&&MSApp.execUnsafeLocalFunction?function(e,n,i,r){MSApp.execUnsafeLocalFunction(function(){return t(e,n,i,r)})}:t}(function(t,e){if(t.namespaceURI!=="http://www.w3.org/2000/svg"||"innerHTML"in t)t.innerHTML=e;else{for(nc=nc||document.createElement("div"),nc.innerHTML="<svg>"+e.valueOf().toString()+"</svg>",e=nc.firstChild;t.firstChild;)t.removeChild(t.firstChild);for(;e.firstChild;)t.appendChild(e.firstChild)}});function al(t,e){if(e){var n=t.firstChild;if(n&&n===t.lastChild&&n.nodeType===3){n.nodeValue=e;return}}t.textContent=e}var Va={animationIterationCount:!0,aspectRatio:!0,borderImageOutset:!0,borderImageSlice:!0,borderImageWidth:!0,boxFlex:!0,boxFlexGroup:!0,boxOrdinalGroup:!0,columnCount:!0,columns:!0,flex:!0,flexGrow:!0,flexPositive:!0,flexShrink:!0,flexNegative:!0,flexOrder:!0,gridArea:!0,gridRow:!0,gridRowEnd:!0,gridRowSpan:!0,gridRowStart:!0,gridColumn:!0,gridColumnEnd:!0,gridColumnSpan:!0,gridColumnStart:!0,fontWeight:!0,lineClamp:!0,lineHeight:!0,opacity:!0,order:!0,orphans:!0,tabSize:!0,widows:!0,zIndex:!0,zoom:!0,fillOpacity:!0,floodOpacity:!0,stopOpacity:!0,strokeDasharray:!0,strokeDashoffset:!0,strokeMiterlimit:!0,strokeOpacity:!0,strokeWidth:!0},Tk=["Webkit","ms","Moz","O"];Object.keys(Va).forEach(function(t){Tk.forEach(function(e){e=e+t.charAt(0).toUpperCase()+t.substring(1),Va[e]=Va[t]})});function ry(t,e,n){return e==null||typeof e=="boolean"||e===""?"":n||typeof e!="number"||e===0||Va.hasOwnProperty(t)&&Va[t]?(""+e).trim():e+"px"}function sy(t,e){t=t.style;for(var n in e)if(e.hasOwnProperty(n)){var i=n.indexOf("--")===0,r=ry(n,e[n],i);n==="float"&&(n="cssFloat"),i?t.setProperty(n,r):t[n]=r}}var Rk=Fe({menuitem:!0},{area:!0,base:!0,br:!0,col:!0,embed:!0,hr:!0,img:!0,input:!0,keygen:!0,link:!0,meta:!0,param:!0,source:!0,track:!0,wbr:!0});function Gh(t,e){if(e){if(Rk[t]&&(e.children!=null||e.dangerouslySetInnerHTML!=null))throw Error(ee(137,t));if(e.dangerouslySetInnerHTML!=null){if(e.children!=null)throw Error(ee(60));if(typeof e.dangerouslySetInnerHTML!="object"||!("__html"in e.dangerouslySetInnerHTML))throw Error(ee(61))}if(e.style!=null&&typeof e.style!="object")throw Error(ee(62))}}function qh(t,e){if(t.indexOf("-")===-1)return typeof e.is=="string";switch(t){case"annotation-xml":case"color-profile":case"font-face":case"font-face-src":case"font-face-uri":case"font-face-format":case"font-face-name":case"missing-glyph":return!1;default:return!0}}var Jh=null;function Mp(t){return t=t.target||t.srcElement||window,t.correspondingUseElement&&(t=t.correspondingUseElement),t.nodeType===3?t.parentNode:t}var Kh=null,So=null,Co=null;function vg(t){if(t=Hl(t)){if(typeof Kh!="function")throw Error(ee(280));var e=t.stateNode;e&&(e=Ku(e),Kh(t.stateNode,t.type,e))}}function oy(t){So?Co?Co.push(t):Co=[t]:So=t}function ay(){if(So){var t=So,e=Co;if(Co=So=null,vg(t),e)for(t=0;t<e.length;t++)vg(e[t])}}function ly(t,e){return t(e)}function cy(){}var zd=!1;function uy(t,e,n){if(zd)return t(e,n);zd=!0;try{return ly(t,e,n)}finally{zd=!1,(So!==null||Co!==null)&&(cy(),ay())}}function ll(t,e){var n=t.stateNode;if(n===null)return null;var i=Ku(n);if(i===null)return null;n=i[e];e:switch(e){case"onClick":case"onClickCapture":case"onDoubleClick":case"onDoubleClickCapture":case"onMouseDown":case"onMouseDownCapture":case"onMouseMove":case"onMouseMoveCapture":case"onMouseUp":case"onMouseUpCapture":case"onMouseEnter":(i=!i.disabled)||(t=t.type,i=!(t==="button"||t==="input"||t==="select"||t==="textarea")),t=!i;break e;default:t=!1}if(t)return null;if(n&&typeof n!="function")throw Error(ee(231,e,typeof n));return n}var Qh=!1;if(pr)try{var ba={};Object.defineProperty(ba,"passive",{get:function(){Qh=!0}}),window.addEventListener("test",ba,ba),window.removeEventListener("test",ba,ba)}catch{Qh=!1}function xk(t,e,n,i,r,s,a,o,l){var c=Array.prototype.slice.call(arguments,3);try{e.apply(n,c)}catch(d){this.onError(d)}}var Ga=!1,eu=null,tu=!1,Xh=null,Pk={onError:function(t){Ga=!0,eu=t}};function Ok(t,e,n,i,r,s,a,o,l){Ga=!1,eu=null,xk.apply(Pk,arguments)}function Ik(t,e,n,i,r,s,a,o,l){if(Ok.apply(this,arguments),Ga){if(Ga){var c=eu;Ga=!1,eu=null}else throw Error(ee(198));tu||(tu=!0,Xh=c)}}function Qs(t){var e=t,n=t;if(t.alternate)for(;e.return;)e=e.return;else{t=e;do e=t,e.flags&4098&&(n=e.return),t=e.return;while(t)}return e.tag===3?n:null}function dy(t){if(t.tag===13){var e=t.memoizedState;if(e===null&&(t=t.alternate,t!==null&&(e=t.memoizedState)),e!==null)return e.dehydrated}return null}function _g(t){if(Qs(t)!==t)throw Error(ee(188))}function Lk(t){var e=t.alternate;if(!e){if(e=Qs(t),e===null)throw Error(ee(188));return e!==t?null:t}for(var n=t,i=e;;){var r=n.return;if(r===null)break;var s=r.alternate;if(s===null){if(i=r.return,i!==null){n=i;continue}break}if(r.child===s.child){for(s=r.child;s;){if(s===n)return _g(r),t;if(s===i)return _g(r),e;s=s.sibling}throw Error(ee(188))}if(n.return!==i.return)n=r,i=s;else{for(var a=!1,o=r.child;o;){if(o===n){a=!0,n=r,i=s;break}if(o===i){a=!0,i=r,n=s;break}o=o.sibling}if(!a){for(o=s.child;o;){if(o===n){a=!0,n=s,i=r;break}if(o===i){a=!0,i=s,n=r;break}o=o.sibling}if(!a)throw Error(ee(189))}}if(n.alternate!==i)throw Error(ee(190))}if(n.tag!==3)throw Error(ee(188));return n.stateNode.current===n?t:e}function hy(t){return t=Lk(t),t!==null?fy(t):null}function fy(t){if(t.tag===5||t.tag===6)return t;for(t=t.child;t!==null;){var e=fy(t);if(e!==null)return e;t=t.sibling}return null}var py=an.unstable_scheduleCallback,yg=an.unstable_cancelCallback,Mk=an.unstable_shouldYield,Dk=an.unstable_requestPaint,Ge=an.unstable_now,Ak=an.unstable_getCurrentPriorityLevel,Dp=an.unstable_ImmediatePriority,my=an.unstable_UserBlockingPriority,nu=an.unstable_NormalPriority,Nk=an.unstable_LowPriority,gy=an.unstable_IdlePriority,Vu=null,wi=null;function Bk(t){if(wi&&typeof wi.onCommitFiberRoot=="function")try{wi.onCommitFiberRoot(Vu,t,void 0,(t.current.flags&128)===128)}catch{}}var jn=Math.clz32?Math.clz32:zk,Fk=Math.log,Uk=Math.LN2;function zk(t){return t>>>=0,t===0?32:31-(Fk(t)/Uk|0)|0}var ic=64,rc=4194304;function Fa(t){switch(t&-t){case 1:return 1;case 2:return 2;case 4:return 4;case 8:return 8;case 16:return 16;case 32:return 32;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return t&4194240;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return t&130023424;case 134217728:return 134217728;case 268435456:return 268435456;case 536870912:return 536870912;case 1073741824:return 1073741824;default:return t}}function iu(t,e){var n=t.pendingLanes;if(n===0)return 0;var i=0,r=t.suspendedLanes,s=t.pingedLanes,a=n&268435455;if(a!==0){var o=a&~r;o!==0?i=Fa(o):(s&=a,s!==0&&(i=Fa(s)))}else a=n&~r,a!==0?i=Fa(a):s!==0&&(i=Fa(s));if(i===0)return 0;if(e!==0&&e!==i&&!(e&r)&&(r=i&-i,s=e&-e,r>=s||r===16&&(s&4194240)!==0))return e;if(i&4&&(i|=n&16),e=t.entangledLanes,e!==0)for(t=t.entanglements,e&=i;0<e;)n=31-jn(e),r=1<<n,i|=t[n],e&=~r;return i}function Hk(t,e){switch(t){case 1:case 2:case 4:return e+250;case 8:case 16:case 32:case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:return e+5e3;case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:return-1;case 134217728:case 268435456:case 536870912:case 1073741824:return-1;default:return-1}}function jk(t,e){for(var n=t.suspendedLanes,i=t.pingedLanes,r=t.expirationTimes,s=t.pendingLanes;0<s;){var a=31-jn(s),o=1<<a,l=r[a];l===-1?(!(o&n)||o&i)&&(r[a]=Hk(o,e)):l<=e&&(t.expiredLanes|=o),s&=~o}}function Yh(t){return t=t.pendingLanes&-1073741825,t!==0?t:t&1073741824?1073741824:0}function vy(){var t=ic;return ic<<=1,!(ic&4194240)&&(ic=64),t}function Hd(t){for(var e=[],n=0;31>n;n++)e.push(t);return e}function Ul(t,e,n){t.pendingLanes|=e,e!==536870912&&(t.suspendedLanes=0,t.pingedLanes=0),t=t.eventTimes,e=31-jn(e),t[e]=n}function Wk(t,e){var n=t.pendingLanes&~e;t.pendingLanes=e,t.suspendedLanes=0,t.pingedLanes=0,t.expiredLanes&=e,t.mutableReadLanes&=e,t.entangledLanes&=e,e=t.entanglements;var i=t.eventTimes;for(t=t.expirationTimes;0<n;){var r=31-jn(n),s=1<<r;e[r]=0,i[r]=-1,t[r]=-1,n&=~s}}function Ap(t,e){var n=t.entangledLanes|=e;for(t=t.entanglements;n;){var i=31-jn(n),r=1<<i;r&e|t[i]&e&&(t[i]|=e),n&=~r}}var ke=0;function _y(t){return t&=-t,1<t?4<t?t&268435455?16:536870912:4:1}var yy,Np,Sy,Cy,by,Zh=!1,sc=[],Kr=null,Qr=null,Xr=null,cl=new Map,ul=new Map,Lr=[],$k="mousedown mouseup touchcancel touchend touchstart auxclick dblclick pointercancel pointerdown pointerup dragend dragstart drop compositionend compositionstart keydown keypress keyup input textInput copy cut paste click change contextmenu reset submit".split(" ");function Sg(t,e){switch(t){case"focusin":case"focusout":Kr=null;break;case"dragenter":case"dragleave":Qr=null;break;case"mouseover":case"mouseout":Xr=null;break;case"pointerover":case"pointerout":cl.delete(e.pointerId);break;case"gotpointercapture":case"lostpointercapture":ul.delete(e.pointerId)}}function wa(t,e,n,i,r,s){return t===null||t.nativeEvent!==s?(t={blockedOn:e,domEventName:n,eventSystemFlags:i,nativeEvent:s,targetContainers:[r]},e!==null&&(e=Hl(e),e!==null&&Np(e)),t):(t.eventSystemFlags|=i,e=t.targetContainers,r!==null&&e.indexOf(r)===-1&&e.push(r),t)}function Vk(t,e,n,i,r){switch(e){case"focusin":return Kr=wa(Kr,t,e,n,i,r),!0;case"dragenter":return Qr=wa(Qr,t,e,n,i,r),!0;case"mouseover":return Xr=wa(Xr,t,e,n,i,r),!0;case"pointerover":var s=r.pointerId;return cl.set(s,wa(cl.get(s)||null,t,e,n,i,r)),!0;case"gotpointercapture":return s=r.pointerId,ul.set(s,wa(ul.get(s)||null,t,e,n,i,r)),!0}return!1}function wy(t){var e=ws(t.target);if(e!==null){var n=Qs(e);if(n!==null){if(e=n.tag,e===13){if(e=dy(n),e!==null){t.blockedOn=e,by(t.priority,function(){Sy(n)});return}}else if(e===3&&n.stateNode.current.memoizedState.isDehydrated){t.blockedOn=n.tag===3?n.stateNode.containerInfo:null;return}}}t.blockedOn=null}function Rc(t){if(t.blockedOn!==null)return!1;for(var e=t.targetContainers;0<e.length;){var n=ef(t.domEventName,t.eventSystemFlags,e[0],t.nativeEvent);if(n===null){n=t.nativeEvent;var i=new n.constructor(n.type,n);Jh=i,n.target.dispatchEvent(i),Jh=null}else return e=Hl(n),e!==null&&Np(e),t.blockedOn=n,!1;e.shift()}return!0}function Cg(t,e,n){Rc(t)&&n.delete(e)}function Gk(){Zh=!1,Kr!==null&&Rc(Kr)&&(Kr=null),Qr!==null&&Rc(Qr)&&(Qr=null),Xr!==null&&Rc(Xr)&&(Xr=null),cl.forEach(Cg),ul.forEach(Cg)}function ka(t,e){t.blockedOn===e&&(t.blockedOn=null,Zh||(Zh=!0,an.unstable_scheduleCallback(an.unstable_NormalPriority,Gk)))}function dl(t){function e(r){return ka(r,t)}if(0<sc.length){ka(sc[0],t);for(var n=1;n<sc.length;n++){var i=sc[n];i.blockedOn===t&&(i.blockedOn=null)}}for(Kr!==null&&ka(Kr,t),Qr!==null&&ka(Qr,t),Xr!==null&&ka(Xr,t),cl.forEach(e),ul.forEach(e),n=0;n<Lr.length;n++)i=Lr[n],i.blockedOn===t&&(i.blockedOn=null);for(;0<Lr.length&&(n=Lr[0],n.blockedOn===null);)wy(n),n.blockedOn===null&&Lr.shift()}var bo=Sr.ReactCurrentBatchConfig,ru=!0;function qk(t,e,n,i){var r=ke,s=bo.transition;bo.transition=null;try{ke=1,Bp(t,e,n,i)}finally{ke=r,bo.transition=s}}function Jk(t,e,n,i){var r=ke,s=bo.transition;bo.transition=null;try{ke=4,Bp(t,e,n,i)}finally{ke=r,bo.transition=s}}function Bp(t,e,n,i){if(ru){var r=ef(t,e,n,i);if(r===null)Xd(t,e,i,su,n),Sg(t,i);else if(Vk(r,t,e,n,i))i.stopPropagation();else if(Sg(t,i),e&4&&-1<$k.indexOf(t)){for(;r!==null;){var s=Hl(r);if(s!==null&&yy(s),s=ef(t,e,n,i),s===null&&Xd(t,e,i,su,n),s===r)break;r=s}r!==null&&i.stopPropagation()}else Xd(t,e,i,null,n)}}var su=null;function ef(t,e,n,i){if(su=null,t=Mp(i),t=ws(t),t!==null)if(e=Qs(t),e===null)t=null;else if(n=e.tag,n===13){if(t=dy(e),t!==null)return t;t=null}else if(n===3){if(e.stateNode.current.memoizedState.isDehydrated)return e.tag===3?e.stateNode.containerInfo:null;t=null}else e!==t&&(t=null);return su=t,null}function ky(t){switch(t){case"cancel":case"click":case"close":case"contextmenu":case"copy":case"cut":case"auxclick":case"dblclick":case"dragend":case"dragstart":case"drop":case"focusin":case"focusout":case"input":case"invalid":case"keydown":case"keypress":case"keyup":case"mousedown":case"mouseup":case"paste":case"pause":case"play":case"pointercancel":case"pointerdown":case"pointerup":case"ratechange":case"reset":case"resize":case"seeked":case"submit":case"touchcancel":case"touchend":case"touchstart":case"volumechange":case"change":case"selectionchange":case"textInput":case"compositionstart":case"compositionend":case"compositionupdate":case"beforeblur":case"afterblur":case"beforeinput":case"blur":case"fullscreenchange":case"focus":case"hashchange":case"popstate":case"select":case"selectstart":return 1;case"drag":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"mousemove":case"mouseout":case"mouseover":case"pointermove":case"pointerout":case"pointerover":case"scroll":case"toggle":case"touchmove":case"wheel":case"mouseenter":case"mouseleave":case"pointerenter":case"pointerleave":return 4;case"message":switch(Ak()){case Dp:return 1;case my:return 4;case nu:case Nk:return 16;case gy:return 536870912;default:return 16}default:return 16}}var Ur=null,Fp=null,xc=null;function Ey(){if(xc)return xc;var t,e=Fp,n=e.length,i,r="value"in Ur?Ur.value:Ur.textContent,s=r.length;for(t=0;t<n&&e[t]===r[t];t++);var a=n-t;for(i=1;i<=a&&e[n-i]===r[s-i];i++);return xc=r.slice(t,1<i?1-i:void 0)}function Pc(t){var e=t.keyCode;return"charCode"in t?(t=t.charCode,t===0&&e===13&&(t=13)):t=e,t===10&&(t=13),32<=t||t===13?t:0}function oc(){return!0}function bg(){return!1}function cn(t){function e(n,i,r,s,a){this._reactName=n,this._targetInst=r,this.type=i,this.nativeEvent=s,this.target=a,this.currentTarget=null;for(var o in t)t.hasOwnProperty(o)&&(n=t[o],this[o]=n?n(s):s[o]);return this.isDefaultPrevented=(s.defaultPrevented!=null?s.defaultPrevented:s.returnValue===!1)?oc:bg,this.isPropagationStopped=bg,this}return Fe(e.prototype,{preventDefault:function(){this.defaultPrevented=!0;var n=this.nativeEvent;n&&(n.preventDefault?n.preventDefault():typeof n.returnValue!="unknown"&&(n.returnValue=!1),this.isDefaultPrevented=oc)},stopPropagation:function(){var n=this.nativeEvent;n&&(n.stopPropagation?n.stopPropagation():typeof n.cancelBubble!="unknown"&&(n.cancelBubble=!0),this.isPropagationStopped=oc)},persist:function(){},isPersistent:oc}),e}var oa={eventPhase:0,bubbles:0,cancelable:0,timeStamp:function(t){return t.timeStamp||Date.now()},defaultPrevented:0,isTrusted:0},Up=cn(oa),zl=Fe({},oa,{view:0,detail:0}),Kk=cn(zl),jd,Wd,Ea,Gu=Fe({},zl,{screenX:0,screenY:0,clientX:0,clientY:0,pageX:0,pageY:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,getModifierState:zp,button:0,buttons:0,relatedTarget:function(t){return t.relatedTarget===void 0?t.fromElement===t.srcElement?t.toElement:t.fromElement:t.relatedTarget},movementX:function(t){return"movementX"in t?t.movementX:(t!==Ea&&(Ea&&t.type==="mousemove"?(jd=t.screenX-Ea.screenX,Wd=t.screenY-Ea.screenY):Wd=jd=0,Ea=t),jd)},movementY:function(t){return"movementY"in t?t.movementY:Wd}}),wg=cn(Gu),Qk=Fe({},Gu,{dataTransfer:0}),Xk=cn(Qk),Yk=Fe({},zl,{relatedTarget:0}),$d=cn(Yk),Zk=Fe({},oa,{animationName:0,elapsedTime:0,pseudoElement:0}),eE=cn(Zk),tE=Fe({},oa,{clipboardData:function(t){return"clipboardData"in t?t.clipboardData:window.clipboardData}}),nE=cn(tE),iE=Fe({},oa,{data:0}),kg=cn(iE),rE={Esc:"Escape",Spacebar:" ",Left:"ArrowLeft",Up:"ArrowUp",Right:"ArrowRight",Down:"ArrowDown",Del:"Delete",Win:"OS",Menu:"ContextMenu",Apps:"ContextMenu",Scroll:"ScrollLock",MozPrintableKey:"Unidentified"},sE={8:"Backspace",9:"Tab",12:"Clear",13:"Enter",16:"Shift",17:"Control",18:"Alt",19:"Pause",20:"CapsLock",27:"Escape",32:" ",33:"PageUp",34:"PageDown",35:"End",36:"Home",37:"ArrowLeft",38:"ArrowUp",39:"ArrowRight",40:"ArrowDown",45:"Insert",46:"Delete",112:"F1",113:"F2",114:"F3",115:"F4",116:"F5",117:"F6",118:"F7",119:"F8",120:"F9",121:"F10",122:"F11",123:"F12",144:"NumLock",145:"ScrollLock",224:"Meta"},oE={Alt:"altKey",Control:"ctrlKey",Meta:"metaKey",Shift:"shiftKey"};function aE(t){var e=this.nativeEvent;return e.getModifierState?e.getModifierState(t):(t=oE[t])?!!e[t]:!1}function zp(){return aE}var lE=Fe({},zl,{key:function(t){if(t.key){var e=rE[t.key]||t.key;if(e!=="Unidentified")return e}return t.type==="keypress"?(t=Pc(t),t===13?"Enter":String.fromCharCode(t)):t.type==="keydown"||t.type==="keyup"?sE[t.keyCode]||"Unidentified":""},code:0,location:0,ctrlKey:0,shiftKey:0,altKey:0,metaKey:0,repeat:0,locale:0,getModifierState:zp,charCode:function(t){return t.type==="keypress"?Pc(t):0},keyCode:function(t){return t.type==="keydown"||t.type==="keyup"?t.keyCode:0},which:function(t){return t.type==="keypress"?Pc(t):t.type==="keydown"||t.type==="keyup"?t.keyCode:0}}),cE=cn(lE),uE=Fe({},Gu,{pointerId:0,width:0,height:0,pressure:0,tangentialPressure:0,tiltX:0,tiltY:0,twist:0,pointerType:0,isPrimary:0}),Eg=cn(uE),dE=Fe({},zl,{touches:0,targetTouches:0,changedTouches:0,altKey:0,metaKey:0,ctrlKey:0,shiftKey:0,getModifierState:zp}),hE=cn(dE),fE=Fe({},oa,{propertyName:0,elapsedTime:0,pseudoElement:0}),pE=cn(fE),mE=Fe({},Gu,{deltaX:function(t){return"deltaX"in t?t.deltaX:"wheelDeltaX"in t?-t.wheelDeltaX:0},deltaY:function(t){return"deltaY"in t?t.deltaY:"wheelDeltaY"in t?-t.wheelDeltaY:"wheelDelta"in t?-t.wheelDelta:0},deltaZ:0,deltaMode:0}),gE=cn(mE),vE=[9,13,27,32],Hp=pr&&"CompositionEvent"in window,qa=null;pr&&"documentMode"in document&&(qa=document.documentMode);var _E=pr&&"TextEvent"in window&&!qa,Ty=pr&&(!Hp||qa&&8<qa&&11>=qa),Tg=String.fromCharCode(32),Rg=!1;function Ry(t,e){switch(t){case"keyup":return vE.indexOf(e.keyCode)!==-1;case"keydown":return e.keyCode!==229;case"keypress":case"mousedown":case"focusout":return!0;default:return!1}}function xy(t){return t=t.detail,typeof t=="object"&&"data"in t?t.data:null}var so=!1;function yE(t,e){switch(t){case"compositionend":return xy(e);case"keypress":return e.which!==32?null:(Rg=!0,Tg);case"textInput":return t=e.data,t===Tg&&Rg?null:t;default:return null}}function SE(t,e){if(so)return t==="compositionend"||!Hp&&Ry(t,e)?(t=Ey(),xc=Fp=Ur=null,so=!1,t):null;switch(t){case"paste":return null;case"keypress":if(!(e.ctrlKey||e.altKey||e.metaKey)||e.ctrlKey&&e.altKey){if(e.char&&1<e.char.length)return e.char;if(e.which)return String.fromCharCode(e.which)}return null;case"compositionend":return Ty&&e.locale!=="ko"?null:e.data;default:return null}}var CE={color:!0,date:!0,datetime:!0,"datetime-local":!0,email:!0,month:!0,number:!0,password:!0,range:!0,search:!0,tel:!0,text:!0,time:!0,url:!0,week:!0};function xg(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e==="input"?!!CE[t.type]:e==="textarea"}function Py(t,e,n,i){oy(i),e=ou(e,"onChange"),0<e.length&&(n=new Up("onChange","change",null,n,i),t.push({event:n,listeners:e}))}var Ja=null,hl=null;function bE(t){zy(t,0)}function qu(t){var e=lo(t);if(Z_(e))return t}function wE(t,e){if(t==="change")return e}var Oy=!1;if(pr){var Vd;if(pr){var Gd="oninput"in document;if(!Gd){var Pg=document.createElement("div");Pg.setAttribute("oninput","return;"),Gd=typeof Pg.oninput=="function"}Vd=Gd}else Vd=!1;Oy=Vd&&(!document.documentMode||9<document.documentMode)}function Og(){Ja&&(Ja.detachEvent("onpropertychange",Iy),hl=Ja=null)}function Iy(t){if(t.propertyName==="value"&&qu(hl)){var e=[];Py(e,hl,t,Mp(t)),uy(bE,e)}}function kE(t,e,n){t==="focusin"?(Og(),Ja=e,hl=n,Ja.attachEvent("onpropertychange",Iy)):t==="focusout"&&Og()}function EE(t){if(t==="selectionchange"||t==="keyup"||t==="keydown")return qu(hl)}function TE(t,e){if(t==="click")return qu(e)}function RE(t,e){if(t==="input"||t==="change")return qu(e)}function xE(t,e){return t===e&&(t!==0||1/t===1/e)||t!==t&&e!==e}var Gn=typeof Object.is=="function"?Object.is:xE;function fl(t,e){if(Gn(t,e))return!0;if(typeof t!="object"||t===null||typeof e!="object"||e===null)return!1;var n=Object.keys(t),i=Object.keys(e);if(n.length!==i.length)return!1;for(i=0;i<n.length;i++){var r=n[i];if(!Nh.call(e,r)||!Gn(t[r],e[r]))return!1}return!0}function Ig(t){for(;t&&t.firstChild;)t=t.firstChild;return t}function Lg(t,e){var n=Ig(t);t=0;for(var i;n;){if(n.nodeType===3){if(i=t+n.textContent.length,t<=e&&i>=e)return{node:n,offset:e-t};t=i}e:{for(;n;){if(n.nextSibling){n=n.nextSibling;break e}n=n.parentNode}n=void 0}n=Ig(n)}}function Ly(t,e){return t&&e?t===e?!0:t&&t.nodeType===3?!1:e&&e.nodeType===3?Ly(t,e.parentNode):"contains"in t?t.contains(e):t.compareDocumentPosition?!!(t.compareDocumentPosition(e)&16):!1:!1}function My(){for(var t=window,e=Zc();e instanceof t.HTMLIFrameElement;){try{var n=typeof e.contentWindow.location.href=="string"}catch{n=!1}if(n)t=e.contentWindow;else break;e=Zc(t.document)}return e}function jp(t){var e=t&&t.nodeName&&t.nodeName.toLowerCase();return e&&(e==="input"&&(t.type==="text"||t.type==="search"||t.type==="tel"||t.type==="url"||t.type==="password")||e==="textarea"||t.contentEditable==="true")}function PE(t){var e=My(),n=t.focusedElem,i=t.selectionRange;if(e!==n&&n&&n.ownerDocument&&Ly(n.ownerDocument.documentElement,n)){if(i!==null&&jp(n)){if(e=i.start,t=i.end,t===void 0&&(t=e),"selectionStart"in n)n.selectionStart=e,n.selectionEnd=Math.min(t,n.value.length);else if(t=(e=n.ownerDocument||document)&&e.defaultView||window,t.getSelection){t=t.getSelection();var r=n.textContent.length,s=Math.min(i.start,r);i=i.end===void 0?s:Math.min(i.end,r),!t.extend&&s>i&&(r=i,i=s,s=r),r=Lg(n,s);var a=Lg(n,i);r&&a&&(t.rangeCount!==1||t.anchorNode!==r.node||t.anchorOffset!==r.offset||t.focusNode!==a.node||t.focusOffset!==a.offset)&&(e=e.createRange(),e.setStart(r.node,r.offset),t.removeAllRanges(),s>i?(t.addRange(e),t.extend(a.node,a.offset)):(e.setEnd(a.node,a.offset),t.addRange(e)))}}for(e=[],t=n;t=t.parentNode;)t.nodeType===1&&e.push({element:t,left:t.scrollLeft,top:t.scrollTop});for(typeof n.focus=="function"&&n.focus(),n=0;n<e.length;n++)t=e[n],t.element.scrollLeft=t.left,t.element.scrollTop=t.top}}var OE=pr&&"documentMode"in document&&11>=document.documentMode,oo=null,tf=null,Ka=null,nf=!1;function Mg(t,e,n){var i=n.window===n?n.document:n.nodeType===9?n:n.ownerDocument;nf||oo==null||oo!==Zc(i)||(i=oo,"selectionStart"in i&&jp(i)?i={start:i.selectionStart,end:i.selectionEnd}:(i=(i.ownerDocument&&i.ownerDocument.defaultView||window).getSelection(),i={anchorNode:i.anchorNode,anchorOffset:i.anchorOffset,focusNode:i.focusNode,focusOffset:i.focusOffset}),Ka&&fl(Ka,i)||(Ka=i,i=ou(tf,"onSelect"),0<i.length&&(e=new Up("onSelect","select",null,e,n),t.push({event:e,listeners:i}),e.target=oo)))}function ac(t,e){var n={};return n[t.toLowerCase()]=e.toLowerCase(),n["Webkit"+t]="webkit"+e,n["Moz"+t]="moz"+e,n}var ao={animationend:ac("Animation","AnimationEnd"),animationiteration:ac("Animation","AnimationIteration"),animationstart:ac("Animation","AnimationStart"),transitionend:ac("Transition","TransitionEnd")},qd={},Dy={};pr&&(Dy=document.createElement("div").style,"AnimationEvent"in window||(delete ao.animationend.animation,delete ao.animationiteration.animation,delete ao.animationstart.animation),"TransitionEvent"in window||delete ao.transitionend.transition);function Ju(t){if(qd[t])return qd[t];if(!ao[t])return t;var e=ao[t],n;for(n in e)if(e.hasOwnProperty(n)&&n in Dy)return qd[t]=e[n];return t}var Ay=Ju("animationend"),Ny=Ju("animationiteration"),By=Ju("animationstart"),Fy=Ju("transitionend"),Uy=new Map,Dg="abort auxClick cancel canPlay canPlayThrough click close contextMenu copy cut drag dragEnd dragEnter dragExit dragLeave dragOver dragStart drop durationChange emptied encrypted ended error gotPointerCapture input invalid keyDown keyPress keyUp load loadedData loadedMetadata loadStart lostPointerCapture mouseDown mouseMove mouseOut mouseOver mouseUp paste pause play playing pointerCancel pointerDown pointerMove pointerOut pointerOver pointerUp progress rateChange reset resize seeked seeking stalled submit suspend timeUpdate touchCancel touchEnd touchStart volumeChange scroll toggle touchMove waiting wheel".split(" ");function fs(t,e){Uy.set(t,e),Ks(e,[t])}for(var Jd=0;Jd<Dg.length;Jd++){var Kd=Dg[Jd],IE=Kd.toLowerCase(),LE=Kd[0].toUpperCase()+Kd.slice(1);fs(IE,"on"+LE)}fs(Ay,"onAnimationEnd");fs(Ny,"onAnimationIteration");fs(By,"onAnimationStart");fs("dblclick","onDoubleClick");fs("focusin","onFocus");fs("focusout","onBlur");fs(Fy,"onTransitionEnd");jo("onMouseEnter",["mouseout","mouseover"]);jo("onMouseLeave",["mouseout","mouseover"]);jo("onPointerEnter",["pointerout","pointerover"]);jo("onPointerLeave",["pointerout","pointerover"]);Ks("onChange","change click focusin focusout input keydown keyup selectionchange".split(" "));Ks("onSelect","focusout contextmenu dragend focusin keydown keyup mousedown mouseup selectionchange".split(" "));Ks("onBeforeInput",["compositionend","keypress","textInput","paste"]);Ks("onCompositionEnd","compositionend focusout keydown keypress keyup mousedown".split(" "));Ks("onCompositionStart","compositionstart focusout keydown keypress keyup mousedown".split(" "));Ks("onCompositionUpdate","compositionupdate focusout keydown keypress keyup mousedown".split(" "));var Ua="abort canplay canplaythrough durationchange emptied encrypted ended error loadeddata loadedmetadata loadstart pause play playing progress ratechange resize seeked seeking stalled suspend timeupdate volumechange waiting".split(" "),ME=new Set("cancel close invalid load scroll toggle".split(" ").concat(Ua));function Ag(t,e,n){var i=t.type||"unknown-event";t.currentTarget=n,Ik(i,e,void 0,t),t.currentTarget=null}function zy(t,e){e=(e&4)!==0;for(var n=0;n<t.length;n++){var i=t[n],r=i.event;i=i.listeners;e:{var s=void 0;if(e)for(var a=i.length-1;0<=a;a--){var o=i[a],l=o.instance,c=o.currentTarget;if(o=o.listener,l!==s&&r.isPropagationStopped())break e;Ag(r,o,c),s=l}else for(a=0;a<i.length;a++){if(o=i[a],l=o.instance,c=o.currentTarget,o=o.listener,l!==s&&r.isPropagationStopped())break e;Ag(r,o,c),s=l}}}if(tu)throw t=Xh,tu=!1,Xh=null,t}function Ie(t,e){var n=e[lf];n===void 0&&(n=e[lf]=new Set);var i=t+"__bubble";n.has(i)||(Hy(e,t,2,!1),n.add(i))}function Qd(t,e,n){var i=0;e&&(i|=4),Hy(n,t,i,e)}var lc="_reactListening"+Math.random().toString(36).slice(2);function pl(t){if(!t[lc]){t[lc]=!0,J_.forEach(function(n){n!=="selectionchange"&&(ME.has(n)||Qd(n,!1,t),Qd(n,!0,t))});var e=t.nodeType===9?t:t.ownerDocument;e===null||e[lc]||(e[lc]=!0,Qd("selectionchange",!1,e))}}function Hy(t,e,n,i){switch(ky(e)){case 1:var r=qk;break;case 4:r=Jk;break;default:r=Bp}n=r.bind(null,e,n,t),r=void 0,!Qh||e!=="touchstart"&&e!=="touchmove"&&e!=="wheel"||(r=!0),i?r!==void 0?t.addEventListener(e,n,{capture:!0,passive:r}):t.addEventListener(e,n,!0):r!==void 0?t.addEventListener(e,n,{passive:r}):t.addEventListener(e,n,!1)}function Xd(t,e,n,i,r){var s=i;if(!(e&1)&&!(e&2)&&i!==null)e:for(;;){if(i===null)return;var a=i.tag;if(a===3||a===4){var o=i.stateNode.containerInfo;if(o===r||o.nodeType===8&&o.parentNode===r)break;if(a===4)for(a=i.return;a!==null;){var l=a.tag;if((l===3||l===4)&&(l=a.stateNode.containerInfo,l===r||l.nodeType===8&&l.parentNode===r))return;a=a.return}for(;o!==null;){if(a=ws(o),a===null)return;if(l=a.tag,l===5||l===6){i=s=a;continue e}o=o.parentNode}}i=i.return}uy(function(){var c=s,d=Mp(n),u=[];e:{var m=Uy.get(t);if(m!==void 0){var v=Up,y=t;switch(t){case"keypress":if(Pc(n)===0)break e;case"keydown":case"keyup":v=cE;break;case"focusin":y="focus",v=$d;break;case"focusout":y="blur",v=$d;break;case"beforeblur":case"afterblur":v=$d;break;case"click":if(n.button===2)break e;case"auxclick":case"dblclick":case"mousedown":case"mousemove":case"mouseup":case"mouseout":case"mouseover":case"contextmenu":v=wg;break;case"drag":case"dragend":case"dragenter":case"dragexit":case"dragleave":case"dragover":case"dragstart":case"drop":v=Xk;break;case"touchcancel":case"touchend":case"touchmove":case"touchstart":v=hE;break;case Ay:case Ny:case By:v=eE;break;case Fy:v=pE;break;case"scroll":v=Kk;break;case"wheel":v=gE;break;case"copy":case"cut":case"paste":v=nE;break;case"gotpointercapture":case"lostpointercapture":case"pointercancel":case"pointerdown":case"pointermove":case"pointerout":case"pointerover":case"pointerup":v=Eg}var _=(e&4)!==0,p=!_&&t==="scroll",f=_?m!==null?m+"Capture":null:m;_=[];for(var h=c,g;h!==null;){g=h;var S=g.stateNode;if(g.tag===5&&S!==null&&(g=S,f!==null&&(S=ll(h,f),S!=null&&_.push(ml(h,S,g)))),p)break;h=h.return}0<_.length&&(m=new v(m,y,null,n,d),u.push({event:m,listeners:_}))}}if(!(e&7)){e:{if(m=t==="mouseover"||t==="pointerover",v=t==="mouseout"||t==="pointerout",m&&n!==Jh&&(y=n.relatedTarget||n.fromElement)&&(ws(y)||y[mr]))break e;if((v||m)&&(m=d.window===d?d:(m=d.ownerDocument)?m.defaultView||m.parentWindow:window,v?(y=n.relatedTarget||n.toElement,v=c,y=y?ws(y):null,y!==null&&(p=Qs(y),y!==p||y.tag!==5&&y.tag!==6)&&(y=null)):(v=null,y=c),v!==y)){if(_=wg,S="onMouseLeave",f="onMouseEnter",h="mouse",(t==="pointerout"||t==="pointerover")&&(_=Eg,S="onPointerLeave",f="onPointerEnter",h="pointer"),p=v==null?m:lo(v),g=y==null?m:lo(y),m=new _(S,h+"leave",v,n,d),m.target=p,m.relatedTarget=g,S=null,ws(d)===c&&(_=new _(f,h+"enter",y,n,d),_.target=g,_.relatedTarget=p,S=_),p=S,v&&y)t:{for(_=v,f=y,h=0,g=_;g;g=Ys(g))h++;for(g=0,S=f;S;S=Ys(S))g++;for(;0<h-g;)_=Ys(_),h--;for(;0<g-h;)f=Ys(f),g--;for(;h--;){if(_===f||f!==null&&_===f.alternate)break t;_=Ys(_),f=Ys(f)}_=null}else _=null;v!==null&&Ng(u,m,v,_,!1),y!==null&&p!==null&&Ng(u,p,y,_,!0)}}e:{if(m=c?lo(c):window,v=m.nodeName&&m.nodeName.toLowerCase(),v==="select"||v==="input"&&m.type==="file")var b=wE;else if(xg(m))if(Oy)b=RE;else{b=EE;var w=kE}else(v=m.nodeName)&&v.toLowerCase()==="input"&&(m.type==="checkbox"||m.type==="radio")&&(b=TE);if(b&&(b=b(t,c))){Py(u,b,n,d);break e}w&&w(t,m,c),t==="focusout"&&(w=m._wrapperState)&&w.controlled&&m.type==="number"&&Wh(m,"number",m.value)}switch(w=c?lo(c):window,t){case"focusin":(xg(w)||w.contentEditable==="true")&&(oo=w,tf=c,Ka=null);break;case"focusout":Ka=tf=oo=null;break;case"mousedown":nf=!0;break;case"contextmenu":case"mouseup":case"dragend":nf=!1,Mg(u,n,d);break;case"selectionchange":if(OE)break;case"keydown":case"keyup":Mg(u,n,d)}var k;if(Hp)e:{switch(t){case"compositionstart":var C="onCompositionStart";break e;case"compositionend":C="onCompositionEnd";break e;case"compositionupdate":C="onCompositionUpdate";break e}C=void 0}else so?Ry(t,n)&&(C="onCompositionEnd"):t==="keydown"&&n.keyCode===229&&(C="onCompositionStart");C&&(Ty&&n.locale!=="ko"&&(so||C!=="onCompositionStart"?C==="onCompositionEnd"&&so&&(k=Ey()):(Ur=d,Fp="value"in Ur?Ur.value:Ur.textContent,so=!0)),w=ou(c,C),0<w.length&&(C=new kg(C,t,null,n,d),u.push({event:C,listeners:w}),k?C.data=k:(k=xy(n),k!==null&&(C.data=k)))),(k=_E?yE(t,n):SE(t,n))&&(c=ou(c,"onBeforeInput"),0<c.length&&(d=new kg("onBeforeInput","beforeinput",null,n,d),u.push({event:d,listeners:c}),d.data=k))}zy(u,e)})}function ml(t,e,n){return{instance:t,listener:e,currentTarget:n}}function ou(t,e){for(var n=e+"Capture",i=[];t!==null;){var r=t,s=r.stateNode;r.tag===5&&s!==null&&(r=s,s=ll(t,n),s!=null&&i.unshift(ml(t,s,r)),s=ll(t,e),s!=null&&i.push(ml(t,s,r))),t=t.return}return i}function Ys(t){if(t===null)return null;do t=t.return;while(t&&t.tag!==5);return t||null}function Ng(t,e,n,i,r){for(var s=e._reactName,a=[];n!==null&&n!==i;){var o=n,l=o.alternate,c=o.stateNode;if(l!==null&&l===i)break;o.tag===5&&c!==null&&(o=c,r?(l=ll(n,s),l!=null&&a.unshift(ml(n,l,o))):r||(l=ll(n,s),l!=null&&a.push(ml(n,l,o)))),n=n.return}a.length!==0&&t.push({event:e,listeners:a})}var DE=/\r\n?/g,AE=/\u0000|\uFFFD/g;function Bg(t){return(typeof t=="string"?t:""+t).replace(DE,`
`).replace(AE,"")}function cc(t,e,n){if(e=Bg(e),Bg(t)!==e&&n)throw Error(ee(425))}function au(){}var rf=null,sf=null;function of(t,e){return t==="textarea"||t==="noscript"||typeof e.children=="string"||typeof e.children=="number"||typeof e.dangerouslySetInnerHTML=="object"&&e.dangerouslySetInnerHTML!==null&&e.dangerouslySetInnerHTML.__html!=null}var af=typeof setTimeout=="function"?setTimeout:void 0,NE=typeof clearTimeout=="function"?clearTimeout:void 0,Fg=typeof Promise=="function"?Promise:void 0,BE=typeof queueMicrotask=="function"?queueMicrotask:typeof Fg<"u"?function(t){return Fg.resolve(null).then(t).catch(FE)}:af;function FE(t){setTimeout(function(){throw t})}function Yd(t,e){var n=e,i=0;do{var r=n.nextSibling;if(t.removeChild(n),r&&r.nodeType===8)if(n=r.data,n==="/$"){if(i===0){t.removeChild(r),dl(e);return}i--}else n!=="$"&&n!=="$?"&&n!=="$!"||i++;n=r}while(n);dl(e)}function Yr(t){for(;t!=null;t=t.nextSibling){var e=t.nodeType;if(e===1||e===3)break;if(e===8){if(e=t.data,e==="$"||e==="$!"||e==="$?")break;if(e==="/$")return null}}return t}function Ug(t){t=t.previousSibling;for(var e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="$"||n==="$!"||n==="$?"){if(e===0)return t;e--}else n==="/$"&&e++}t=t.previousSibling}return null}var aa=Math.random().toString(36).slice(2),si="__reactFiber$"+aa,gl="__reactProps$"+aa,mr="__reactContainer$"+aa,lf="__reactEvents$"+aa,UE="__reactListeners$"+aa,zE="__reactHandles$"+aa;function ws(t){var e=t[si];if(e)return e;for(var n=t.parentNode;n;){if(e=n[mr]||n[si]){if(n=e.alternate,e.child!==null||n!==null&&n.child!==null)for(t=Ug(t);t!==null;){if(n=t[si])return n;t=Ug(t)}return e}t=n,n=t.parentNode}return null}function Hl(t){return t=t[si]||t[mr],!t||t.tag!==5&&t.tag!==6&&t.tag!==13&&t.tag!==3?null:t}function lo(t){if(t.tag===5||t.tag===6)return t.stateNode;throw Error(ee(33))}function Ku(t){return t[gl]||null}var cf=[],co=-1;function ps(t){return{current:t}}function Me(t){0>co||(t.current=cf[co],cf[co]=null,co--)}function Pe(t,e){co++,cf[co]=t.current,t.current=e}var ls={},Tt=ps(ls),Vt=ps(!1),As=ls;function Wo(t,e){var n=t.type.contextTypes;if(!n)return ls;var i=t.stateNode;if(i&&i.__reactInternalMemoizedUnmaskedChildContext===e)return i.__reactInternalMemoizedMaskedChildContext;var r={},s;for(s in n)r[s]=e[s];return i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=e,t.__reactInternalMemoizedMaskedChildContext=r),r}function Gt(t){return t=t.childContextTypes,t!=null}function lu(){Me(Vt),Me(Tt)}function zg(t,e,n){if(Tt.current!==ls)throw Error(ee(168));Pe(Tt,e),Pe(Vt,n)}function jy(t,e,n){var i=t.stateNode;if(e=e.childContextTypes,typeof i.getChildContext!="function")return n;i=i.getChildContext();for(var r in i)if(!(r in e))throw Error(ee(108,kk(t)||"Unknown",r));return Fe({},n,i)}function cu(t){return t=(t=t.stateNode)&&t.__reactInternalMemoizedMergedChildContext||ls,As=Tt.current,Pe(Tt,t),Pe(Vt,Vt.current),!0}function Hg(t,e,n){var i=t.stateNode;if(!i)throw Error(ee(169));n?(t=jy(t,e,As),i.__reactInternalMemoizedMergedChildContext=t,Me(Vt),Me(Tt),Pe(Tt,t)):Me(Vt),Pe(Vt,n)}var Di=null,Qu=!1,Zd=!1;function Wy(t){Di===null?Di=[t]:Di.push(t)}function HE(t){Qu=!0,Wy(t)}function ms(){if(!Zd&&Di!==null){Zd=!0;var t=0,e=ke;try{var n=Di;for(ke=1;t<n.length;t++){var i=n[t];do i=i(!0);while(i!==null)}Di=null,Qu=!1}catch(r){throw Di!==null&&(Di=Di.slice(t+1)),py(Dp,ms),r}finally{ke=e,Zd=!1}}return null}var uo=[],ho=0,uu=null,du=0,fn=[],pn=0,Ns=null,Fi=1,Ui="";function Ss(t,e){uo[ho++]=du,uo[ho++]=uu,uu=t,du=e}function $y(t,e,n){fn[pn++]=Fi,fn[pn++]=Ui,fn[pn++]=Ns,Ns=t;var i=Fi;t=Ui;var r=32-jn(i)-1;i&=~(1<<r),n+=1;var s=32-jn(e)+r;if(30<s){var a=r-r%5;s=(i&(1<<a)-1).toString(32),i>>=a,r-=a,Fi=1<<32-jn(e)+r|n<<r|i,Ui=s+t}else Fi=1<<s|n<<r|i,Ui=t}function Wp(t){t.return!==null&&(Ss(t,1),$y(t,1,0))}function $p(t){for(;t===uu;)uu=uo[--ho],uo[ho]=null,du=uo[--ho],uo[ho]=null;for(;t===Ns;)Ns=fn[--pn],fn[pn]=null,Ui=fn[--pn],fn[pn]=null,Fi=fn[--pn],fn[pn]=null}var rn=null,tn=null,De=!1,Mn=null;function Vy(t,e){var n=gn(5,null,null,0);n.elementType="DELETED",n.stateNode=e,n.return=t,e=t.deletions,e===null?(t.deletions=[n],t.flags|=16):e.push(n)}function jg(t,e){switch(t.tag){case 5:var n=t.type;return e=e.nodeType!==1||n.toLowerCase()!==e.nodeName.toLowerCase()?null:e,e!==null?(t.stateNode=e,rn=t,tn=Yr(e.firstChild),!0):!1;case 6:return e=t.pendingProps===""||e.nodeType!==3?null:e,e!==null?(t.stateNode=e,rn=t,tn=null,!0):!1;case 13:return e=e.nodeType!==8?null:e,e!==null?(n=Ns!==null?{id:Fi,overflow:Ui}:null,t.memoizedState={dehydrated:e,treeContext:n,retryLane:1073741824},n=gn(18,null,null,0),n.stateNode=e,n.return=t,t.child=n,rn=t,tn=null,!0):!1;default:return!1}}function uf(t){return(t.mode&1)!==0&&(t.flags&128)===0}function df(t){if(De){var e=tn;if(e){var n=e;if(!jg(t,e)){if(uf(t))throw Error(ee(418));e=Yr(n.nextSibling);var i=rn;e&&jg(t,e)?Vy(i,n):(t.flags=t.flags&-4097|2,De=!1,rn=t)}}else{if(uf(t))throw Error(ee(418));t.flags=t.flags&-4097|2,De=!1,rn=t}}}function Wg(t){for(t=t.return;t!==null&&t.tag!==5&&t.tag!==3&&t.tag!==13;)t=t.return;rn=t}function uc(t){if(t!==rn)return!1;if(!De)return Wg(t),De=!0,!1;var e;if((e=t.tag!==3)&&!(e=t.tag!==5)&&(e=t.type,e=e!=="head"&&e!=="body"&&!of(t.type,t.memoizedProps)),e&&(e=tn)){if(uf(t))throw Gy(),Error(ee(418));for(;e;)Vy(t,e),e=Yr(e.nextSibling)}if(Wg(t),t.tag===13){if(t=t.memoizedState,t=t!==null?t.dehydrated:null,!t)throw Error(ee(317));e:{for(t=t.nextSibling,e=0;t;){if(t.nodeType===8){var n=t.data;if(n==="/$"){if(e===0){tn=Yr(t.nextSibling);break e}e--}else n!=="$"&&n!=="$!"&&n!=="$?"||e++}t=t.nextSibling}tn=null}}else tn=rn?Yr(t.stateNode.nextSibling):null;return!0}function Gy(){for(var t=tn;t;)t=Yr(t.nextSibling)}function $o(){tn=rn=null,De=!1}function Vp(t){Mn===null?Mn=[t]:Mn.push(t)}var jE=Sr.ReactCurrentBatchConfig;function Ta(t,e,n){if(t=n.ref,t!==null&&typeof t!="function"&&typeof t!="object"){if(n._owner){if(n=n._owner,n){if(n.tag!==1)throw Error(ee(309));var i=n.stateNode}if(!i)throw Error(ee(147,t));var r=i,s=""+t;return e!==null&&e.ref!==null&&typeof e.ref=="function"&&e.ref._stringRef===s?e.ref:(e=function(a){var o=r.refs;a===null?delete o[s]:o[s]=a},e._stringRef=s,e)}if(typeof t!="string")throw Error(ee(284));if(!n._owner)throw Error(ee(290,t))}return t}function dc(t,e){throw t=Object.prototype.toString.call(e),Error(ee(31,t==="[object Object]"?"object with keys {"+Object.keys(e).join(", ")+"}":t))}function $g(t){var e=t._init;return e(t._payload)}function qy(t){function e(f,h){if(t){var g=f.deletions;g===null?(f.deletions=[h],f.flags|=16):g.push(h)}}function n(f,h){if(!t)return null;for(;h!==null;)e(f,h),h=h.sibling;return null}function i(f,h){for(f=new Map;h!==null;)h.key!==null?f.set(h.key,h):f.set(h.index,h),h=h.sibling;return f}function r(f,h){return f=ns(f,h),f.index=0,f.sibling=null,f}function s(f,h,g){return f.index=g,t?(g=f.alternate,g!==null?(g=g.index,g<h?(f.flags|=2,h):g):(f.flags|=2,h)):(f.flags|=1048576,h)}function a(f){return t&&f.alternate===null&&(f.flags|=2),f}function o(f,h,g,S){return h===null||h.tag!==6?(h=oh(g,f.mode,S),h.return=f,h):(h=r(h,g),h.return=f,h)}function l(f,h,g,S){var b=g.type;return b===ro?d(f,h,g.props.children,S,g.key):h!==null&&(h.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Or&&$g(b)===h.type)?(S=r(h,g.props),S.ref=Ta(f,h,g),S.return=f,S):(S=Nc(g.type,g.key,g.props,null,f.mode,S),S.ref=Ta(f,h,g),S.return=f,S)}function c(f,h,g,S){return h===null||h.tag!==4||h.stateNode.containerInfo!==g.containerInfo||h.stateNode.implementation!==g.implementation?(h=ah(g,f.mode,S),h.return=f,h):(h=r(h,g.children||[]),h.return=f,h)}function d(f,h,g,S,b){return h===null||h.tag!==7?(h=Ls(g,f.mode,S,b),h.return=f,h):(h=r(h,g),h.return=f,h)}function u(f,h,g){if(typeof h=="string"&&h!==""||typeof h=="number")return h=oh(""+h,f.mode,g),h.return=f,h;if(typeof h=="object"&&h!==null){switch(h.$$typeof){case ec:return g=Nc(h.type,h.key,h.props,null,f.mode,g),g.ref=Ta(f,null,h),g.return=f,g;case io:return h=ah(h,f.mode,g),h.return=f,h;case Or:var S=h._init;return u(f,S(h._payload),g)}if(Ba(h)||Ca(h))return h=Ls(h,f.mode,g,null),h.return=f,h;dc(f,h)}return null}function m(f,h,g,S){var b=h!==null?h.key:null;if(typeof g=="string"&&g!==""||typeof g=="number")return b!==null?null:o(f,h,""+g,S);if(typeof g=="object"&&g!==null){switch(g.$$typeof){case ec:return g.key===b?l(f,h,g,S):null;case io:return g.key===b?c(f,h,g,S):null;case Or:return b=g._init,m(f,h,b(g._payload),S)}if(Ba(g)||Ca(g))return b!==null?null:d(f,h,g,S,null);dc(f,g)}return null}function v(f,h,g,S,b){if(typeof S=="string"&&S!==""||typeof S=="number")return f=f.get(g)||null,o(h,f,""+S,b);if(typeof S=="object"&&S!==null){switch(S.$$typeof){case ec:return f=f.get(S.key===null?g:S.key)||null,l(h,f,S,b);case io:return f=f.get(S.key===null?g:S.key)||null,c(h,f,S,b);case Or:var w=S._init;return v(f,h,g,w(S._payload),b)}if(Ba(S)||Ca(S))return f=f.get(g)||null,d(h,f,S,b,null);dc(h,S)}return null}function y(f,h,g,S){for(var b=null,w=null,k=h,C=h=0,E=null;k!==null&&C<g.length;C++){k.index>C?(E=k,k=null):E=k.sibling;var x=m(f,k,g[C],S);if(x===null){k===null&&(k=E);break}t&&k&&x.alternate===null&&e(f,k),h=s(x,h,C),w===null?b=x:w.sibling=x,w=x,k=E}if(C===g.length)return n(f,k),De&&Ss(f,C),b;if(k===null){for(;C<g.length;C++)k=u(f,g[C],S),k!==null&&(h=s(k,h,C),w===null?b=k:w.sibling=k,w=k);return De&&Ss(f,C),b}for(k=i(f,k);C<g.length;C++)E=v(k,f,C,g[C],S),E!==null&&(t&&E.alternate!==null&&k.delete(E.key===null?C:E.key),h=s(E,h,C),w===null?b=E:w.sibling=E,w=E);return t&&k.forEach(function(I){return e(f,I)}),De&&Ss(f,C),b}function _(f,h,g,S){var b=Ca(g);if(typeof b!="function")throw Error(ee(150));if(g=b.call(g),g==null)throw Error(ee(151));for(var w=b=null,k=h,C=h=0,E=null,x=g.next();k!==null&&!x.done;C++,x=g.next()){k.index>C?(E=k,k=null):E=k.sibling;var I=m(f,k,x.value,S);if(I===null){k===null&&(k=E);break}t&&k&&I.alternate===null&&e(f,k),h=s(I,h,C),w===null?b=I:w.sibling=I,w=I,k=E}if(x.done)return n(f,k),De&&Ss(f,C),b;if(k===null){for(;!x.done;C++,x=g.next())x=u(f,x.value,S),x!==null&&(h=s(x,h,C),w===null?b=x:w.sibling=x,w=x);return De&&Ss(f,C),b}for(k=i(f,k);!x.done;C++,x=g.next())x=v(k,f,C,x.value,S),x!==null&&(t&&x.alternate!==null&&k.delete(x.key===null?C:x.key),h=s(x,h,C),w===null?b=x:w.sibling=x,w=x);return t&&k.forEach(function(A){return e(f,A)}),De&&Ss(f,C),b}function p(f,h,g,S){if(typeof g=="object"&&g!==null&&g.type===ro&&g.key===null&&(g=g.props.children),typeof g=="object"&&g!==null){switch(g.$$typeof){case ec:e:{for(var b=g.key,w=h;w!==null;){if(w.key===b){if(b=g.type,b===ro){if(w.tag===7){n(f,w.sibling),h=r(w,g.props.children),h.return=f,f=h;break e}}else if(w.elementType===b||typeof b=="object"&&b!==null&&b.$$typeof===Or&&$g(b)===w.type){n(f,w.sibling),h=r(w,g.props),h.ref=Ta(f,w,g),h.return=f,f=h;break e}n(f,w);break}else e(f,w);w=w.sibling}g.type===ro?(h=Ls(g.props.children,f.mode,S,g.key),h.return=f,f=h):(S=Nc(g.type,g.key,g.props,null,f.mode,S),S.ref=Ta(f,h,g),S.return=f,f=S)}return a(f);case io:e:{for(w=g.key;h!==null;){if(h.key===w)if(h.tag===4&&h.stateNode.containerInfo===g.containerInfo&&h.stateNode.implementation===g.implementation){n(f,h.sibling),h=r(h,g.children||[]),h.return=f,f=h;break e}else{n(f,h);break}else e(f,h);h=h.sibling}h=ah(g,f.mode,S),h.return=f,f=h}return a(f);case Or:return w=g._init,p(f,h,w(g._payload),S)}if(Ba(g))return y(f,h,g,S);if(Ca(g))return _(f,h,g,S);dc(f,g)}return typeof g=="string"&&g!==""||typeof g=="number"?(g=""+g,h!==null&&h.tag===6?(n(f,h.sibling),h=r(h,g),h.return=f,f=h):(n(f,h),h=oh(g,f.mode,S),h.return=f,f=h),a(f)):n(f,h)}return p}var Vo=qy(!0),Jy=qy(!1),hu=ps(null),fu=null,fo=null,Gp=null;function qp(){Gp=fo=fu=null}function Jp(t){var e=hu.current;Me(hu),t._currentValue=e}function hf(t,e,n){for(;t!==null;){var i=t.alternate;if((t.childLanes&e)!==e?(t.childLanes|=e,i!==null&&(i.childLanes|=e)):i!==null&&(i.childLanes&e)!==e&&(i.childLanes|=e),t===n)break;t=t.return}}function wo(t,e){fu=t,Gp=fo=null,t=t.dependencies,t!==null&&t.firstContext!==null&&(t.lanes&e&&(Wt=!0),t.firstContext=null)}function Cn(t){var e=t._currentValue;if(Gp!==t)if(t={context:t,memoizedValue:e,next:null},fo===null){if(fu===null)throw Error(ee(308));fo=t,fu.dependencies={lanes:0,firstContext:t}}else fo=fo.next=t;return e}var ks=null;function Kp(t){ks===null?ks=[t]:ks.push(t)}function Ky(t,e,n,i){var r=e.interleaved;return r===null?(n.next=n,Kp(e)):(n.next=r.next,r.next=n),e.interleaved=n,gr(t,i)}function gr(t,e){t.lanes|=e;var n=t.alternate;for(n!==null&&(n.lanes|=e),n=t,t=t.return;t!==null;)t.childLanes|=e,n=t.alternate,n!==null&&(n.childLanes|=e),n=t,t=t.return;return n.tag===3?n.stateNode:null}var Ir=!1;function Qp(t){t.updateQueue={baseState:t.memoizedState,firstBaseUpdate:null,lastBaseUpdate:null,shared:{pending:null,interleaved:null,lanes:0},effects:null}}function Qy(t,e){t=t.updateQueue,e.updateQueue===t&&(e.updateQueue={baseState:t.baseState,firstBaseUpdate:t.firstBaseUpdate,lastBaseUpdate:t.lastBaseUpdate,shared:t.shared,effects:t.effects})}function ur(t,e){return{eventTime:t,lane:e,tag:0,payload:null,callback:null,next:null}}function Zr(t,e,n){var i=t.updateQueue;if(i===null)return null;if(i=i.shared,Ce&2){var r=i.pending;return r===null?e.next=e:(e.next=r.next,r.next=e),i.pending=e,gr(t,n)}return r=i.interleaved,r===null?(e.next=e,Kp(i)):(e.next=r.next,r.next=e),i.interleaved=e,gr(t,n)}function Oc(t,e,n){if(e=e.updateQueue,e!==null&&(e=e.shared,(n&4194240)!==0)){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Ap(t,n)}}function Vg(t,e){var n=t.updateQueue,i=t.alternate;if(i!==null&&(i=i.updateQueue,n===i)){var r=null,s=null;if(n=n.firstBaseUpdate,n!==null){do{var a={eventTime:n.eventTime,lane:n.lane,tag:n.tag,payload:n.payload,callback:n.callback,next:null};s===null?r=s=a:s=s.next=a,n=n.next}while(n!==null);s===null?r=s=e:s=s.next=e}else r=s=e;n={baseState:i.baseState,firstBaseUpdate:r,lastBaseUpdate:s,shared:i.shared,effects:i.effects},t.updateQueue=n;return}t=n.lastBaseUpdate,t===null?n.firstBaseUpdate=e:t.next=e,n.lastBaseUpdate=e}function pu(t,e,n,i){var r=t.updateQueue;Ir=!1;var s=r.firstBaseUpdate,a=r.lastBaseUpdate,o=r.shared.pending;if(o!==null){r.shared.pending=null;var l=o,c=l.next;l.next=null,a===null?s=c:a.next=c,a=l;var d=t.alternate;d!==null&&(d=d.updateQueue,o=d.lastBaseUpdate,o!==a&&(o===null?d.firstBaseUpdate=c:o.next=c,d.lastBaseUpdate=l))}if(s!==null){var u=r.baseState;a=0,d=c=l=null,o=s;do{var m=o.lane,v=o.eventTime;if((i&m)===m){d!==null&&(d=d.next={eventTime:v,lane:0,tag:o.tag,payload:o.payload,callback:o.callback,next:null});e:{var y=t,_=o;switch(m=e,v=n,_.tag){case 1:if(y=_.payload,typeof y=="function"){u=y.call(v,u,m);break e}u=y;break e;case 3:y.flags=y.flags&-65537|128;case 0:if(y=_.payload,m=typeof y=="function"?y.call(v,u,m):y,m==null)break e;u=Fe({},u,m);break e;case 2:Ir=!0}}o.callback!==null&&o.lane!==0&&(t.flags|=64,m=r.effects,m===null?r.effects=[o]:m.push(o))}else v={eventTime:v,lane:m,tag:o.tag,payload:o.payload,callback:o.callback,next:null},d===null?(c=d=v,l=u):d=d.next=v,a|=m;if(o=o.next,o===null){if(o=r.shared.pending,o===null)break;m=o,o=m.next,m.next=null,r.lastBaseUpdate=m,r.shared.pending=null}}while(1);if(d===null&&(l=u),r.baseState=l,r.firstBaseUpdate=c,r.lastBaseUpdate=d,e=r.shared.interleaved,e!==null){r=e;do a|=r.lane,r=r.next;while(r!==e)}else s===null&&(r.shared.lanes=0);Fs|=a,t.lanes=a,t.memoizedState=u}}function Gg(t,e,n){if(t=e.effects,e.effects=null,t!==null)for(e=0;e<t.length;e++){var i=t[e],r=i.callback;if(r!==null){if(i.callback=null,i=n,typeof r!="function")throw Error(ee(191,r));r.call(i)}}}var jl={},ki=ps(jl),vl=ps(jl),_l=ps(jl);function Es(t){if(t===jl)throw Error(ee(174));return t}function Xp(t,e){switch(Pe(_l,e),Pe(vl,t),Pe(ki,jl),t=e.nodeType,t){case 9:case 11:e=(e=e.documentElement)?e.namespaceURI:Vh(null,"");break;default:t=t===8?e.parentNode:e,e=t.namespaceURI||null,t=t.tagName,e=Vh(e,t)}Me(ki),Pe(ki,e)}function Go(){Me(ki),Me(vl),Me(_l)}function Xy(t){Es(_l.current);var e=Es(ki.current),n=Vh(e,t.type);e!==n&&(Pe(vl,t),Pe(ki,n))}function Yp(t){vl.current===t&&(Me(ki),Me(vl))}var Ne=ps(0);function mu(t){for(var e=t;e!==null;){if(e.tag===13){var n=e.memoizedState;if(n!==null&&(n=n.dehydrated,n===null||n.data==="$?"||n.data==="$!"))return e}else if(e.tag===19&&e.memoizedProps.revealOrder!==void 0){if(e.flags&128)return e}else if(e.child!==null){e.child.return=e,e=e.child;continue}if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return null;e=e.return}e.sibling.return=e.return,e=e.sibling}return null}var eh=[];function Zp(){for(var t=0;t<eh.length;t++)eh[t]._workInProgressVersionPrimary=null;eh.length=0}var Ic=Sr.ReactCurrentDispatcher,th=Sr.ReactCurrentBatchConfig,Bs=0,Be=null,tt=null,st=null,gu=!1,Qa=!1,yl=0,WE=0;function _t(){throw Error(ee(321))}function em(t,e){if(e===null)return!1;for(var n=0;n<e.length&&n<t.length;n++)if(!Gn(t[n],e[n]))return!1;return!0}function tm(t,e,n,i,r,s){if(Bs=s,Be=e,e.memoizedState=null,e.updateQueue=null,e.lanes=0,Ic.current=t===null||t.memoizedState===null?qE:JE,t=n(i,r),Qa){s=0;do{if(Qa=!1,yl=0,25<=s)throw Error(ee(301));s+=1,st=tt=null,e.updateQueue=null,Ic.current=KE,t=n(i,r)}while(Qa)}if(Ic.current=vu,e=tt!==null&&tt.next!==null,Bs=0,st=tt=Be=null,gu=!1,e)throw Error(ee(300));return t}function nm(){var t=yl!==0;return yl=0,t}function ei(){var t={memoizedState:null,baseState:null,baseQueue:null,queue:null,next:null};return st===null?Be.memoizedState=st=t:st=st.next=t,st}function bn(){if(tt===null){var t=Be.alternate;t=t!==null?t.memoizedState:null}else t=tt.next;var e=st===null?Be.memoizedState:st.next;if(e!==null)st=e,tt=t;else{if(t===null)throw Error(ee(310));tt=t,t={memoizedState:tt.memoizedState,baseState:tt.baseState,baseQueue:tt.baseQueue,queue:tt.queue,next:null},st===null?Be.memoizedState=st=t:st=st.next=t}return st}function Sl(t,e){return typeof e=="function"?e(t):e}function nh(t){var e=bn(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var i=tt,r=i.baseQueue,s=n.pending;if(s!==null){if(r!==null){var a=r.next;r.next=s.next,s.next=a}i.baseQueue=r=s,n.pending=null}if(r!==null){s=r.next,i=i.baseState;var o=a=null,l=null,c=s;do{var d=c.lane;if((Bs&d)===d)l!==null&&(l=l.next={lane:0,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null}),i=c.hasEagerState?c.eagerState:t(i,c.action);else{var u={lane:d,action:c.action,hasEagerState:c.hasEagerState,eagerState:c.eagerState,next:null};l===null?(o=l=u,a=i):l=l.next=u,Be.lanes|=d,Fs|=d}c=c.next}while(c!==null&&c!==s);l===null?a=i:l.next=o,Gn(i,e.memoizedState)||(Wt=!0),e.memoizedState=i,e.baseState=a,e.baseQueue=l,n.lastRenderedState=i}if(t=n.interleaved,t!==null){r=t;do s=r.lane,Be.lanes|=s,Fs|=s,r=r.next;while(r!==t)}else r===null&&(n.lanes=0);return[e.memoizedState,n.dispatch]}function ih(t){var e=bn(),n=e.queue;if(n===null)throw Error(ee(311));n.lastRenderedReducer=t;var i=n.dispatch,r=n.pending,s=e.memoizedState;if(r!==null){n.pending=null;var a=r=r.next;do s=t(s,a.action),a=a.next;while(a!==r);Gn(s,e.memoizedState)||(Wt=!0),e.memoizedState=s,e.baseQueue===null&&(e.baseState=s),n.lastRenderedState=s}return[s,i]}function Yy(){}function Zy(t,e){var n=Be,i=bn(),r=e(),s=!Gn(i.memoizedState,r);if(s&&(i.memoizedState=r,Wt=!0),i=i.queue,im(nS.bind(null,n,i,t),[t]),i.getSnapshot!==e||s||st!==null&&st.memoizedState.tag&1){if(n.flags|=2048,Cl(9,tS.bind(null,n,i,r,e),void 0,null),lt===null)throw Error(ee(349));Bs&30||eS(n,e,r)}return r}function eS(t,e,n){t.flags|=16384,t={getSnapshot:e,value:n},e=Be.updateQueue,e===null?(e={lastEffect:null,stores:null},Be.updateQueue=e,e.stores=[t]):(n=e.stores,n===null?e.stores=[t]:n.push(t))}function tS(t,e,n,i){e.value=n,e.getSnapshot=i,iS(e)&&rS(t)}function nS(t,e,n){return n(function(){iS(e)&&rS(t)})}function iS(t){var e=t.getSnapshot;t=t.value;try{var n=e();return!Gn(t,n)}catch{return!0}}function rS(t){var e=gr(t,1);e!==null&&Wn(e,t,1,-1)}function qg(t){var e=ei();return typeof t=="function"&&(t=t()),e.memoizedState=e.baseState=t,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:Sl,lastRenderedState:t},e.queue=t,t=t.dispatch=GE.bind(null,Be,t),[e.memoizedState,t]}function Cl(t,e,n,i){return t={tag:t,create:e,destroy:n,deps:i,next:null},e=Be.updateQueue,e===null?(e={lastEffect:null,stores:null},Be.updateQueue=e,e.lastEffect=t.next=t):(n=e.lastEffect,n===null?e.lastEffect=t.next=t:(i=n.next,n.next=t,t.next=i,e.lastEffect=t)),t}function sS(){return bn().memoizedState}function Lc(t,e,n,i){var r=ei();Be.flags|=t,r.memoizedState=Cl(1|e,n,void 0,i===void 0?null:i)}function Xu(t,e,n,i){var r=bn();i=i===void 0?null:i;var s=void 0;if(tt!==null){var a=tt.memoizedState;if(s=a.destroy,i!==null&&em(i,a.deps)){r.memoizedState=Cl(e,n,s,i);return}}Be.flags|=t,r.memoizedState=Cl(1|e,n,s,i)}function Jg(t,e){return Lc(8390656,8,t,e)}function im(t,e){return Xu(2048,8,t,e)}function oS(t,e){return Xu(4,2,t,e)}function aS(t,e){return Xu(4,4,t,e)}function lS(t,e){if(typeof e=="function")return t=t(),e(t),function(){e(null)};if(e!=null)return t=t(),e.current=t,function(){e.current=null}}function cS(t,e,n){return n=n!=null?n.concat([t]):null,Xu(4,4,lS.bind(null,e,t),n)}function rm(){}function uS(t,e){var n=bn();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&em(e,i[1])?i[0]:(n.memoizedState=[t,e],t)}function dS(t,e){var n=bn();e=e===void 0?null:e;var i=n.memoizedState;return i!==null&&e!==null&&em(e,i[1])?i[0]:(t=t(),n.memoizedState=[t,e],t)}function hS(t,e,n){return Bs&21?(Gn(n,e)||(n=vy(),Be.lanes|=n,Fs|=n,t.baseState=!0),e):(t.baseState&&(t.baseState=!1,Wt=!0),t.memoizedState=n)}function $E(t,e){var n=ke;ke=n!==0&&4>n?n:4,t(!0);var i=th.transition;th.transition={};try{t(!1),e()}finally{ke=n,th.transition=i}}function fS(){return bn().memoizedState}function VE(t,e,n){var i=ts(t);if(n={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null},pS(t))mS(e,n);else if(n=Ky(t,e,n,i),n!==null){var r=Dt();Wn(n,t,i,r),gS(n,e,i)}}function GE(t,e,n){var i=ts(t),r={lane:i,action:n,hasEagerState:!1,eagerState:null,next:null};if(pS(t))mS(e,r);else{var s=t.alternate;if(t.lanes===0&&(s===null||s.lanes===0)&&(s=e.lastRenderedReducer,s!==null))try{var a=e.lastRenderedState,o=s(a,n);if(r.hasEagerState=!0,r.eagerState=o,Gn(o,a)){var l=e.interleaved;l===null?(r.next=r,Kp(e)):(r.next=l.next,l.next=r),e.interleaved=r;return}}catch{}finally{}n=Ky(t,e,r,i),n!==null&&(r=Dt(),Wn(n,t,i,r),gS(n,e,i))}}function pS(t){var e=t.alternate;return t===Be||e!==null&&e===Be}function mS(t,e){Qa=gu=!0;var n=t.pending;n===null?e.next=e:(e.next=n.next,n.next=e),t.pending=e}function gS(t,e,n){if(n&4194240){var i=e.lanes;i&=t.pendingLanes,n|=i,e.lanes=n,Ap(t,n)}}var vu={readContext:Cn,useCallback:_t,useContext:_t,useEffect:_t,useImperativeHandle:_t,useInsertionEffect:_t,useLayoutEffect:_t,useMemo:_t,useReducer:_t,useRef:_t,useState:_t,useDebugValue:_t,useDeferredValue:_t,useTransition:_t,useMutableSource:_t,useSyncExternalStore:_t,useId:_t,unstable_isNewReconciler:!1},qE={readContext:Cn,useCallback:function(t,e){return ei().memoizedState=[t,e===void 0?null:e],t},useContext:Cn,useEffect:Jg,useImperativeHandle:function(t,e,n){return n=n!=null?n.concat([t]):null,Lc(4194308,4,lS.bind(null,e,t),n)},useLayoutEffect:function(t,e){return Lc(4194308,4,t,e)},useInsertionEffect:function(t,e){return Lc(4,2,t,e)},useMemo:function(t,e){var n=ei();return e=e===void 0?null:e,t=t(),n.memoizedState=[t,e],t},useReducer:function(t,e,n){var i=ei();return e=n!==void 0?n(e):e,i.memoizedState=i.baseState=e,t={pending:null,interleaved:null,lanes:0,dispatch:null,lastRenderedReducer:t,lastRenderedState:e},i.queue=t,t=t.dispatch=VE.bind(null,Be,t),[i.memoizedState,t]},useRef:function(t){var e=ei();return t={current:t},e.memoizedState=t},useState:qg,useDebugValue:rm,useDeferredValue:function(t){return ei().memoizedState=t},useTransition:function(){var t=qg(!1),e=t[0];return t=$E.bind(null,t[1]),ei().memoizedState=t,[e,t]},useMutableSource:function(){},useSyncExternalStore:function(t,e,n){var i=Be,r=ei();if(De){if(n===void 0)throw Error(ee(407));n=n()}else{if(n=e(),lt===null)throw Error(ee(349));Bs&30||eS(i,e,n)}r.memoizedState=n;var s={value:n,getSnapshot:e};return r.queue=s,Jg(nS.bind(null,i,s,t),[t]),i.flags|=2048,Cl(9,tS.bind(null,i,s,n,e),void 0,null),n},useId:function(){var t=ei(),e=lt.identifierPrefix;if(De){var n=Ui,i=Fi;n=(i&~(1<<32-jn(i)-1)).toString(32)+n,e=":"+e+"R"+n,n=yl++,0<n&&(e+="H"+n.toString(32)),e+=":"}else n=WE++,e=":"+e+"r"+n.toString(32)+":";return t.memoizedState=e},unstable_isNewReconciler:!1},JE={readContext:Cn,useCallback:uS,useContext:Cn,useEffect:im,useImperativeHandle:cS,useInsertionEffect:oS,useLayoutEffect:aS,useMemo:dS,useReducer:nh,useRef:sS,useState:function(){return nh(Sl)},useDebugValue:rm,useDeferredValue:function(t){var e=bn();return hS(e,tt.memoizedState,t)},useTransition:function(){var t=nh(Sl)[0],e=bn().memoizedState;return[t,e]},useMutableSource:Yy,useSyncExternalStore:Zy,useId:fS,unstable_isNewReconciler:!1},KE={readContext:Cn,useCallback:uS,useContext:Cn,useEffect:im,useImperativeHandle:cS,useInsertionEffect:oS,useLayoutEffect:aS,useMemo:dS,useReducer:ih,useRef:sS,useState:function(){return ih(Sl)},useDebugValue:rm,useDeferredValue:function(t){var e=bn();return tt===null?e.memoizedState=t:hS(e,tt.memoizedState,t)},useTransition:function(){var t=ih(Sl)[0],e=bn().memoizedState;return[t,e]},useMutableSource:Yy,useSyncExternalStore:Zy,useId:fS,unstable_isNewReconciler:!1};function xn(t,e){if(t&&t.defaultProps){e=Fe({},e),t=t.defaultProps;for(var n in t)e[n]===void 0&&(e[n]=t[n]);return e}return e}function ff(t,e,n,i){e=t.memoizedState,n=n(i,e),n=n==null?e:Fe({},e,n),t.memoizedState=n,t.lanes===0&&(t.updateQueue.baseState=n)}var Yu={isMounted:function(t){return(t=t._reactInternals)?Qs(t)===t:!1},enqueueSetState:function(t,e,n){t=t._reactInternals;var i=Dt(),r=ts(t),s=ur(i,r);s.payload=e,n!=null&&(s.callback=n),e=Zr(t,s,r),e!==null&&(Wn(e,t,r,i),Oc(e,t,r))},enqueueReplaceState:function(t,e,n){t=t._reactInternals;var i=Dt(),r=ts(t),s=ur(i,r);s.tag=1,s.payload=e,n!=null&&(s.callback=n),e=Zr(t,s,r),e!==null&&(Wn(e,t,r,i),Oc(e,t,r))},enqueueForceUpdate:function(t,e){t=t._reactInternals;var n=Dt(),i=ts(t),r=ur(n,i);r.tag=2,e!=null&&(r.callback=e),e=Zr(t,r,i),e!==null&&(Wn(e,t,i,n),Oc(e,t,i))}};function Kg(t,e,n,i,r,s,a){return t=t.stateNode,typeof t.shouldComponentUpdate=="function"?t.shouldComponentUpdate(i,s,a):e.prototype&&e.prototype.isPureReactComponent?!fl(n,i)||!fl(r,s):!0}function vS(t,e,n){var i=!1,r=ls,s=e.contextType;return typeof s=="object"&&s!==null?s=Cn(s):(r=Gt(e)?As:Tt.current,i=e.contextTypes,s=(i=i!=null)?Wo(t,r):ls),e=new e(n,s),t.memoizedState=e.state!==null&&e.state!==void 0?e.state:null,e.updater=Yu,t.stateNode=e,e._reactInternals=t,i&&(t=t.stateNode,t.__reactInternalMemoizedUnmaskedChildContext=r,t.__reactInternalMemoizedMaskedChildContext=s),e}function Qg(t,e,n,i){t=e.state,typeof e.componentWillReceiveProps=="function"&&e.componentWillReceiveProps(n,i),typeof e.UNSAFE_componentWillReceiveProps=="function"&&e.UNSAFE_componentWillReceiveProps(n,i),e.state!==t&&Yu.enqueueReplaceState(e,e.state,null)}function pf(t,e,n,i){var r=t.stateNode;r.props=n,r.state=t.memoizedState,r.refs={},Qp(t);var s=e.contextType;typeof s=="object"&&s!==null?r.context=Cn(s):(s=Gt(e)?As:Tt.current,r.context=Wo(t,s)),r.state=t.memoizedState,s=e.getDerivedStateFromProps,typeof s=="function"&&(ff(t,e,s,n),r.state=t.memoizedState),typeof e.getDerivedStateFromProps=="function"||typeof r.getSnapshotBeforeUpdate=="function"||typeof r.UNSAFE_componentWillMount!="function"&&typeof r.componentWillMount!="function"||(e=r.state,typeof r.componentWillMount=="function"&&r.componentWillMount(),typeof r.UNSAFE_componentWillMount=="function"&&r.UNSAFE_componentWillMount(),e!==r.state&&Yu.enqueueReplaceState(r,r.state,null),pu(t,n,r,i),r.state=t.memoizedState),typeof r.componentDidMount=="function"&&(t.flags|=4194308)}function qo(t,e){try{var n="",i=e;do n+=wk(i),i=i.return;while(i);var r=n}catch(s){r=`
Error generating stack: `+s.message+`
`+s.stack}return{value:t,source:e,stack:r,digest:null}}function rh(t,e,n){return{value:t,source:null,stack:n??null,digest:e??null}}function mf(t,e){try{console.error(e.value)}catch(n){setTimeout(function(){throw n})}}var QE=typeof WeakMap=="function"?WeakMap:Map;function _S(t,e,n){n=ur(-1,n),n.tag=3,n.payload={element:null};var i=e.value;return n.callback=function(){yu||(yu=!0,Ef=i),mf(t,e)},n}function yS(t,e,n){n=ur(-1,n),n.tag=3;var i=t.type.getDerivedStateFromError;if(typeof i=="function"){var r=e.value;n.payload=function(){return i(r)},n.callback=function(){mf(t,e)}}var s=t.stateNode;return s!==null&&typeof s.componentDidCatch=="function"&&(n.callback=function(){mf(t,e),typeof i!="function"&&(es===null?es=new Set([this]):es.add(this));var a=e.stack;this.componentDidCatch(e.value,{componentStack:a!==null?a:""})}),n}function Xg(t,e,n){var i=t.pingCache;if(i===null){i=t.pingCache=new QE;var r=new Set;i.set(e,r)}else r=i.get(e),r===void 0&&(r=new Set,i.set(e,r));r.has(n)||(r.add(n),t=uT.bind(null,t,e,n),e.then(t,t))}function Yg(t){do{var e;if((e=t.tag===13)&&(e=t.memoizedState,e=e!==null?e.dehydrated!==null:!0),e)return t;t=t.return}while(t!==null);return null}function Zg(t,e,n,i,r){return t.mode&1?(t.flags|=65536,t.lanes=r,t):(t===e?t.flags|=65536:(t.flags|=128,n.flags|=131072,n.flags&=-52805,n.tag===1&&(n.alternate===null?n.tag=17:(e=ur(-1,1),e.tag=2,Zr(n,e,1))),n.lanes|=1),t)}var XE=Sr.ReactCurrentOwner,Wt=!1;function xt(t,e,n,i){e.child=t===null?Jy(e,null,n,i):Vo(e,t.child,n,i)}function ev(t,e,n,i,r){n=n.render;var s=e.ref;return wo(e,r),i=tm(t,e,n,i,s,r),n=nm(),t!==null&&!Wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,vr(t,e,r)):(De&&n&&Wp(e),e.flags|=1,xt(t,e,i,r),e.child)}function tv(t,e,n,i,r){if(t===null){var s=n.type;return typeof s=="function"&&!hm(s)&&s.defaultProps===void 0&&n.compare===null&&n.defaultProps===void 0?(e.tag=15,e.type=s,SS(t,e,s,i,r)):(t=Nc(n.type,null,i,e,e.mode,r),t.ref=e.ref,t.return=e,e.child=t)}if(s=t.child,!(t.lanes&r)){var a=s.memoizedProps;if(n=n.compare,n=n!==null?n:fl,n(a,i)&&t.ref===e.ref)return vr(t,e,r)}return e.flags|=1,t=ns(s,i),t.ref=e.ref,t.return=e,e.child=t}function SS(t,e,n,i,r){if(t!==null){var s=t.memoizedProps;if(fl(s,i)&&t.ref===e.ref)if(Wt=!1,e.pendingProps=i=s,(t.lanes&r)!==0)t.flags&131072&&(Wt=!0);else return e.lanes=t.lanes,vr(t,e,r)}return gf(t,e,n,i,r)}function CS(t,e,n){var i=e.pendingProps,r=i.children,s=t!==null?t.memoizedState:null;if(i.mode==="hidden")if(!(e.mode&1))e.memoizedState={baseLanes:0,cachePool:null,transitions:null},Pe(mo,Yt),Yt|=n;else{if(!(n&1073741824))return t=s!==null?s.baseLanes|n:n,e.lanes=e.childLanes=1073741824,e.memoizedState={baseLanes:t,cachePool:null,transitions:null},e.updateQueue=null,Pe(mo,Yt),Yt|=t,null;e.memoizedState={baseLanes:0,cachePool:null,transitions:null},i=s!==null?s.baseLanes:n,Pe(mo,Yt),Yt|=i}else s!==null?(i=s.baseLanes|n,e.memoizedState=null):i=n,Pe(mo,Yt),Yt|=i;return xt(t,e,r,n),e.child}function bS(t,e){var n=e.ref;(t===null&&n!==null||t!==null&&t.ref!==n)&&(e.flags|=512,e.flags|=2097152)}function gf(t,e,n,i,r){var s=Gt(n)?As:Tt.current;return s=Wo(e,s),wo(e,r),n=tm(t,e,n,i,s,r),i=nm(),t!==null&&!Wt?(e.updateQueue=t.updateQueue,e.flags&=-2053,t.lanes&=~r,vr(t,e,r)):(De&&i&&Wp(e),e.flags|=1,xt(t,e,n,r),e.child)}function nv(t,e,n,i,r){if(Gt(n)){var s=!0;cu(e)}else s=!1;if(wo(e,r),e.stateNode===null)Mc(t,e),vS(e,n,i),pf(e,n,i,r),i=!0;else if(t===null){var a=e.stateNode,o=e.memoizedProps;a.props=o;var l=a.context,c=n.contextType;typeof c=="object"&&c!==null?c=Cn(c):(c=Gt(n)?As:Tt.current,c=Wo(e,c));var d=n.getDerivedStateFromProps,u=typeof d=="function"||typeof a.getSnapshotBeforeUpdate=="function";u||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==i||l!==c)&&Qg(e,a,i,c),Ir=!1;var m=e.memoizedState;a.state=m,pu(e,i,a,r),l=e.memoizedState,o!==i||m!==l||Vt.current||Ir?(typeof d=="function"&&(ff(e,n,d,i),l=e.memoizedState),(o=Ir||Kg(e,n,o,i,m,l,c))?(u||typeof a.UNSAFE_componentWillMount!="function"&&typeof a.componentWillMount!="function"||(typeof a.componentWillMount=="function"&&a.componentWillMount(),typeof a.UNSAFE_componentWillMount=="function"&&a.UNSAFE_componentWillMount()),typeof a.componentDidMount=="function"&&(e.flags|=4194308)):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),e.memoizedProps=i,e.memoizedState=l),a.props=i,a.state=l,a.context=c,i=o):(typeof a.componentDidMount=="function"&&(e.flags|=4194308),i=!1)}else{a=e.stateNode,Qy(t,e),o=e.memoizedProps,c=e.type===e.elementType?o:xn(e.type,o),a.props=c,u=e.pendingProps,m=a.context,l=n.contextType,typeof l=="object"&&l!==null?l=Cn(l):(l=Gt(n)?As:Tt.current,l=Wo(e,l));var v=n.getDerivedStateFromProps;(d=typeof v=="function"||typeof a.getSnapshotBeforeUpdate=="function")||typeof a.UNSAFE_componentWillReceiveProps!="function"&&typeof a.componentWillReceiveProps!="function"||(o!==u||m!==l)&&Qg(e,a,i,l),Ir=!1,m=e.memoizedState,a.state=m,pu(e,i,a,r);var y=e.memoizedState;o!==u||m!==y||Vt.current||Ir?(typeof v=="function"&&(ff(e,n,v,i),y=e.memoizedState),(c=Ir||Kg(e,n,c,i,m,y,l)||!1)?(d||typeof a.UNSAFE_componentWillUpdate!="function"&&typeof a.componentWillUpdate!="function"||(typeof a.componentWillUpdate=="function"&&a.componentWillUpdate(i,y,l),typeof a.UNSAFE_componentWillUpdate=="function"&&a.UNSAFE_componentWillUpdate(i,y,l)),typeof a.componentDidUpdate=="function"&&(e.flags|=4),typeof a.getSnapshotBeforeUpdate=="function"&&(e.flags|=1024)):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),e.memoizedProps=i,e.memoizedState=y),a.props=i,a.state=y,a.context=l,i=c):(typeof a.componentDidUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=4),typeof a.getSnapshotBeforeUpdate!="function"||o===t.memoizedProps&&m===t.memoizedState||(e.flags|=1024),i=!1)}return vf(t,e,n,i,s,r)}function vf(t,e,n,i,r,s){bS(t,e);var a=(e.flags&128)!==0;if(!i&&!a)return r&&Hg(e,n,!1),vr(t,e,s);i=e.stateNode,XE.current=e;var o=a&&typeof n.getDerivedStateFromError!="function"?null:i.render();return e.flags|=1,t!==null&&a?(e.child=Vo(e,t.child,null,s),e.child=Vo(e,null,o,s)):xt(t,e,o,s),e.memoizedState=i.state,r&&Hg(e,n,!0),e.child}function wS(t){var e=t.stateNode;e.pendingContext?zg(t,e.pendingContext,e.pendingContext!==e.context):e.context&&zg(t,e.context,!1),Xp(t,e.containerInfo)}function iv(t,e,n,i,r){return $o(),Vp(r),e.flags|=256,xt(t,e,n,i),e.child}var _f={dehydrated:null,treeContext:null,retryLane:0};function yf(t){return{baseLanes:t,cachePool:null,transitions:null}}function kS(t,e,n){var i=e.pendingProps,r=Ne.current,s=!1,a=(e.flags&128)!==0,o;if((o=a)||(o=t!==null&&t.memoizedState===null?!1:(r&2)!==0),o?(s=!0,e.flags&=-129):(t===null||t.memoizedState!==null)&&(r|=1),Pe(Ne,r&1),t===null)return df(e),t=e.memoizedState,t!==null&&(t=t.dehydrated,t!==null)?(e.mode&1?t.data==="$!"?e.lanes=8:e.lanes=1073741824:e.lanes=1,null):(a=i.children,t=i.fallback,s?(i=e.mode,s=e.child,a={mode:"hidden",children:a},!(i&1)&&s!==null?(s.childLanes=0,s.pendingProps=a):s=td(a,i,0,null),t=Ls(t,i,n,null),s.return=e,t.return=e,s.sibling=t,e.child=s,e.child.memoizedState=yf(n),e.memoizedState=_f,t):sm(e,a));if(r=t.memoizedState,r!==null&&(o=r.dehydrated,o!==null))return YE(t,e,a,i,o,r,n);if(s){s=i.fallback,a=e.mode,r=t.child,o=r.sibling;var l={mode:"hidden",children:i.children};return!(a&1)&&e.child!==r?(i=e.child,i.childLanes=0,i.pendingProps=l,e.deletions=null):(i=ns(r,l),i.subtreeFlags=r.subtreeFlags&14680064),o!==null?s=ns(o,s):(s=Ls(s,a,n,null),s.flags|=2),s.return=e,i.return=e,i.sibling=s,e.child=i,i=s,s=e.child,a=t.child.memoizedState,a=a===null?yf(n):{baseLanes:a.baseLanes|n,cachePool:null,transitions:a.transitions},s.memoizedState=a,s.childLanes=t.childLanes&~n,e.memoizedState=_f,i}return s=t.child,t=s.sibling,i=ns(s,{mode:"visible",children:i.children}),!(e.mode&1)&&(i.lanes=n),i.return=e,i.sibling=null,t!==null&&(n=e.deletions,n===null?(e.deletions=[t],e.flags|=16):n.push(t)),e.child=i,e.memoizedState=null,i}function sm(t,e){return e=td({mode:"visible",children:e},t.mode,0,null),e.return=t,t.child=e}function hc(t,e,n,i){return i!==null&&Vp(i),Vo(e,t.child,null,n),t=sm(e,e.pendingProps.children),t.flags|=2,e.memoizedState=null,t}function YE(t,e,n,i,r,s,a){if(n)return e.flags&256?(e.flags&=-257,i=rh(Error(ee(422))),hc(t,e,a,i)):e.memoizedState!==null?(e.child=t.child,e.flags|=128,null):(s=i.fallback,r=e.mode,i=td({mode:"visible",children:i.children},r,0,null),s=Ls(s,r,a,null),s.flags|=2,i.return=e,s.return=e,i.sibling=s,e.child=i,e.mode&1&&Vo(e,t.child,null,a),e.child.memoizedState=yf(a),e.memoizedState=_f,s);if(!(e.mode&1))return hc(t,e,a,null);if(r.data==="$!"){if(i=r.nextSibling&&r.nextSibling.dataset,i)var o=i.dgst;return i=o,s=Error(ee(419)),i=rh(s,i,void 0),hc(t,e,a,i)}if(o=(a&t.childLanes)!==0,Wt||o){if(i=lt,i!==null){switch(a&-a){case 4:r=2;break;case 16:r=8;break;case 64:case 128:case 256:case 512:case 1024:case 2048:case 4096:case 8192:case 16384:case 32768:case 65536:case 131072:case 262144:case 524288:case 1048576:case 2097152:case 4194304:case 8388608:case 16777216:case 33554432:case 67108864:r=32;break;case 536870912:r=268435456;break;default:r=0}r=r&(i.suspendedLanes|a)?0:r,r!==0&&r!==s.retryLane&&(s.retryLane=r,gr(t,r),Wn(i,t,r,-1))}return dm(),i=rh(Error(ee(421))),hc(t,e,a,i)}return r.data==="$?"?(e.flags|=128,e.child=t.child,e=dT.bind(null,t),r._reactRetry=e,null):(t=s.treeContext,tn=Yr(r.nextSibling),rn=e,De=!0,Mn=null,t!==null&&(fn[pn++]=Fi,fn[pn++]=Ui,fn[pn++]=Ns,Fi=t.id,Ui=t.overflow,Ns=e),e=sm(e,i.children),e.flags|=4096,e)}function rv(t,e,n){t.lanes|=e;var i=t.alternate;i!==null&&(i.lanes|=e),hf(t.return,e,n)}function sh(t,e,n,i,r){var s=t.memoizedState;s===null?t.memoizedState={isBackwards:e,rendering:null,renderingStartTime:0,last:i,tail:n,tailMode:r}:(s.isBackwards=e,s.rendering=null,s.renderingStartTime=0,s.last=i,s.tail=n,s.tailMode=r)}function ES(t,e,n){var i=e.pendingProps,r=i.revealOrder,s=i.tail;if(xt(t,e,i.children,n),i=Ne.current,i&2)i=i&1|2,e.flags|=128;else{if(t!==null&&t.flags&128)e:for(t=e.child;t!==null;){if(t.tag===13)t.memoizedState!==null&&rv(t,n,e);else if(t.tag===19)rv(t,n,e);else if(t.child!==null){t.child.return=t,t=t.child;continue}if(t===e)break e;for(;t.sibling===null;){if(t.return===null||t.return===e)break e;t=t.return}t.sibling.return=t.return,t=t.sibling}i&=1}if(Pe(Ne,i),!(e.mode&1))e.memoizedState=null;else switch(r){case"forwards":for(n=e.child,r=null;n!==null;)t=n.alternate,t!==null&&mu(t)===null&&(r=n),n=n.sibling;n=r,n===null?(r=e.child,e.child=null):(r=n.sibling,n.sibling=null),sh(e,!1,r,n,s);break;case"backwards":for(n=null,r=e.child,e.child=null;r!==null;){if(t=r.alternate,t!==null&&mu(t)===null){e.child=r;break}t=r.sibling,r.sibling=n,n=r,r=t}sh(e,!0,n,null,s);break;case"together":sh(e,!1,null,null,void 0);break;default:e.memoizedState=null}return e.child}function Mc(t,e){!(e.mode&1)&&t!==null&&(t.alternate=null,e.alternate=null,e.flags|=2)}function vr(t,e,n){if(t!==null&&(e.dependencies=t.dependencies),Fs|=e.lanes,!(n&e.childLanes))return null;if(t!==null&&e.child!==t.child)throw Error(ee(153));if(e.child!==null){for(t=e.child,n=ns(t,t.pendingProps),e.child=n,n.return=e;t.sibling!==null;)t=t.sibling,n=n.sibling=ns(t,t.pendingProps),n.return=e;n.sibling=null}return e.child}function ZE(t,e,n){switch(e.tag){case 3:wS(e),$o();break;case 5:Xy(e);break;case 1:Gt(e.type)&&cu(e);break;case 4:Xp(e,e.stateNode.containerInfo);break;case 10:var i=e.type._context,r=e.memoizedProps.value;Pe(hu,i._currentValue),i._currentValue=r;break;case 13:if(i=e.memoizedState,i!==null)return i.dehydrated!==null?(Pe(Ne,Ne.current&1),e.flags|=128,null):n&e.child.childLanes?kS(t,e,n):(Pe(Ne,Ne.current&1),t=vr(t,e,n),t!==null?t.sibling:null);Pe(Ne,Ne.current&1);break;case 19:if(i=(n&e.childLanes)!==0,t.flags&128){if(i)return ES(t,e,n);e.flags|=128}if(r=e.memoizedState,r!==null&&(r.rendering=null,r.tail=null,r.lastEffect=null),Pe(Ne,Ne.current),i)break;return null;case 22:case 23:return e.lanes=0,CS(t,e,n)}return vr(t,e,n)}var TS,Sf,RS,xS;TS=function(t,e){for(var n=e.child;n!==null;){if(n.tag===5||n.tag===6)t.appendChild(n.stateNode);else if(n.tag!==4&&n.child!==null){n.child.return=n,n=n.child;continue}if(n===e)break;for(;n.sibling===null;){if(n.return===null||n.return===e)return;n=n.return}n.sibling.return=n.return,n=n.sibling}};Sf=function(){};RS=function(t,e,n,i){var r=t.memoizedProps;if(r!==i){t=e.stateNode,Es(ki.current);var s=null;switch(n){case"input":r=Hh(t,r),i=Hh(t,i),s=[];break;case"select":r=Fe({},r,{value:void 0}),i=Fe({},i,{value:void 0}),s=[];break;case"textarea":r=$h(t,r),i=$h(t,i),s=[];break;default:typeof r.onClick!="function"&&typeof i.onClick=="function"&&(t.onclick=au)}Gh(n,i);var a;n=null;for(c in r)if(!i.hasOwnProperty(c)&&r.hasOwnProperty(c)&&r[c]!=null)if(c==="style"){var o=r[c];for(a in o)o.hasOwnProperty(a)&&(n||(n={}),n[a]="")}else c!=="dangerouslySetInnerHTML"&&c!=="children"&&c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&c!=="autoFocus"&&(ol.hasOwnProperty(c)?s||(s=[]):(s=s||[]).push(c,null));for(c in i){var l=i[c];if(o=r!=null?r[c]:void 0,i.hasOwnProperty(c)&&l!==o&&(l!=null||o!=null))if(c==="style")if(o){for(a in o)!o.hasOwnProperty(a)||l&&l.hasOwnProperty(a)||(n||(n={}),n[a]="");for(a in l)l.hasOwnProperty(a)&&o[a]!==l[a]&&(n||(n={}),n[a]=l[a])}else n||(s||(s=[]),s.push(c,n)),n=l;else c==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,o=o?o.__html:void 0,l!=null&&o!==l&&(s=s||[]).push(c,l)):c==="children"?typeof l!="string"&&typeof l!="number"||(s=s||[]).push(c,""+l):c!=="suppressContentEditableWarning"&&c!=="suppressHydrationWarning"&&(ol.hasOwnProperty(c)?(l!=null&&c==="onScroll"&&Ie("scroll",t),s||o===l||(s=[])):(s=s||[]).push(c,l))}n&&(s=s||[]).push("style",n);var c=s;(e.updateQueue=c)&&(e.flags|=4)}};xS=function(t,e,n,i){n!==i&&(e.flags|=4)};function Ra(t,e){if(!De)switch(t.tailMode){case"hidden":e=t.tail;for(var n=null;e!==null;)e.alternate!==null&&(n=e),e=e.sibling;n===null?t.tail=null:n.sibling=null;break;case"collapsed":n=t.tail;for(var i=null;n!==null;)n.alternate!==null&&(i=n),n=n.sibling;i===null?e||t.tail===null?t.tail=null:t.tail.sibling=null:i.sibling=null}}function yt(t){var e=t.alternate!==null&&t.alternate.child===t.child,n=0,i=0;if(e)for(var r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags&14680064,i|=r.flags&14680064,r.return=t,r=r.sibling;else for(r=t.child;r!==null;)n|=r.lanes|r.childLanes,i|=r.subtreeFlags,i|=r.flags,r.return=t,r=r.sibling;return t.subtreeFlags|=i,t.childLanes=n,e}function eT(t,e,n){var i=e.pendingProps;switch($p(e),e.tag){case 2:case 16:case 15:case 0:case 11:case 7:case 8:case 12:case 9:case 14:return yt(e),null;case 1:return Gt(e.type)&&lu(),yt(e),null;case 3:return i=e.stateNode,Go(),Me(Vt),Me(Tt),Zp(),i.pendingContext&&(i.context=i.pendingContext,i.pendingContext=null),(t===null||t.child===null)&&(uc(e)?e.flags|=4:t===null||t.memoizedState.isDehydrated&&!(e.flags&256)||(e.flags|=1024,Mn!==null&&(xf(Mn),Mn=null))),Sf(t,e),yt(e),null;case 5:Yp(e);var r=Es(_l.current);if(n=e.type,t!==null&&e.stateNode!=null)RS(t,e,n,i,r),t.ref!==e.ref&&(e.flags|=512,e.flags|=2097152);else{if(!i){if(e.stateNode===null)throw Error(ee(166));return yt(e),null}if(t=Es(ki.current),uc(e)){i=e.stateNode,n=e.type;var s=e.memoizedProps;switch(i[si]=e,i[gl]=s,t=(e.mode&1)!==0,n){case"dialog":Ie("cancel",i),Ie("close",i);break;case"iframe":case"object":case"embed":Ie("load",i);break;case"video":case"audio":for(r=0;r<Ua.length;r++)Ie(Ua[r],i);break;case"source":Ie("error",i);break;case"img":case"image":case"link":Ie("error",i),Ie("load",i);break;case"details":Ie("toggle",i);break;case"input":fg(i,s),Ie("invalid",i);break;case"select":i._wrapperState={wasMultiple:!!s.multiple},Ie("invalid",i);break;case"textarea":mg(i,s),Ie("invalid",i)}Gh(n,s),r=null;for(var a in s)if(s.hasOwnProperty(a)){var o=s[a];a==="children"?typeof o=="string"?i.textContent!==o&&(s.suppressHydrationWarning!==!0&&cc(i.textContent,o,t),r=["children",o]):typeof o=="number"&&i.textContent!==""+o&&(s.suppressHydrationWarning!==!0&&cc(i.textContent,o,t),r=["children",""+o]):ol.hasOwnProperty(a)&&o!=null&&a==="onScroll"&&Ie("scroll",i)}switch(n){case"input":tc(i),pg(i,s,!0);break;case"textarea":tc(i),gg(i);break;case"select":case"option":break;default:typeof s.onClick=="function"&&(i.onclick=au)}i=r,e.updateQueue=i,i!==null&&(e.flags|=4)}else{a=r.nodeType===9?r:r.ownerDocument,t==="http://www.w3.org/1999/xhtml"&&(t=ny(n)),t==="http://www.w3.org/1999/xhtml"?n==="script"?(t=a.createElement("div"),t.innerHTML="<script><\/script>",t=t.removeChild(t.firstChild)):typeof i.is=="string"?t=a.createElement(n,{is:i.is}):(t=a.createElement(n),n==="select"&&(a=t,i.multiple?a.multiple=!0:i.size&&(a.size=i.size))):t=a.createElementNS(t,n),t[si]=e,t[gl]=i,TS(t,e,!1,!1),e.stateNode=t;e:{switch(a=qh(n,i),n){case"dialog":Ie("cancel",t),Ie("close",t),r=i;break;case"iframe":case"object":case"embed":Ie("load",t),r=i;break;case"video":case"audio":for(r=0;r<Ua.length;r++)Ie(Ua[r],t);r=i;break;case"source":Ie("error",t),r=i;break;case"img":case"image":case"link":Ie("error",t),Ie("load",t),r=i;break;case"details":Ie("toggle",t),r=i;break;case"input":fg(t,i),r=Hh(t,i),Ie("invalid",t);break;case"option":r=i;break;case"select":t._wrapperState={wasMultiple:!!i.multiple},r=Fe({},i,{value:void 0}),Ie("invalid",t);break;case"textarea":mg(t,i),r=$h(t,i),Ie("invalid",t);break;default:r=i}Gh(n,r),o=r;for(s in o)if(o.hasOwnProperty(s)){var l=o[s];s==="style"?sy(t,l):s==="dangerouslySetInnerHTML"?(l=l?l.__html:void 0,l!=null&&iy(t,l)):s==="children"?typeof l=="string"?(n!=="textarea"||l!=="")&&al(t,l):typeof l=="number"&&al(t,""+l):s!=="suppressContentEditableWarning"&&s!=="suppressHydrationWarning"&&s!=="autoFocus"&&(ol.hasOwnProperty(s)?l!=null&&s==="onScroll"&&Ie("scroll",t):l!=null&&Pp(t,s,l,a))}switch(n){case"input":tc(t),pg(t,i,!1);break;case"textarea":tc(t),gg(t);break;case"option":i.value!=null&&t.setAttribute("value",""+as(i.value));break;case"select":t.multiple=!!i.multiple,s=i.value,s!=null?yo(t,!!i.multiple,s,!1):i.defaultValue!=null&&yo(t,!!i.multiple,i.defaultValue,!0);break;default:typeof r.onClick=="function"&&(t.onclick=au)}switch(n){case"button":case"input":case"select":case"textarea":i=!!i.autoFocus;break e;case"img":i=!0;break e;default:i=!1}}i&&(e.flags|=4)}e.ref!==null&&(e.flags|=512,e.flags|=2097152)}return yt(e),null;case 6:if(t&&e.stateNode!=null)xS(t,e,t.memoizedProps,i);else{if(typeof i!="string"&&e.stateNode===null)throw Error(ee(166));if(n=Es(_l.current),Es(ki.current),uc(e)){if(i=e.stateNode,n=e.memoizedProps,i[si]=e,(s=i.nodeValue!==n)&&(t=rn,t!==null))switch(t.tag){case 3:cc(i.nodeValue,n,(t.mode&1)!==0);break;case 5:t.memoizedProps.suppressHydrationWarning!==!0&&cc(i.nodeValue,n,(t.mode&1)!==0)}s&&(e.flags|=4)}else i=(n.nodeType===9?n:n.ownerDocument).createTextNode(i),i[si]=e,e.stateNode=i}return yt(e),null;case 13:if(Me(Ne),i=e.memoizedState,t===null||t.memoizedState!==null&&t.memoizedState.dehydrated!==null){if(De&&tn!==null&&e.mode&1&&!(e.flags&128))Gy(),$o(),e.flags|=98560,s=!1;else if(s=uc(e),i!==null&&i.dehydrated!==null){if(t===null){if(!s)throw Error(ee(318));if(s=e.memoizedState,s=s!==null?s.dehydrated:null,!s)throw Error(ee(317));s[si]=e}else $o(),!(e.flags&128)&&(e.memoizedState=null),e.flags|=4;yt(e),s=!1}else Mn!==null&&(xf(Mn),Mn=null),s=!0;if(!s)return e.flags&65536?e:null}return e.flags&128?(e.lanes=n,e):(i=i!==null,i!==(t!==null&&t.memoizedState!==null)&&i&&(e.child.flags|=8192,e.mode&1&&(t===null||Ne.current&1?nt===0&&(nt=3):dm())),e.updateQueue!==null&&(e.flags|=4),yt(e),null);case 4:return Go(),Sf(t,e),t===null&&pl(e.stateNode.containerInfo),yt(e),null;case 10:return Jp(e.type._context),yt(e),null;case 17:return Gt(e.type)&&lu(),yt(e),null;case 19:if(Me(Ne),s=e.memoizedState,s===null)return yt(e),null;if(i=(e.flags&128)!==0,a=s.rendering,a===null)if(i)Ra(s,!1);else{if(nt!==0||t!==null&&t.flags&128)for(t=e.child;t!==null;){if(a=mu(t),a!==null){for(e.flags|=128,Ra(s,!1),i=a.updateQueue,i!==null&&(e.updateQueue=i,e.flags|=4),e.subtreeFlags=0,i=n,n=e.child;n!==null;)s=n,t=i,s.flags&=14680066,a=s.alternate,a===null?(s.childLanes=0,s.lanes=t,s.child=null,s.subtreeFlags=0,s.memoizedProps=null,s.memoizedState=null,s.updateQueue=null,s.dependencies=null,s.stateNode=null):(s.childLanes=a.childLanes,s.lanes=a.lanes,s.child=a.child,s.subtreeFlags=0,s.deletions=null,s.memoizedProps=a.memoizedProps,s.memoizedState=a.memoizedState,s.updateQueue=a.updateQueue,s.type=a.type,t=a.dependencies,s.dependencies=t===null?null:{lanes:t.lanes,firstContext:t.firstContext}),n=n.sibling;return Pe(Ne,Ne.current&1|2),e.child}t=t.sibling}s.tail!==null&&Ge()>Jo&&(e.flags|=128,i=!0,Ra(s,!1),e.lanes=4194304)}else{if(!i)if(t=mu(a),t!==null){if(e.flags|=128,i=!0,n=t.updateQueue,n!==null&&(e.updateQueue=n,e.flags|=4),Ra(s,!0),s.tail===null&&s.tailMode==="hidden"&&!a.alternate&&!De)return yt(e),null}else 2*Ge()-s.renderingStartTime>Jo&&n!==1073741824&&(e.flags|=128,i=!0,Ra(s,!1),e.lanes=4194304);s.isBackwards?(a.sibling=e.child,e.child=a):(n=s.last,n!==null?n.sibling=a:e.child=a,s.last=a)}return s.tail!==null?(e=s.tail,s.rendering=e,s.tail=e.sibling,s.renderingStartTime=Ge(),e.sibling=null,n=Ne.current,Pe(Ne,i?n&1|2:n&1),e):(yt(e),null);case 22:case 23:return um(),i=e.memoizedState!==null,t!==null&&t.memoizedState!==null!==i&&(e.flags|=8192),i&&e.mode&1?Yt&1073741824&&(yt(e),e.subtreeFlags&6&&(e.flags|=8192)):yt(e),null;case 24:return null;case 25:return null}throw Error(ee(156,e.tag))}function tT(t,e){switch($p(e),e.tag){case 1:return Gt(e.type)&&lu(),t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 3:return Go(),Me(Vt),Me(Tt),Zp(),t=e.flags,t&65536&&!(t&128)?(e.flags=t&-65537|128,e):null;case 5:return Yp(e),null;case 13:if(Me(Ne),t=e.memoizedState,t!==null&&t.dehydrated!==null){if(e.alternate===null)throw Error(ee(340));$o()}return t=e.flags,t&65536?(e.flags=t&-65537|128,e):null;case 19:return Me(Ne),null;case 4:return Go(),null;case 10:return Jp(e.type._context),null;case 22:case 23:return um(),null;case 24:return null;default:return null}}var fc=!1,Ct=!1,nT=typeof WeakSet=="function"?WeakSet:Set,oe=null;function po(t,e){var n=t.ref;if(n!==null)if(typeof n=="function")try{n(null)}catch(i){We(t,e,i)}else n.current=null}function Cf(t,e,n){try{n()}catch(i){We(t,e,i)}}var sv=!1;function iT(t,e){if(rf=ru,t=My(),jp(t)){if("selectionStart"in t)var n={start:t.selectionStart,end:t.selectionEnd};else e:{n=(n=t.ownerDocument)&&n.defaultView||window;var i=n.getSelection&&n.getSelection();if(i&&i.rangeCount!==0){n=i.anchorNode;var r=i.anchorOffset,s=i.focusNode;i=i.focusOffset;try{n.nodeType,s.nodeType}catch{n=null;break e}var a=0,o=-1,l=-1,c=0,d=0,u=t,m=null;t:for(;;){for(var v;u!==n||r!==0&&u.nodeType!==3||(o=a+r),u!==s||i!==0&&u.nodeType!==3||(l=a+i),u.nodeType===3&&(a+=u.nodeValue.length),(v=u.firstChild)!==null;)m=u,u=v;for(;;){if(u===t)break t;if(m===n&&++c===r&&(o=a),m===s&&++d===i&&(l=a),(v=u.nextSibling)!==null)break;u=m,m=u.parentNode}u=v}n=o===-1||l===-1?null:{start:o,end:l}}else n=null}n=n||{start:0,end:0}}else n=null;for(sf={focusedElem:t,selectionRange:n},ru=!1,oe=e;oe!==null;)if(e=oe,t=e.child,(e.subtreeFlags&1028)!==0&&t!==null)t.return=e,oe=t;else for(;oe!==null;){e=oe;try{var y=e.alternate;if(e.flags&1024)switch(e.tag){case 0:case 11:case 15:break;case 1:if(y!==null){var _=y.memoizedProps,p=y.memoizedState,f=e.stateNode,h=f.getSnapshotBeforeUpdate(e.elementType===e.type?_:xn(e.type,_),p);f.__reactInternalSnapshotBeforeUpdate=h}break;case 3:var g=e.stateNode.containerInfo;g.nodeType===1?g.textContent="":g.nodeType===9&&g.documentElement&&g.removeChild(g.documentElement);break;case 5:case 6:case 4:case 17:break;default:throw Error(ee(163))}}catch(S){We(e,e.return,S)}if(t=e.sibling,t!==null){t.return=e.return,oe=t;break}oe=e.return}return y=sv,sv=!1,y}function Xa(t,e,n){var i=e.updateQueue;if(i=i!==null?i.lastEffect:null,i!==null){var r=i=i.next;do{if((r.tag&t)===t){var s=r.destroy;r.destroy=void 0,s!==void 0&&Cf(e,n,s)}r=r.next}while(r!==i)}}function Zu(t,e){if(e=e.updateQueue,e=e!==null?e.lastEffect:null,e!==null){var n=e=e.next;do{if((n.tag&t)===t){var i=n.create;n.destroy=i()}n=n.next}while(n!==e)}}function bf(t){var e=t.ref;if(e!==null){var n=t.stateNode;switch(t.tag){case 5:t=n;break;default:t=n}typeof e=="function"?e(t):e.current=t}}function PS(t){var e=t.alternate;e!==null&&(t.alternate=null,PS(e)),t.child=null,t.deletions=null,t.sibling=null,t.tag===5&&(e=t.stateNode,e!==null&&(delete e[si],delete e[gl],delete e[lf],delete e[UE],delete e[zE])),t.stateNode=null,t.return=null,t.dependencies=null,t.memoizedProps=null,t.memoizedState=null,t.pendingProps=null,t.stateNode=null,t.updateQueue=null}function OS(t){return t.tag===5||t.tag===3||t.tag===4}function ov(t){e:for(;;){for(;t.sibling===null;){if(t.return===null||OS(t.return))return null;t=t.return}for(t.sibling.return=t.return,t=t.sibling;t.tag!==5&&t.tag!==6&&t.tag!==18;){if(t.flags&2||t.child===null||t.tag===4)continue e;t.child.return=t,t=t.child}if(!(t.flags&2))return t.stateNode}}function wf(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.nodeType===8?n.parentNode.insertBefore(t,e):n.insertBefore(t,e):(n.nodeType===8?(e=n.parentNode,e.insertBefore(t,n)):(e=n,e.appendChild(t)),n=n._reactRootContainer,n!=null||e.onclick!==null||(e.onclick=au));else if(i!==4&&(t=t.child,t!==null))for(wf(t,e,n),t=t.sibling;t!==null;)wf(t,e,n),t=t.sibling}function kf(t,e,n){var i=t.tag;if(i===5||i===6)t=t.stateNode,e?n.insertBefore(t,e):n.appendChild(t);else if(i!==4&&(t=t.child,t!==null))for(kf(t,e,n),t=t.sibling;t!==null;)kf(t,e,n),t=t.sibling}var ct=null,In=!1;function Rr(t,e,n){for(n=n.child;n!==null;)IS(t,e,n),n=n.sibling}function IS(t,e,n){if(wi&&typeof wi.onCommitFiberUnmount=="function")try{wi.onCommitFiberUnmount(Vu,n)}catch{}switch(n.tag){case 5:Ct||po(n,e);case 6:var i=ct,r=In;ct=null,Rr(t,e,n),ct=i,In=r,ct!==null&&(In?(t=ct,n=n.stateNode,t.nodeType===8?t.parentNode.removeChild(n):t.removeChild(n)):ct.removeChild(n.stateNode));break;case 18:ct!==null&&(In?(t=ct,n=n.stateNode,t.nodeType===8?Yd(t.parentNode,n):t.nodeType===1&&Yd(t,n),dl(t)):Yd(ct,n.stateNode));break;case 4:i=ct,r=In,ct=n.stateNode.containerInfo,In=!0,Rr(t,e,n),ct=i,In=r;break;case 0:case 11:case 14:case 15:if(!Ct&&(i=n.updateQueue,i!==null&&(i=i.lastEffect,i!==null))){r=i=i.next;do{var s=r,a=s.destroy;s=s.tag,a!==void 0&&(s&2||s&4)&&Cf(n,e,a),r=r.next}while(r!==i)}Rr(t,e,n);break;case 1:if(!Ct&&(po(n,e),i=n.stateNode,typeof i.componentWillUnmount=="function"))try{i.props=n.memoizedProps,i.state=n.memoizedState,i.componentWillUnmount()}catch(o){We(n,e,o)}Rr(t,e,n);break;case 21:Rr(t,e,n);break;case 22:n.mode&1?(Ct=(i=Ct)||n.memoizedState!==null,Rr(t,e,n),Ct=i):Rr(t,e,n);break;default:Rr(t,e,n)}}function av(t){var e=t.updateQueue;if(e!==null){t.updateQueue=null;var n=t.stateNode;n===null&&(n=t.stateNode=new nT),e.forEach(function(i){var r=hT.bind(null,t,i);n.has(i)||(n.add(i),i.then(r,r))})}}function Tn(t,e){var n=e.deletions;if(n!==null)for(var i=0;i<n.length;i++){var r=n[i];try{var s=t,a=e,o=a;e:for(;o!==null;){switch(o.tag){case 5:ct=o.stateNode,In=!1;break e;case 3:ct=o.stateNode.containerInfo,In=!0;break e;case 4:ct=o.stateNode.containerInfo,In=!0;break e}o=o.return}if(ct===null)throw Error(ee(160));IS(s,a,r),ct=null,In=!1;var l=r.alternate;l!==null&&(l.return=null),r.return=null}catch(c){We(r,e,c)}}if(e.subtreeFlags&12854)for(e=e.child;e!==null;)LS(e,t),e=e.sibling}function LS(t,e){var n=t.alternate,i=t.flags;switch(t.tag){case 0:case 11:case 14:case 15:if(Tn(e,t),Xn(t),i&4){try{Xa(3,t,t.return),Zu(3,t)}catch(_){We(t,t.return,_)}try{Xa(5,t,t.return)}catch(_){We(t,t.return,_)}}break;case 1:Tn(e,t),Xn(t),i&512&&n!==null&&po(n,n.return);break;case 5:if(Tn(e,t),Xn(t),i&512&&n!==null&&po(n,n.return),t.flags&32){var r=t.stateNode;try{al(r,"")}catch(_){We(t,t.return,_)}}if(i&4&&(r=t.stateNode,r!=null)){var s=t.memoizedProps,a=n!==null?n.memoizedProps:s,o=t.type,l=t.updateQueue;if(t.updateQueue=null,l!==null)try{o==="input"&&s.type==="radio"&&s.name!=null&&ey(r,s),qh(o,a);var c=qh(o,s);for(a=0;a<l.length;a+=2){var d=l[a],u=l[a+1];d==="style"?sy(r,u):d==="dangerouslySetInnerHTML"?iy(r,u):d==="children"?al(r,u):Pp(r,d,u,c)}switch(o){case"input":jh(r,s);break;case"textarea":ty(r,s);break;case"select":var m=r._wrapperState.wasMultiple;r._wrapperState.wasMultiple=!!s.multiple;var v=s.value;v!=null?yo(r,!!s.multiple,v,!1):m!==!!s.multiple&&(s.defaultValue!=null?yo(r,!!s.multiple,s.defaultValue,!0):yo(r,!!s.multiple,s.multiple?[]:"",!1))}r[gl]=s}catch(_){We(t,t.return,_)}}break;case 6:if(Tn(e,t),Xn(t),i&4){if(t.stateNode===null)throw Error(ee(162));r=t.stateNode,s=t.memoizedProps;try{r.nodeValue=s}catch(_){We(t,t.return,_)}}break;case 3:if(Tn(e,t),Xn(t),i&4&&n!==null&&n.memoizedState.isDehydrated)try{dl(e.containerInfo)}catch(_){We(t,t.return,_)}break;case 4:Tn(e,t),Xn(t);break;case 13:Tn(e,t),Xn(t),r=t.child,r.flags&8192&&(s=r.memoizedState!==null,r.stateNode.isHidden=s,!s||r.alternate!==null&&r.alternate.memoizedState!==null||(lm=Ge())),i&4&&av(t);break;case 22:if(d=n!==null&&n.memoizedState!==null,t.mode&1?(Ct=(c=Ct)||d,Tn(e,t),Ct=c):Tn(e,t),Xn(t),i&8192){if(c=t.memoizedState!==null,(t.stateNode.isHidden=c)&&!d&&t.mode&1)for(oe=t,d=t.child;d!==null;){for(u=oe=d;oe!==null;){switch(m=oe,v=m.child,m.tag){case 0:case 11:case 14:case 15:Xa(4,m,m.return);break;case 1:po(m,m.return);var y=m.stateNode;if(typeof y.componentWillUnmount=="function"){i=m,n=m.return;try{e=i,y.props=e.memoizedProps,y.state=e.memoizedState,y.componentWillUnmount()}catch(_){We(i,n,_)}}break;case 5:po(m,m.return);break;case 22:if(m.memoizedState!==null){cv(u);continue}}v!==null?(v.return=m,oe=v):cv(u)}d=d.sibling}e:for(d=null,u=t;;){if(u.tag===5){if(d===null){d=u;try{r=u.stateNode,c?(s=r.style,typeof s.setProperty=="function"?s.setProperty("display","none","important"):s.display="none"):(o=u.stateNode,l=u.memoizedProps.style,a=l!=null&&l.hasOwnProperty("display")?l.display:null,o.style.display=ry("display",a))}catch(_){We(t,t.return,_)}}}else if(u.tag===6){if(d===null)try{u.stateNode.nodeValue=c?"":u.memoizedProps}catch(_){We(t,t.return,_)}}else if((u.tag!==22&&u.tag!==23||u.memoizedState===null||u===t)&&u.child!==null){u.child.return=u,u=u.child;continue}if(u===t)break e;for(;u.sibling===null;){if(u.return===null||u.return===t)break e;d===u&&(d=null),u=u.return}d===u&&(d=null),u.sibling.return=u.return,u=u.sibling}}break;case 19:Tn(e,t),Xn(t),i&4&&av(t);break;case 21:break;default:Tn(e,t),Xn(t)}}function Xn(t){var e=t.flags;if(e&2){try{e:{for(var n=t.return;n!==null;){if(OS(n)){var i=n;break e}n=n.return}throw Error(ee(160))}switch(i.tag){case 5:var r=i.stateNode;i.flags&32&&(al(r,""),i.flags&=-33);var s=ov(t);kf(t,s,r);break;case 3:case 4:var a=i.stateNode.containerInfo,o=ov(t);wf(t,o,a);break;default:throw Error(ee(161))}}catch(l){We(t,t.return,l)}t.flags&=-3}e&4096&&(t.flags&=-4097)}function rT(t,e,n){oe=t,MS(t)}function MS(t,e,n){for(var i=(t.mode&1)!==0;oe!==null;){var r=oe,s=r.child;if(r.tag===22&&i){var a=r.memoizedState!==null||fc;if(!a){var o=r.alternate,l=o!==null&&o.memoizedState!==null||Ct;o=fc;var c=Ct;if(fc=a,(Ct=l)&&!c)for(oe=r;oe!==null;)a=oe,l=a.child,a.tag===22&&a.memoizedState!==null?uv(r):l!==null?(l.return=a,oe=l):uv(r);for(;s!==null;)oe=s,MS(s),s=s.sibling;oe=r,fc=o,Ct=c}lv(t)}else r.subtreeFlags&8772&&s!==null?(s.return=r,oe=s):lv(t)}}function lv(t){for(;oe!==null;){var e=oe;if(e.flags&8772){var n=e.alternate;try{if(e.flags&8772)switch(e.tag){case 0:case 11:case 15:Ct||Zu(5,e);break;case 1:var i=e.stateNode;if(e.flags&4&&!Ct)if(n===null)i.componentDidMount();else{var r=e.elementType===e.type?n.memoizedProps:xn(e.type,n.memoizedProps);i.componentDidUpdate(r,n.memoizedState,i.__reactInternalSnapshotBeforeUpdate)}var s=e.updateQueue;s!==null&&Gg(e,s,i);break;case 3:var a=e.updateQueue;if(a!==null){if(n=null,e.child!==null)switch(e.child.tag){case 5:n=e.child.stateNode;break;case 1:n=e.child.stateNode}Gg(e,a,n)}break;case 5:var o=e.stateNode;if(n===null&&e.flags&4){n=o;var l=e.memoizedProps;switch(e.type){case"button":case"input":case"select":case"textarea":l.autoFocus&&n.focus();break;case"img":l.src&&(n.src=l.src)}}break;case 6:break;case 4:break;case 12:break;case 13:if(e.memoizedState===null){var c=e.alternate;if(c!==null){var d=c.memoizedState;if(d!==null){var u=d.dehydrated;u!==null&&dl(u)}}}break;case 19:case 17:case 21:case 22:case 23:case 25:break;default:throw Error(ee(163))}Ct||e.flags&512&&bf(e)}catch(m){We(e,e.return,m)}}if(e===t){oe=null;break}if(n=e.sibling,n!==null){n.return=e.return,oe=n;break}oe=e.return}}function cv(t){for(;oe!==null;){var e=oe;if(e===t){oe=null;break}var n=e.sibling;if(n!==null){n.return=e.return,oe=n;break}oe=e.return}}function uv(t){for(;oe!==null;){var e=oe;try{switch(e.tag){case 0:case 11:case 15:var n=e.return;try{Zu(4,e)}catch(l){We(e,n,l)}break;case 1:var i=e.stateNode;if(typeof i.componentDidMount=="function"){var r=e.return;try{i.componentDidMount()}catch(l){We(e,r,l)}}var s=e.return;try{bf(e)}catch(l){We(e,s,l)}break;case 5:var a=e.return;try{bf(e)}catch(l){We(e,a,l)}}}catch(l){We(e,e.return,l)}if(e===t){oe=null;break}var o=e.sibling;if(o!==null){o.return=e.return,oe=o;break}oe=e.return}}var sT=Math.ceil,_u=Sr.ReactCurrentDispatcher,om=Sr.ReactCurrentOwner,Sn=Sr.ReactCurrentBatchConfig,Ce=0,lt=null,Qe=null,ft=0,Yt=0,mo=ps(0),nt=0,bl=null,Fs=0,ed=0,am=0,Ya=null,Ht=null,lm=0,Jo=1/0,Mi=null,yu=!1,Ef=null,es=null,pc=!1,zr=null,Su=0,Za=0,Tf=null,Dc=-1,Ac=0;function Dt(){return Ce&6?Ge():Dc!==-1?Dc:Dc=Ge()}function ts(t){return t.mode&1?Ce&2&&ft!==0?ft&-ft:jE.transition!==null?(Ac===0&&(Ac=vy()),Ac):(t=ke,t!==0||(t=window.event,t=t===void 0?16:ky(t.type)),t):1}function Wn(t,e,n,i){if(50<Za)throw Za=0,Tf=null,Error(ee(185));Ul(t,n,i),(!(Ce&2)||t!==lt)&&(t===lt&&(!(Ce&2)&&(ed|=n),nt===4&&Mr(t,ft)),qt(t,i),n===1&&Ce===0&&!(e.mode&1)&&(Jo=Ge()+500,Qu&&ms()))}function qt(t,e){var n=t.callbackNode;jk(t,e);var i=iu(t,t===lt?ft:0);if(i===0)n!==null&&yg(n),t.callbackNode=null,t.callbackPriority=0;else if(e=i&-i,t.callbackPriority!==e){if(n!=null&&yg(n),e===1)t.tag===0?HE(dv.bind(null,t)):Wy(dv.bind(null,t)),BE(function(){!(Ce&6)&&ms()}),n=null;else{switch(_y(i)){case 1:n=Dp;break;case 4:n=my;break;case 16:n=nu;break;case 536870912:n=gy;break;default:n=nu}n=HS(n,DS.bind(null,t))}t.callbackPriority=e,t.callbackNode=n}}function DS(t,e){if(Dc=-1,Ac=0,Ce&6)throw Error(ee(327));var n=t.callbackNode;if(ko()&&t.callbackNode!==n)return null;var i=iu(t,t===lt?ft:0);if(i===0)return null;if(i&30||i&t.expiredLanes||e)e=Cu(t,i);else{e=i;var r=Ce;Ce|=2;var s=NS();(lt!==t||ft!==e)&&(Mi=null,Jo=Ge()+500,Is(t,e));do try{lT();break}catch(o){AS(t,o)}while(1);qp(),_u.current=s,Ce=r,Qe!==null?e=0:(lt=null,ft=0,e=nt)}if(e!==0){if(e===2&&(r=Yh(t),r!==0&&(i=r,e=Rf(t,r))),e===1)throw n=bl,Is(t,0),Mr(t,i),qt(t,Ge()),n;if(e===6)Mr(t,i);else{if(r=t.current.alternate,!(i&30)&&!oT(r)&&(e=Cu(t,i),e===2&&(s=Yh(t),s!==0&&(i=s,e=Rf(t,s))),e===1))throw n=bl,Is(t,0),Mr(t,i),qt(t,Ge()),n;switch(t.finishedWork=r,t.finishedLanes=i,e){case 0:case 1:throw Error(ee(345));case 2:Cs(t,Ht,Mi);break;case 3:if(Mr(t,i),(i&130023424)===i&&(e=lm+500-Ge(),10<e)){if(iu(t,0)!==0)break;if(r=t.suspendedLanes,(r&i)!==i){Dt(),t.pingedLanes|=t.suspendedLanes&r;break}t.timeoutHandle=af(Cs.bind(null,t,Ht,Mi),e);break}Cs(t,Ht,Mi);break;case 4:if(Mr(t,i),(i&4194240)===i)break;for(e=t.eventTimes,r=-1;0<i;){var a=31-jn(i);s=1<<a,a=e[a],a>r&&(r=a),i&=~s}if(i=r,i=Ge()-i,i=(120>i?120:480>i?480:1080>i?1080:1920>i?1920:3e3>i?3e3:4320>i?4320:1960*sT(i/1960))-i,10<i){t.timeoutHandle=af(Cs.bind(null,t,Ht,Mi),i);break}Cs(t,Ht,Mi);break;case 5:Cs(t,Ht,Mi);break;default:throw Error(ee(329))}}}return qt(t,Ge()),t.callbackNode===n?DS.bind(null,t):null}function Rf(t,e){var n=Ya;return t.current.memoizedState.isDehydrated&&(Is(t,e).flags|=256),t=Cu(t,e),t!==2&&(e=Ht,Ht=n,e!==null&&xf(e)),t}function xf(t){Ht===null?Ht=t:Ht.push.apply(Ht,t)}function oT(t){for(var e=t;;){if(e.flags&16384){var n=e.updateQueue;if(n!==null&&(n=n.stores,n!==null))for(var i=0;i<n.length;i++){var r=n[i],s=r.getSnapshot;r=r.value;try{if(!Gn(s(),r))return!1}catch{return!1}}}if(n=e.child,e.subtreeFlags&16384&&n!==null)n.return=e,e=n;else{if(e===t)break;for(;e.sibling===null;){if(e.return===null||e.return===t)return!0;e=e.return}e.sibling.return=e.return,e=e.sibling}}return!0}function Mr(t,e){for(e&=~am,e&=~ed,t.suspendedLanes|=e,t.pingedLanes&=~e,t=t.expirationTimes;0<e;){var n=31-jn(e),i=1<<n;t[n]=-1,e&=~i}}function dv(t){if(Ce&6)throw Error(ee(327));ko();var e=iu(t,0);if(!(e&1))return qt(t,Ge()),null;var n=Cu(t,e);if(t.tag!==0&&n===2){var i=Yh(t);i!==0&&(e=i,n=Rf(t,i))}if(n===1)throw n=bl,Is(t,0),Mr(t,e),qt(t,Ge()),n;if(n===6)throw Error(ee(345));return t.finishedWork=t.current.alternate,t.finishedLanes=e,Cs(t,Ht,Mi),qt(t,Ge()),null}function cm(t,e){var n=Ce;Ce|=1;try{return t(e)}finally{Ce=n,Ce===0&&(Jo=Ge()+500,Qu&&ms())}}function Us(t){zr!==null&&zr.tag===0&&!(Ce&6)&&ko();var e=Ce;Ce|=1;var n=Sn.transition,i=ke;try{if(Sn.transition=null,ke=1,t)return t()}finally{ke=i,Sn.transition=n,Ce=e,!(Ce&6)&&ms()}}function um(){Yt=mo.current,Me(mo)}function Is(t,e){t.finishedWork=null,t.finishedLanes=0;var n=t.timeoutHandle;if(n!==-1&&(t.timeoutHandle=-1,NE(n)),Qe!==null)for(n=Qe.return;n!==null;){var i=n;switch($p(i),i.tag){case 1:i=i.type.childContextTypes,i!=null&&lu();break;case 3:Go(),Me(Vt),Me(Tt),Zp();break;case 5:Yp(i);break;case 4:Go();break;case 13:Me(Ne);break;case 19:Me(Ne);break;case 10:Jp(i.type._context);break;case 22:case 23:um()}n=n.return}if(lt=t,Qe=t=ns(t.current,null),ft=Yt=e,nt=0,bl=null,am=ed=Fs=0,Ht=Ya=null,ks!==null){for(e=0;e<ks.length;e++)if(n=ks[e],i=n.interleaved,i!==null){n.interleaved=null;var r=i.next,s=n.pending;if(s!==null){var a=s.next;s.next=r,i.next=a}n.pending=i}ks=null}return t}function AS(t,e){do{var n=Qe;try{if(qp(),Ic.current=vu,gu){for(var i=Be.memoizedState;i!==null;){var r=i.queue;r!==null&&(r.pending=null),i=i.next}gu=!1}if(Bs=0,st=tt=Be=null,Qa=!1,yl=0,om.current=null,n===null||n.return===null){nt=1,bl=e,Qe=null;break}e:{var s=t,a=n.return,o=n,l=e;if(e=ft,o.flags|=32768,l!==null&&typeof l=="object"&&typeof l.then=="function"){var c=l,d=o,u=d.tag;if(!(d.mode&1)&&(u===0||u===11||u===15)){var m=d.alternate;m?(d.updateQueue=m.updateQueue,d.memoizedState=m.memoizedState,d.lanes=m.lanes):(d.updateQueue=null,d.memoizedState=null)}var v=Yg(a);if(v!==null){v.flags&=-257,Zg(v,a,o,s,e),v.mode&1&&Xg(s,c,e),e=v,l=c;var y=e.updateQueue;if(y===null){var _=new Set;_.add(l),e.updateQueue=_}else y.add(l);break e}else{if(!(e&1)){Xg(s,c,e),dm();break e}l=Error(ee(426))}}else if(De&&o.mode&1){var p=Yg(a);if(p!==null){!(p.flags&65536)&&(p.flags|=256),Zg(p,a,o,s,e),Vp(qo(l,o));break e}}s=l=qo(l,o),nt!==4&&(nt=2),Ya===null?Ya=[s]:Ya.push(s),s=a;do{switch(s.tag){case 3:s.flags|=65536,e&=-e,s.lanes|=e;var f=_S(s,l,e);Vg(s,f);break e;case 1:o=l;var h=s.type,g=s.stateNode;if(!(s.flags&128)&&(typeof h.getDerivedStateFromError=="function"||g!==null&&typeof g.componentDidCatch=="function"&&(es===null||!es.has(g)))){s.flags|=65536,e&=-e,s.lanes|=e;var S=yS(s,o,e);Vg(s,S);break e}}s=s.return}while(s!==null)}FS(n)}catch(b){e=b,Qe===n&&n!==null&&(Qe=n=n.return);continue}break}while(1)}function NS(){var t=_u.current;return _u.current=vu,t===null?vu:t}function dm(){(nt===0||nt===3||nt===2)&&(nt=4),lt===null||!(Fs&268435455)&&!(ed&268435455)||Mr(lt,ft)}function Cu(t,e){var n=Ce;Ce|=2;var i=NS();(lt!==t||ft!==e)&&(Mi=null,Is(t,e));do try{aT();break}catch(r){AS(t,r)}while(1);if(qp(),Ce=n,_u.current=i,Qe!==null)throw Error(ee(261));return lt=null,ft=0,nt}function aT(){for(;Qe!==null;)BS(Qe)}function lT(){for(;Qe!==null&&!Mk();)BS(Qe)}function BS(t){var e=zS(t.alternate,t,Yt);t.memoizedProps=t.pendingProps,e===null?FS(t):Qe=e,om.current=null}function FS(t){var e=t;do{var n=e.alternate;if(t=e.return,e.flags&32768){if(n=tT(n,e),n!==null){n.flags&=32767,Qe=n;return}if(t!==null)t.flags|=32768,t.subtreeFlags=0,t.deletions=null;else{nt=6,Qe=null;return}}else if(n=eT(n,e,Yt),n!==null){Qe=n;return}if(e=e.sibling,e!==null){Qe=e;return}Qe=e=t}while(e!==null);nt===0&&(nt=5)}function Cs(t,e,n){var i=ke,r=Sn.transition;try{Sn.transition=null,ke=1,cT(t,e,n,i)}finally{Sn.transition=r,ke=i}return null}function cT(t,e,n,i){do ko();while(zr!==null);if(Ce&6)throw Error(ee(327));n=t.finishedWork;var r=t.finishedLanes;if(n===null)return null;if(t.finishedWork=null,t.finishedLanes=0,n===t.current)throw Error(ee(177));t.callbackNode=null,t.callbackPriority=0;var s=n.lanes|n.childLanes;if(Wk(t,s),t===lt&&(Qe=lt=null,ft=0),!(n.subtreeFlags&2064)&&!(n.flags&2064)||pc||(pc=!0,HS(nu,function(){return ko(),null})),s=(n.flags&15990)!==0,n.subtreeFlags&15990||s){s=Sn.transition,Sn.transition=null;var a=ke;ke=1;var o=Ce;Ce|=4,om.current=null,iT(t,n),LS(n,t),PE(sf),ru=!!rf,sf=rf=null,t.current=n,rT(n),Dk(),Ce=o,ke=a,Sn.transition=s}else t.current=n;if(pc&&(pc=!1,zr=t,Su=r),s=t.pendingLanes,s===0&&(es=null),Bk(n.stateNode),qt(t,Ge()),e!==null)for(i=t.onRecoverableError,n=0;n<e.length;n++)r=e[n],i(r.value,{componentStack:r.stack,digest:r.digest});if(yu)throw yu=!1,t=Ef,Ef=null,t;return Su&1&&t.tag!==0&&ko(),s=t.pendingLanes,s&1?t===Tf?Za++:(Za=0,Tf=t):Za=0,ms(),null}function ko(){if(zr!==null){var t=_y(Su),e=Sn.transition,n=ke;try{if(Sn.transition=null,ke=16>t?16:t,zr===null)var i=!1;else{if(t=zr,zr=null,Su=0,Ce&6)throw Error(ee(331));var r=Ce;for(Ce|=4,oe=t.current;oe!==null;){var s=oe,a=s.child;if(oe.flags&16){var o=s.deletions;if(o!==null){for(var l=0;l<o.length;l++){var c=o[l];for(oe=c;oe!==null;){var d=oe;switch(d.tag){case 0:case 11:case 15:Xa(8,d,s)}var u=d.child;if(u!==null)u.return=d,oe=u;else for(;oe!==null;){d=oe;var m=d.sibling,v=d.return;if(PS(d),d===c){oe=null;break}if(m!==null){m.return=v,oe=m;break}oe=v}}}var y=s.alternate;if(y!==null){var _=y.child;if(_!==null){y.child=null;do{var p=_.sibling;_.sibling=null,_=p}while(_!==null)}}oe=s}}if(s.subtreeFlags&2064&&a!==null)a.return=s,oe=a;else e:for(;oe!==null;){if(s=oe,s.flags&2048)switch(s.tag){case 0:case 11:case 15:Xa(9,s,s.return)}var f=s.sibling;if(f!==null){f.return=s.return,oe=f;break e}oe=s.return}}var h=t.current;for(oe=h;oe!==null;){a=oe;var g=a.child;if(a.subtreeFlags&2064&&g!==null)g.return=a,oe=g;else e:for(a=h;oe!==null;){if(o=oe,o.flags&2048)try{switch(o.tag){case 0:case 11:case 15:Zu(9,o)}}catch(b){We(o,o.return,b)}if(o===a){oe=null;break e}var S=o.sibling;if(S!==null){S.return=o.return,oe=S;break e}oe=o.return}}if(Ce=r,ms(),wi&&typeof wi.onPostCommitFiberRoot=="function")try{wi.onPostCommitFiberRoot(Vu,t)}catch{}i=!0}return i}finally{ke=n,Sn.transition=e}}return!1}function hv(t,e,n){e=qo(n,e),e=_S(t,e,1),t=Zr(t,e,1),e=Dt(),t!==null&&(Ul(t,1,e),qt(t,e))}function We(t,e,n){if(t.tag===3)hv(t,t,n);else for(;e!==null;){if(e.tag===3){hv(e,t,n);break}else if(e.tag===1){var i=e.stateNode;if(typeof e.type.getDerivedStateFromError=="function"||typeof i.componentDidCatch=="function"&&(es===null||!es.has(i))){t=qo(n,t),t=yS(e,t,1),e=Zr(e,t,1),t=Dt(),e!==null&&(Ul(e,1,t),qt(e,t));break}}e=e.return}}function uT(t,e,n){var i=t.pingCache;i!==null&&i.delete(e),e=Dt(),t.pingedLanes|=t.suspendedLanes&n,lt===t&&(ft&n)===n&&(nt===4||nt===3&&(ft&130023424)===ft&&500>Ge()-lm?Is(t,0):am|=n),qt(t,e)}function US(t,e){e===0&&(t.mode&1?(e=rc,rc<<=1,!(rc&130023424)&&(rc=4194304)):e=1);var n=Dt();t=gr(t,e),t!==null&&(Ul(t,e,n),qt(t,n))}function dT(t){var e=t.memoizedState,n=0;e!==null&&(n=e.retryLane),US(t,n)}function hT(t,e){var n=0;switch(t.tag){case 13:var i=t.stateNode,r=t.memoizedState;r!==null&&(n=r.retryLane);break;case 19:i=t.stateNode;break;default:throw Error(ee(314))}i!==null&&i.delete(e),US(t,n)}var zS;zS=function(t,e,n){if(t!==null)if(t.memoizedProps!==e.pendingProps||Vt.current)Wt=!0;else{if(!(t.lanes&n)&&!(e.flags&128))return Wt=!1,ZE(t,e,n);Wt=!!(t.flags&131072)}else Wt=!1,De&&e.flags&1048576&&$y(e,du,e.index);switch(e.lanes=0,e.tag){case 2:var i=e.type;Mc(t,e),t=e.pendingProps;var r=Wo(e,Tt.current);wo(e,n),r=tm(null,e,i,t,r,n);var s=nm();return e.flags|=1,typeof r=="object"&&r!==null&&typeof r.render=="function"&&r.$$typeof===void 0?(e.tag=1,e.memoizedState=null,e.updateQueue=null,Gt(i)?(s=!0,cu(e)):s=!1,e.memoizedState=r.state!==null&&r.state!==void 0?r.state:null,Qp(e),r.updater=Yu,e.stateNode=r,r._reactInternals=e,pf(e,i,t,n),e=vf(null,e,i,!0,s,n)):(e.tag=0,De&&s&&Wp(e),xt(null,e,r,n),e=e.child),e;case 16:i=e.elementType;e:{switch(Mc(t,e),t=e.pendingProps,r=i._init,i=r(i._payload),e.type=i,r=e.tag=pT(i),t=xn(i,t),r){case 0:e=gf(null,e,i,t,n);break e;case 1:e=nv(null,e,i,t,n);break e;case 11:e=ev(null,e,i,t,n);break e;case 14:e=tv(null,e,i,xn(i.type,t),n);break e}throw Error(ee(306,i,""))}return e;case 0:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xn(i,r),gf(t,e,i,r,n);case 1:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xn(i,r),nv(t,e,i,r,n);case 3:e:{if(wS(e),t===null)throw Error(ee(387));i=e.pendingProps,s=e.memoizedState,r=s.element,Qy(t,e),pu(e,i,null,n);var a=e.memoizedState;if(i=a.element,s.isDehydrated)if(s={element:i,isDehydrated:!1,cache:a.cache,pendingSuspenseBoundaries:a.pendingSuspenseBoundaries,transitions:a.transitions},e.updateQueue.baseState=s,e.memoizedState=s,e.flags&256){r=qo(Error(ee(423)),e),e=iv(t,e,i,n,r);break e}else if(i!==r){r=qo(Error(ee(424)),e),e=iv(t,e,i,n,r);break e}else for(tn=Yr(e.stateNode.containerInfo.firstChild),rn=e,De=!0,Mn=null,n=Jy(e,null,i,n),e.child=n;n;)n.flags=n.flags&-3|4096,n=n.sibling;else{if($o(),i===r){e=vr(t,e,n);break e}xt(t,e,i,n)}e=e.child}return e;case 5:return Xy(e),t===null&&df(e),i=e.type,r=e.pendingProps,s=t!==null?t.memoizedProps:null,a=r.children,of(i,r)?a=null:s!==null&&of(i,s)&&(e.flags|=32),bS(t,e),xt(t,e,a,n),e.child;case 6:return t===null&&df(e),null;case 13:return kS(t,e,n);case 4:return Xp(e,e.stateNode.containerInfo),i=e.pendingProps,t===null?e.child=Vo(e,null,i,n):xt(t,e,i,n),e.child;case 11:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xn(i,r),ev(t,e,i,r,n);case 7:return xt(t,e,e.pendingProps,n),e.child;case 8:return xt(t,e,e.pendingProps.children,n),e.child;case 12:return xt(t,e,e.pendingProps.children,n),e.child;case 10:e:{if(i=e.type._context,r=e.pendingProps,s=e.memoizedProps,a=r.value,Pe(hu,i._currentValue),i._currentValue=a,s!==null)if(Gn(s.value,a)){if(s.children===r.children&&!Vt.current){e=vr(t,e,n);break e}}else for(s=e.child,s!==null&&(s.return=e);s!==null;){var o=s.dependencies;if(o!==null){a=s.child;for(var l=o.firstContext;l!==null;){if(l.context===i){if(s.tag===1){l=ur(-1,n&-n),l.tag=2;var c=s.updateQueue;if(c!==null){c=c.shared;var d=c.pending;d===null?l.next=l:(l.next=d.next,d.next=l),c.pending=l}}s.lanes|=n,l=s.alternate,l!==null&&(l.lanes|=n),hf(s.return,n,e),o.lanes|=n;break}l=l.next}}else if(s.tag===10)a=s.type===e.type?null:s.child;else if(s.tag===18){if(a=s.return,a===null)throw Error(ee(341));a.lanes|=n,o=a.alternate,o!==null&&(o.lanes|=n),hf(a,n,e),a=s.sibling}else a=s.child;if(a!==null)a.return=s;else for(a=s;a!==null;){if(a===e){a=null;break}if(s=a.sibling,s!==null){s.return=a.return,a=s;break}a=a.return}s=a}xt(t,e,r.children,n),e=e.child}return e;case 9:return r=e.type,i=e.pendingProps.children,wo(e,n),r=Cn(r),i=i(r),e.flags|=1,xt(t,e,i,n),e.child;case 14:return i=e.type,r=xn(i,e.pendingProps),r=xn(i.type,r),tv(t,e,i,r,n);case 15:return SS(t,e,e.type,e.pendingProps,n);case 17:return i=e.type,r=e.pendingProps,r=e.elementType===i?r:xn(i,r),Mc(t,e),e.tag=1,Gt(i)?(t=!0,cu(e)):t=!1,wo(e,n),vS(e,i,r),pf(e,i,r,n),vf(null,e,i,!0,t,n);case 19:return ES(t,e,n);case 22:return CS(t,e,n)}throw Error(ee(156,e.tag))};function HS(t,e){return py(t,e)}function fT(t,e,n,i){this.tag=t,this.key=n,this.sibling=this.child=this.return=this.stateNode=this.type=this.elementType=null,this.index=0,this.ref=null,this.pendingProps=e,this.dependencies=this.memoizedState=this.updateQueue=this.memoizedProps=null,this.mode=i,this.subtreeFlags=this.flags=0,this.deletions=null,this.childLanes=this.lanes=0,this.alternate=null}function gn(t,e,n,i){return new fT(t,e,n,i)}function hm(t){return t=t.prototype,!(!t||!t.isReactComponent)}function pT(t){if(typeof t=="function")return hm(t)?1:0;if(t!=null){if(t=t.$$typeof,t===Ip)return 11;if(t===Lp)return 14}return 2}function ns(t,e){var n=t.alternate;return n===null?(n=gn(t.tag,e,t.key,t.mode),n.elementType=t.elementType,n.type=t.type,n.stateNode=t.stateNode,n.alternate=t,t.alternate=n):(n.pendingProps=e,n.type=t.type,n.flags=0,n.subtreeFlags=0,n.deletions=null),n.flags=t.flags&14680064,n.childLanes=t.childLanes,n.lanes=t.lanes,n.child=t.child,n.memoizedProps=t.memoizedProps,n.memoizedState=t.memoizedState,n.updateQueue=t.updateQueue,e=t.dependencies,n.dependencies=e===null?null:{lanes:e.lanes,firstContext:e.firstContext},n.sibling=t.sibling,n.index=t.index,n.ref=t.ref,n}function Nc(t,e,n,i,r,s){var a=2;if(i=t,typeof t=="function")hm(t)&&(a=1);else if(typeof t=="string")a=5;else e:switch(t){case ro:return Ls(n.children,r,s,e);case Op:a=8,r|=8;break;case Bh:return t=gn(12,n,e,r|2),t.elementType=Bh,t.lanes=s,t;case Fh:return t=gn(13,n,e,r),t.elementType=Fh,t.lanes=s,t;case Uh:return t=gn(19,n,e,r),t.elementType=Uh,t.lanes=s,t;case X_:return td(n,r,s,e);default:if(typeof t=="object"&&t!==null)switch(t.$$typeof){case K_:a=10;break e;case Q_:a=9;break e;case Ip:a=11;break e;case Lp:a=14;break e;case Or:a=16,i=null;break e}throw Error(ee(130,t==null?t:typeof t,""))}return e=gn(a,n,e,r),e.elementType=t,e.type=i,e.lanes=s,e}function Ls(t,e,n,i){return t=gn(7,t,i,e),t.lanes=n,t}function td(t,e,n,i){return t=gn(22,t,i,e),t.elementType=X_,t.lanes=n,t.stateNode={isHidden:!1},t}function oh(t,e,n){return t=gn(6,t,null,e),t.lanes=n,t}function ah(t,e,n){return e=gn(4,t.children!==null?t.children:[],t.key,e),e.lanes=n,e.stateNode={containerInfo:t.containerInfo,pendingChildren:null,implementation:t.implementation},e}function mT(t,e,n,i,r){this.tag=e,this.containerInfo=t,this.finishedWork=this.pingCache=this.current=this.pendingChildren=null,this.timeoutHandle=-1,this.callbackNode=this.pendingContext=this.context=null,this.callbackPriority=0,this.eventTimes=Hd(0),this.expirationTimes=Hd(-1),this.entangledLanes=this.finishedLanes=this.mutableReadLanes=this.expiredLanes=this.pingedLanes=this.suspendedLanes=this.pendingLanes=0,this.entanglements=Hd(0),this.identifierPrefix=i,this.onRecoverableError=r,this.mutableSourceEagerHydrationData=null}function fm(t,e,n,i,r,s,a,o,l){return t=new mT(t,e,n,o,l),e===1?(e=1,s===!0&&(e|=8)):e=0,s=gn(3,null,null,e),t.current=s,s.stateNode=t,s.memoizedState={element:i,isDehydrated:n,cache:null,transitions:null,pendingSuspenseBoundaries:null},Qp(s),t}function gT(t,e,n){var i=3<arguments.length&&arguments[3]!==void 0?arguments[3]:null;return{$$typeof:io,key:i==null?null:""+i,children:t,containerInfo:e,implementation:n}}function jS(t){if(!t)return ls;t=t._reactInternals;e:{if(Qs(t)!==t||t.tag!==1)throw Error(ee(170));var e=t;do{switch(e.tag){case 3:e=e.stateNode.context;break e;case 1:if(Gt(e.type)){e=e.stateNode.__reactInternalMemoizedMergedChildContext;break e}}e=e.return}while(e!==null);throw Error(ee(171))}if(t.tag===1){var n=t.type;if(Gt(n))return jy(t,n,e)}return e}function WS(t,e,n,i,r,s,a,o,l){return t=fm(n,i,!0,t,r,s,a,o,l),t.context=jS(null),n=t.current,i=Dt(),r=ts(n),s=ur(i,r),s.callback=e??null,Zr(n,s,r),t.current.lanes=r,Ul(t,r,i),qt(t,i),t}function nd(t,e,n,i){var r=e.current,s=Dt(),a=ts(r);return n=jS(n),e.context===null?e.context=n:e.pendingContext=n,e=ur(s,a),e.payload={element:t},i=i===void 0?null:i,i!==null&&(e.callback=i),t=Zr(r,e,a),t!==null&&(Wn(t,r,a,s),Oc(t,r,a)),a}function bu(t){if(t=t.current,!t.child)return null;switch(t.child.tag){case 5:return t.child.stateNode;default:return t.child.stateNode}}function fv(t,e){if(t=t.memoizedState,t!==null&&t.dehydrated!==null){var n=t.retryLane;t.retryLane=n!==0&&n<e?n:e}}function pm(t,e){fv(t,e),(t=t.alternate)&&fv(t,e)}function vT(){return null}var $S=typeof reportError=="function"?reportError:function(t){console.error(t)};function mm(t){this._internalRoot=t}id.prototype.render=mm.prototype.render=function(t){var e=this._internalRoot;if(e===null)throw Error(ee(409));nd(t,e,null,null)};id.prototype.unmount=mm.prototype.unmount=function(){var t=this._internalRoot;if(t!==null){this._internalRoot=null;var e=t.containerInfo;Us(function(){nd(null,t,null,null)}),e[mr]=null}};function id(t){this._internalRoot=t}id.prototype.unstable_scheduleHydration=function(t){if(t){var e=Cy();t={blockedOn:null,target:t,priority:e};for(var n=0;n<Lr.length&&e!==0&&e<Lr[n].priority;n++);Lr.splice(n,0,t),n===0&&wy(t)}};function gm(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11)}function rd(t){return!(!t||t.nodeType!==1&&t.nodeType!==9&&t.nodeType!==11&&(t.nodeType!==8||t.nodeValue!==" react-mount-point-unstable "))}function pv(){}function _T(t,e,n,i,r){if(r){if(typeof i=="function"){var s=i;i=function(){var c=bu(a);s.call(c)}}var a=WS(e,i,t,0,null,!1,!1,"",pv);return t._reactRootContainer=a,t[mr]=a.current,pl(t.nodeType===8?t.parentNode:t),Us(),a}for(;r=t.lastChild;)t.removeChild(r);if(typeof i=="function"){var o=i;i=function(){var c=bu(l);o.call(c)}}var l=fm(t,0,!1,null,null,!1,!1,"",pv);return t._reactRootContainer=l,t[mr]=l.current,pl(t.nodeType===8?t.parentNode:t),Us(function(){nd(e,l,n,i)}),l}function sd(t,e,n,i,r){var s=n._reactRootContainer;if(s){var a=s;if(typeof r=="function"){var o=r;r=function(){var l=bu(a);o.call(l)}}nd(e,a,t,r)}else a=_T(n,e,t,r,i);return bu(a)}yy=function(t){switch(t.tag){case 3:var e=t.stateNode;if(e.current.memoizedState.isDehydrated){var n=Fa(e.pendingLanes);n!==0&&(Ap(e,n|1),qt(e,Ge()),!(Ce&6)&&(Jo=Ge()+500,ms()))}break;case 13:Us(function(){var i=gr(t,1);if(i!==null){var r=Dt();Wn(i,t,1,r)}}),pm(t,1)}};Np=function(t){if(t.tag===13){var e=gr(t,134217728);if(e!==null){var n=Dt();Wn(e,t,134217728,n)}pm(t,134217728)}};Sy=function(t){if(t.tag===13){var e=ts(t),n=gr(t,e);if(n!==null){var i=Dt();Wn(n,t,e,i)}pm(t,e)}};Cy=function(){return ke};by=function(t,e){var n=ke;try{return ke=t,e()}finally{ke=n}};Kh=function(t,e,n){switch(e){case"input":if(jh(t,n),e=n.name,n.type==="radio"&&e!=null){for(n=t;n.parentNode;)n=n.parentNode;for(n=n.querySelectorAll("input[name="+JSON.stringify(""+e)+'][type="radio"]'),e=0;e<n.length;e++){var i=n[e];if(i!==t&&i.form===t.form){var r=Ku(i);if(!r)throw Error(ee(90));Z_(i),jh(i,r)}}}break;case"textarea":ty(t,n);break;case"select":e=n.value,e!=null&&yo(t,!!n.multiple,e,!1)}};ly=cm;cy=Us;var yT={usingClientEntryPoint:!1,Events:[Hl,lo,Ku,oy,ay,cm]},xa={findFiberByHostInstance:ws,bundleType:0,version:"18.3.1",rendererPackageName:"react-dom"},ST={bundleType:xa.bundleType,version:xa.version,rendererPackageName:xa.rendererPackageName,rendererConfig:xa.rendererConfig,overrideHookState:null,overrideHookStateDeletePath:null,overrideHookStateRenamePath:null,overrideProps:null,overridePropsDeletePath:null,overridePropsRenamePath:null,setErrorHandler:null,setSuspenseHandler:null,scheduleUpdate:null,currentDispatcherRef:Sr.ReactCurrentDispatcher,findHostInstanceByFiber:function(t){return t=hy(t),t===null?null:t.stateNode},findFiberByHostInstance:xa.findFiberByHostInstance||vT,findHostInstancesForRefresh:null,scheduleRefresh:null,scheduleRoot:null,setRefreshHandler:null,getCurrentFiber:null,reconcilerVersion:"18.3.1-next-f1338f8080-20240426"};if(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__<"u"){var mc=__REACT_DEVTOOLS_GLOBAL_HOOK__;if(!mc.isDisabled&&mc.supportsFiber)try{Vu=mc.inject(ST),wi=mc}catch{}}ln.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED=yT;ln.createPortal=function(t,e){var n=2<arguments.length&&arguments[2]!==void 0?arguments[2]:null;if(!gm(e))throw Error(ee(200));return gT(t,e,null,n)};ln.createRoot=function(t,e){if(!gm(t))throw Error(ee(299));var n=!1,i="",r=$S;return e!=null&&(e.unstable_strictMode===!0&&(n=!0),e.identifierPrefix!==void 0&&(i=e.identifierPrefix),e.onRecoverableError!==void 0&&(r=e.onRecoverableError)),e=fm(t,1,!1,null,null,n,!1,i,r),t[mr]=e.current,pl(t.nodeType===8?t.parentNode:t),new mm(e)};ln.findDOMNode=function(t){if(t==null)return null;if(t.nodeType===1)return t;var e=t._reactInternals;if(e===void 0)throw typeof t.render=="function"?Error(ee(188)):(t=Object.keys(t).join(","),Error(ee(268,t)));return t=hy(e),t=t===null?null:t.stateNode,t};ln.flushSync=function(t){return Us(t)};ln.hydrate=function(t,e,n){if(!rd(e))throw Error(ee(200));return sd(null,t,e,!0,n)};ln.hydrateRoot=function(t,e,n){if(!gm(t))throw Error(ee(405));var i=n!=null&&n.hydratedSources||null,r=!1,s="",a=$S;if(n!=null&&(n.unstable_strictMode===!0&&(r=!0),n.identifierPrefix!==void 0&&(s=n.identifierPrefix),n.onRecoverableError!==void 0&&(a=n.onRecoverableError)),e=WS(e,null,t,1,n??null,r,!1,s,a),t[mr]=e.current,pl(t),i)for(t=0;t<i.length;t++)n=i[t],r=n._getVersion,r=r(n._source),e.mutableSourceEagerHydrationData==null?e.mutableSourceEagerHydrationData=[n,r]:e.mutableSourceEagerHydrationData.push(n,r);return new id(e)};ln.render=function(t,e,n){if(!rd(e))throw Error(ee(200));return sd(null,t,e,!1,n)};ln.unmountComponentAtNode=function(t){if(!rd(t))throw Error(ee(40));return t._reactRootContainer?(Us(function(){sd(null,null,t,!1,function(){t._reactRootContainer=null,t[mr]=null})}),!0):!1};ln.unstable_batchedUpdates=cm;ln.unstable_renderSubtreeIntoContainer=function(t,e,n,i){if(!rd(n))throw Error(ee(200));if(t==null||t._reactInternals===void 0)throw Error(ee(38));return sd(t,e,n,!1,i)};ln.version="18.3.1-next-f1338f8080-20240426";function VS(){if(!(typeof __REACT_DEVTOOLS_GLOBAL_HOOK__>"u"||typeof __REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE!="function"))try{__REACT_DEVTOOLS_GLOBAL_HOOK__.checkDCE(VS)}catch(t){console.error(t)}}VS(),N_.exports=ln;var CT=N_.exports,GS,mv=CT;GS=mv.createRoot,mv.hydrateRoot;const bT=t=>{const e=T.useRef(t);return T.useEffect(()=>{e.current=t}),e},wT=bT;function kT(t,e){return e.forEach(function(n){n&&typeof n!="string"&&!Array.isArray(n)&&Object.keys(n).forEach(function(i){if(i!=="default"&&!(i in t)){var r=Object.getOwnPropertyDescriptor(n,i);Object.defineProperty(t,i,r.get?r:{enumerable:!0,get:function(){return n[i]}})}})}),Object.freeze(t)}var ET=typeof globalThis<"u"?globalThis:typeof window<"u"?window:typeof global<"u"?global:typeof self<"u"?self:{};function TT(t){return t&&t.__esModule&&Object.prototype.hasOwnProperty.call(t,"default")?t.default:t}var qS={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(ET,function(){var e=function(){},n="undefined",i=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function s(_,p){var f=_[p];if(typeof f.bind=="function")return f.bind(_);try{return Function.prototype.bind.call(f,_)}catch{return function(){return Function.prototype.apply.apply(f,[_,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(_){return _==="debug"&&(_="log"),typeof console===n?!1:_==="trace"&&i?a:console[_]!==void 0?s(console,_):console.log!==void 0?s(console,"log"):e}function l(_,p){for(var f=0;f<r.length;f++){var h=r[f];this[h]=f<_?e:this.methodFactory(h,_,p)}this.log=this.debug}function c(_,p,f){return function(){typeof console!==n&&(l.call(this,p,f),this[_].apply(this,arguments))}}function d(_,p,f){return o(_)||c.apply(this,arguments)}function u(_,p,f){var h=this,g;p=p??"WARN";var S="loglevel";typeof _=="string"?S+=":"+_:typeof _=="symbol"&&(S=void 0);function b(E){var x=(r[E]||"silent").toUpperCase();if(!(typeof window===n||!S)){try{window.localStorage[S]=x;return}catch{}try{window.document.cookie=encodeURIComponent(S)+"="+x+";"}catch{}}}function w(){var E;if(!(typeof window===n||!S)){try{E=window.localStorage[S]}catch{}if(typeof E===n)try{var x=window.document.cookie,I=x.indexOf(encodeURIComponent(S)+"=");I!==-1&&(E=/^([^;]+)/.exec(x.slice(I))[1])}catch{}return h.levels[E]===void 0&&(E=void 0),E}}function k(){if(!(typeof window===n||!S)){try{window.localStorage.removeItem(S);return}catch{}try{window.document.cookie=encodeURIComponent(S)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}h.name=_,h.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},h.methodFactory=f||d,h.getLevel=function(){return g},h.setLevel=function(E,x){if(typeof E=="string"&&h.levels[E.toUpperCase()]!==void 0&&(E=h.levels[E.toUpperCase()]),typeof E=="number"&&E>=0&&E<=h.levels.SILENT){if(g=E,x!==!1&&b(E),l.call(h,E,_),typeof console===n&&E<h.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+E},h.setDefaultLevel=function(E){p=E,w()||h.setLevel(E,!1)},h.resetLevel=function(){h.setLevel(p,!1),k()},h.enableAll=function(E){h.setLevel(h.levels.TRACE,E)},h.disableAll=function(E){h.setLevel(h.levels.SILENT,E)};var C=w();C==null&&(C=p),h.setLevel(C,!1)}var m=new u,v={};m.getLogger=function(p){if(typeof p!="symbol"&&typeof p!="string"||p==="")throw new TypeError("You must supply a name when creating a logger.");var f=v[p];return f||(f=v[p]=new u(p,m.getLevel(),m.methodFactory)),f};var y=typeof window!==n?window.log:void 0;return m.noConflict=function(){return typeof window!==n&&window.log===m&&(window.log=y),m},m.getLoggers=function(){return v},m.default=m,m})})(qS);var vm=qS.exports,Pf;(function(t){t[t.trace=0]="trace",t[t.debug=1]="debug",t[t.info=2]="info",t[t.warn=3]="warn",t[t.error=4]="error",t[t.silent=5]="silent"})(Pf||(Pf={}));var Ei;(function(t){t.Default="livekit",t.Room="livekit-room",t.Participant="livekit-participant",t.Track="livekit-track",t.Publication="livekit-track-publication",t.Engine="livekit-engine",t.Signal="livekit-signal",t.PCManager="livekit-pc-manager",t.PCTransport="livekit-pc-transport",t.E2EE="lk-e2ee"})(Ei||(Ei={}));let _e=vm.getLogger("livekit");_e.setDefaultLevel(Pf.info);function _r(t){const e=vm.getLogger(t);return e.setDefaultLevel(_e.getLevel()),e}vm.getLogger("lk-e2ee");function jt(t,e){if(!t)throw new Error(e)}const RT=34028234663852886e22,xT=-34028234663852886e22,PT=4294967295,OT=2147483647,IT=-2147483648;function Bc(t){if(typeof t!="number")throw new Error("invalid int 32: "+typeof t);if(!Number.isInteger(t)||t>OT||t<IT)throw new Error("invalid int 32: "+t)}function Of(t){if(typeof t!="number")throw new Error("invalid uint 32: "+typeof t);if(!Number.isInteger(t)||t>PT||t<0)throw new Error("invalid uint 32: "+t)}function JS(t){if(typeof t!="number")throw new Error("invalid float 32: "+typeof t);if(Number.isFinite(t)&&(t>RT||t<xT))throw new Error("invalid float 32: "+t)}const KS=Symbol("@bufbuild/protobuf/enum-type");function LT(t){const e=t[KS];return jt(e,"missing enum type on enum object"),e}function QS(t,e,n,i){t[KS]=XS(e,n.map(r=>({no:r.no,name:r.name,localName:t[r.no]})))}function XS(t,e,n){const i=Object.create(null),r=Object.create(null),s=[];for(const a of e){const o=YS(a);s.push(o),i[a.name]=o,r[a.no]=o}return{typeName:t,values:s,findName(a){return i[a]},findNumber(a){return r[a]}}}function MT(t,e,n){const i={};for(const r of e){const s=YS(r);i[s.localName]=s.no,i[s.no]=s.localName}return QS(i,t,e),i}function YS(t){return"localName"in t?t:Object.assign(Object.assign({},t),{localName:t.name})}class ae{equals(e){return this.getType().runtime.util.equals(this.getType(),this,e)}clone(){return this.getType().runtime.util.clone(this)}fromBinary(e,n){const i=this.getType(),r=i.runtime.bin,s=r.makeReadOptions(n);return r.readMessage(this,s.readerFactory(e),e.byteLength,s),this}fromJson(e,n){const i=this.getType(),r=i.runtime.json,s=r.makeReadOptions(n);return r.readMessage(i,e,s,this),this}fromJsonString(e,n){let i;try{i=JSON.parse(e)}catch(r){throw new Error("cannot decode ".concat(this.getType().typeName," from JSON: ").concat(r instanceof Error?r.message:String(r)))}return this.fromJson(i,n)}toBinary(e){const n=this.getType(),i=n.runtime.bin,r=i.makeWriteOptions(e),s=r.writerFactory();return i.writeMessage(this,s,r),s.finish()}toJson(e){const n=this.getType(),i=n.runtime.json,r=i.makeWriteOptions(e);return i.writeMessage(this,r)}toJsonString(e){var n;const i=this.toJson(e);return JSON.stringify(i,null,(n=e==null?void 0:e.prettySpaces)!==null&&n!==void 0?n:0)}toJSON(){return this.toJson({emitDefaultValues:!0})}getType(){return Object.getPrototypeOf(this).constructor}}function DT(t,e,n,i){var r;const s=(r=i==null?void 0:i.localName)!==null&&r!==void 0?r:e.substring(e.lastIndexOf(".")+1),a={[s]:function(o){t.util.initFields(this),t.util.initPartial(o,this)}}[s];return Object.setPrototypeOf(a.prototype,new ae),Object.assign(a,{runtime:t,typeName:e,fields:t.util.newFieldList(n),fromBinary(o,l){return new a().fromBinary(o,l)},fromJson(o,l){return new a().fromJson(o,l)},fromJsonString(o,l){return new a().fromJsonString(o,l)},equals(o,l){return t.util.equals(a,o,l)}}),a}function AT(t,e,n,i){return{syntax:t,json:e,bin:n,util:i,makeMessageType(r,s,a){return DT(this,r,s,a)},makeEnum:MT,makeEnumType:XS,getEnumType:LT}}var Q;(function(t){t[t.DOUBLE=1]="DOUBLE",t[t.FLOAT=2]="FLOAT",t[t.INT64=3]="INT64",t[t.UINT64=4]="UINT64",t[t.INT32=5]="INT32",t[t.FIXED64=6]="FIXED64",t[t.FIXED32=7]="FIXED32",t[t.BOOL=8]="BOOL",t[t.STRING=9]="STRING",t[t.BYTES=12]="BYTES",t[t.UINT32=13]="UINT32",t[t.SFIXED32=15]="SFIXED32",t[t.SFIXED64=16]="SFIXED64",t[t.SINT32=17]="SINT32",t[t.SINT64=18]="SINT64"})(Q||(Q={}));var zs;(function(t){t[t.BIGINT=0]="BIGINT",t[t.STRING=1]="STRING"})(zs||(zs={}));function NT(){let t=0,e=0;for(let i=0;i<28;i+=7){let r=this.buf[this.pos++];if(t|=(r&127)<<i,!(r&128))return this.assertBounds(),[t,e]}let n=this.buf[this.pos++];if(t|=(n&15)<<28,e=(n&112)>>4,!(n&128))return this.assertBounds(),[t,e];for(let i=3;i<=31;i+=7){let r=this.buf[this.pos++];if(e|=(r&127)<<i,!(r&128))return this.assertBounds(),[t,e]}throw new Error("invalid varint")}function lh(t,e,n){for(let s=0;s<28;s=s+7){const a=t>>>s,o=!(!(a>>>7)&&e==0),l=(o?a|128:a)&255;if(n.push(l),!o)return}const i=t>>>28&15|(e&7)<<4,r=!!(e>>3);if(n.push((r?i|128:i)&255),!!r){for(let s=3;s<31;s=s+7){const a=e>>>s,o=!!(a>>>7),l=(o?a|128:a)&255;if(n.push(l),!o)return}n.push(e>>>31&1)}}const Fc=4294967296;function gv(t){const e=t[0]==="-";e&&(t=t.slice(1));const n=1e6;let i=0,r=0;function s(a,o){const l=Number(t.slice(a,o));r*=n,i=i*n+l,i>=Fc&&(r=r+(i/Fc|0),i=i%Fc)}return s(-24,-18),s(-18,-12),s(-12,-6),s(-6),e?eC(i,r):_m(i,r)}function BT(t,e){let n=_m(t,e);const i=n.hi&2147483648;i&&(n=eC(n.lo,n.hi));const r=ZS(n.lo,n.hi);return i?"-"+r:r}function ZS(t,e){if({lo:t,hi:e}=FT(t,e),e<=2097151)return String(Fc*e+t);const n=t&16777215,i=(t>>>24|e<<8)&16777215,r=e>>16&65535;let s=n+i*6777216+r*6710656,a=i+r*8147497,o=r*2;const l=1e7;return s>=l&&(a+=Math.floor(s/l),s%=l),a>=l&&(o+=Math.floor(a/l),a%=l),o.toString()+vv(a)+vv(s)}function FT(t,e){return{lo:t>>>0,hi:e>>>0}}function _m(t,e){return{lo:t|0,hi:e|0}}function eC(t,e){return e=~e,t?t=~t+1:e+=1,_m(t,e)}const vv=t=>{const e=String(t);return"0000000".slice(e.length)+e};function _v(t,e){if(t>=0){for(;t>127;)e.push(t&127|128),t=t>>>7;e.push(t)}else{for(let n=0;n<9;n++)e.push(t&127|128),t=t>>7;e.push(1)}}function UT(){let t=this.buf[this.pos++],e=t&127;if(!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<7,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<14,!(t&128))return this.assertBounds(),e;if(t=this.buf[this.pos++],e|=(t&127)<<21,!(t&128))return this.assertBounds(),e;t=this.buf[this.pos++],e|=(t&15)<<28;for(let n=5;t&128&&n<10;n++)t=this.buf[this.pos++];if(t&128)throw new Error("invalid varint");return this.assertBounds(),e>>>0}function zT(){const t=new DataView(new ArrayBuffer(8));if(typeof BigInt=="function"&&typeof t.getBigInt64=="function"&&typeof t.getBigUint64=="function"&&typeof t.setBigInt64=="function"&&typeof t.setBigUint64=="function"&&(typeof process!="object"||typeof process.env!="object"||{}.BUF_BIGINT_DISABLE!=="1")){const r=BigInt("-9223372036854775808"),s=BigInt("9223372036854775807"),a=BigInt("0"),o=BigInt("18446744073709551615");return{zero:BigInt(0),supported:!0,parse(l){const c=typeof l=="bigint"?l:BigInt(l);if(c>s||c<r)throw new Error("int64 invalid: ".concat(l));return c},uParse(l){const c=typeof l=="bigint"?l:BigInt(l);if(c>o||c<a)throw new Error("uint64 invalid: ".concat(l));return c},enc(l){return t.setBigInt64(0,this.parse(l),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},uEnc(l){return t.setBigInt64(0,this.uParse(l),!0),{lo:t.getInt32(0,!0),hi:t.getInt32(4,!0)}},dec(l,c){return t.setInt32(0,l,!0),t.setInt32(4,c,!0),t.getBigInt64(0,!0)},uDec(l,c){return t.setInt32(0,l,!0),t.setInt32(4,c,!0),t.getBigUint64(0,!0)}}}const n=r=>jt(/^-?[0-9]+$/.test(r),"int64 invalid: ".concat(r)),i=r=>jt(/^[0-9]+$/.test(r),"uint64 invalid: ".concat(r));return{zero:"0",supported:!1,parse(r){return typeof r!="string"&&(r=r.toString()),n(r),r},uParse(r){return typeof r!="string"&&(r=r.toString()),i(r),r},enc(r){return typeof r!="string"&&(r=r.toString()),n(r),gv(r)},uEnc(r){return typeof r!="string"&&(r=r.toString()),i(r),gv(r)},dec(r,s){return BT(r,s)},uDec(r,s){return ZS(r,s)}}}const pe=zT();var $e;(function(t){t[t.Varint=0]="Varint",t[t.Bit64=1]="Bit64",t[t.LengthDelimited=2]="LengthDelimited",t[t.StartGroup=3]="StartGroup",t[t.EndGroup=4]="EndGroup",t[t.Bit32=5]="Bit32"})($e||($e={}));class HT{constructor(e){this.stack=[],this.textEncoder=e??new TextEncoder,this.chunks=[],this.buf=[]}finish(){this.chunks.push(new Uint8Array(this.buf));let e=0;for(let r=0;r<this.chunks.length;r++)e+=this.chunks[r].length;let n=new Uint8Array(e),i=0;for(let r=0;r<this.chunks.length;r++)n.set(this.chunks[r],i),i+=this.chunks[r].length;return this.chunks=[],n}fork(){return this.stack.push({chunks:this.chunks,buf:this.buf}),this.chunks=[],this.buf=[],this}join(){let e=this.finish(),n=this.stack.pop();if(!n)throw new Error("invalid state, fork stack empty");return this.chunks=n.chunks,this.buf=n.buf,this.uint32(e.byteLength),this.raw(e)}tag(e,n){return this.uint32((e<<3|n)>>>0)}raw(e){return this.buf.length&&(this.chunks.push(new Uint8Array(this.buf)),this.buf=[]),this.chunks.push(e),this}uint32(e){for(Of(e);e>127;)this.buf.push(e&127|128),e=e>>>7;return this.buf.push(e),this}int32(e){return Bc(e),_v(e,this.buf),this}bool(e){return this.buf.push(e?1:0),this}bytes(e){return this.uint32(e.byteLength),this.raw(e)}string(e){let n=this.textEncoder.encode(e);return this.uint32(n.byteLength),this.raw(n)}float(e){JS(e);let n=new Uint8Array(4);return new DataView(n.buffer).setFloat32(0,e,!0),this.raw(n)}double(e){let n=new Uint8Array(8);return new DataView(n.buffer).setFloat64(0,e,!0),this.raw(n)}fixed32(e){Of(e);let n=new Uint8Array(4);return new DataView(n.buffer).setUint32(0,e,!0),this.raw(n)}sfixed32(e){Bc(e);let n=new Uint8Array(4);return new DataView(n.buffer).setInt32(0,e,!0),this.raw(n)}sint32(e){return Bc(e),e=(e<<1^e>>31)>>>0,_v(e,this.buf),this}sfixed64(e){let n=new Uint8Array(8),i=new DataView(n.buffer),r=pe.enc(e);return i.setInt32(0,r.lo,!0),i.setInt32(4,r.hi,!0),this.raw(n)}fixed64(e){let n=new Uint8Array(8),i=new DataView(n.buffer),r=pe.uEnc(e);return i.setInt32(0,r.lo,!0),i.setInt32(4,r.hi,!0),this.raw(n)}int64(e){let n=pe.enc(e);return lh(n.lo,n.hi,this.buf),this}sint64(e){let n=pe.enc(e),i=n.hi>>31,r=n.lo<<1^i,s=(n.hi<<1|n.lo>>>31)^i;return lh(r,s,this.buf),this}uint64(e){let n=pe.uEnc(e);return lh(n.lo,n.hi,this.buf),this}}class jT{constructor(e,n){this.varint64=NT,this.uint32=UT,this.buf=e,this.len=e.length,this.pos=0,this.view=new DataView(e.buffer,e.byteOffset,e.byteLength),this.textDecoder=n??new TextDecoder}tag(){let e=this.uint32(),n=e>>>3,i=e&7;if(n<=0||i<0||i>5)throw new Error("illegal tag: field no "+n+" wire type "+i);return[n,i]}skip(e){let n=this.pos;switch(e){case $e.Varint:for(;this.buf[this.pos++]&128;);break;case $e.Bit64:this.pos+=4;case $e.Bit32:this.pos+=4;break;case $e.LengthDelimited:let i=this.uint32();this.pos+=i;break;case $e.StartGroup:let r;for(;(r=this.tag()[1])!==$e.EndGroup;)this.skip(r);break;default:throw new Error("cant skip wire type "+e)}return this.assertBounds(),this.buf.subarray(n,this.pos)}assertBounds(){if(this.pos>this.len)throw new RangeError("premature EOF")}int32(){return this.uint32()|0}sint32(){let e=this.uint32();return e>>>1^-(e&1)}int64(){return pe.dec(...this.varint64())}uint64(){return pe.uDec(...this.varint64())}sint64(){let[e,n]=this.varint64(),i=-(e&1);return e=(e>>>1|(n&1)<<31)^i,n=n>>>1^i,pe.dec(e,n)}bool(){let[e,n]=this.varint64();return e!==0||n!==0}fixed32(){return this.view.getUint32((this.pos+=4)-4,!0)}sfixed32(){return this.view.getInt32((this.pos+=4)-4,!0)}fixed64(){return pe.uDec(this.sfixed32(),this.sfixed32())}sfixed64(){return pe.dec(this.sfixed32(),this.sfixed32())}float(){return this.view.getFloat32((this.pos+=4)-4,!0)}double(){return this.view.getFloat64((this.pos+=8)-8,!0)}bytes(){let e=this.uint32(),n=this.pos;return this.pos+=e,this.assertBounds(),this.buf.subarray(n,n+e)}string(){return this.textDecoder.decode(this.bytes())}}function If(t,e){return e instanceof ae||!t.fieldWrapper?e:t.fieldWrapper.wrapField(e)}Q.DOUBLE,Q.FLOAT,Q.INT64,Q.UINT64,Q.INT32,Q.UINT32,Q.BOOL,Q.STRING,Q.BYTES;function xr(t,e,n){if(e===n)return!0;if(t==Q.BYTES){if(!(e instanceof Uint8Array)||!(n instanceof Uint8Array)||e.length!==n.length)return!1;for(let i=0;i<e.length;i++)if(e[i]!==n[i])return!1;return!0}switch(t){case Q.UINT64:case Q.FIXED64:case Q.INT64:case Q.SFIXED64:case Q.SINT64:return e==n}return!1}function Lf(t,e){switch(t){case Q.BOOL:return!1;case Q.UINT64:case Q.FIXED64:case Q.INT64:case Q.SFIXED64:case Q.SINT64:return e==0?pe.zero:"0";case Q.DOUBLE:case Q.FLOAT:return 0;case Q.BYTES:return new Uint8Array(0);case Q.STRING:return"";default:return 0}}function tC(t,e){const n=e===void 0;let i=$e.Varint,r=e===0;switch(t){case Q.STRING:r=n||!e.length,i=$e.LengthDelimited;break;case Q.BOOL:r=e===!1;break;case Q.DOUBLE:i=$e.Bit64;break;case Q.FLOAT:i=$e.Bit32;break;case Q.INT64:r=n||e==0;break;case Q.UINT64:r=n||e==0;break;case Q.FIXED64:r=n||e==0,i=$e.Bit64;break;case Q.BYTES:r=n||!e.byteLength,i=$e.LengthDelimited;break;case Q.FIXED32:i=$e.Bit32;break;case Q.SFIXED32:i=$e.Bit32;break;case Q.SFIXED64:r=n||e==0,i=$e.Bit64;break;case Q.SINT64:r=n||e==0;break}const s=Q[t].toLowerCase();return[i,s,n||r]}const Zs=Symbol("@bufbuild/protobuf/unknown-fields"),yv={readUnknownFields:!0,readerFactory:t=>new jT(t)},Sv={writeUnknownFields:!0,writerFactory:()=>new HT};function WT(t){return t?Object.assign(Object.assign({},yv),t):yv}function $T(t){return t?Object.assign(Object.assign({},Sv),t):Sv}function VT(){return{makeReadOptions:WT,makeWriteOptions:$T,listUnknownFields(t){var e;return(e=t[Zs])!==null&&e!==void 0?e:[]},discardUnknownFields(t){delete t[Zs]},writeUnknownFields(t,e){const i=t[Zs];if(i)for(const r of i)e.tag(r.no,r.wireType).raw(r.data)},onUnknownField(t,e,n,i){const r=t;Array.isArray(r[Zs])||(r[Zs]=[]),r[Zs].push({no:e,wireType:n,data:i})},readMessage(t,e,n,i){const r=t.getType(),s=n===void 0?e.len:e.pos+n;for(;e.pos<s;){const[a,o]=e.tag(),l=r.fields.find(a);if(!l){const m=e.skip(o);i.readUnknownFields&&this.onUnknownField(t,a,o,m);continue}let c=t,d=l.repeated,u=l.localName;switch(l.oneof&&(c=c[l.oneof.localName],c.case!=u&&delete c.value,c.case=u,u="value"),l.kind){case"scalar":case"enum":const m=l.kind=="enum"?Q.INT32:l.T;let v=wu;if(l.kind=="scalar"&&l.L>0&&(v=qT),d){let f=c[u];if(o==$e.LengthDelimited&&m!=Q.STRING&&m!=Q.BYTES){let h=e.uint32()+e.pos;for(;e.pos<h;)f.push(v(e,m))}else f.push(v(e,m))}else c[u]=v(e,m);break;case"message":const y=l.T;d?c[u].push(Uc(e,new y,i)):c[u]instanceof ae?Uc(e,c[u],i):(c[u]=Uc(e,new y,i),y.fieldWrapper&&!l.oneof&&!l.repeated&&(c[u]=y.fieldWrapper.unwrapField(c[u])));break;case"map":let[_,p]=GT(l,e,i);c[u][_]=p;break}}}}}function Uc(t,e,n){return e.getType().runtime.bin.readMessage(e,t,t.uint32(),n),e}function GT(t,e,n){const i=e.uint32(),r=e.pos+i;let s,a;for(;e.pos<r;){let[o]=e.tag();switch(o){case 1:s=wu(e,t.K);break;case 2:switch(t.V.kind){case"scalar":a=wu(e,t.V.T);break;case"enum":a=e.int32();break;case"message":a=Uc(e,new t.V.T,n);break}break}}if(s===void 0){let o=Lf(t.K,zs.BIGINT);s=t.K==Q.BOOL?o.toString():o}if(typeof s!="string"&&typeof s!="number"&&(s=s.toString()),a===void 0)switch(t.V.kind){case"scalar":a=Lf(t.V.T,zs.BIGINT);break;case"enum":a=0;break;case"message":a=new t.V.T;break}return[s,a]}function qT(t,e){const n=wu(t,e);return typeof n=="bigint"?n.toString():n}function wu(t,e){switch(e){case Q.STRING:return t.string();case Q.BOOL:return t.bool();case Q.DOUBLE:return t.double();case Q.FLOAT:return t.float();case Q.INT32:return t.int32();case Q.INT64:return t.int64();case Q.UINT64:return t.uint64();case Q.FIXED64:return t.fixed64();case Q.BYTES:return t.bytes();case Q.FIXED32:return t.fixed32();case Q.SFIXED32:return t.sfixed32();case Q.SFIXED64:return t.sfixed64();case Q.SINT64:return t.sint64();case Q.UINT32:return t.uint32();case Q.SINT32:return t.sint32()}}function JT(t,e,n,i,r){t.tag(n.no,$e.LengthDelimited),t.fork();let s=i;switch(n.K){case Q.INT32:case Q.FIXED32:case Q.UINT32:case Q.SFIXED32:case Q.SINT32:s=Number.parseInt(i);break;case Q.BOOL:jt(i=="true"||i=="false"),s=i=="true";break}switch(el(t,n.K,1,s,!0),n.V.kind){case"scalar":el(t,n.V.T,2,r,!0);break;case"enum":el(t,Q.INT32,2,r,!0);break;case"message":Mf(t,e,n.V.T,2,r);break}t.join()}function Mf(t,e,n,i,r){if(r!==void 0){const s=If(n,r);t.tag(i,$e.LengthDelimited).bytes(s.toBinary(e))}}function el(t,e,n,i,r){let[s,a,o]=tC(e,i);(!o||r)&&t.tag(n,s)[a](i)}function KT(t,e,n,i){if(!i.length)return;t.tag(n,$e.LengthDelimited).fork();let[,r]=tC(e);for(let s=0;s<i.length;s++)t[r](i[s]);t.join()}function QT(){return Object.assign(Object.assign({},VT()),{writeMessage(t,e,n){const i=t.getType();for(const r of i.fields.byNumber()){let s,a=r.repeated,o=r.localName;if(r.oneof){const l=t[r.oneof.localName];if(l.case!==o)continue;s=l.value}else s=t[o];switch(r.kind){case"scalar":case"enum":let l=r.kind=="enum"?Q.INT32:r.T;if(a)if(r.packed)KT(e,l,r.no,s);else for(const c of s)el(e,l,r.no,c,!0);else s!==void 0&&el(e,l,r.no,s,!!r.oneof||r.opt);break;case"message":if(a)for(const c of s)Mf(e,n,r.T,r.no,c);else Mf(e,n,r.T,r.no,s);break;case"map":for(const[c,d]of Object.entries(s))JT(e,n,r,c,d);break}}return n.writeUnknownFields&&this.writeUnknownFields(t,e),e}})}let Bi="ABCDEFGHIJKLMNOPQRSTUVWXYZabcdefghijklmnopqrstuvwxyz0123456789+/".split(""),od=[];for(let t=0;t<Bi.length;t++)od[Bi[t].charCodeAt(0)]=t;od["-".charCodeAt(0)]=Bi.indexOf("+");od["_".charCodeAt(0)]=Bi.indexOf("/");const nC={dec(t){let e=t.length*3/4;t[t.length-2]=="="?e-=2:t[t.length-1]=="="&&(e-=1);let n=new Uint8Array(e),i=0,r=0,s,a=0;for(let o=0;o<t.length;o++){if(s=od[t.charCodeAt(o)],s===void 0)switch(t[o]){case"=":r=0;case`
`:case"\r":case"	":case" ":continue;default:throw Error("invalid base64 string.")}switch(r){case 0:a=s,r=1;break;case 1:n[i++]=a<<2|(s&48)>>4,a=s,r=2;break;case 2:n[i++]=(a&15)<<4|(s&60)>>2,a=s,r=3;break;case 3:n[i++]=(a&3)<<6|s,r=0;break}}if(r==1)throw Error("invalid base64 string.");return n.subarray(0,i)},enc(t){let e="",n=0,i,r=0;for(let s=0;s<t.length;s++)switch(i=t[s],n){case 0:e+=Bi[i>>2],r=(i&3)<<4,n=1;break;case 1:e+=Bi[r|i>>4],r=(i&15)<<2,n=2;break;case 2:e+=Bi[r|i>>6],e+=Bi[i&63],n=0;break}return n&&(e+=Bi[r],e+="=",n==1&&(e+="=")),e}},Cv={ignoreUnknownFields:!1},bv={emitDefaultValues:!1,enumAsInteger:!1,useProtoFieldName:!1,prettySpaces:0};function XT(t){return t?Object.assign(Object.assign({},Cv),t):Cv}function YT(t){return t?Object.assign(Object.assign({},bv),t):bv}function ZT(t){const e=t(eR,wv);return{makeReadOptions:XT,makeWriteOptions:YT,readMessage(n,i,r,s){if(i==null||Array.isArray(i)||typeof i!="object")throw new Error("cannot decode message ".concat(n.typeName," from JSON: ").concat(this.debug(i)));s=s??new n;const a={};for(const[o,l]of Object.entries(i)){const c=n.fields.findJsonName(o);if(!c){if(!r.ignoreUnknownFields)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: key "').concat(o,'" is unknown'));continue}let d=c.localName,u=s;if(c.oneof){if(l===null&&c.kind=="scalar")continue;const m=a[c.oneof.localName];if(m)throw new Error("cannot decode message ".concat(n.typeName,' from JSON: multiple keys for oneof "').concat(c.oneof.name,'" present: "').concat(m,'", "').concat(o,'"'));a[c.oneof.localName]=o,u=u[c.oneof.localName]={case:d},d="value"}if(c.repeated){if(l===null)continue;if(!Array.isArray(l))throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l)));const m=u[d];for(const v of l){if(v===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(v)));let y;switch(c.kind){case"message":y=c.T.fromJson(v,r);break;case"enum":if(y=ch(c.T,v,r.ignoreUnknownFields),y===void 0)continue;break;case"scalar":try{y=Pa(c.T,v,c.L)}catch(_){let p="cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(v));throw _ instanceof Error&&_.message.length>0&&(p+=": ".concat(_.message)),new Error(p)}break}m.push(y)}}else if(c.kind=="map"){if(l===null)continue;if(Array.isArray(l)||typeof l!="object")throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l)));const m=u[d];for(const[v,y]of Object.entries(l)){if(y===null)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: map value null"));let _;switch(c.V.kind){case"message":_=c.V.T.fromJson(y,r);break;case"enum":if(_=ch(c.V.T,y,r.ignoreUnknownFields),_===void 0)continue;break;case"scalar":try{_=Pa(c.V.T,y,zs.BIGINT)}catch(p){let f="cannot decode map value for field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw p instanceof Error&&p.message.length>0&&(f+=": ".concat(p.message)),new Error(f)}break}try{m[Pa(c.K,c.K==Q.BOOL?v=="true"?!0:v=="false"?!1:v:v,zs.BIGINT).toString()]=_}catch(p){let f="cannot decode map key for field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw p instanceof Error&&p.message.length>0&&(f+=": ".concat(p.message)),new Error(f)}}}else switch(c.kind){case"message":const m=c.T;if(l===null&&m.typeName!="google.protobuf.Value"){if(c.oneof)throw new Error("cannot decode field ".concat(n.typeName,".").concat(c.name,' from JSON: null is invalid for oneof field "').concat(o,'"'));continue}u[d]instanceof ae?u[d].fromJson(l,r):(u[d]=m.fromJson(l,r),m.fieldWrapper&&!c.oneof&&(u[d]=m.fieldWrapper.unwrapField(u[d])));break;case"enum":const v=ch(c.T,l,r.ignoreUnknownFields);v!==void 0&&(u[d]=v);break;case"scalar":try{u[d]=Pa(c.T,l,c.L)}catch(y){let _="cannot decode field ".concat(n.typeName,".").concat(c.name," from JSON: ").concat(this.debug(l));throw y instanceof Error&&y.message.length>0&&(_+=": ".concat(y.message)),new Error(_)}break}}return s},writeMessage(n,i){const r=n.getType(),s={};let a;try{for(const o of r.fields.byMember()){let l;if(o.kind=="oneof"){const c=n[o.localName];if(c.value===void 0)continue;if(a=o.findField(c.case),!a)throw"oneof case not found: "+c.case;l=e(a,c.value,i)}else a=o,l=e(a,n[a.localName],i);l!==void 0&&(s[i.useProtoFieldName?a.name:a.jsonName]=l)}}catch(o){const l=a?"cannot encode field ".concat(r.typeName,".").concat(a.name," to JSON"):"cannot encode message ".concat(r.typeName," to JSON"),c=o instanceof Error?o.message:String(o);throw new Error(l+(c.length>0?": ".concat(c):""))}return s},readScalar:Pa,writeScalar:wv,debug:iC}}function iC(t){if(t===null)return"null";switch(typeof t){case"object":return Array.isArray(t)?"array":"object";case"string":return t.length>100?"string":'"'.concat(t.split('"').join('\\"'),'"');default:return String(t)}}function Pa(t,e,n){switch(t){case Q.DOUBLE:case Q.FLOAT:if(e===null)return 0;if(e==="NaN")return Number.NaN;if(e==="Infinity")return Number.POSITIVE_INFINITY;if(e==="-Infinity")return Number.NEGATIVE_INFINITY;if(e===""||typeof e=="string"&&e.trim().length!==e.length||typeof e!="string"&&typeof e!="number")break;const i=Number(e);if(Number.isNaN(i)||!Number.isFinite(i))break;return t==Q.FLOAT&&JS(i),i;case Q.INT32:case Q.FIXED32:case Q.SFIXED32:case Q.SINT32:case Q.UINT32:if(e===null)return 0;let r;if(typeof e=="number"?r=e:typeof e=="string"&&e.length>0&&e.trim().length===e.length&&(r=Number(e)),r===void 0)break;return t==Q.UINT32?Of(r):Bc(r),r;case Q.INT64:case Q.SFIXED64:case Q.SINT64:if(e===null)return pe.zero;if(typeof e!="number"&&typeof e!="string")break;const s=pe.parse(e);return n?s.toString():s;case Q.FIXED64:case Q.UINT64:if(e===null)return pe.zero;if(typeof e!="number"&&typeof e!="string")break;const a=pe.uParse(e);return n?a.toString():a;case Q.BOOL:if(e===null)return!1;if(typeof e!="boolean")break;return e;case Q.STRING:if(e===null)return"";if(typeof e!="string")break;try{encodeURIComponent(e)}catch{throw new Error("invalid UTF8")}return e;case Q.BYTES:if(e===null||e==="")return new Uint8Array(0);if(typeof e!="string")break;return nC.dec(e)}throw new Error}function ch(t,e,n){if(e===null)return 0;switch(typeof e){case"number":if(Number.isInteger(e))return e;break;case"string":const i=t.findName(e);if(i||n)return i==null?void 0:i.no;break}throw new Error("cannot decode enum ".concat(t.typeName," from JSON: ").concat(iC(e)))}function eR(t,e,n,i){var r;if(e===void 0)return e;if(e===0&&!n)return;if(i)return e;if(t.typeName=="google.protobuf.NullValue")return null;const s=t.findNumber(e);return(r=s==null?void 0:s.name)!==null&&r!==void 0?r:e}function wv(t,e,n){if(e!==void 0)switch(t){case Q.INT32:case Q.SFIXED32:case Q.SINT32:case Q.FIXED32:case Q.UINT32:return jt(typeof e=="number"),e!=0||n?e:void 0;case Q.FLOAT:case Q.DOUBLE:return jt(typeof e=="number"),Number.isNaN(e)?"NaN":e===Number.POSITIVE_INFINITY?"Infinity":e===Number.NEGATIVE_INFINITY?"-Infinity":e!==0||n?e:void 0;case Q.STRING:return jt(typeof e=="string"),e.length>0||n?e:void 0;case Q.BOOL:return jt(typeof e=="boolean"),e||n?e:void 0;case Q.UINT64:case Q.FIXED64:case Q.INT64:case Q.SFIXED64:case Q.SINT64:return jt(typeof e=="bigint"||typeof e=="string"||typeof e=="number"),n||e!=0?e.toString(10):void 0;case Q.BYTES:return jt(e instanceof Uint8Array),n||e.byteLength>0?nC.enc(e):void 0}}function tR(){return ZT((t,e)=>function(i,r,s){if(i.kind=="map"){const a={};switch(i.V.kind){case"scalar":for(const[l,c]of Object.entries(r)){const d=e(i.V.T,c,!0);jt(d!==void 0),a[l.toString()]=d}break;case"message":for(const[l,c]of Object.entries(r))a[l.toString()]=c.toJson(s);break;case"enum":const o=i.V.T;for(const[l,c]of Object.entries(r)){jt(c===void 0||typeof c=="number");const d=t(o,c,!0,s.enumAsInteger);jt(d!==void 0),a[l.toString()]=d}break}return s.emitDefaultValues||Object.keys(a).length>0?a:void 0}else if(i.repeated){const a=[];switch(i.kind){case"scalar":for(let o=0;o<r.length;o++)a.push(e(i.T,r[o],!0));break;case"enum":for(let o=0;o<r.length;o++)a.push(t(i.T,r[o],!0,s.enumAsInteger));break;case"message":for(let o=0;o<r.length;o++)a.push(If(i.T,r[o]).toJson(s));break}return s.emitDefaultValues||a.length>0?a:void 0}else switch(i.kind){case"scalar":return e(i.T,r,!!i.oneof||i.opt||s.emitDefaultValues);case"enum":return t(i.T,r,!!i.oneof||i.opt||s.emitDefaultValues,s.enumAsInteger);case"message":return r!==void 0?If(i.T,r).toJson(s):void 0}})}function nR(){return{setEnumType:QS,initPartial(t,e){if(t===void 0)return;const n=e.getType();for(const i of n.fields.byMember()){const r=i.localName,s=e,a=t;if(a[r]!==void 0)switch(i.kind){case"oneof":const o=a[r].case;if(o===void 0)continue;const l=i.findField(o);let c=a[r].value;l&&l.kind=="message"&&!(c instanceof l.T)?c=new l.T(c):l&&l.kind==="scalar"&&l.T===Q.BYTES&&(c=Oa(c)),s[r]={case:o,value:c};break;case"scalar":case"enum":let d=a[r];i.T===Q.BYTES&&(d=i.repeated?d.map(Oa):Oa(d)),s[r]=d;break;case"map":switch(i.V.kind){case"scalar":case"enum":if(i.V.T===Q.BYTES)for(const[v,y]of Object.entries(a[r]))s[r][v]=Oa(y);else Object.assign(s[r],a[r]);break;case"message":const m=i.V.T;for(const v of Object.keys(a[r])){let y=a[r][v];m.fieldWrapper||(y=new m(y)),s[r][v]=y}break}break;case"message":const u=i.T;if(i.repeated)s[r]=a[r].map(m=>m instanceof u?m:new u(m));else if(a[r]!==void 0){const m=a[r];u.fieldWrapper?u.typeName==="google.protobuf.BytesValue"?s[r]=Oa(m):s[r]=m:s[r]=m instanceof u?m:new u(m)}break}}},equals(t,e,n){return e===n?!0:!e||!n?!1:t.fields.byMember().every(i=>{const r=e[i.localName],s=n[i.localName];if(i.repeated){if(r.length!==s.length)return!1;switch(i.kind){case"message":return r.every((a,o)=>i.T.equals(a,s[o]));case"scalar":return r.every((a,o)=>xr(i.T,a,s[o]));case"enum":return r.every((a,o)=>xr(Q.INT32,a,s[o]))}throw new Error("repeated cannot contain ".concat(i.kind))}switch(i.kind){case"message":return i.T.equals(r,s);case"enum":return xr(Q.INT32,r,s);case"scalar":return xr(i.T,r,s);case"oneof":if(r.case!==s.case)return!1;const a=i.findField(r.case);if(a===void 0)return!0;switch(a.kind){case"message":return a.T.equals(r.value,s.value);case"enum":return xr(Q.INT32,r.value,s.value);case"scalar":return xr(a.T,r.value,s.value)}throw new Error("oneof cannot contain ".concat(a.kind));case"map":const o=Object.keys(r).concat(Object.keys(s));switch(i.V.kind){case"message":const l=i.V.T;return o.every(d=>l.equals(r[d],s[d]));case"enum":return o.every(d=>xr(Q.INT32,r[d],s[d]));case"scalar":const c=i.V.T;return o.every(d=>xr(c,r[d],s[d]))}break}})},clone(t){const e=t.getType(),n=new e,i=n;for(const r of e.fields.byMember()){const s=t[r.localName];let a;if(r.repeated)a=s.map(gc);else if(r.kind=="map"){a=i[r.localName];for(const[o,l]of Object.entries(s))a[o]=gc(l)}else r.kind=="oneof"?a=r.findField(s.case)?{case:s.case,value:gc(s.value)}:{case:void 0}:a=gc(s);i[r.localName]=a}return n}}}function gc(t){if(t===void 0)return t;if(t instanceof ae)return t.clone();if(t instanceof Uint8Array){const e=new Uint8Array(t.byteLength);return e.set(t),e}return t}function Oa(t){return t instanceof Uint8Array?t:new Uint8Array(t)}class iR{constructor(e,n){this._fields=e,this._normalizer=n}findJsonName(e){if(!this.jsonNames){const n={};for(const i of this.list())n[i.jsonName]=n[i.name]=i;this.jsonNames=n}return this.jsonNames[e]}find(e){if(!this.numbers){const n={};for(const i of this.list())n[i.no]=i;this.numbers=n}return this.numbers[e]}list(){return this.all||(this.all=this._normalizer(this._fields)),this.all}byNumber(){return this.numbersAsc||(this.numbersAsc=this.list().concat().sort((e,n)=>e.no-n.no)),this.numbersAsc}byMember(){if(!this.members){this.members=[];const e=this.members;let n;for(const i of this.list())i.oneof?i.oneof!==n&&(n=i.oneof,e.push(n)):e.push(i)}return this.members}}function rC(t,e){const n=sC(t);return e?n:cR(lR(n))}function rR(t){return rC(t,!1)}const sR=sC;function sC(t){let e=!1;const n=[];for(let i=0;i<t.length;i++){let r=t.charAt(i);switch(r){case"_":e=!0;break;case"0":case"1":case"2":case"3":case"4":case"5":case"6":case"7":case"8":case"9":n.push(r),e=!1;break;default:e&&(e=!1,r=r.toUpperCase()),n.push(r);break}}return n.join("")}const oR=new Set(["constructor","toString","toJSON","valueOf"]),aR=new Set(["getType","clone","equals","fromBinary","fromJson","fromJsonString","toBinary","toJson","toJsonString","toObject"]),oC=t=>"".concat(t,"$"),lR=t=>aR.has(t)?oC(t):t,cR=t=>oR.has(t)?oC(t):t;class uR{constructor(e){this.kind="oneof",this.repeated=!1,this.packed=!1,this.opt=!1,this.default=void 0,this.fields=[],this.name=e,this.localName=rR(e)}addField(e){jt(e.oneof===this,"field ".concat(e.name," not one of ").concat(this.name)),this.fields.push(e)}findField(e){if(!this._lookup){this._lookup=Object.create(null);for(let n=0;n<this.fields.length;n++)this._lookup[this.fields[n].localName]=this.fields[n]}return this._lookup[e]}}const L=AT("proto3",tR(),QT(),Object.assign(Object.assign({},nR()),{newFieldList(t){return new iR(t,dR)},initFields(t){for(const e of t.getType().fields.byMember()){if(e.opt)continue;const n=e.localName,i=t;if(e.repeated){i[n]=[];continue}switch(e.kind){case"oneof":i[n]={case:void 0};break;case"enum":i[n]=0;break;case"map":i[n]={};break;case"scalar":i[n]=Lf(e.T,e.L);break}}}}));function dR(t){var e,n,i,r;const s=[];let a;for(const o of typeof t=="function"?t():t){const l=o;if(l.localName=rC(o.name,o.oneof!==void 0),l.jsonName=(e=o.jsonName)!==null&&e!==void 0?e:sR(o.name),l.repeated=(n=o.repeated)!==null&&n!==void 0?n:!1,o.kind=="scalar"&&(l.L=(i=o.L)!==null&&i!==void 0?i:zs.BIGINT),l.packed=(r=o.packed)!==null&&r!==void 0?r:o.kind=="enum"||o.kind=="scalar"&&o.T!=Q.BYTES&&o.T!=Q.STRING,o.oneof!==void 0){const c=typeof o.oneof=="string"?o.oneof:o.oneof.name;(!a||a.name!=c)&&(a=new uR(c)),l.oneof=a,a.addField(l)}s.push(l)}return s}class ot extends ae{constructor(e){super(),this.seconds=pe.zero,this.nanos=0,L.util.initPartial(e,this)}fromJson(e,n){if(typeof e!="string")throw new Error("cannot decode google.protobuf.Timestamp from JSON: ".concat(L.json.debug(e)));const i=e.match(/^([0-9]{4})-([0-9]{2})-([0-9]{2})T([0-9]{2}):([0-9]{2}):([0-9]{2})(?:Z|\.([0-9]{3,9})Z|([+-][0-9][0-9]:[0-9][0-9]))$/);if(!i)throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");const r=Date.parse(i[1]+"-"+i[2]+"-"+i[3]+"T"+i[4]+":"+i[5]+":"+i[6]+(i[8]?i[8]:"Z"));if(Number.isNaN(r))throw new Error("cannot decode google.protobuf.Timestamp from JSON: invalid RFC 3339 string");if(r<Date.parse("0001-01-01T00:00:00Z")||r>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot decode message google.protobuf.Timestamp from JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");return this.seconds=pe.parse(r/1e3),this.nanos=0,i[7]&&(this.nanos=parseInt("1"+i[7]+"0".repeat(9-i[7].length))-1e9),this}toJson(e){const n=Number(this.seconds)*1e3;if(n<Date.parse("0001-01-01T00:00:00Z")||n>Date.parse("9999-12-31T23:59:59Z"))throw new Error("cannot encode google.protobuf.Timestamp to JSON: must be from 0001-01-01T00:00:00Z to 9999-12-31T23:59:59Z inclusive");if(this.nanos<0)throw new Error("cannot encode google.protobuf.Timestamp to JSON: nanos must not be negative");let i="Z";if(this.nanos>0){const r=(this.nanos+1e9).toString().substring(1);r.substring(3)==="000000"?i="."+r.substring(0,3)+"Z":r.substring(6)==="000"?i="."+r.substring(0,6)+"Z":i="."+r+"Z"}return new Date(n).toISOString().replace(".000Z",i)}toDate(){return new Date(Number(this.seconds)*1e3+Math.ceil(this.nanos/1e6))}static now(){return ot.fromDate(new Date)}static fromDate(e){const n=e.getTime();return new ot({seconds:pe.parse(Math.floor(n/1e3)),nanos:n%1e3*1e6})}static fromBinary(e,n){return new ot().fromBinary(e,n)}static fromJson(e,n){return new ot().fromJson(e,n)}static fromJsonString(e,n){return new ot().fromJsonString(e,n)}static equals(e,n){return L.util.equals(ot,e,n)}}ot.runtime=L;ot.typeName="google.protobuf.Timestamp";ot.fields=L.util.newFieldList(()=>[{no:1,name:"seconds",kind:"scalar",T:3},{no:2,name:"nanos",kind:"scalar",T:5}]);var Df;(function(t){t[t.DEFAULT_AC=0]="DEFAULT_AC",t[t.OPUS=1]="OPUS",t[t.AAC=2]="AAC"})(Df||(Df={}));L.util.setEnumType(Df,"livekit.AudioCodec",[{no:0,name:"DEFAULT_AC"},{no:1,name:"OPUS"},{no:2,name:"AAC"}]);var Af;(function(t){t[t.DEFAULT_VC=0]="DEFAULT_VC",t[t.H264_BASELINE=1]="H264_BASELINE",t[t.H264_MAIN=2]="H264_MAIN",t[t.H264_HIGH=3]="H264_HIGH",t[t.VP8=4]="VP8"})(Af||(Af={}));L.util.setEnumType(Af,"livekit.VideoCodec",[{no:0,name:"DEFAULT_VC"},{no:1,name:"H264_BASELINE"},{no:2,name:"H264_MAIN"},{no:3,name:"H264_HIGH"},{no:4,name:"VP8"}]);var Nf;(function(t){t[t.IC_DEFAULT=0]="IC_DEFAULT",t[t.IC_JPEG=1]="IC_JPEG"})(Nf||(Nf={}));L.util.setEnumType(Nf,"livekit.ImageCodec",[{no:0,name:"IC_DEFAULT"},{no:1,name:"IC_JPEG"}]);var bt;(function(t){t[t.AUDIO=0]="AUDIO",t[t.VIDEO=1]="VIDEO",t[t.DATA=2]="DATA"})(bt||(bt={}));L.util.setEnumType(bt,"livekit.TrackType",[{no:0,name:"AUDIO"},{no:1,name:"VIDEO"},{no:2,name:"DATA"}]);var Ve;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.CAMERA=1]="CAMERA",t[t.MICROPHONE=2]="MICROPHONE",t[t.SCREEN_SHARE=3]="SCREEN_SHARE",t[t.SCREEN_SHARE_AUDIO=4]="SCREEN_SHARE_AUDIO"})(Ve||(Ve={}));L.util.setEnumType(Ve,"livekit.TrackSource",[{no:0,name:"UNKNOWN"},{no:1,name:"CAMERA"},{no:2,name:"MICROPHONE"},{no:3,name:"SCREEN_SHARE"},{no:4,name:"SCREEN_SHARE_AUDIO"}]);var it;(function(t){t[t.LOW=0]="LOW",t[t.MEDIUM=1]="MEDIUM",t[t.HIGH=2]="HIGH",t[t.OFF=3]="OFF"})(it||(it={}));L.util.setEnumType(it,"livekit.VideoQuality",[{no:0,name:"LOW"},{no:1,name:"MEDIUM"},{no:2,name:"HIGH"},{no:3,name:"OFF"}]);var zi;(function(t){t[t.POOR=0]="POOR",t[t.GOOD=1]="GOOD",t[t.EXCELLENT=2]="EXCELLENT",t[t.LOST=3]="LOST"})(zi||(zi={}));L.util.setEnumType(zi,"livekit.ConnectionQuality",[{no:0,name:"POOR"},{no:1,name:"GOOD"},{no:2,name:"EXCELLENT"},{no:3,name:"LOST"}]);var qn;(function(t){t[t.UNSET=0]="UNSET",t[t.DISABLED=1]="DISABLED",t[t.ENABLED=2]="ENABLED"})(qn||(qn={}));L.util.setEnumType(qn,"livekit.ClientConfigSetting",[{no:0,name:"UNSET"},{no:1,name:"DISABLED"},{no:2,name:"ENABLED"}]);var dr;(function(t){t[t.UNKNOWN_REASON=0]="UNKNOWN_REASON",t[t.CLIENT_INITIATED=1]="CLIENT_INITIATED",t[t.DUPLICATE_IDENTITY=2]="DUPLICATE_IDENTITY",t[t.SERVER_SHUTDOWN=3]="SERVER_SHUTDOWN",t[t.PARTICIPANT_REMOVED=4]="PARTICIPANT_REMOVED",t[t.ROOM_DELETED=5]="ROOM_DELETED",t[t.STATE_MISMATCH=6]="STATE_MISMATCH",t[t.JOIN_FAILURE=7]="JOIN_FAILURE"})(dr||(dr={}));L.util.setEnumType(dr,"livekit.DisconnectReason",[{no:0,name:"UNKNOWN_REASON"},{no:1,name:"CLIENT_INITIATED"},{no:2,name:"DUPLICATE_IDENTITY"},{no:3,name:"SERVER_SHUTDOWN"},{no:4,name:"PARTICIPANT_REMOVED"},{no:5,name:"ROOM_DELETED"},{no:6,name:"STATE_MISMATCH"},{no:7,name:"JOIN_FAILURE"}]);var Ai;(function(t){t[t.RR_UNKNOWN=0]="RR_UNKNOWN",t[t.RR_SIGNAL_DISCONNECTED=1]="RR_SIGNAL_DISCONNECTED",t[t.RR_PUBLISHER_FAILED=2]="RR_PUBLISHER_FAILED",t[t.RR_SUBSCRIBER_FAILED=3]="RR_SUBSCRIBER_FAILED",t[t.RR_SWITCH_CANDIDATE=4]="RR_SWITCH_CANDIDATE"})(Ai||(Ai={}));L.util.setEnumType(Ai,"livekit.ReconnectReason",[{no:0,name:"RR_UNKNOWN"},{no:1,name:"RR_SIGNAL_DISCONNECTED"},{no:2,name:"RR_PUBLISHER_FAILED"},{no:3,name:"RR_SUBSCRIBER_FAILED"},{no:4,name:"RR_SWITCH_CANDIDATE"}]);var wl;(function(t){t[t.SE_UNKNOWN=0]="SE_UNKNOWN",t[t.SE_CODEC_UNSUPPORTED=1]="SE_CODEC_UNSUPPORTED",t[t.SE_TRACK_NOTFOUND=2]="SE_TRACK_NOTFOUND"})(wl||(wl={}));L.util.setEnumType(wl,"livekit.SubscriptionError",[{no:0,name:"SE_UNKNOWN"},{no:1,name:"SE_CODEC_UNSUPPORTED"},{no:2,name:"SE_TRACK_NOTFOUND"}]);let la=class za extends ae{constructor(e){super(),this.sid="",this.name="",this.emptyTimeout=0,this.maxParticipants=0,this.creationTime=pe.zero,this.turnPassword="",this.enabledCodecs=[],this.metadata="",this.numParticipants=0,this.numPublishers=0,this.activeRecording=!1,L.util.initPartial(e,this)}static fromBinary(e,n){return new za().fromBinary(e,n)}static fromJson(e,n){return new za().fromJson(e,n)}static fromJsonString(e,n){return new za().fromJsonString(e,n)}static equals(e,n){return L.util.equals(za,e,n)}};la.runtime=L;la.typeName="livekit.Room";la.fields=L.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"empty_timeout",kind:"scalar",T:13},{no:4,name:"max_participants",kind:"scalar",T:13},{no:5,name:"creation_time",kind:"scalar",T:3},{no:6,name:"turn_password",kind:"scalar",T:9},{no:7,name:"enabled_codecs",kind:"message",T:An,repeated:!0},{no:8,name:"metadata",kind:"scalar",T:9},{no:9,name:"num_participants",kind:"scalar",T:13},{no:11,name:"num_publishers",kind:"scalar",T:13},{no:10,name:"active_recording",kind:"scalar",T:8}]);class An extends ae{constructor(e){super(),this.mime="",this.fmtpLine="",L.util.initPartial(e,this)}static fromBinary(e,n){return new An().fromBinary(e,n)}static fromJson(e,n){return new An().fromJson(e,n)}static fromJsonString(e,n){return new An().fromJsonString(e,n)}static equals(e,n){return L.util.equals(An,e,n)}}An.runtime=L;An.typeName="livekit.Codec";An.fields=L.util.newFieldList(()=>[{no:1,name:"mime",kind:"scalar",T:9},{no:2,name:"fmtp_line",kind:"scalar",T:9}]);class Hr extends ae{constructor(e){super(),this.enabled=!1,this.min=0,this.max=0,L.util.initPartial(e,this)}static fromBinary(e,n){return new Hr().fromBinary(e,n)}static fromJson(e,n){return new Hr().fromJson(e,n)}static fromJsonString(e,n){return new Hr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Hr,e,n)}}Hr.runtime=L;Hr.typeName="livekit.PlayoutDelay";Hr.fields=L.util.newFieldList(()=>[{no:1,name:"enabled",kind:"scalar",T:8},{no:2,name:"min",kind:"scalar",T:13},{no:3,name:"max",kind:"scalar",T:13}]);class Hi extends ae{constructor(e){super(),this.canSubscribe=!1,this.canPublish=!1,this.canPublishData=!1,this.canPublishSources=[],this.hidden=!1,this.recorder=!1,this.canUpdateMetadata=!1,this.agent=!1,L.util.initPartial(e,this)}static fromBinary(e,n){return new Hi().fromBinary(e,n)}static fromJson(e,n){return new Hi().fromJson(e,n)}static fromJsonString(e,n){return new Hi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Hi,e,n)}}Hi.runtime=L;Hi.typeName="livekit.ParticipantPermission";Hi.fields=L.util.newFieldList(()=>[{no:1,name:"can_subscribe",kind:"scalar",T:8},{no:2,name:"can_publish",kind:"scalar",T:8},{no:3,name:"can_publish_data",kind:"scalar",T:8},{no:9,name:"can_publish_sources",kind:"enum",T:L.getEnumType(Ve),repeated:!0},{no:7,name:"hidden",kind:"scalar",T:8},{no:8,name:"recorder",kind:"scalar",T:8},{no:10,name:"can_update_metadata",kind:"scalar",T:8},{no:11,name:"agent",kind:"scalar",T:8}]);class nn extends ae{constructor(e){super(),this.sid="",this.identity="",this.state=Hs.JOINING,this.tracks=[],this.metadata="",this.joinedAt=pe.zero,this.name="",this.version=0,this.region="",this.isPublisher=!1,L.util.initPartial(e,this)}static fromBinary(e,n){return new nn().fromBinary(e,n)}static fromJson(e,n){return new nn().fromJson(e,n)}static fromJsonString(e,n){return new nn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(nn,e,n)}}nn.runtime=L;nn.typeName="livekit.ParticipantInfo";nn.fields=L.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"identity",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:L.getEnumType(Hs)},{no:4,name:"tracks",kind:"message",T:$t,repeated:!0},{no:5,name:"metadata",kind:"scalar",T:9},{no:6,name:"joined_at",kind:"scalar",T:3},{no:9,name:"name",kind:"scalar",T:9},{no:10,name:"version",kind:"scalar",T:13},{no:11,name:"permission",kind:"message",T:Hi},{no:12,name:"region",kind:"scalar",T:9},{no:13,name:"is_publisher",kind:"scalar",T:8}]);var Hs;(function(t){t[t.JOINING=0]="JOINING",t[t.JOINED=1]="JOINED",t[t.ACTIVE=2]="ACTIVE",t[t.DISCONNECTED=3]="DISCONNECTED"})(Hs||(Hs={}));L.util.setEnumType(Hs,"livekit.ParticipantInfo.State",[{no:0,name:"JOINING"},{no:1,name:"JOINED"},{no:2,name:"ACTIVE"},{no:3,name:"DISCONNECTED"}]);class jr extends ae{constructor(e){super(),L.util.initPartial(e,this)}static fromBinary(e,n){return new jr().fromBinary(e,n)}static fromJson(e,n){return new jr().fromJson(e,n)}static fromJsonString(e,n){return new jr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(jr,e,n)}}jr.runtime=L;jr.typeName="livekit.Encryption";jr.fields=L.util.newFieldList(()=>[]);var dt;(function(t){t[t.NONE=0]="NONE",t[t.GCM=1]="GCM",t[t.CUSTOM=2]="CUSTOM"})(dt||(dt={}));L.util.setEnumType(dt,"livekit.Encryption.Type",[{no:0,name:"NONE"},{no:1,name:"GCM"},{no:2,name:"CUSTOM"}]);class ji extends ae{constructor(e){super(),this.mimeType="",this.mid="",this.cid="",this.layers=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new ji().fromBinary(e,n)}static fromJson(e,n){return new ji().fromJson(e,n)}static fromJsonString(e,n){return new ji().fromJsonString(e,n)}static equals(e,n){return L.util.equals(ji,e,n)}}ji.runtime=L;ji.typeName="livekit.SimulcastCodecInfo";ji.fields=L.util.newFieldList(()=>[{no:1,name:"mime_type",kind:"scalar",T:9},{no:2,name:"mid",kind:"scalar",T:9},{no:3,name:"cid",kind:"scalar",T:9},{no:4,name:"layers",kind:"message",T:Lt,repeated:!0}]);class $t extends ae{constructor(e){super(),this.sid="",this.type=bt.AUDIO,this.name="",this.muted=!1,this.width=0,this.height=0,this.simulcast=!1,this.disableDtx=!1,this.source=Ve.UNKNOWN,this.layers=[],this.mimeType="",this.mid="",this.codecs=[],this.stereo=!1,this.disableRed=!1,this.encryption=dt.NONE,this.stream="",L.util.initPartial(e,this)}static fromBinary(e,n){return new $t().fromBinary(e,n)}static fromJson(e,n){return new $t().fromJson(e,n)}static fromJsonString(e,n){return new $t().fromJsonString(e,n)}static equals(e,n){return L.util.equals($t,e,n)}}$t.runtime=L;$t.typeName="livekit.TrackInfo";$t.fields=L.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"type",kind:"enum",T:L.getEnumType(bt)},{no:3,name:"name",kind:"scalar",T:9},{no:4,name:"muted",kind:"scalar",T:8},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"simulcast",kind:"scalar",T:8},{no:8,name:"disable_dtx",kind:"scalar",T:8},{no:9,name:"source",kind:"enum",T:L.getEnumType(Ve)},{no:10,name:"layers",kind:"message",T:Lt,repeated:!0},{no:11,name:"mime_type",kind:"scalar",T:9},{no:12,name:"mid",kind:"scalar",T:9},{no:13,name:"codecs",kind:"message",T:ji,repeated:!0},{no:14,name:"stereo",kind:"scalar",T:8},{no:15,name:"disable_red",kind:"scalar",T:8},{no:16,name:"encryption",kind:"enum",T:L.getEnumType(dt)},{no:17,name:"stream",kind:"scalar",T:9}]);class Lt extends ae{constructor(e){super(),this.quality=it.LOW,this.width=0,this.height=0,this.bitrate=0,this.ssrc=0,L.util.initPartial(e,this)}static fromBinary(e,n){return new Lt().fromBinary(e,n)}static fromJson(e,n){return new Lt().fromJson(e,n)}static fromJsonString(e,n){return new Lt().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Lt,e,n)}}Lt.runtime=L;Lt.typeName="livekit.VideoLayer";Lt.fields=L.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:L.getEnumType(it)},{no:2,name:"width",kind:"scalar",T:13},{no:3,name:"height",kind:"scalar",T:13},{no:4,name:"bitrate",kind:"scalar",T:13},{no:5,name:"ssrc",kind:"scalar",T:13}]);class oi extends ae{constructor(e){super(),this.kind=Ze.RELIABLE,this.value={case:void 0},L.util.initPartial(e,this)}static fromBinary(e,n){return new oi().fromBinary(e,n)}static fromJson(e,n){return new oi().fromJson(e,n)}static fromJsonString(e,n){return new oi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(oi,e,n)}}oi.runtime=L;oi.typeName="livekit.DataPacket";oi.fields=L.util.newFieldList(()=>[{no:1,name:"kind",kind:"enum",T:L.getEnumType(Ze)},{no:2,name:"user",kind:"message",T:li,oneof:"value"},{no:3,name:"speaker",kind:"message",T:Wi,oneof:"value"}]);var Ze;(function(t){t[t.RELIABLE=0]="RELIABLE",t[t.LOSSY=1]="LOSSY"})(Ze||(Ze={}));L.util.setEnumType(Ze,"livekit.DataPacket.Kind",[{no:0,name:"RELIABLE"},{no:1,name:"LOSSY"}]);class Wi extends ae{constructor(e){super(),this.speakers=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new Wi().fromBinary(e,n)}static fromJson(e,n){return new Wi().fromJson(e,n)}static fromJsonString(e,n){return new Wi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Wi,e,n)}}Wi.runtime=L;Wi.typeName="livekit.ActiveSpeakerUpdate";Wi.fields=L.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:ai,repeated:!0}]);class ai extends ae{constructor(e){super(),this.sid="",this.level=0,this.active=!1,L.util.initPartial(e,this)}static fromBinary(e,n){return new ai().fromBinary(e,n)}static fromJson(e,n){return new ai().fromJson(e,n)}static fromJsonString(e,n){return new ai().fromJsonString(e,n)}static equals(e,n){return L.util.equals(ai,e,n)}}ai.runtime=L;ai.typeName="livekit.SpeakerInfo";ai.fields=L.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"level",kind:"scalar",T:2},{no:3,name:"active",kind:"scalar",T:8}]);class li extends ae{constructor(e){super(),this.participantSid="",this.participantIdentity="",this.payload=new Uint8Array(0),this.destinationSids=[],this.destinationIdentities=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new li().fromBinary(e,n)}static fromJson(e,n){return new li().fromJson(e,n)}static fromJsonString(e,n){return new li().fromJsonString(e,n)}static equals(e,n){return L.util.equals(li,e,n)}}li.runtime=L;li.typeName="livekit.UserPacket";li.fields=L.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:5,name:"participant_identity",kind:"scalar",T:9},{no:2,name:"payload",kind:"scalar",T:12},{no:3,name:"destination_sids",kind:"scalar",T:9,repeated:!0},{no:6,name:"destination_identities",kind:"scalar",T:9,repeated:!0},{no:4,name:"topic",kind:"scalar",T:9,opt:!0}]);class ci extends ae{constructor(e){super(),this.participantSid="",this.trackSids=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new ci().fromBinary(e,n)}static fromJson(e,n){return new ci().fromJson(e,n)}static fromJsonString(e,n){return new ci().fromJsonString(e,n)}static equals(e,n){return L.util.equals(ci,e,n)}}ci.runtime=L;ci.typeName="livekit.ParticipantTracks";ci.fields=L.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sids",kind:"scalar",T:9,repeated:!0}]);class $i extends ae{constructor(e){super(),this.edition=Ko.Standard,this.version="",this.protocol=0,this.region="",this.nodeId="",this.debugInfo="",L.util.initPartial(e,this)}static fromBinary(e,n){return new $i().fromBinary(e,n)}static fromJson(e,n){return new $i().fromJson(e,n)}static fromJsonString(e,n){return new $i().fromJsonString(e,n)}static equals(e,n){return L.util.equals($i,e,n)}}$i.runtime=L;$i.typeName="livekit.ServerInfo";$i.fields=L.util.newFieldList(()=>[{no:1,name:"edition",kind:"enum",T:L.getEnumType(Ko)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"region",kind:"scalar",T:9},{no:5,name:"node_id",kind:"scalar",T:9},{no:6,name:"debug_info",kind:"scalar",T:9}]);var Ko;(function(t){t[t.Standard=0]="Standard",t[t.Cloud=1]="Cloud"})(Ko||(Ko={}));L.util.setEnumType(Ko,"livekit.ServerInfo.Edition",[{no:0,name:"Standard"},{no:1,name:"Cloud"}]);class Vi extends ae{constructor(e){super(),this.sdk=Qo.UNKNOWN,this.version="",this.protocol=0,this.os="",this.osVersion="",this.deviceModel="",this.browser="",this.browserVersion="",this.address="",this.network="",L.util.initPartial(e,this)}static fromBinary(e,n){return new Vi().fromBinary(e,n)}static fromJson(e,n){return new Vi().fromJson(e,n)}static fromJsonString(e,n){return new Vi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Vi,e,n)}}Vi.runtime=L;Vi.typeName="livekit.ClientInfo";Vi.fields=L.util.newFieldList(()=>[{no:1,name:"sdk",kind:"enum",T:L.getEnumType(Qo)},{no:2,name:"version",kind:"scalar",T:9},{no:3,name:"protocol",kind:"scalar",T:5},{no:4,name:"os",kind:"scalar",T:9},{no:5,name:"os_version",kind:"scalar",T:9},{no:6,name:"device_model",kind:"scalar",T:9},{no:7,name:"browser",kind:"scalar",T:9},{no:8,name:"browser_version",kind:"scalar",T:9},{no:9,name:"address",kind:"scalar",T:9},{no:10,name:"network",kind:"scalar",T:9}]);var Qo;(function(t){t[t.UNKNOWN=0]="UNKNOWN",t[t.JS=1]="JS",t[t.SWIFT=2]="SWIFT",t[t.ANDROID=3]="ANDROID",t[t.FLUTTER=4]="FLUTTER",t[t.GO=5]="GO",t[t.UNITY=6]="UNITY",t[t.REACT_NATIVE=7]="REACT_NATIVE",t[t.RUST=8]="RUST",t[t.PYTHON=9]="PYTHON",t[t.CPP=10]="CPP"})(Qo||(Qo={}));L.util.setEnumType(Qo,"livekit.ClientInfo.SDK",[{no:0,name:"UNKNOWN"},{no:1,name:"JS"},{no:2,name:"SWIFT"},{no:3,name:"ANDROID"},{no:4,name:"FLUTTER"},{no:5,name:"GO"},{no:6,name:"UNITY"},{no:7,name:"REACT_NATIVE"},{no:8,name:"RUST"},{no:9,name:"PYTHON"},{no:10,name:"CPP"}]);class ui extends ae{constructor(e){super(),this.resumeConnection=qn.UNSET,this.forceRelay=qn.UNSET,L.util.initPartial(e,this)}static fromBinary(e,n){return new ui().fromBinary(e,n)}static fromJson(e,n){return new ui().fromJson(e,n)}static fromJsonString(e,n){return new ui().fromJsonString(e,n)}static equals(e,n){return L.util.equals(ui,e,n)}}ui.runtime=L;ui.typeName="livekit.ClientConfiguration";ui.fields=L.util.newFieldList(()=>[{no:1,name:"video",kind:"message",T:di},{no:2,name:"screen",kind:"message",T:di},{no:3,name:"resume_connection",kind:"enum",T:L.getEnumType(qn)},{no:4,name:"disabled_codecs",kind:"message",T:Gi},{no:5,name:"force_relay",kind:"enum",T:L.getEnumType(qn)}]);class di extends ae{constructor(e){super(),this.hardwareEncoder=qn.UNSET,L.util.initPartial(e,this)}static fromBinary(e,n){return new di().fromBinary(e,n)}static fromJson(e,n){return new di().fromJson(e,n)}static fromJsonString(e,n){return new di().fromJsonString(e,n)}static equals(e,n){return L.util.equals(di,e,n)}}di.runtime=L;di.typeName="livekit.VideoConfiguration";di.fields=L.util.newFieldList(()=>[{no:1,name:"hardware_encoder",kind:"enum",T:L.getEnumType(qn)}]);class Gi extends ae{constructor(e){super(),this.codecs=[],this.publish=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new Gi().fromBinary(e,n)}static fromJson(e,n){return new Gi().fromJson(e,n)}static fromJsonString(e,n){return new Gi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Gi,e,n)}}Gi.runtime=L;Gi.typeName="livekit.DisabledCodecs";Gi.fields=L.util.newFieldList(()=>[{no:1,name:"codecs",kind:"message",T:An,repeated:!0},{no:2,name:"publish",kind:"message",T:An,repeated:!0}]);class hi extends ae{constructor(e){super(),this.duration=0,this.startTimestamp=pe.zero,this.endTimestamp=pe.zero,this.rtpClockTicks=pe.zero,this.driftSamples=pe.zero,this.driftMs=0,this.clockRate=0,L.util.initPartial(e,this)}static fromBinary(e,n){return new hi().fromBinary(e,n)}static fromJson(e,n){return new hi().fromJson(e,n)}static fromJsonString(e,n){return new hi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(hi,e,n)}}hi.runtime=L;hi.typeName="livekit.RTPDrift";hi.fields=L.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:ot},{no:2,name:"end_time",kind:"message",T:ot},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"start_timestamp",kind:"scalar",T:4},{no:5,name:"end_timestamp",kind:"scalar",T:4},{no:6,name:"rtp_clock_ticks",kind:"scalar",T:4},{no:7,name:"drift_samples",kind:"scalar",T:3},{no:8,name:"drift_ms",kind:"scalar",T:1},{no:9,name:"clock_rate",kind:"scalar",T:1}]);class Wr extends ae{constructor(e){super(),this.duration=0,this.packets=0,this.packetRate=0,this.bytes=pe.zero,this.headerBytes=pe.zero,this.bitrate=0,this.packetsLost=0,this.packetLossRate=0,this.packetLossPercentage=0,this.packetsDuplicate=0,this.packetDuplicateRate=0,this.bytesDuplicate=pe.zero,this.headerBytesDuplicate=pe.zero,this.bitrateDuplicate=0,this.packetsPadding=0,this.packetPaddingRate=0,this.bytesPadding=pe.zero,this.headerBytesPadding=pe.zero,this.bitratePadding=0,this.packetsOutOfOrder=0,this.frames=0,this.frameRate=0,this.jitterCurrent=0,this.jitterMax=0,this.gapHistogram={},this.nacks=0,this.nackAcks=0,this.nackMisses=0,this.nackRepeated=0,this.plis=0,this.firs=0,this.rttCurrent=0,this.rttMax=0,this.keyFrames=0,this.layerLockPlis=0,L.util.initPartial(e,this)}static fromBinary(e,n){return new Wr().fromBinary(e,n)}static fromJson(e,n){return new Wr().fromJson(e,n)}static fromJsonString(e,n){return new Wr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Wr,e,n)}}Wr.runtime=L;Wr.typeName="livekit.RTPStats";Wr.fields=L.util.newFieldList(()=>[{no:1,name:"start_time",kind:"message",T:ot},{no:2,name:"end_time",kind:"message",T:ot},{no:3,name:"duration",kind:"scalar",T:1},{no:4,name:"packets",kind:"scalar",T:13},{no:5,name:"packet_rate",kind:"scalar",T:1},{no:6,name:"bytes",kind:"scalar",T:4},{no:39,name:"header_bytes",kind:"scalar",T:4},{no:7,name:"bitrate",kind:"scalar",T:1},{no:8,name:"packets_lost",kind:"scalar",T:13},{no:9,name:"packet_loss_rate",kind:"scalar",T:1},{no:10,name:"packet_loss_percentage",kind:"scalar",T:2},{no:11,name:"packets_duplicate",kind:"scalar",T:13},{no:12,name:"packet_duplicate_rate",kind:"scalar",T:1},{no:13,name:"bytes_duplicate",kind:"scalar",T:4},{no:40,name:"header_bytes_duplicate",kind:"scalar",T:4},{no:14,name:"bitrate_duplicate",kind:"scalar",T:1},{no:15,name:"packets_padding",kind:"scalar",T:13},{no:16,name:"packet_padding_rate",kind:"scalar",T:1},{no:17,name:"bytes_padding",kind:"scalar",T:4},{no:41,name:"header_bytes_padding",kind:"scalar",T:4},{no:18,name:"bitrate_padding",kind:"scalar",T:1},{no:19,name:"packets_out_of_order",kind:"scalar",T:13},{no:20,name:"frames",kind:"scalar",T:13},{no:21,name:"frame_rate",kind:"scalar",T:1},{no:22,name:"jitter_current",kind:"scalar",T:1},{no:23,name:"jitter_max",kind:"scalar",T:1},{no:24,name:"gap_histogram",kind:"map",K:5,V:{kind:"scalar",T:13}},{no:25,name:"nacks",kind:"scalar",T:13},{no:37,name:"nack_acks",kind:"scalar",T:13},{no:26,name:"nack_misses",kind:"scalar",T:13},{no:38,name:"nack_repeated",kind:"scalar",T:13},{no:27,name:"plis",kind:"scalar",T:13},{no:28,name:"last_pli",kind:"message",T:ot},{no:29,name:"firs",kind:"scalar",T:13},{no:30,name:"last_fir",kind:"message",T:ot},{no:31,name:"rtt_current",kind:"scalar",T:13},{no:32,name:"rtt_max",kind:"scalar",T:13},{no:33,name:"key_frames",kind:"scalar",T:13},{no:34,name:"last_key_frame",kind:"message",T:ot},{no:35,name:"layer_lock_plis",kind:"scalar",T:13},{no:36,name:"last_layer_lock_pli",kind:"message",T:ot},{no:44,name:"packet_drift",kind:"message",T:hi},{no:45,name:"report_drift",kind:"message",T:hi}]);class $r extends ae{constructor(e){super(),this.unixMicro=pe.zero,this.ticks=0,L.util.initPartial(e,this)}static fromBinary(e,n){return new $r().fromBinary(e,n)}static fromJson(e,n){return new $r().fromJson(e,n)}static fromJsonString(e,n){return new $r().fromJsonString(e,n)}static equals(e,n){return L.util.equals($r,e,n)}}$r.runtime=L;$r.typeName="livekit.TimedVersion";$r.fields=L.util.newFieldList(()=>[{no:1,name:"unix_micro",kind:"scalar",T:3},{no:2,name:"ticks",kind:"scalar",T:5}]);const Ia=7e3,hR=[0,300,2*2*300,3*3*300,4*4*300,Ia,Ia,Ia,Ia,Ia];class fR{constructor(e){this._retryDelays=e!==void 0?[...e]:hR}nextRetryDelayInMs(e){if(e.retryCount>=this._retryDelays.length)return null;const n=this._retryDelays[e.retryCount];return e.retryCount<=1?n:n+Math.random()*1e3}}function H(t,e,n,i){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{c(i.next(d))}catch(u){a(u)}}function l(d){try{c(i.throw(d))}catch(u){a(u)}}function c(d){d.done?s(d.value):r(d.value).then(o,l)}c((i=i.apply(t,e||[])).next())})}function kv(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function no(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof kv=="function"?kv(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=t[s]&&function(a){return new Promise(function(o,l){a=t[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(c){s({value:c,done:o})},a)}}var ym={exports:{}},Eo=typeof Reflect=="object"?Reflect:null,Ev=Eo&&typeof Eo.apply=="function"?Eo.apply:function(e,n,i){return Function.prototype.apply.call(e,n,i)},zc;Eo&&typeof Eo.ownKeys=="function"?zc=Eo.ownKeys:Object.getOwnPropertySymbols?zc=function(e){return Object.getOwnPropertyNames(e).concat(Object.getOwnPropertySymbols(e))}:zc=function(e){return Object.getOwnPropertyNames(e)};function pR(t){console&&console.warn&&console.warn(t)}var aC=Number.isNaN||function(e){return e!==e};function Te(){Te.init.call(this)}ym.exports=Te;ym.exports.once=_R;Te.EventEmitter=Te;Te.prototype._events=void 0;Te.prototype._eventsCount=0;Te.prototype._maxListeners=void 0;var Tv=10;function ad(t){if(typeof t!="function")throw new TypeError('The "listener" argument must be of type Function. Received type '+typeof t)}Object.defineProperty(Te,"defaultMaxListeners",{enumerable:!0,get:function(){return Tv},set:function(t){if(typeof t!="number"||t<0||aC(t))throw new RangeError('The value of "defaultMaxListeners" is out of range. It must be a non-negative number. Received '+t+".");Tv=t}});Te.init=function(){(this._events===void 0||this._events===Object.getPrototypeOf(this)._events)&&(this._events=Object.create(null),this._eventsCount=0),this._maxListeners=this._maxListeners||void 0};Te.prototype.setMaxListeners=function(e){if(typeof e!="number"||e<0||aC(e))throw new RangeError('The value of "n" is out of range. It must be a non-negative number. Received '+e+".");return this._maxListeners=e,this};function lC(t){return t._maxListeners===void 0?Te.defaultMaxListeners:t._maxListeners}Te.prototype.getMaxListeners=function(){return lC(this)};Te.prototype.emit=function(e){for(var n=[],i=1;i<arguments.length;i++)n.push(arguments[i]);var r=e==="error",s=this._events;if(s!==void 0)r=r&&s.error===void 0;else if(!r)return!1;if(r){var a;if(n.length>0&&(a=n[0]),a instanceof Error)throw a;var o=new Error("Unhandled error."+(a?" ("+a.message+")":""));throw o.context=a,o}var l=s[e];if(l===void 0)return!1;if(typeof l=="function")Ev(l,this,n);else for(var c=l.length,d=fC(l,c),i=0;i<c;++i)Ev(d[i],this,n);return!0};function cC(t,e,n,i){var r,s,a;if(ad(n),s=t._events,s===void 0?(s=t._events=Object.create(null),t._eventsCount=0):(s.newListener!==void 0&&(t.emit("newListener",e,n.listener?n.listener:n),s=t._events),a=s[e]),a===void 0)a=s[e]=n,++t._eventsCount;else if(typeof a=="function"?a=s[e]=i?[n,a]:[a,n]:i?a.unshift(n):a.push(n),r=lC(t),r>0&&a.length>r&&!a.warned){a.warned=!0;var o=new Error("Possible EventEmitter memory leak detected. "+a.length+" "+String(e)+" listeners added. Use emitter.setMaxListeners() to increase limit");o.name="MaxListenersExceededWarning",o.emitter=t,o.type=e,o.count=a.length,pR(o)}return t}Te.prototype.addListener=function(e,n){return cC(this,e,n,!1)};Te.prototype.on=Te.prototype.addListener;Te.prototype.prependListener=function(e,n){return cC(this,e,n,!0)};function mR(){if(!this.fired)return this.target.removeListener(this.type,this.wrapFn),this.fired=!0,arguments.length===0?this.listener.call(this.target):this.listener.apply(this.target,arguments)}function uC(t,e,n){var i={fired:!1,wrapFn:void 0,target:t,type:e,listener:n},r=mR.bind(i);return r.listener=n,i.wrapFn=r,r}Te.prototype.once=function(e,n){return ad(n),this.on(e,uC(this,e,n)),this};Te.prototype.prependOnceListener=function(e,n){return ad(n),this.prependListener(e,uC(this,e,n)),this};Te.prototype.removeListener=function(e,n){var i,r,s,a,o;if(ad(n),r=this._events,r===void 0)return this;if(i=r[e],i===void 0)return this;if(i===n||i.listener===n)--this._eventsCount===0?this._events=Object.create(null):(delete r[e],r.removeListener&&this.emit("removeListener",e,i.listener||n));else if(typeof i!="function"){for(s=-1,a=i.length-1;a>=0;a--)if(i[a]===n||i[a].listener===n){o=i[a].listener,s=a;break}if(s<0)return this;s===0?i.shift():gR(i,s),i.length===1&&(r[e]=i[0]),r.removeListener!==void 0&&this.emit("removeListener",e,o||n)}return this};Te.prototype.off=Te.prototype.removeListener;Te.prototype.removeAllListeners=function(e){var n,i,r;if(i=this._events,i===void 0)return this;if(i.removeListener===void 0)return arguments.length===0?(this._events=Object.create(null),this._eventsCount=0):i[e]!==void 0&&(--this._eventsCount===0?this._events=Object.create(null):delete i[e]),this;if(arguments.length===0){var s=Object.keys(i),a;for(r=0;r<s.length;++r)a=s[r],a!=="removeListener"&&this.removeAllListeners(a);return this.removeAllListeners("removeListener"),this._events=Object.create(null),this._eventsCount=0,this}if(n=i[e],typeof n=="function")this.removeListener(e,n);else if(n!==void 0)for(r=n.length-1;r>=0;r--)this.removeListener(e,n[r]);return this};function dC(t,e,n){var i=t._events;if(i===void 0)return[];var r=i[e];return r===void 0?[]:typeof r=="function"?n?[r.listener||r]:[r]:n?vR(r):fC(r,r.length)}Te.prototype.listeners=function(e){return dC(this,e,!0)};Te.prototype.rawListeners=function(e){return dC(this,e,!1)};Te.listenerCount=function(t,e){return typeof t.listenerCount=="function"?t.listenerCount(e):hC.call(t,e)};Te.prototype.listenerCount=hC;function hC(t){var e=this._events;if(e!==void 0){var n=e[t];if(typeof n=="function")return 1;if(n!==void 0)return n.length}return 0}Te.prototype.eventNames=function(){return this._eventsCount>0?zc(this._events):[]};function fC(t,e){for(var n=new Array(e),i=0;i<e;++i)n[i]=t[i];return n}function gR(t,e){for(;e+1<t.length;e++)t[e]=t[e+1];t.pop()}function vR(t){for(var e=new Array(t.length),n=0;n<e.length;++n)e[n]=t[n].listener||t[n];return e}function _R(t,e){return new Promise(function(n,i){function r(a){t.removeListener(e,s),i(a)}function s(){typeof t.removeListener=="function"&&t.removeListener("error",r),n([].slice.call(arguments))}pC(t,e,s,{once:!0}),e!=="error"&&yR(t,r,{once:!0})})}function yR(t,e,n){typeof t.on=="function"&&pC(t,"error",e,n)}function pC(t,e,n,i){if(typeof t.on=="function")i.once?t.once(e,n):t.on(e,n);else if(typeof t.addEventListener=="function")t.addEventListener(e,function r(s){i.once&&t.removeEventListener(e,r),n(s)});else throw new TypeError('The "emitter" argument must be of type EventEmitter. Received type '+typeof t)}var xi=ym.exports;let mC=!0,gC=!0;function Hc(t,e,n){const i=t.match(e);return i&&i.length>=n&&parseInt(i[n],10)}function Xs(t,e,n){if(!t.RTCPeerConnection)return;const i=t.RTCPeerConnection.prototype,r=i.addEventListener;i.addEventListener=function(a,o){if(a!==e)return r.apply(this,arguments);const l=c=>{const d=n(c);d&&(o.handleEvent?o.handleEvent(d):o(d))};return this._eventMap=this._eventMap||{},this._eventMap[e]||(this._eventMap[e]=new Map),this._eventMap[e].set(o,l),r.apply(this,[a,l])};const s=i.removeEventListener;i.removeEventListener=function(a,o){if(a!==e||!this._eventMap||!this._eventMap[e])return s.apply(this,arguments);if(!this._eventMap[e].has(o))return s.apply(this,arguments);const l=this._eventMap[e].get(o);return this._eventMap[e].delete(o),this._eventMap[e].size===0&&delete this._eventMap[e],Object.keys(this._eventMap).length===0&&delete this._eventMap,s.apply(this,[a,l])},Object.defineProperty(i,"on"+e,{get(){return this["_on"+e]},set(a){this["_on"+e]&&(this.removeEventListener(e,this["_on"+e]),delete this["_on"+e]),a&&this.addEventListener(e,this["_on"+e]=a)},enumerable:!0,configurable:!0})}function SR(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(mC=t,t?"adapter.js logging disabled":"adapter.js logging enabled")}function CR(t){return typeof t!="boolean"?new Error("Argument type: "+typeof t+". Please use a boolean."):(gC=!t,"adapter.js deprecation warnings "+(t?"disabled":"enabled"))}function vC(){if(typeof window=="object"){if(mC)return;typeof console<"u"&&typeof console.log=="function"&&console.log.apply(console,arguments)}}function Sm(t,e){gC&&console.warn(t+" is deprecated, please use "+e+" instead.")}function bR(t){const e={browser:null,version:null};if(typeof t>"u"||!t.navigator||!t.navigator.userAgent)return e.browser="Not a browser.",e;const{navigator:n}=t;if(n.mozGetUserMedia)e.browser="firefox",e.version=Hc(n.userAgent,/Firefox\/(\d+)\./,1);else if(n.webkitGetUserMedia||t.isSecureContext===!1&&t.webkitRTCPeerConnection)e.browser="chrome",e.version=Hc(n.userAgent,/Chrom(e|ium)\/(\d+)\./,2);else if(t.RTCPeerConnection&&n.userAgent.match(/AppleWebKit\/(\d+)\./))e.browser="safari",e.version=Hc(n.userAgent,/AppleWebKit\/(\d+)\./,1),e.supportsUnifiedPlan=t.RTCRtpTransceiver&&"currentDirection"in t.RTCRtpTransceiver.prototype;else return e.browser="Not a supported browser.",e;return e}function Rv(t){return Object.prototype.toString.call(t)==="[object Object]"}function _C(t){return Rv(t)?Object.keys(t).reduce(function(e,n){const i=Rv(t[n]),r=i?_C(t[n]):t[n],s=i&&!Object.keys(r).length;return r===void 0||s?e:Object.assign(e,{[n]:r})},{}):t}function Bf(t,e,n){!e||n.has(e.id)||(n.set(e.id,e),Object.keys(e).forEach(i=>{i.endsWith("Id")?Bf(t,t.get(e[i]),n):i.endsWith("Ids")&&e[i].forEach(r=>{Bf(t,t.get(r),n)})}))}function xv(t,e,n){const i=n?"outbound-rtp":"inbound-rtp",r=new Map;if(e===null)return r;const s=[];return t.forEach(a=>{a.type==="track"&&a.trackIdentifier===e.id&&s.push(a)}),s.forEach(a=>{t.forEach(o=>{o.type===i&&o.trackId===a.id&&Bf(t,o,r)})}),r}const Pv=vC;function yC(t,e){const n=t&&t.navigator;if(!n.mediaDevices)return;const i=function(o){if(typeof o!="object"||o.mandatory||o.optional)return o;const l={};return Object.keys(o).forEach(c=>{if(c==="require"||c==="advanced"||c==="mediaSource")return;const d=typeof o[c]=="object"?o[c]:{ideal:o[c]};d.exact!==void 0&&typeof d.exact=="number"&&(d.min=d.max=d.exact);const u=function(m,v){return m?m+v.charAt(0).toUpperCase()+v.slice(1):v==="deviceId"?"sourceId":v};if(d.ideal!==void 0){l.optional=l.optional||[];let m={};typeof d.ideal=="number"?(m[u("min",c)]=d.ideal,l.optional.push(m),m={},m[u("max",c)]=d.ideal,l.optional.push(m)):(m[u("",c)]=d.ideal,l.optional.push(m))}d.exact!==void 0&&typeof d.exact!="number"?(l.mandatory=l.mandatory||{},l.mandatory[u("",c)]=d.exact):["min","max"].forEach(m=>{d[m]!==void 0&&(l.mandatory=l.mandatory||{},l.mandatory[u(m,c)]=d[m])})}),o.advanced&&(l.optional=(l.optional||[]).concat(o.advanced)),l},r=function(o,l){if(e.version>=61)return l(o);if(o=JSON.parse(JSON.stringify(o)),o&&typeof o.audio=="object"){const c=function(d,u,m){u in d&&!(m in d)&&(d[m]=d[u],delete d[u])};o=JSON.parse(JSON.stringify(o)),c(o.audio,"autoGainControl","googAutoGainControl"),c(o.audio,"noiseSuppression","googNoiseSuppression"),o.audio=i(o.audio)}if(o&&typeof o.video=="object"){let c=o.video.facingMode;c=c&&(typeof c=="object"?c:{ideal:c});const d=e.version<66;if(c&&(c.exact==="user"||c.exact==="environment"||c.ideal==="user"||c.ideal==="environment")&&!(n.mediaDevices.getSupportedConstraints&&n.mediaDevices.getSupportedConstraints().facingMode&&!d)){delete o.video.facingMode;let u;if(c.exact==="environment"||c.ideal==="environment"?u=["back","rear"]:(c.exact==="user"||c.ideal==="user")&&(u=["front"]),u)return n.mediaDevices.enumerateDevices().then(m=>{m=m.filter(y=>y.kind==="videoinput");let v=m.find(y=>u.some(_=>y.label.toLowerCase().includes(_)));return!v&&m.length&&u.includes("back")&&(v=m[m.length-1]),v&&(o.video.deviceId=c.exact?{exact:v.deviceId}:{ideal:v.deviceId}),o.video=i(o.video),Pv("chrome: "+JSON.stringify(o)),l(o)})}o.video=i(o.video)}return Pv("chrome: "+JSON.stringify(o)),l(o)},s=function(o){return e.version>=64?o:{name:{PermissionDeniedError:"NotAllowedError",PermissionDismissedError:"NotAllowedError",InvalidStateError:"NotAllowedError",DevicesNotFoundError:"NotFoundError",ConstraintNotSatisfiedError:"OverconstrainedError",TrackStartError:"NotReadableError",MediaDeviceFailedDueToShutdown:"NotAllowedError",MediaDeviceKillSwitchOn:"NotAllowedError",TabCaptureError:"AbortError",ScreenCaptureError:"AbortError",DeviceCaptureError:"AbortError"}[o.name]||o.name,message:o.message,constraint:o.constraint||o.constraintName,toString(){return this.name+(this.message&&": ")+this.message}}},a=function(o,l,c){r(o,d=>{n.webkitGetUserMedia(d,l,u=>{c&&c(s(u))})})};if(n.getUserMedia=a.bind(n),n.mediaDevices.getUserMedia){const o=n.mediaDevices.getUserMedia.bind(n.mediaDevices);n.mediaDevices.getUserMedia=function(l){return r(l,c=>o(c).then(d=>{if(c.audio&&!d.getAudioTracks().length||c.video&&!d.getVideoTracks().length)throw d.getTracks().forEach(u=>{u.stop()}),new DOMException("","NotFoundError");return d},d=>Promise.reject(s(d))))}}}function wR(t,e){if(!(t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices)&&t.navigator.mediaDevices){if(typeof e!="function"){console.error("shimGetDisplayMedia: getSourceId argument is not a function");return}t.navigator.mediaDevices.getDisplayMedia=function(i){return e(i).then(r=>{const s=i.video&&i.video.width,a=i.video&&i.video.height,o=i.video&&i.video.frameRate;return i.video={mandatory:{chromeMediaSource:"desktop",chromeMediaSourceId:r,maxFrameRate:o||3}},s&&(i.video.mandatory.maxWidth=s),a&&(i.video.mandatory.maxHeight=a),t.navigator.mediaDevices.getUserMedia(i)})}}}function SC(t){t.MediaStream=t.MediaStream||t.webkitMediaStream}function CC(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("ontrack"in t.RTCPeerConnection.prototype)){Object.defineProperty(t.RTCPeerConnection.prototype,"ontrack",{get(){return this._ontrack},set(n){this._ontrack&&this.removeEventListener("track",this._ontrack),this.addEventListener("track",this._ontrack=n)},enumerable:!0,configurable:!0});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){return this._ontrackpoly||(this._ontrackpoly=i=>{i.stream.addEventListener("addtrack",r=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===r.track.id):s={track:r.track};const a=new Event("track");a.track=r.track,a.receiver=s,a.transceiver={receiver:s},a.streams=[i.stream],this.dispatchEvent(a)}),i.stream.getTracks().forEach(r=>{let s;t.RTCPeerConnection.prototype.getReceivers?s=this.getReceivers().find(o=>o.track&&o.track.id===r.id):s={track:r};const a=new Event("track");a.track=r,a.receiver=s,a.transceiver={receiver:s},a.streams=[i.stream],this.dispatchEvent(a)})},this.addEventListener("addstream",this._ontrackpoly)),e.apply(this,arguments)}}else Xs(t,"track",e=>(e.transceiver||Object.defineProperty(e,"transceiver",{value:{receiver:e.receiver}}),e))}function bC(t){if(typeof t=="object"&&t.RTCPeerConnection&&!("getSenders"in t.RTCPeerConnection.prototype)&&"createDTMFSender"in t.RTCPeerConnection.prototype){const e=function(r,s){return{track:s,get dtmf(){return this._dtmf===void 0&&(s.kind==="audio"?this._dtmf=r.createDTMFSender(s):this._dtmf=null),this._dtmf},_pc:r}};if(!t.RTCPeerConnection.prototype.getSenders){t.RTCPeerConnection.prototype.getSenders=function(){return this._senders=this._senders||[],this._senders.slice()};const r=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(o,l){let c=r.apply(this,arguments);return c||(c=e(this,o),this._senders.push(c)),c};const s=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(o){s.apply(this,arguments);const l=this._senders.indexOf(o);l!==-1&&this._senders.splice(l,1)}}const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(s){this._senders=this._senders||[],n.apply(this,[s]),s.getTracks().forEach(a=>{this._senders.push(e(this,a))})};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(s){this._senders=this._senders||[],i.apply(this,[s]),s.getTracks().forEach(a=>{const o=this._senders.find(l=>l.track===a);o&&this._senders.splice(this._senders.indexOf(o),1)})}}else if(typeof t=="object"&&t.RTCPeerConnection&&"getSenders"in t.RTCPeerConnection.prototype&&"createDTMFSender"in t.RTCPeerConnection.prototype&&t.RTCRtpSender&&!("dtmf"in t.RTCRtpSender.prototype)){const e=t.RTCPeerConnection.prototype.getSenders;t.RTCPeerConnection.prototype.getSenders=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i},Object.defineProperty(t.RTCRtpSender.prototype,"dtmf",{get(){return this._dtmf===void 0&&(this.track.kind==="audio"?this._dtmf=this._pc.createDTMFSender(this.track):this._dtmf=null),this._dtmf}})}}function wC(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[i,r,s]=arguments;if(arguments.length>0&&typeof i=="function")return e.apply(this,arguments);if(e.length===0&&(arguments.length===0||typeof i!="function"))return e.apply(this,[]);const a=function(l){const c={};return l.result().forEach(u=>{const m={id:u.id,timestamp:u.timestamp,type:{localcandidate:"local-candidate",remotecandidate:"remote-candidate"}[u.type]||u.type};u.names().forEach(v=>{m[v]=u.stat(v)}),c[m.id]=m}),c},o=function(l){return new Map(Object.keys(l).map(c=>[c,l[c]]))};if(arguments.length>=2){const l=function(c){r(o(a(c)))};return e.apply(this,[l,i])}return new Promise((l,c)=>{e.apply(this,[function(d){l(o(a(d)))},c])}).then(r,s)}}function kC(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender&&t.RTCRtpReceiver))return;if(!("getStats"in t.RTCRtpSender.prototype)){const n=t.RTCPeerConnection.prototype.getSenders;n&&(t.RTCPeerConnection.prototype.getSenders=function(){const s=n.apply(this,[]);return s.forEach(a=>a._pc=this),s});const i=t.RTCPeerConnection.prototype.addTrack;i&&(t.RTCPeerConnection.prototype.addTrack=function(){const s=i.apply(this,arguments);return s._pc=this,s}),t.RTCRtpSender.prototype.getStats=function(){const s=this;return this._pc.getStats().then(a=>xv(a,s.track,!0))}}if(!("getStats"in t.RTCRtpReceiver.prototype)){const n=t.RTCPeerConnection.prototype.getReceivers;n&&(t.RTCPeerConnection.prototype.getReceivers=function(){const r=n.apply(this,[]);return r.forEach(s=>s._pc=this),r}),Xs(t,"track",i=>(i.receiver._pc=i.srcElement,i)),t.RTCRtpReceiver.prototype.getStats=function(){const r=this;return this._pc.getStats().then(s=>xv(s,r.track,!1))}}if(!("getStats"in t.RTCRtpSender.prototype&&"getStats"in t.RTCRtpReceiver.prototype))return;const e=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){if(arguments.length>0&&arguments[0]instanceof t.MediaStreamTrack){const i=arguments[0];let r,s,a;return this.getSenders().forEach(o=>{o.track===i&&(r?a=!0:r=o)}),this.getReceivers().forEach(o=>(o.track===i&&(s?a=!0:s=o),o.track===i)),a||r&&s?Promise.reject(new DOMException("There are more than one sender or receiver for the track.","InvalidAccessError")):r?r.getStats():s?s.getStats():Promise.reject(new DOMException("There is no sender or receiver for the track.","InvalidAccessError"))}return e.apply(this,arguments)}}function EC(t){t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},Object.keys(this._shimmedLocalStreams).map(a=>this._shimmedLocalStreams[a][0])};const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addTrack=function(a,o){if(!o)return e.apply(this,arguments);this._shimmedLocalStreams=this._shimmedLocalStreams||{};const l=e.apply(this,arguments);return this._shimmedLocalStreams[o.id]?this._shimmedLocalStreams[o.id].indexOf(l)===-1&&this._shimmedLocalStreams[o.id].push(l):this._shimmedLocalStreams[o.id]=[o,l],l};const n=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(a){this._shimmedLocalStreams=this._shimmedLocalStreams||{},a.getTracks().forEach(c=>{if(this.getSenders().find(u=>u.track===c))throw new DOMException("Track already exists.","InvalidAccessError")});const o=this.getSenders();n.apply(this,arguments);const l=this.getSenders().filter(c=>o.indexOf(c)===-1);this._shimmedLocalStreams[a.id]=[a].concat(l)};const i=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},delete this._shimmedLocalStreams[a.id],i.apply(this,arguments)};const r=t.RTCPeerConnection.prototype.removeTrack;t.RTCPeerConnection.prototype.removeTrack=function(a){return this._shimmedLocalStreams=this._shimmedLocalStreams||{},a&&Object.keys(this._shimmedLocalStreams).forEach(o=>{const l=this._shimmedLocalStreams[o].indexOf(a);l!==-1&&this._shimmedLocalStreams[o].splice(l,1),this._shimmedLocalStreams[o].length===1&&delete this._shimmedLocalStreams[o]}),r.apply(this,arguments)}}function TC(t,e){if(!t.RTCPeerConnection)return;if(t.RTCPeerConnection.prototype.addTrack&&e.version>=65)return EC(t);const n=t.RTCPeerConnection.prototype.getLocalStreams;t.RTCPeerConnection.prototype.getLocalStreams=function(){const d=n.apply(this);return this._reverseStreams=this._reverseStreams||{},d.map(u=>this._reverseStreams[u.id])};const i=t.RTCPeerConnection.prototype.addStream;t.RTCPeerConnection.prototype.addStream=function(d){if(this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},d.getTracks().forEach(u=>{if(this.getSenders().find(v=>v.track===u))throw new DOMException("Track already exists.","InvalidAccessError")}),!this._reverseStreams[d.id]){const u=new t.MediaStream(d.getTracks());this._streams[d.id]=u,this._reverseStreams[u.id]=d,d=u}i.apply(this,[d])};const r=t.RTCPeerConnection.prototype.removeStream;t.RTCPeerConnection.prototype.removeStream=function(d){this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{},r.apply(this,[this._streams[d.id]||d]),delete this._reverseStreams[this._streams[d.id]?this._streams[d.id].id:d.id],delete this._streams[d.id]},t.RTCPeerConnection.prototype.addTrack=function(d,u){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");const m=[].slice.call(arguments,1);if(m.length!==1||!m[0].getTracks().find(_=>_===d))throw new DOMException("The adapter.js addTrack polyfill only supports a single  stream which is associated with the specified track.","NotSupportedError");if(this.getSenders().find(_=>_.track===d))throw new DOMException("Track already exists.","InvalidAccessError");this._streams=this._streams||{},this._reverseStreams=this._reverseStreams||{};const y=this._streams[u.id];if(y)y.addTrack(d),Promise.resolve().then(()=>{this.dispatchEvent(new Event("negotiationneeded"))});else{const _=new t.MediaStream([d]);this._streams[u.id]=_,this._reverseStreams[_.id]=u,this.addStream(_)}return this.getSenders().find(_=>_.track===d)};function s(c,d){let u=d.sdp;return Object.keys(c._reverseStreams||[]).forEach(m=>{const v=c._reverseStreams[m],y=c._streams[v.id];u=u.replace(new RegExp(y.id,"g"),v.id)}),new RTCSessionDescription({type:d.type,sdp:u})}function a(c,d){let u=d.sdp;return Object.keys(c._reverseStreams||[]).forEach(m=>{const v=c._reverseStreams[m],y=c._streams[v.id];u=u.replace(new RegExp(v.id,"g"),y.id)}),new RTCSessionDescription({type:d.type,sdp:u})}["createOffer","createAnswer"].forEach(function(c){const d=t.RTCPeerConnection.prototype[c],u={[c](){const m=arguments;return arguments.length&&typeof arguments[0]=="function"?d.apply(this,[y=>{const _=s(this,y);m[0].apply(null,[_])},y=>{m[1]&&m[1].apply(null,y)},arguments[2]]):d.apply(this,arguments).then(y=>s(this,y))}};t.RTCPeerConnection.prototype[c]=u[c]});const o=t.RTCPeerConnection.prototype.setLocalDescription;t.RTCPeerConnection.prototype.setLocalDescription=function(){return!arguments.length||!arguments[0].type?o.apply(this,arguments):(arguments[0]=a(this,arguments[0]),o.apply(this,arguments))};const l=Object.getOwnPropertyDescriptor(t.RTCPeerConnection.prototype,"localDescription");Object.defineProperty(t.RTCPeerConnection.prototype,"localDescription",{get(){const c=l.get.apply(this);return c.type===""?c:s(this,c)}}),t.RTCPeerConnection.prototype.removeTrack=function(d){if(this.signalingState==="closed")throw new DOMException("The RTCPeerConnection's signalingState is 'closed'.","InvalidStateError");if(!d._pc)throw new DOMException("Argument 1 of RTCPeerConnection.removeTrack does not implement interface RTCRtpSender.","TypeError");if(!(d._pc===this))throw new DOMException("Sender was not created by this connection.","InvalidAccessError");this._streams=this._streams||{};let m;Object.keys(this._streams).forEach(v=>{this._streams[v].getTracks().find(_=>d.track===_)&&(m=this._streams[v])}),m&&(m.getTracks().length===1?this.removeStream(this._reverseStreams[m.id]):m.removeTrack(d.track),this.dispatchEvent(new Event("negotiationneeded")))}}function Ff(t,e){!t.RTCPeerConnection&&t.webkitRTCPeerConnection&&(t.RTCPeerConnection=t.webkitRTCPeerConnection),t.RTCPeerConnection&&e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(n){const i=t.RTCPeerConnection.prototype[n],r={[n](){return arguments[0]=new(n==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),i.apply(this,arguments)}};t.RTCPeerConnection.prototype[n]=r[n]})}function RC(t,e){Xs(t,"negotiationneeded",n=>{const i=n.target;if(!((e.version<72||i.getConfiguration&&i.getConfiguration().sdpSemantics==="plan-b")&&i.signalingState!=="stable"))return n})}var Ov=Object.freeze({__proto__:null,fixNegotiationNeeded:RC,shimAddTrackRemoveTrack:TC,shimAddTrackRemoveTrackWithNative:EC,shimGetDisplayMedia:wR,shimGetSendersWithDtmf:bC,shimGetStats:wC,shimGetUserMedia:yC,shimMediaStream:SC,shimOnTrack:CC,shimPeerConnection:Ff,shimSenderReceiverGetStats:kC});function xC(t,e){const n=t&&t.navigator,i=t&&t.MediaStreamTrack;if(n.getUserMedia=function(r,s,a){Sm("navigator.getUserMedia","navigator.mediaDevices.getUserMedia"),n.mediaDevices.getUserMedia(r).then(s,a)},!(e.version>55&&"autoGainControl"in n.mediaDevices.getSupportedConstraints())){const r=function(a,o,l){o in a&&!(l in a)&&(a[l]=a[o],delete a[o])},s=n.mediaDevices.getUserMedia.bind(n.mediaDevices);if(n.mediaDevices.getUserMedia=function(a){return typeof a=="object"&&typeof a.audio=="object"&&(a=JSON.parse(JSON.stringify(a)),r(a.audio,"autoGainControl","mozAutoGainControl"),r(a.audio,"noiseSuppression","mozNoiseSuppression")),s(a)},i&&i.prototype.getSettings){const a=i.prototype.getSettings;i.prototype.getSettings=function(){const o=a.apply(this,arguments);return r(o,"mozAutoGainControl","autoGainControl"),r(o,"mozNoiseSuppression","noiseSuppression"),o}}if(i&&i.prototype.applyConstraints){const a=i.prototype.applyConstraints;i.prototype.applyConstraints=function(o){return this.kind==="audio"&&typeof o=="object"&&(o=JSON.parse(JSON.stringify(o)),r(o,"autoGainControl","mozAutoGainControl"),r(o,"noiseSuppression","mozNoiseSuppression")),a.apply(this,[o])}}}}function kR(t,e){t.navigator.mediaDevices&&"getDisplayMedia"in t.navigator.mediaDevices||t.navigator.mediaDevices&&(t.navigator.mediaDevices.getDisplayMedia=function(i){if(!(i&&i.video)){const r=new DOMException("getDisplayMedia without video constraints is undefined");return r.name="NotFoundError",r.code=8,Promise.reject(r)}return i.video===!0?i.video={mediaSource:e}:i.video.mediaSource=e,t.navigator.mediaDevices.getUserMedia(i)})}function PC(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function Uf(t,e){if(typeof t!="object"||!(t.RTCPeerConnection||t.mozRTCPeerConnection))return;!t.RTCPeerConnection&&t.mozRTCPeerConnection&&(t.RTCPeerConnection=t.mozRTCPeerConnection),e.version<53&&["setLocalDescription","setRemoteDescription","addIceCandidate"].forEach(function(r){const s=t.RTCPeerConnection.prototype[r],a={[r](){return arguments[0]=new(r==="addIceCandidate"?t.RTCIceCandidate:t.RTCSessionDescription)(arguments[0]),s.apply(this,arguments)}};t.RTCPeerConnection.prototype[r]=a[r]});const n={inboundrtp:"inbound-rtp",outboundrtp:"outbound-rtp",candidatepair:"candidate-pair",localcandidate:"local-candidate",remotecandidate:"remote-candidate"},i=t.RTCPeerConnection.prototype.getStats;t.RTCPeerConnection.prototype.getStats=function(){const[s,a,o]=arguments;return i.apply(this,[s||null]).then(l=>{if(e.version<53&&!a)try{l.forEach(c=>{c.type=n[c.type]||c.type})}catch(c){if(c.name!=="TypeError")throw c;l.forEach((d,u)=>{l.set(u,Object.assign({},d,{type:n[d.type]||d.type}))})}return l}).then(a,o)}}function OC(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpSender.prototype)return;const e=t.RTCPeerConnection.prototype.getSenders;e&&(t.RTCPeerConnection.prototype.getSenders=function(){const r=e.apply(this,[]);return r.forEach(s=>s._pc=this),r});const n=t.RTCPeerConnection.prototype.addTrack;n&&(t.RTCPeerConnection.prototype.addTrack=function(){const r=n.apply(this,arguments);return r._pc=this,r}),t.RTCRtpSender.prototype.getStats=function(){return this.track?this._pc.getStats(this.track):Promise.resolve(new Map)}}function IC(t){if(!(typeof t=="object"&&t.RTCPeerConnection&&t.RTCRtpSender)||t.RTCRtpSender&&"getStats"in t.RTCRtpReceiver.prototype)return;const e=t.RTCPeerConnection.prototype.getReceivers;e&&(t.RTCPeerConnection.prototype.getReceivers=function(){const i=e.apply(this,[]);return i.forEach(r=>r._pc=this),i}),Xs(t,"track",n=>(n.receiver._pc=n.srcElement,n)),t.RTCRtpReceiver.prototype.getStats=function(){return this._pc.getStats(this.track)}}function LC(t){!t.RTCPeerConnection||"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){Sm("removeStream","removeTrack"),this.getSenders().forEach(i=>{i.track&&n.getTracks().includes(i.track)&&this.removeTrack(i)})})}function MC(t){t.DataChannel&&!t.RTCDataChannel&&(t.RTCDataChannel=t.DataChannel)}function DC(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.addTransceiver;e&&(t.RTCPeerConnection.prototype.addTransceiver=function(){this.setParametersPromises=[];let i=arguments[1]&&arguments[1].sendEncodings;i===void 0&&(i=[]),i=[...i];const r=i.length>0;r&&i.forEach(a=>{if("rid"in a&&!/^[a-z0-9]{0,16}$/i.test(a.rid))throw new TypeError("Invalid RID value provided.");if("scaleResolutionDownBy"in a&&!(parseFloat(a.scaleResolutionDownBy)>=1))throw new RangeError("scale_resolution_down_by must be >= 1.0");if("maxFramerate"in a&&!(parseFloat(a.maxFramerate)>=0))throw new RangeError("max_framerate must be >= 0.0")});const s=e.apply(this,arguments);if(r){const{sender:a}=s,o=a.getParameters();(!("encodings"in o)||o.encodings.length===1&&Object.keys(o.encodings[0]).length===0)&&(o.encodings=i,a.sendEncodings=i,this.setParametersPromises.push(a.setParameters(o).then(()=>{delete a.sendEncodings}).catch(()=>{delete a.sendEncodings})))}return s})}function AC(t){if(!(typeof t=="object"&&t.RTCRtpSender))return;const e=t.RTCRtpSender.prototype.getParameters;e&&(t.RTCRtpSender.prototype.getParameters=function(){const i=e.apply(this,arguments);return"encodings"in i||(i.encodings=[].concat(this.sendEncodings||[{}])),i})}function NC(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}function BC(t){if(!(typeof t=="object"&&t.RTCPeerConnection))return;const e=t.RTCPeerConnection.prototype.createAnswer;t.RTCPeerConnection.prototype.createAnswer=function(){return this.setParametersPromises&&this.setParametersPromises.length?Promise.all(this.setParametersPromises).then(()=>e.apply(this,arguments)).finally(()=>{this.setParametersPromises=[]}):e.apply(this,arguments)}}var Iv=Object.freeze({__proto__:null,shimAddTransceiver:DC,shimCreateAnswer:BC,shimCreateOffer:NC,shimGetDisplayMedia:kR,shimGetParameters:AC,shimGetUserMedia:xC,shimOnTrack:PC,shimPeerConnection:Uf,shimRTCDataChannel:MC,shimReceiverGetStats:IC,shimRemoveStream:LC,shimSenderGetStats:OC});function FC(t){if(!(typeof t!="object"||!t.RTCPeerConnection)){if("getLocalStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getLocalStreams=function(){return this._localStreams||(this._localStreams=[]),this._localStreams}),!("addStream"in t.RTCPeerConnection.prototype)){const e=t.RTCPeerConnection.prototype.addTrack;t.RTCPeerConnection.prototype.addStream=function(i){this._localStreams||(this._localStreams=[]),this._localStreams.includes(i)||this._localStreams.push(i),i.getAudioTracks().forEach(r=>e.call(this,r,i)),i.getVideoTracks().forEach(r=>e.call(this,r,i))},t.RTCPeerConnection.prototype.addTrack=function(i){for(var r=arguments.length,s=new Array(r>1?r-1:0),a=1;a<r;a++)s[a-1]=arguments[a];return s&&s.forEach(o=>{this._localStreams?this._localStreams.includes(o)||this._localStreams.push(o):this._localStreams=[o]}),e.apply(this,arguments)}}"removeStream"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.removeStream=function(n){this._localStreams||(this._localStreams=[]);const i=this._localStreams.indexOf(n);if(i===-1)return;this._localStreams.splice(i,1);const r=n.getTracks();this.getSenders().forEach(s=>{r.includes(s.track)&&this.removeTrack(s)})})}}function UC(t){if(!(typeof t!="object"||!t.RTCPeerConnection)&&("getRemoteStreams"in t.RTCPeerConnection.prototype||(t.RTCPeerConnection.prototype.getRemoteStreams=function(){return this._remoteStreams?this._remoteStreams:[]}),!("onaddstream"in t.RTCPeerConnection.prototype))){Object.defineProperty(t.RTCPeerConnection.prototype,"onaddstream",{get(){return this._onaddstream},set(n){this._onaddstream&&(this.removeEventListener("addstream",this._onaddstream),this.removeEventListener("track",this._onaddstreampoly)),this.addEventListener("addstream",this._onaddstream=n),this.addEventListener("track",this._onaddstreampoly=i=>{i.streams.forEach(r=>{if(this._remoteStreams||(this._remoteStreams=[]),this._remoteStreams.includes(r))return;this._remoteStreams.push(r);const s=new Event("addstream");s.stream=r,this.dispatchEvent(s)})})}});const e=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){const i=this;return this._onaddstreampoly||this.addEventListener("track",this._onaddstreampoly=function(r){r.streams.forEach(s=>{if(i._remoteStreams||(i._remoteStreams=[]),i._remoteStreams.indexOf(s)>=0)return;i._remoteStreams.push(s);const a=new Event("addstream");a.stream=s,i.dispatchEvent(a)})}),e.apply(i,arguments)}}}function zC(t){if(typeof t!="object"||!t.RTCPeerConnection)return;const e=t.RTCPeerConnection.prototype,n=e.createOffer,i=e.createAnswer,r=e.setLocalDescription,s=e.setRemoteDescription,a=e.addIceCandidate;e.createOffer=function(c,d){const u=arguments.length>=2?arguments[2]:arguments[0],m=n.apply(this,[u]);return d?(m.then(c,d),Promise.resolve()):m},e.createAnswer=function(c,d){const u=arguments.length>=2?arguments[2]:arguments[0],m=i.apply(this,[u]);return d?(m.then(c,d),Promise.resolve()):m};let o=function(l,c,d){const u=r.apply(this,[l]);return d?(u.then(c,d),Promise.resolve()):u};e.setLocalDescription=o,o=function(l,c,d){const u=s.apply(this,[l]);return d?(u.then(c,d),Promise.resolve()):u},e.setRemoteDescription=o,o=function(l,c,d){const u=a.apply(this,[l]);return d?(u.then(c,d),Promise.resolve()):u},e.addIceCandidate=o}function HC(t){const e=t&&t.navigator;if(e.mediaDevices&&e.mediaDevices.getUserMedia){const n=e.mediaDevices,i=n.getUserMedia.bind(n);e.mediaDevices.getUserMedia=r=>i(jC(r))}!e.getUserMedia&&e.mediaDevices&&e.mediaDevices.getUserMedia&&(e.getUserMedia=(function(i,r,s){e.mediaDevices.getUserMedia(i).then(r,s)}).bind(e))}function jC(t){return t&&t.video!==void 0?Object.assign({},t,{video:_C(t.video)}):t}function WC(t){if(!t.RTCPeerConnection)return;const e=t.RTCPeerConnection;t.RTCPeerConnection=function(i,r){if(i&&i.iceServers){const s=[];for(let a=0;a<i.iceServers.length;a++){let o=i.iceServers[a];o.urls===void 0&&o.url?(Sm("RTCIceServer.url","RTCIceServer.urls"),o=JSON.parse(JSON.stringify(o)),o.urls=o.url,delete o.url,s.push(o)):s.push(i.iceServers[a])}i.iceServers=s}return new e(i,r)},t.RTCPeerConnection.prototype=e.prototype,"generateCertificate"in e&&Object.defineProperty(t.RTCPeerConnection,"generateCertificate",{get(){return e.generateCertificate}})}function $C(t){typeof t=="object"&&t.RTCTrackEvent&&"receiver"in t.RTCTrackEvent.prototype&&!("transceiver"in t.RTCTrackEvent.prototype)&&Object.defineProperty(t.RTCTrackEvent.prototype,"transceiver",{get(){return{receiver:this.receiver}}})}function VC(t){const e=t.RTCPeerConnection.prototype.createOffer;t.RTCPeerConnection.prototype.createOffer=function(i){if(i){typeof i.offerToReceiveAudio<"u"&&(i.offerToReceiveAudio=!!i.offerToReceiveAudio);const r=this.getTransceivers().find(a=>a.receiver.track.kind==="audio");i.offerToReceiveAudio===!1&&r?r.direction==="sendrecv"?r.setDirection?r.setDirection("sendonly"):r.direction="sendonly":r.direction==="recvonly"&&(r.setDirection?r.setDirection("inactive"):r.direction="inactive"):i.offerToReceiveAudio===!0&&!r&&this.addTransceiver("audio",{direction:"recvonly"}),typeof i.offerToReceiveVideo<"u"&&(i.offerToReceiveVideo=!!i.offerToReceiveVideo);const s=this.getTransceivers().find(a=>a.receiver.track.kind==="video");i.offerToReceiveVideo===!1&&s?s.direction==="sendrecv"?s.setDirection?s.setDirection("sendonly"):s.direction="sendonly":s.direction==="recvonly"&&(s.setDirection?s.setDirection("inactive"):s.direction="inactive"):i.offerToReceiveVideo===!0&&!s&&this.addTransceiver("video",{direction:"recvonly"})}return e.apply(this,arguments)}}function GC(t){typeof t!="object"||t.AudioContext||(t.AudioContext=t.webkitAudioContext)}var Lv=Object.freeze({__proto__:null,shimAudioContext:GC,shimCallbacksAPI:zC,shimConstraints:jC,shimCreateOfferLegacy:VC,shimGetUserMedia:HC,shimLocalStreamsAPI:FC,shimRTCIceServerUrls:WC,shimRemoteStreamsAPI:UC,shimTrackEventTransceiver:$C}),qC={exports:{}};(function(t){const e={};e.generateIdentifier=function(){return Math.random().toString(36).substring(2,12)},e.localCName=e.generateIdentifier(),e.splitLines=function(n){return n.trim().split(`
`).map(i=>i.trim())},e.splitSections=function(n){return n.split(`
m=`).map((r,s)=>(s>0?"m="+r:r).trim()+`\r
`)},e.getDescription=function(n){const i=e.splitSections(n);return i&&i[0]},e.getMediaSections=function(n){const i=e.splitSections(n);return i.shift(),i},e.matchPrefix=function(n,i){return e.splitLines(n).filter(r=>r.indexOf(i)===0)},e.parseCandidate=function(n){let i;n.indexOf("a=candidate:")===0?i=n.substring(12).split(" "):i=n.substring(10).split(" ");const r={foundation:i[0],component:{1:"rtp",2:"rtcp"}[i[1]]||i[1],protocol:i[2].toLowerCase(),priority:parseInt(i[3],10),ip:i[4],address:i[4],port:parseInt(i[5],10),type:i[7]};for(let s=8;s<i.length;s+=2)switch(i[s]){case"raddr":r.relatedAddress=i[s+1];break;case"rport":r.relatedPort=parseInt(i[s+1],10);break;case"tcptype":r.tcpType=i[s+1];break;case"ufrag":r.ufrag=i[s+1],r.usernameFragment=i[s+1];break;default:r[i[s]]===void 0&&(r[i[s]]=i[s+1]);break}return r},e.writeCandidate=function(n){const i=[];i.push(n.foundation);const r=n.component;r==="rtp"?i.push(1):r==="rtcp"?i.push(2):i.push(r),i.push(n.protocol.toUpperCase()),i.push(n.priority),i.push(n.address||n.ip),i.push(n.port);const s=n.type;return i.push("typ"),i.push(s),s!=="host"&&n.relatedAddress&&n.relatedPort&&(i.push("raddr"),i.push(n.relatedAddress),i.push("rport"),i.push(n.relatedPort)),n.tcpType&&n.protocol.toLowerCase()==="tcp"&&(i.push("tcptype"),i.push(n.tcpType)),(n.usernameFragment||n.ufrag)&&(i.push("ufrag"),i.push(n.usernameFragment||n.ufrag)),"candidate:"+i.join(" ")},e.parseIceOptions=function(n){return n.substring(14).split(" ")},e.parseRtpMap=function(n){let i=n.substring(9).split(" ");const r={payloadType:parseInt(i.shift(),10)};return i=i[0].split("/"),r.name=i[0],r.clockRate=parseInt(i[1],10),r.channels=i.length===3?parseInt(i[2],10):1,r.numChannels=r.channels,r},e.writeRtpMap=function(n){let i=n.payloadType;n.preferredPayloadType!==void 0&&(i=n.preferredPayloadType);const r=n.channels||n.numChannels||1;return"a=rtpmap:"+i+" "+n.name+"/"+n.clockRate+(r!==1?"/"+r:"")+`\r
`},e.parseExtmap=function(n){const i=n.substring(9).split(" ");return{id:parseInt(i[0],10),direction:i[0].indexOf("/")>0?i[0].split("/")[1]:"sendrecv",uri:i[1],attributes:i.slice(2).join(" ")}},e.writeExtmap=function(n){return"a=extmap:"+(n.id||n.preferredId)+(n.direction&&n.direction!=="sendrecv"?"/"+n.direction:"")+" "+n.uri+(n.attributes?" "+n.attributes:"")+`\r
`},e.parseFmtp=function(n){const i={};let r;const s=n.substring(n.indexOf(" ")+1).split(";");for(let a=0;a<s.length;a++)r=s[a].trim().split("="),i[r[0].trim()]=r[1];return i},e.writeFmtp=function(n){let i="",r=n.payloadType;if(n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.parameters&&Object.keys(n.parameters).length){const s=[];Object.keys(n.parameters).forEach(a=>{n.parameters[a]!==void 0?s.push(a+"="+n.parameters[a]):s.push(a)}),i+="a=fmtp:"+r+" "+s.join(";")+`\r
`}return i},e.parseRtcpFb=function(n){const i=n.substring(n.indexOf(" ")+1).split(" ");return{type:i.shift(),parameter:i.join(" ")}},e.writeRtcpFb=function(n){let i="",r=n.payloadType;return n.preferredPayloadType!==void 0&&(r=n.preferredPayloadType),n.rtcpFeedback&&n.rtcpFeedback.length&&n.rtcpFeedback.forEach(s=>{i+="a=rtcp-fb:"+r+" "+s.type+(s.parameter&&s.parameter.length?" "+s.parameter:"")+`\r
`}),i},e.parseSsrcMedia=function(n){const i=n.indexOf(" "),r={ssrc:parseInt(n.substring(7,i),10)},s=n.indexOf(":",i);return s>-1?(r.attribute=n.substring(i+1,s),r.value=n.substring(s+1)):r.attribute=n.substring(i+1),r},e.parseSsrcGroup=function(n){const i=n.substring(13).split(" ");return{semantics:i.shift(),ssrcs:i.map(r=>parseInt(r,10))}},e.getMid=function(n){const i=e.matchPrefix(n,"a=mid:")[0];if(i)return i.substring(6)},e.parseFingerprint=function(n){const i=n.substring(14).split(" ");return{algorithm:i[0].toLowerCase(),value:i[1].toUpperCase()}},e.getDtlsParameters=function(n,i){return{role:"auto",fingerprints:e.matchPrefix(n+i,"a=fingerprint:").map(e.parseFingerprint)}},e.writeDtlsParameters=function(n,i){let r="a=setup:"+i+`\r
`;return n.fingerprints.forEach(s=>{r+="a=fingerprint:"+s.algorithm+" "+s.value+`\r
`}),r},e.parseCryptoLine=function(n){const i=n.substring(9).split(" ");return{tag:parseInt(i[0],10),cryptoSuite:i[1],keyParams:i[2],sessionParams:i.slice(3)}},e.writeCryptoLine=function(n){return"a=crypto:"+n.tag+" "+n.cryptoSuite+" "+(typeof n.keyParams=="object"?e.writeCryptoKeyParams(n.keyParams):n.keyParams)+(n.sessionParams?" "+n.sessionParams.join(" "):"")+`\r
`},e.parseCryptoKeyParams=function(n){if(n.indexOf("inline:")!==0)return null;const i=n.substring(7).split("|");return{keyMethod:"inline",keySalt:i[0],lifeTime:i[1],mkiValue:i[2]?i[2].split(":")[0]:void 0,mkiLength:i[2]?i[2].split(":")[1]:void 0}},e.writeCryptoKeyParams=function(n){return n.keyMethod+":"+n.keySalt+(n.lifeTime?"|"+n.lifeTime:"")+(n.mkiValue&&n.mkiLength?"|"+n.mkiValue+":"+n.mkiLength:"")},e.getCryptoParameters=function(n,i){return e.matchPrefix(n+i,"a=crypto:").map(e.parseCryptoLine)},e.getIceParameters=function(n,i){const r=e.matchPrefix(n+i,"a=ice-ufrag:")[0],s=e.matchPrefix(n+i,"a=ice-pwd:")[0];return r&&s?{usernameFragment:r.substring(12),password:s.substring(10)}:null},e.writeIceParameters=function(n){let i="a=ice-ufrag:"+n.usernameFragment+`\r
a=ice-pwd:`+n.password+`\r
`;return n.iceLite&&(i+=`a=ice-lite\r
`),i},e.parseRtpParameters=function(n){const i={codecs:[],headerExtensions:[],fecMechanisms:[],rtcp:[]},s=e.splitLines(n)[0].split(" ");i.profile=s[2];for(let o=3;o<s.length;o++){const l=s[o],c=e.matchPrefix(n,"a=rtpmap:"+l+" ")[0];if(c){const d=e.parseRtpMap(c),u=e.matchPrefix(n,"a=fmtp:"+l+" ");switch(d.parameters=u.length?e.parseFmtp(u[0]):{},d.rtcpFeedback=e.matchPrefix(n,"a=rtcp-fb:"+l+" ").map(e.parseRtcpFb),i.codecs.push(d),d.name.toUpperCase()){case"RED":case"ULPFEC":i.fecMechanisms.push(d.name.toUpperCase());break}}}e.matchPrefix(n,"a=extmap:").forEach(o=>{i.headerExtensions.push(e.parseExtmap(o))});const a=e.matchPrefix(n,"a=rtcp-fb:* ").map(e.parseRtcpFb);return i.codecs.forEach(o=>{a.forEach(l=>{o.rtcpFeedback.find(d=>d.type===l.type&&d.parameter===l.parameter)||o.rtcpFeedback.push(l)})}),i},e.writeRtpDescription=function(n,i){let r="";r+="m="+n+" ",r+=i.codecs.length>0?"9":"0",r+=" "+(i.profile||"UDP/TLS/RTP/SAVPF")+" ",r+=i.codecs.map(a=>a.preferredPayloadType!==void 0?a.preferredPayloadType:a.payloadType).join(" ")+`\r
`,r+=`c=IN IP4 0.0.0.0\r
`,r+=`a=rtcp:9 IN IP4 0.0.0.0\r
`,i.codecs.forEach(a=>{r+=e.writeRtpMap(a),r+=e.writeFmtp(a),r+=e.writeRtcpFb(a)});let s=0;return i.codecs.forEach(a=>{a.maxptime>s&&(s=a.maxptime)}),s>0&&(r+="a=maxptime:"+s+`\r
`),i.headerExtensions&&i.headerExtensions.forEach(a=>{r+=e.writeExtmap(a)}),r},e.parseRtpEncodingParameters=function(n){const i=[],r=e.parseRtpParameters(n),s=r.fecMechanisms.indexOf("RED")!==-1,a=r.fecMechanisms.indexOf("ULPFEC")!==-1,o=e.matchPrefix(n,"a=ssrc:").map(m=>e.parseSsrcMedia(m)).filter(m=>m.attribute==="cname"),l=o.length>0&&o[0].ssrc;let c;const d=e.matchPrefix(n,"a=ssrc-group:FID").map(m=>m.substring(17).split(" ").map(y=>parseInt(y,10)));d.length>0&&d[0].length>1&&d[0][0]===l&&(c=d[0][1]),r.codecs.forEach(m=>{if(m.name.toUpperCase()==="RTX"&&m.parameters.apt){let v={ssrc:l,codecPayloadType:parseInt(m.parameters.apt,10)};l&&c&&(v.rtx={ssrc:c}),i.push(v),s&&(v=JSON.parse(JSON.stringify(v)),v.fec={ssrc:l,mechanism:a?"red+ulpfec":"red"},i.push(v))}}),i.length===0&&l&&i.push({ssrc:l});let u=e.matchPrefix(n,"b=");return u.length&&(u[0].indexOf("b=TIAS:")===0?u=parseInt(u[0].substring(7),10):u[0].indexOf("b=AS:")===0?u=parseInt(u[0].substring(5),10)*1e3*.95-50*40*8:u=void 0,i.forEach(m=>{m.maxBitrate=u})),i},e.parseRtcpParameters=function(n){const i={},r=e.matchPrefix(n,"a=ssrc:").map(o=>e.parseSsrcMedia(o)).filter(o=>o.attribute==="cname")[0];r&&(i.cname=r.value,i.ssrc=r.ssrc);const s=e.matchPrefix(n,"a=rtcp-rsize");i.reducedSize=s.length>0,i.compound=s.length===0;const a=e.matchPrefix(n,"a=rtcp-mux");return i.mux=a.length>0,i},e.writeRtcpParameters=function(n){let i="";return n.reducedSize&&(i+=`a=rtcp-rsize\r
`),n.mux&&(i+=`a=rtcp-mux\r
`),n.ssrc!==void 0&&n.cname&&(i+="a=ssrc:"+n.ssrc+" cname:"+n.cname+`\r
`),i},e.parseMsid=function(n){let i;const r=e.matchPrefix(n,"a=msid:");if(r.length===1)return i=r[0].substring(7).split(" "),{stream:i[0],track:i[1]};const s=e.matchPrefix(n,"a=ssrc:").map(a=>e.parseSsrcMedia(a)).filter(a=>a.attribute==="msid");if(s.length>0)return i=s[0].value.split(" "),{stream:i[0],track:i[1]}},e.parseSctpDescription=function(n){const i=e.parseMLine(n),r=e.matchPrefix(n,"a=max-message-size:");let s;r.length>0&&(s=parseInt(r[0].substring(19),10)),isNaN(s)&&(s=65536);const a=e.matchPrefix(n,"a=sctp-port:");if(a.length>0)return{port:parseInt(a[0].substring(12),10),protocol:i.fmt,maxMessageSize:s};const o=e.matchPrefix(n,"a=sctpmap:");if(o.length>0){const l=o[0].substring(10).split(" ");return{port:parseInt(l[0],10),protocol:l[1],maxMessageSize:s}}},e.writeSctpDescription=function(n,i){let r=[];return n.protocol!=="DTLS/SCTP"?r=["m="+n.kind+" 9 "+n.protocol+" "+i.protocol+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctp-port:"+i.port+`\r
`]:r=["m="+n.kind+" 9 "+n.protocol+" "+i.port+`\r
`,`c=IN IP4 0.0.0.0\r
`,"a=sctpmap:"+i.port+" "+i.protocol+` 65535\r
`],i.maxMessageSize!==void 0&&r.push("a=max-message-size:"+i.maxMessageSize+`\r
`),r.join("")},e.generateSessionId=function(){return Math.random().toString().substr(2,22)},e.writeSessionBoilerplate=function(n,i,r){let s;const a=i!==void 0?i:2;return n?s=n:s=e.generateSessionId(),`v=0\r
o=`+(r||"thisisadapterortc")+" "+s+" "+a+` IN IP4 127.0.0.1\r
s=-\r
t=0 0\r
`},e.getDirection=function(n,i){const r=e.splitLines(n);for(let s=0;s<r.length;s++)switch(r[s]){case"a=sendrecv":case"a=sendonly":case"a=recvonly":case"a=inactive":return r[s].substring(2)}return i?e.getDirection(i):"sendrecv"},e.getKind=function(n){return e.splitLines(n)[0].split(" ")[0].substring(2)},e.isRejected=function(n){return n.split(" ",2)[1]==="0"},e.parseMLine=function(n){const r=e.splitLines(n)[0].substring(2).split(" ");return{kind:r[0],port:parseInt(r[1],10),protocol:r[2],fmt:r.slice(3).join(" ")}},e.parseOLine=function(n){const r=e.matchPrefix(n,"o=")[0].substring(2).split(" ");return{username:r[0],sessionId:r[1],sessionVersion:parseInt(r[2],10),netType:r[3],addressType:r[4],address:r[5]}},e.isValidSDP=function(n){if(typeof n!="string"||n.length===0)return!1;const i=e.splitLines(n);for(let r=0;r<i.length;r++)if(i[r].length<2||i[r].charAt(1)!=="=")return!1;return!0},t.exports=e})(qC);var JC=qC.exports,To=TT(JC),ER=kT({__proto__:null,default:To},[JC]);function jc(t){if(!t.RTCIceCandidate||t.RTCIceCandidate&&"foundation"in t.RTCIceCandidate.prototype)return;const e=t.RTCIceCandidate;t.RTCIceCandidate=function(i){if(typeof i=="object"&&i.candidate&&i.candidate.indexOf("a=")===0&&(i=JSON.parse(JSON.stringify(i)),i.candidate=i.candidate.substring(2)),i.candidate&&i.candidate.length){const r=new e(i),s=To.parseCandidate(i.candidate);for(const a in s)a in r||Object.defineProperty(r,a,{value:s[a]});return r.toJSON=function(){return{candidate:r.candidate,sdpMid:r.sdpMid,sdpMLineIndex:r.sdpMLineIndex,usernameFragment:r.usernameFragment}},r}return new e(i)},t.RTCIceCandidate.prototype=e.prototype,Xs(t,"icecandidate",n=>(n.candidate&&Object.defineProperty(n,"candidate",{value:new t.RTCIceCandidate(n.candidate),writable:"false"}),n))}function zf(t){!t.RTCIceCandidate||t.RTCIceCandidate&&"relayProtocol"in t.RTCIceCandidate.prototype||Xs(t,"icecandidate",e=>{if(e.candidate){const n=To.parseCandidate(e.candidate.candidate);n.type==="relay"&&(e.candidate.relayProtocol={0:"tls",1:"tcp",2:"udp"}[n.priority>>24])}return e})}function Wc(t,e){if(!t.RTCPeerConnection)return;"sctp"in t.RTCPeerConnection.prototype||Object.defineProperty(t.RTCPeerConnection.prototype,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp}});const n=function(o){if(!o||!o.sdp)return!1;const l=To.splitSections(o.sdp);return l.shift(),l.some(c=>{const d=To.parseMLine(c);return d&&d.kind==="application"&&d.protocol.indexOf("SCTP")!==-1})},i=function(o){const l=o.sdp.match(/mozilla...THIS_IS_SDPARTA-(\d+)/);if(l===null||l.length<2)return-1;const c=parseInt(l[1],10);return c!==c?-1:c},r=function(o){let l=65536;return e.browser==="firefox"&&(e.version<57?o===-1?l=16384:l=2147483637:e.version<60?l=e.version===57?65535:65536:l=2147483637),l},s=function(o,l){let c=65536;e.browser==="firefox"&&e.version===57&&(c=65535);const d=To.matchPrefix(o.sdp,"a=max-message-size:");return d.length>0?c=parseInt(d[0].substring(19),10):e.browser==="firefox"&&l!==-1&&(c=2147483637),c},a=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(){if(this._sctp=null,e.browser==="chrome"&&e.version>=76){const{sdpSemantics:l}=this.getConfiguration();l==="plan-b"&&Object.defineProperty(this,"sctp",{get(){return typeof this._sctp>"u"?null:this._sctp},enumerable:!0,configurable:!0})}if(n(arguments[0])){const l=i(arguments[0]),c=r(l),d=s(arguments[0],l);let u;c===0&&d===0?u=Number.POSITIVE_INFINITY:c===0||d===0?u=Math.max(c,d):u=Math.min(c,d);const m={};Object.defineProperty(m,"maxMessageSize",{get(){return u}}),this._sctp=m}return a.apply(this,arguments)}}function $c(t){if(!(t.RTCPeerConnection&&"createDataChannel"in t.RTCPeerConnection.prototype))return;function e(i,r){const s=i.send;i.send=function(){const o=arguments[0],l=o.length||o.size||o.byteLength;if(i.readyState==="open"&&r.sctp&&l>r.sctp.maxMessageSize)throw new TypeError("Message too large (can send a maximum of "+r.sctp.maxMessageSize+" bytes)");return s.apply(i,arguments)}}const n=t.RTCPeerConnection.prototype.createDataChannel;t.RTCPeerConnection.prototype.createDataChannel=function(){const r=n.apply(this,arguments);return e(r,this),r},Xs(t,"datachannel",i=>(e(i.channel,i.target),i))}function Hf(t){if(!t.RTCPeerConnection||"connectionState"in t.RTCPeerConnection.prototype)return;const e=t.RTCPeerConnection.prototype;Object.defineProperty(e,"connectionState",{get(){return{completed:"connected",checking:"connecting"}[this.iceConnectionState]||this.iceConnectionState},enumerable:!0,configurable:!0}),Object.defineProperty(e,"onconnectionstatechange",{get(){return this._onconnectionstatechange||null},set(n){this._onconnectionstatechange&&(this.removeEventListener("connectionstatechange",this._onconnectionstatechange),delete this._onconnectionstatechange),n&&this.addEventListener("connectionstatechange",this._onconnectionstatechange=n)},enumerable:!0,configurable:!0}),["setLocalDescription","setRemoteDescription"].forEach(n=>{const i=e[n];e[n]=function(){return this._connectionstatechangepoly||(this._connectionstatechangepoly=r=>{const s=r.target;if(s._lastConnectionState!==s.connectionState){s._lastConnectionState=s.connectionState;const a=new Event("connectionstatechange",r);s.dispatchEvent(a)}return r},this.addEventListener("iceconnectionstatechange",this._connectionstatechangepoly)),i.apply(this,arguments)}})}function jf(t,e){if(!t.RTCPeerConnection||e.browser==="chrome"&&e.version>=71||e.browser==="safari"&&e.version>=605)return;const n=t.RTCPeerConnection.prototype.setRemoteDescription;t.RTCPeerConnection.prototype.setRemoteDescription=function(r){if(r&&r.sdp&&r.sdp.indexOf(`
a=extmap-allow-mixed`)!==-1){const s=r.sdp.split(`
`).filter(a=>a.trim()!=="a=extmap-allow-mixed").join(`
`);t.RTCSessionDescription&&r instanceof t.RTCSessionDescription?arguments[0]=new t.RTCSessionDescription({type:r.type,sdp:s}):r.sdp=s}return n.apply(this,arguments)}}function Vc(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.addIceCandidate;!n||n.length===0||(t.RTCPeerConnection.prototype.addIceCandidate=function(){return arguments[0]?(e.browser==="chrome"&&e.version<78||e.browser==="firefox"&&e.version<68||e.browser==="safari")&&arguments[0]&&arguments[0].candidate===""?Promise.resolve():n.apply(this,arguments):(arguments[1]&&arguments[1].apply(null),Promise.resolve())})}function Gc(t,e){if(!(t.RTCPeerConnection&&t.RTCPeerConnection.prototype))return;const n=t.RTCPeerConnection.prototype.setLocalDescription;!n||n.length===0||(t.RTCPeerConnection.prototype.setLocalDescription=function(){let r=arguments[0]||{};if(typeof r!="object"||r.type&&r.sdp)return n.apply(this,arguments);if(r={type:r.type,sdp:r.sdp},!r.type)switch(this.signalingState){case"stable":case"have-local-offer":case"have-remote-pranswer":r.type="offer";break;default:r.type="answer";break}return r.sdp||r.type!=="offer"&&r.type!=="answer"?n.apply(this,[r]):(r.type==="offer"?this.createOffer:this.createAnswer).apply(this).then(a=>n.apply(this,[a]))})}var TR=Object.freeze({__proto__:null,removeExtmapAllowMixed:jf,shimAddIceCandidateNullOrEmpty:Vc,shimConnectionState:Hf,shimMaxMessageSize:Wc,shimParameterlessSetLocalDescription:Gc,shimRTCIceCandidate:jc,shimRTCIceCandidateRelayProtocol:zf,shimSendThrowTypeError:$c});function RR(){let{window:t}=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{shimChrome:!0,shimFirefox:!0,shimSafari:!0};const n=vC,i=bR(t),r={browserDetails:i,commonShim:TR,extractVersion:Hc,disableLog:SR,disableWarnings:CR,sdp:ER};switch(i.browser){case"chrome":if(!Ov||!Ff||!e.shimChrome)return n("Chrome shim is not included in this adapter release."),r;if(i.version===null)return n("Chrome shim can not determine version, not shimming."),r;n("adapter.js shimming chrome."),r.browserShim=Ov,Vc(t,i),Gc(t),yC(t,i),SC(t),Ff(t,i),CC(t),TC(t,i),bC(t),wC(t),kC(t),RC(t,i),jc(t),zf(t),Hf(t),Wc(t,i),$c(t),jf(t,i);break;case"firefox":if(!Iv||!Uf||!e.shimFirefox)return n("Firefox shim is not included in this adapter release."),r;n("adapter.js shimming firefox."),r.browserShim=Iv,Vc(t,i),Gc(t),xC(t,i),Uf(t,i),PC(t),LC(t),OC(t),IC(t),MC(t),DC(t),AC(t),NC(t),BC(t),jc(t),Hf(t),Wc(t,i),$c(t);break;case"safari":if(!Lv||!e.shimSafari)return n("Safari shim is not included in this adapter release."),r;n("adapter.js shimming safari."),r.browserShim=Lv,Vc(t,i),Gc(t),WC(t),VC(t),zC(t),FC(t),UC(t),$C(t),HC(t),GC(t),jc(t),zf(t),Wc(t,i),$c(t),jf(t,i);break;default:n("Unsupported browser!");break}return r}RR({window:typeof window>"u"?void 0:window});const xR=10,vc="lk_e2ee",PR="LKFrameEncryptionKey",OR={sharedKey:!1,ratchetSalt:PR,ratchetWindowSize:8,failureTolerance:xR};var is;(function(t){t.SetKey="setKey",t.RatchetRequest="ratchetRequest",t.KeyRatcheted="keyRatcheted"})(is||(is={}));var Mv;(function(t){t.KeyRatcheted="keyRatcheted"})(Mv||(Mv={}));var Vr;(function(t){t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError"})(Vr||(Vr={}));var Dv;(function(t){t.Error="cryptorError"})(Dv||(Dv={}));function IR(){return LR()||Wf()}function Wf(){return typeof window.RTCRtpScriptTransform<"u"}function LR(){return typeof window.RTCRtpSender<"u"&&typeof window.RTCRtpSender.prototype.createEncodedStreams<"u"}class IN extends xi.EventEmitter{constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};super(),this.onKeyRatcheted=(n,i)=>{_e.debug("key ratcheted event received",{material:n,keyIndex:i})},this.keyInfoMap=new Map,this.options=Object.assign(Object.assign({},OR),e),this.on(is.KeyRatcheted,this.onKeyRatcheted)}onSetEncryptionKey(e,n,i){const r={key:e,participantIdentity:n,keyIndex:i};this.keyInfoMap.set("".concat(n??"shared","-").concat(i??0),r),this.emit(is.SetKey,r)}getKeys(){return Array.from(this.keyInfoMap.values())}getOptions(){return this.options}ratchetKey(e,n){this.emit(is.RatchetRequest,e,n)}}class ca extends Error{constructor(e,n){super(n||"an error has occured"),this.code=e}}class xe extends ca{constructor(e,n,i){super(1,e),this.status=i,this.reason=n}}class Cm extends ca{constructor(e){super(21,e??"device is unsupported")}}class ri extends ca{constructor(e){super(20,e??"track is invalid")}}class MR extends ca{constructor(e){super(10,e??"unsupported server")}}class Ye extends ca{constructor(e){super(12,e??"unexpected connection state")}}class $f extends ca{constructor(e){super(13,e??"unable to negotiate")}}var kl;(function(t){t.PermissionDenied="PermissionDenied",t.NotFound="NotFound",t.DeviceInUse="DeviceInUse",t.Other="Other"})(kl||(kl={}));(function(t){function e(n){if(n&&"name"in n)return n.name==="NotFoundError"||n.name==="DevicesNotFoundError"?t.NotFound:n.name==="NotAllowedError"||n.name==="PermissionDeniedError"?t.PermissionDenied:n.name==="NotReadableError"||n.name==="TrackStartError"?t.DeviceInUse:t.Other}t.getFailure=e})(kl||(kl={}));var J;(function(t){t.Connected="connected",t.Reconnecting="reconnecting",t.Reconnected="reconnected",t.Disconnected="disconnected",t.ConnectionStateChanged="connectionStateChanged",t.StateChanged="connectionStateChanged",t.MediaDevicesChanged="mediaDevicesChanged",t.ParticipantConnected="participantConnected",t.ParticipantDisconnected="participantDisconnected",t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.LocalAudioSilenceDetected="localAudioSilenceDetected",t.ActiveSpeakersChanged="activeSpeakersChanged",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.RoomMetadataChanged="roomMetadataChanged",t.DataReceived="dataReceived",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.AudioPlaybackStatusChanged="audioPlaybackChanged",t.VideoPlaybackStatusChanged="videoPlaybackChanged",t.MediaDevicesError="mediaDevicesError",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.SignalConnected="signalConnected",t.RecordingStatusChanged="recordingStatusChanged",t.ParticipantEncryptionStatusChanged="participantEncryptionStatusChanged",t.EncryptionError="encryptionError",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ActiveDeviceChanged="activeDeviceChanged"})(J||(J={}));var Z;(function(t){t.TrackPublished="trackPublished",t.TrackSubscribed="trackSubscribed",t.TrackSubscriptionFailed="trackSubscriptionFailed",t.TrackUnpublished="trackUnpublished",t.TrackUnsubscribed="trackUnsubscribed",t.TrackMuted="trackMuted",t.TrackUnmuted="trackUnmuted",t.LocalTrackPublished="localTrackPublished",t.LocalTrackUnpublished="localTrackUnpublished",t.ParticipantMetadataChanged="participantMetadataChanged",t.ParticipantNameChanged="participantNameChanged",t.DataReceived="dataReceived",t.IsSpeakingChanged="isSpeakingChanged",t.ConnectionQualityChanged="connectionQualityChanged",t.TrackStreamStateChanged="trackStreamStateChanged",t.TrackSubscriptionPermissionChanged="trackSubscriptionPermissionChanged",t.TrackSubscriptionStatusChanged="trackSubscriptionStatusChanged",t.MediaDevicesError="mediaDevicesError",t.AudioStreamAcquired="audioStreamAcquired",t.ParticipantPermissionsChanged="participantPermissionsChanged",t.PCTrackAdded="pcTrackAdded"})(Z||(Z={}));var ue;(function(t){t.TransportsCreated="transportsCreated",t.Connected="connected",t.Disconnected="disconnected",t.Resuming="resuming",t.Resumed="resumed",t.Restarting="restarting",t.Restarted="restarted",t.SignalResumed="signalResumed",t.SignalRestarted="signalRestarted",t.Closing="closing",t.MediaTrackAdded="mediaTrackAdded",t.ActiveSpeakersUpdate="activeSpeakersUpdate",t.DataPacketReceived="dataPacketReceived",t.RTPVideoMapUpdate="rtpVideoMapUpdate",t.DCBufferStatusChanged="dcBufferStatusChanged",t.ParticipantUpdate="participantUpdate",t.RoomUpdate="roomUpdate",t.SpeakersChanged="speakersChanged",t.StreamStateChanged="streamStateChanged",t.ConnectionQualityUpdate="connectionQualityUpdate",t.SubscriptionError="subscriptionError",t.SubscriptionPermissionUpdate="subscriptionPermissionUpdate",t.RemoteMute="remoteMute",t.SubscribedQualityUpdate="subscribedQualityUpdate",t.LocalTrackUnpublished="localTrackUnpublished"})(ue||(ue={}));var re;(function(t){t.Message="message",t.Muted="muted",t.Unmuted="unmuted",t.Restarted="restarted",t.Ended="ended",t.Subscribed="subscribed",t.Unsubscribed="unsubscribed",t.UpdateSettings="updateSettings",t.UpdateSubscription="updateSubscription",t.AudioPlaybackStarted="audioPlaybackStarted",t.AudioPlaybackFailed="audioPlaybackFailed",t.AudioSilenceDetected="audioSilenceDetected",t.VisibilityChanged="visibilityChanged",t.VideoDimensionsChanged="videoDimensionsChanged",t.VideoPlaybackStarted="videoPlaybackStarted",t.VideoPlaybackFailed="videoPlaybackFailed",t.ElementAttached="elementAttached",t.ElementDetached="elementDetached",t.UpstreamPaused="upstreamPaused",t.UpstreamResumed="upstreamResumed",t.SubscriptionPermissionChanged="subscriptionPermissionChanged",t.SubscriptionStatusChanged="subscriptionStatusChanged",t.SubscriptionFailed="subscriptionFailed"})(re||(re={}));function bm(t,e,n){var i,r,s;e===void 0&&(e=50),n===void 0&&(n={});var a=(i=n.isImmediate)!=null&&i,o=(r=n.callback)!=null&&r,l=n.maxWait,c=Date.now(),d=[];function u(){if(l!==void 0){var v=Date.now()-c;if(v+e>=l)return l-v}return e}var m=function(){var v=[].slice.call(arguments),y=this;return new Promise(function(_,p){var f=a&&s===void 0;if(s!==void 0&&clearTimeout(s),s=setTimeout(function(){if(s=void 0,c=Date.now(),!a){var g=t.apply(y,v);o&&o(g),d.forEach(function(S){return(0,S.resolve)(g)}),d=[]}},u()),f){var h=t.apply(y,v);return o&&o(h),_(h)}d.push({resolve:_,reject:p})})};return m.cancel=function(v){s!==void 0&&clearTimeout(s),d.forEach(function(y){return(0,y.reject)(v)}),d=[]},m}const DR=/version\/(\d+(\.?_?\d+)+)/i;let uh;function yr(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;if(typeof t>"u"&&typeof navigator>"u")return;const n=(t??navigator.userAgent).toLowerCase();if(uh===void 0||e){const i=AR.find(r=>{let{test:s}=r;return s.test(n)});uh=i==null?void 0:i.describe(n)}return uh}const AR=[{test:/firefox|iceweasel|fxios/i,describe(t){return{name:"Firefox",version:dh(/(?:firefox|iceweasel|fxios)[\s/](\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("fxios")?"iOS":void 0}}},{test:/chrom|crios|crmo/i,describe(t){return{name:"Chrome",version:dh(/(?:chrome|chromium|crios|crmo)\/(\d+(\.?_?\d+)+)/i,t),os:t.toLowerCase().includes("crios")?"iOS":void 0}}},{test:/safari|applewebkit/i,describe(t){return{name:"Safari",version:dh(DR,t),os:t.includes("mobile/")?"iOS":"macOS"}}}];function dh(t,e){let n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:1;const i=e.match(t);return i&&i.length>=n&&i[n]||""}var NR="1.15.13";const BR=NR,FR=11;class ht{}ht.setTimeout=function(){return setTimeout(...arguments)};ht.setInterval=function(){return setInterval(...arguments)};ht.clearTimeout=function(){return clearTimeout(...arguments)};ht.clearInterval=function(){return clearInterval(...arguments)};class Ee{constructor(e,n,i,r,s){this.width=e,this.height=n,this.encoding={maxBitrate:i,maxFramerate:r,priority:s}}get resolution(){return{width:this.width,height:this.height,frameRate:this.encoding.maxFramerate,aspectRatio:this.width/this.height}}}const UR=["vp8","h264"],KC=["vp8","h264","vp9","av1"];function zR(t){return!!UR.find(e=>e===t)}var ku;(function(t){t.telephone={maxBitrate:12e3},t.speech={maxBitrate:2e4},t.music={maxBitrate:32e3},t.musicStereo={maxBitrate:48e3},t.musicHighQuality={maxBitrate:64e3},t.musicHighQualityStereo={maxBitrate:96e3}})(ku||(ku={}));const El={h90:new Ee(160,90,9e4,20),h180:new Ee(320,180,16e4,20),h216:new Ee(384,216,18e4,20),h360:new Ee(640,360,45e4,20),h540:new Ee(960,540,8e5,25),h720:new Ee(1280,720,17e5,30),h1080:new Ee(1920,1080,3e6,30),h1440:new Ee(2560,1440,5e6,30),h2160:new Ee(3840,2160,8e6,30)},Vf={h120:new Ee(160,120,7e4,20),h180:new Ee(240,180,125e3,20),h240:new Ee(320,240,14e4,20),h360:new Ee(480,360,33e4,20),h480:new Ee(640,480,5e5,20),h540:new Ee(720,540,6e5,25),h720:new Ee(960,720,13e5,30),h1080:new Ee(1440,1080,23e5,30),h1440:new Ee(1920,1440,38e5,30)},wm={h360fps3:new Ee(640,360,2e5,3,"medium"),h360fps15:new Ee(640,360,4e5,15,"medium"),h720fps5:new Ee(1280,720,8e5,5,"medium"),h720fps15:new Ee(1280,720,15e5,15,"medium"),h720fps30:new Ee(1280,720,2e6,30,"medium"),h1080fps15:new Ee(1920,1080,25e5,15,"medium"),h1080fps30:new Ee(1920,1080,5e6,30,"medium"),original:new Ee(0,0,7e6,30,"medium")};var wt;(function(t){t[t.PUBLISHER=0]="PUBLISHER",t[t.SUBSCRIBER=1]="SUBSCRIBER"})(wt||(wt={}));L.util.setEnumType(wt,"livekit.SignalTarget",[{no:0,name:"PUBLISHER"},{no:1,name:"SUBSCRIBER"}]);var js;(function(t){t[t.ACTIVE=0]="ACTIVE",t[t.PAUSED=1]="PAUSED"})(js||(js={}));L.util.setEnumType(js,"livekit.StreamState",[{no:0,name:"ACTIVE"},{no:1,name:"PAUSED"}]);var Eu;(function(t){t[t.UDP=0]="UDP",t[t.TCP=1]="TCP",t[t.TLS=2]="TLS"})(Eu||(Eu={}));L.util.setEnumType(Eu,"livekit.CandidateProtocol",[{no:0,name:"UDP"},{no:1,name:"TCP"},{no:2,name:"TLS"}]);class qi extends ae{constructor(e){super(),this.message={case:void 0},L.util.initPartial(e,this)}static fromBinary(e,n){return new qi().fromBinary(e,n)}static fromJson(e,n){return new qi().fromJson(e,n)}static fromJsonString(e,n){return new qi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(qi,e,n)}}qi.runtime=L;qi.typeName="livekit.SignalRequest";qi.fields=L.util.newFieldList(()=>[{no:1,name:"offer",kind:"message",T:Mt,oneof:"message"},{no:2,name:"answer",kind:"message",T:Mt,oneof:"message"},{no:3,name:"trickle",kind:"message",T:Fn,oneof:"message"},{no:4,name:"add_track",kind:"message",T:Bn,oneof:"message"},{no:5,name:"mute",kind:"message",T:Un,oneof:"message"},{no:6,name:"subscription",kind:"message",T:vn,oneof:"message"},{no:7,name:"track_setting",kind:"message",T:pi,oneof:"message"},{no:8,name:"leave",kind:"message",T:_n,oneof:"message"},{no:10,name:"update_layers",kind:"message",T:mi,oneof:"message"},{no:11,name:"subscription_permission",kind:"message",T:yi,oneof:"message"},{no:12,name:"sync_state",kind:"message",T:Si,oneof:"message"},{no:13,name:"simulate",kind:"message",T:ut,oneof:"message"},{no:14,name:"ping",kind:"scalar",T:3,oneof:"message"},{no:15,name:"update_metadata",kind:"message",T:gi,oneof:"message"},{no:16,name:"ping_req",kind:"message",T:bi,oneof:"message"}]);class fi extends ae{constructor(e){super(),this.message={case:void 0},L.util.initPartial(e,this)}static fromBinary(e,n){return new fi().fromBinary(e,n)}static fromJson(e,n){return new fi().fromJson(e,n)}static fromJsonString(e,n){return new fi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(fi,e,n)}}fi.runtime=L;fi.typeName="livekit.SignalResponse";fi.fields=L.util.newFieldList(()=>[{no:1,name:"join",kind:"message",T:Ji,oneof:"message"},{no:2,name:"answer",kind:"message",T:Mt,oneof:"message"},{no:3,name:"offer",kind:"message",T:Mt,oneof:"message"},{no:4,name:"trickle",kind:"message",T:Fn,oneof:"message"},{no:5,name:"update",kind:"message",T:Xi,oneof:"message"},{no:6,name:"track_published",kind:"message",T:zn,oneof:"message"},{no:8,name:"leave",kind:"message",T:_n,oneof:"message"},{no:9,name:"mute",kind:"message",T:Un,oneof:"message"},{no:10,name:"speakers_changed",kind:"message",T:Yi,oneof:"message"},{no:11,name:"room_update",kind:"message",T:Zi,oneof:"message"},{no:12,name:"connection_quality",kind:"message",T:tr,oneof:"message"},{no:13,name:"stream_state_update",kind:"message",T:ir,oneof:"message"},{no:14,name:"subscribed_quality_update",kind:"message",T:sr,oneof:"message"},{no:15,name:"subscription_permission_update",kind:"message",T:or,oneof:"message"},{no:16,name:"refresh_token",kind:"scalar",T:9,oneof:"message"},{no:17,name:"track_unpublished",kind:"message",T:Qi,oneof:"message"},{no:18,name:"pong",kind:"scalar",T:3,oneof:"message"},{no:19,name:"reconnect",kind:"message",T:Ki,oneof:"message"},{no:20,name:"pong_resp",kind:"message",T:ar,oneof:"message"},{no:21,name:"subscription_response",kind:"message",T:cr,oneof:"message"}]);class Nn extends ae{constructor(e){super(),this.codec="",this.cid="",L.util.initPartial(e,this)}static fromBinary(e,n){return new Nn().fromBinary(e,n)}static fromJson(e,n){return new Nn().fromJson(e,n)}static fromJsonString(e,n){return new Nn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Nn,e,n)}}Nn.runtime=L;Nn.typeName="livekit.SimulcastCodec";Nn.fields=L.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"cid",kind:"scalar",T:9}]);class Bn extends ae{constructor(e){super(),this.cid="",this.name="",this.type=bt.AUDIO,this.width=0,this.height=0,this.muted=!1,this.disableDtx=!1,this.source=Ve.UNKNOWN,this.layers=[],this.simulcastCodecs=[],this.sid="",this.stereo=!1,this.disableRed=!1,this.encryption=dt.NONE,this.stream="",L.util.initPartial(e,this)}static fromBinary(e,n){return new Bn().fromBinary(e,n)}static fromJson(e,n){return new Bn().fromJson(e,n)}static fromJsonString(e,n){return new Bn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Bn,e,n)}}Bn.runtime=L;Bn.typeName="livekit.AddTrackRequest";Bn.fields=L.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9},{no:3,name:"type",kind:"enum",T:L.getEnumType(bt)},{no:4,name:"width",kind:"scalar",T:13},{no:5,name:"height",kind:"scalar",T:13},{no:6,name:"muted",kind:"scalar",T:8},{no:7,name:"disable_dtx",kind:"scalar",T:8},{no:8,name:"source",kind:"enum",T:L.getEnumType(Ve)},{no:9,name:"layers",kind:"message",T:Lt,repeated:!0},{no:10,name:"simulcast_codecs",kind:"message",T:Nn,repeated:!0},{no:11,name:"sid",kind:"scalar",T:9},{no:12,name:"stereo",kind:"scalar",T:8},{no:13,name:"disable_red",kind:"scalar",T:8},{no:14,name:"encryption",kind:"enum",T:L.getEnumType(dt)},{no:15,name:"stream",kind:"scalar",T:9}]);class Fn extends ae{constructor(e){super(),this.candidateInit="",this.target=wt.PUBLISHER,L.util.initPartial(e,this)}static fromBinary(e,n){return new Fn().fromBinary(e,n)}static fromJson(e,n){return new Fn().fromJson(e,n)}static fromJsonString(e,n){return new Fn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Fn,e,n)}}Fn.runtime=L;Fn.typeName="livekit.TrickleRequest";Fn.fields=L.util.newFieldList(()=>[{no:1,name:"candidateInit",kind:"scalar",T:9},{no:2,name:"target",kind:"enum",T:L.getEnumType(wt)}]);class Un extends ae{constructor(e){super(),this.sid="",this.muted=!1,L.util.initPartial(e,this)}static fromBinary(e,n){return new Un().fromBinary(e,n)}static fromJson(e,n){return new Un().fromJson(e,n)}static fromJsonString(e,n){return new Un().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Un,e,n)}}Un.runtime=L;Un.typeName="livekit.MuteTrackRequest";Un.fields=L.util.newFieldList(()=>[{no:1,name:"sid",kind:"scalar",T:9},{no:2,name:"muted",kind:"scalar",T:8}]);class Ji extends ae{constructor(e){super(),this.otherParticipants=[],this.serverVersion="",this.iceServers=[],this.subscriberPrimary=!1,this.alternativeUrl="",this.serverRegion="",this.pingTimeout=0,this.pingInterval=0,this.sifTrailer=new Uint8Array(0),L.util.initPartial(e,this)}static fromBinary(e,n){return new Ji().fromBinary(e,n)}static fromJson(e,n){return new Ji().fromJson(e,n)}static fromJsonString(e,n){return new Ji().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Ji,e,n)}}Ji.runtime=L;Ji.typeName="livekit.JoinResponse";Ji.fields=L.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:la},{no:2,name:"participant",kind:"message",T:nn},{no:3,name:"other_participants",kind:"message",T:nn,repeated:!0},{no:4,name:"server_version",kind:"scalar",T:9},{no:5,name:"ice_servers",kind:"message",T:vi,repeated:!0},{no:6,name:"subscriber_primary",kind:"scalar",T:8},{no:7,name:"alternative_url",kind:"scalar",T:9},{no:8,name:"client_configuration",kind:"message",T:ui},{no:9,name:"server_region",kind:"scalar",T:9},{no:10,name:"ping_timeout",kind:"scalar",T:5},{no:11,name:"ping_interval",kind:"scalar",T:5},{no:12,name:"server_info",kind:"message",T:$i},{no:13,name:"sif_trailer",kind:"scalar",T:12}]);class Ki extends ae{constructor(e){super(),this.iceServers=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new Ki().fromBinary(e,n)}static fromJson(e,n){return new Ki().fromJson(e,n)}static fromJsonString(e,n){return new Ki().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Ki,e,n)}}Ki.runtime=L;Ki.typeName="livekit.ReconnectResponse";Ki.fields=L.util.newFieldList(()=>[{no:1,name:"ice_servers",kind:"message",T:vi,repeated:!0},{no:2,name:"client_configuration",kind:"message",T:ui}]);class zn extends ae{constructor(e){super(),this.cid="",L.util.initPartial(e,this)}static fromBinary(e,n){return new zn().fromBinary(e,n)}static fromJson(e,n){return new zn().fromJson(e,n)}static fromJsonString(e,n){return new zn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(zn,e,n)}}zn.runtime=L;zn.typeName="livekit.TrackPublishedResponse";zn.fields=L.util.newFieldList(()=>[{no:1,name:"cid",kind:"scalar",T:9},{no:2,name:"track",kind:"message",T:$t}]);class Qi extends ae{constructor(e){super(),this.trackSid="",L.util.initPartial(e,this)}static fromBinary(e,n){return new Qi().fromBinary(e,n)}static fromJson(e,n){return new Qi().fromJson(e,n)}static fromJsonString(e,n){return new Qi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Qi,e,n)}}Qi.runtime=L;Qi.typeName="livekit.TrackUnpublishedResponse";Qi.fields=L.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9}]);class Mt extends ae{constructor(e){super(),this.type="",this.sdp="",L.util.initPartial(e,this)}static fromBinary(e,n){return new Mt().fromBinary(e,n)}static fromJson(e,n){return new Mt().fromJson(e,n)}static fromJsonString(e,n){return new Mt().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Mt,e,n)}}Mt.runtime=L;Mt.typeName="livekit.SessionDescription";Mt.fields=L.util.newFieldList(()=>[{no:1,name:"type",kind:"scalar",T:9},{no:2,name:"sdp",kind:"scalar",T:9}]);class Xi extends ae{constructor(e){super(),this.participants=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new Xi().fromBinary(e,n)}static fromJson(e,n){return new Xi().fromJson(e,n)}static fromJsonString(e,n){return new Xi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Xi,e,n)}}Xi.runtime=L;Xi.typeName="livekit.ParticipantUpdate";Xi.fields=L.util.newFieldList(()=>[{no:1,name:"participants",kind:"message",T:nn,repeated:!0}]);class vn extends ae{constructor(e){super(),this.trackSids=[],this.subscribe=!1,this.participantTracks=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new vn().fromBinary(e,n)}static fromJson(e,n){return new vn().fromJson(e,n)}static fromJsonString(e,n){return new vn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(vn,e,n)}}vn.runtime=L;vn.typeName="livekit.UpdateSubscription";vn.fields=L.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:2,name:"subscribe",kind:"scalar",T:8},{no:3,name:"participant_tracks",kind:"message",T:ci,repeated:!0}]);class pi extends ae{constructor(e){super(),this.trackSids=[],this.disabled=!1,this.quality=it.LOW,this.width=0,this.height=0,this.fps=0,this.priority=0,L.util.initPartial(e,this)}static fromBinary(e,n){return new pi().fromBinary(e,n)}static fromJson(e,n){return new pi().fromJson(e,n)}static fromJsonString(e,n){return new pi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(pi,e,n)}}pi.runtime=L;pi.typeName="livekit.UpdateTrackSettings";pi.fields=L.util.newFieldList(()=>[{no:1,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:3,name:"disabled",kind:"scalar",T:8},{no:4,name:"quality",kind:"enum",T:L.getEnumType(it)},{no:5,name:"width",kind:"scalar",T:13},{no:6,name:"height",kind:"scalar",T:13},{no:7,name:"fps",kind:"scalar",T:13},{no:8,name:"priority",kind:"scalar",T:13}]);class _n extends ae{constructor(e){super(),this.canReconnect=!1,this.reason=dr.UNKNOWN_REASON,L.util.initPartial(e,this)}static fromBinary(e,n){return new _n().fromBinary(e,n)}static fromJson(e,n){return new _n().fromJson(e,n)}static fromJsonString(e,n){return new _n().fromJsonString(e,n)}static equals(e,n){return L.util.equals(_n,e,n)}}_n.runtime=L;_n.typeName="livekit.LeaveRequest";_n.fields=L.util.newFieldList(()=>[{no:1,name:"can_reconnect",kind:"scalar",T:8},{no:2,name:"reason",kind:"enum",T:L.getEnumType(dr)}]);class mi extends ae{constructor(e){super(),this.trackSid="",this.layers=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new mi().fromBinary(e,n)}static fromJson(e,n){return new mi().fromJson(e,n)}static fromJsonString(e,n){return new mi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(mi,e,n)}}mi.runtime=L;mi.typeName="livekit.UpdateVideoLayers";mi.fields=L.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"layers",kind:"message",T:Lt,repeated:!0}]);class gi extends ae{constructor(e){super(),this.metadata="",this.name="",L.util.initPartial(e,this)}static fromBinary(e,n){return new gi().fromBinary(e,n)}static fromJson(e,n){return new gi().fromJson(e,n)}static fromJsonString(e,n){return new gi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(gi,e,n)}}gi.runtime=L;gi.typeName="livekit.UpdateParticipantMetadata";gi.fields=L.util.newFieldList(()=>[{no:1,name:"metadata",kind:"scalar",T:9},{no:2,name:"name",kind:"scalar",T:9}]);class vi extends ae{constructor(e){super(),this.urls=[],this.username="",this.credential="",L.util.initPartial(e,this)}static fromBinary(e,n){return new vi().fromBinary(e,n)}static fromJson(e,n){return new vi().fromJson(e,n)}static fromJsonString(e,n){return new vi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(vi,e,n)}}vi.runtime=L;vi.typeName="livekit.ICEServer";vi.fields=L.util.newFieldList(()=>[{no:1,name:"urls",kind:"scalar",T:9,repeated:!0},{no:2,name:"username",kind:"scalar",T:9},{no:3,name:"credential",kind:"scalar",T:9}]);class Yi extends ae{constructor(e){super(),this.speakers=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new Yi().fromBinary(e,n)}static fromJson(e,n){return new Yi().fromJson(e,n)}static fromJsonString(e,n){return new Yi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Yi,e,n)}}Yi.runtime=L;Yi.typeName="livekit.SpeakersChanged";Yi.fields=L.util.newFieldList(()=>[{no:1,name:"speakers",kind:"message",T:ai,repeated:!0}]);class Zi extends ae{constructor(e){super(),L.util.initPartial(e,this)}static fromBinary(e,n){return new Zi().fromBinary(e,n)}static fromJson(e,n){return new Zi().fromJson(e,n)}static fromJsonString(e,n){return new Zi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Zi,e,n)}}Zi.runtime=L;Zi.typeName="livekit.RoomUpdate";Zi.fields=L.util.newFieldList(()=>[{no:1,name:"room",kind:"message",T:la}]);class er extends ae{constructor(e){super(),this.participantSid="",this.quality=zi.POOR,this.score=0,L.util.initPartial(e,this)}static fromBinary(e,n){return new er().fromBinary(e,n)}static fromJson(e,n){return new er().fromJson(e,n)}static fromJsonString(e,n){return new er().fromJsonString(e,n)}static equals(e,n){return L.util.equals(er,e,n)}}er.runtime=L;er.typeName="livekit.ConnectionQualityInfo";er.fields=L.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"quality",kind:"enum",T:L.getEnumType(zi)},{no:3,name:"score",kind:"scalar",T:2}]);class tr extends ae{constructor(e){super(),this.updates=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new tr().fromBinary(e,n)}static fromJson(e,n){return new tr().fromJson(e,n)}static fromJsonString(e,n){return new tr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(tr,e,n)}}tr.runtime=L;tr.typeName="livekit.ConnectionQualityUpdate";tr.fields=L.util.newFieldList(()=>[{no:1,name:"updates",kind:"message",T:er,repeated:!0}]);class nr extends ae{constructor(e){super(),this.participantSid="",this.trackSid="",this.state=js.ACTIVE,L.util.initPartial(e,this)}static fromBinary(e,n){return new nr().fromBinary(e,n)}static fromJson(e,n){return new nr().fromJson(e,n)}static fromJsonString(e,n){return new nr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(nr,e,n)}}nr.runtime=L;nr.typeName="livekit.StreamStateInfo";nr.fields=L.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"state",kind:"enum",T:L.getEnumType(js)}]);class ir extends ae{constructor(e){super(),this.streamStates=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new ir().fromBinary(e,n)}static fromJson(e,n){return new ir().fromJson(e,n)}static fromJsonString(e,n){return new ir().fromJsonString(e,n)}static equals(e,n){return L.util.equals(ir,e,n)}}ir.runtime=L;ir.typeName="livekit.StreamStateUpdate";ir.fields=L.util.newFieldList(()=>[{no:1,name:"stream_states",kind:"message",T:nr,repeated:!0}]);class Hn extends ae{constructor(e){super(),this.quality=it.LOW,this.enabled=!1,L.util.initPartial(e,this)}static fromBinary(e,n){return new Hn().fromBinary(e,n)}static fromJson(e,n){return new Hn().fromJson(e,n)}static fromJsonString(e,n){return new Hn().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Hn,e,n)}}Hn.runtime=L;Hn.typeName="livekit.SubscribedQuality";Hn.fields=L.util.newFieldList(()=>[{no:1,name:"quality",kind:"enum",T:L.getEnumType(it)},{no:2,name:"enabled",kind:"scalar",T:8}]);class rr extends ae{constructor(e){super(),this.codec="",this.qualities=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new rr().fromBinary(e,n)}static fromJson(e,n){return new rr().fromJson(e,n)}static fromJsonString(e,n){return new rr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(rr,e,n)}}rr.runtime=L;rr.typeName="livekit.SubscribedCodec";rr.fields=L.util.newFieldList(()=>[{no:1,name:"codec",kind:"scalar",T:9},{no:2,name:"qualities",kind:"message",T:Hn,repeated:!0}]);class sr extends ae{constructor(e){super(),this.trackSid="",this.subscribedQualities=[],this.subscribedCodecs=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new sr().fromBinary(e,n)}static fromJson(e,n){return new sr().fromJson(e,n)}static fromJsonString(e,n){return new sr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(sr,e,n)}}sr.runtime=L;sr.typeName="livekit.SubscribedQualityUpdate";sr.fields=L.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"subscribed_qualities",kind:"message",T:Hn,repeated:!0},{no:3,name:"subscribed_codecs",kind:"message",T:rr,repeated:!0}]);class _i extends ae{constructor(e){super(),this.participantSid="",this.allTracks=!1,this.trackSids=[],this.participantIdentity="",L.util.initPartial(e,this)}static fromBinary(e,n){return new _i().fromBinary(e,n)}static fromJson(e,n){return new _i().fromJson(e,n)}static fromJsonString(e,n){return new _i().fromJsonString(e,n)}static equals(e,n){return L.util.equals(_i,e,n)}}_i.runtime=L;_i.typeName="livekit.TrackPermission";_i.fields=L.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"all_tracks",kind:"scalar",T:8},{no:3,name:"track_sids",kind:"scalar",T:9,repeated:!0},{no:4,name:"participant_identity",kind:"scalar",T:9}]);class yi extends ae{constructor(e){super(),this.allParticipants=!1,this.trackPermissions=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new yi().fromBinary(e,n)}static fromJson(e,n){return new yi().fromJson(e,n)}static fromJsonString(e,n){return new yi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(yi,e,n)}}yi.runtime=L;yi.typeName="livekit.SubscriptionPermission";yi.fields=L.util.newFieldList(()=>[{no:1,name:"all_participants",kind:"scalar",T:8},{no:2,name:"track_permissions",kind:"message",T:_i,repeated:!0}]);class or extends ae{constructor(e){super(),this.participantSid="",this.trackSid="",this.allowed=!1,L.util.initPartial(e,this)}static fromBinary(e,n){return new or().fromBinary(e,n)}static fromJson(e,n){return new or().fromJson(e,n)}static fromJsonString(e,n){return new or().fromJsonString(e,n)}static equals(e,n){return L.util.equals(or,e,n)}}or.runtime=L;or.typeName="livekit.SubscriptionPermissionUpdate";or.fields=L.util.newFieldList(()=>[{no:1,name:"participant_sid",kind:"scalar",T:9},{no:2,name:"track_sid",kind:"scalar",T:9},{no:3,name:"allowed",kind:"scalar",T:8}]);class Si extends ae{constructor(e){super(),this.publishTracks=[],this.dataChannels=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new Si().fromBinary(e,n)}static fromJson(e,n){return new Si().fromJson(e,n)}static fromJsonString(e,n){return new Si().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Si,e,n)}}Si.runtime=L;Si.typeName="livekit.SyncState";Si.fields=L.util.newFieldList(()=>[{no:1,name:"answer",kind:"message",T:Mt},{no:2,name:"subscription",kind:"message",T:vn},{no:3,name:"publish_tracks",kind:"message",T:zn,repeated:!0},{no:4,name:"data_channels",kind:"message",T:Ci,repeated:!0},{no:5,name:"offer",kind:"message",T:Mt}]);class Ci extends ae{constructor(e){super(),this.label="",this.id=0,this.target=wt.PUBLISHER,L.util.initPartial(e,this)}static fromBinary(e,n){return new Ci().fromBinary(e,n)}static fromJson(e,n){return new Ci().fromJson(e,n)}static fromJsonString(e,n){return new Ci().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Ci,e,n)}}Ci.runtime=L;Ci.typeName="livekit.DataChannelInfo";Ci.fields=L.util.newFieldList(()=>[{no:1,name:"label",kind:"scalar",T:9},{no:2,name:"id",kind:"scalar",T:13},{no:3,name:"target",kind:"enum",T:L.getEnumType(wt)}]);class ut extends ae{constructor(e){super(),this.scenario={case:void 0},L.util.initPartial(e,this)}static fromBinary(e,n){return new ut().fromBinary(e,n)}static fromJson(e,n){return new ut().fromJson(e,n)}static fromJsonString(e,n){return new ut().fromJsonString(e,n)}static equals(e,n){return L.util.equals(ut,e,n)}}ut.runtime=L;ut.typeName="livekit.SimulateScenario";ut.fields=L.util.newFieldList(()=>[{no:1,name:"speaker_update",kind:"scalar",T:5,oneof:"scenario"},{no:2,name:"node_failure",kind:"scalar",T:8,oneof:"scenario"},{no:3,name:"migration",kind:"scalar",T:8,oneof:"scenario"},{no:4,name:"server_leave",kind:"scalar",T:8,oneof:"scenario"},{no:5,name:"switch_candidate_protocol",kind:"enum",T:L.getEnumType(Eu),oneof:"scenario"},{no:6,name:"subscriber_bandwidth",kind:"scalar",T:3,oneof:"scenario"},{no:7,name:"disconnect_signal_on_resume",kind:"scalar",T:8,oneof:"scenario"},{no:8,name:"disconnect_signal_on_resume_no_messages",kind:"scalar",T:8,oneof:"scenario"}]);class bi extends ae{constructor(e){super(),this.timestamp=pe.zero,this.rtt=pe.zero,L.util.initPartial(e,this)}static fromBinary(e,n){return new bi().fromBinary(e,n)}static fromJson(e,n){return new bi().fromJson(e,n)}static fromJsonString(e,n){return new bi().fromJsonString(e,n)}static equals(e,n){return L.util.equals(bi,e,n)}}bi.runtime=L;bi.typeName="livekit.Ping";bi.fields=L.util.newFieldList(()=>[{no:1,name:"timestamp",kind:"scalar",T:3},{no:2,name:"rtt",kind:"scalar",T:3}]);class ar extends ae{constructor(e){super(),this.lastPingTimestamp=pe.zero,this.timestamp=pe.zero,L.util.initPartial(e,this)}static fromBinary(e,n){return new ar().fromBinary(e,n)}static fromJson(e,n){return new ar().fromJson(e,n)}static fromJsonString(e,n){return new ar().fromJsonString(e,n)}static equals(e,n){return L.util.equals(ar,e,n)}}ar.runtime=L;ar.typeName="livekit.Pong";ar.fields=L.util.newFieldList(()=>[{no:1,name:"last_ping_timestamp",kind:"scalar",T:3},{no:2,name:"timestamp",kind:"scalar",T:3}]);class Gr extends ae{constructor(e){super(),this.regions=[],L.util.initPartial(e,this)}static fromBinary(e,n){return new Gr().fromBinary(e,n)}static fromJson(e,n){return new Gr().fromJson(e,n)}static fromJsonString(e,n){return new Gr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(Gr,e,n)}}Gr.runtime=L;Gr.typeName="livekit.RegionSettings";Gr.fields=L.util.newFieldList(()=>[{no:1,name:"regions",kind:"message",T:lr,repeated:!0}]);class lr extends ae{constructor(e){super(),this.region="",this.url="",this.distance=pe.zero,L.util.initPartial(e,this)}static fromBinary(e,n){return new lr().fromBinary(e,n)}static fromJson(e,n){return new lr().fromJson(e,n)}static fromJsonString(e,n){return new lr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(lr,e,n)}}lr.runtime=L;lr.typeName="livekit.RegionInfo";lr.fields=L.util.newFieldList(()=>[{no:1,name:"region",kind:"scalar",T:9},{no:2,name:"url",kind:"scalar",T:9},{no:3,name:"distance",kind:"scalar",T:3}]);class cr extends ae{constructor(e){super(),this.trackSid="",this.err=wl.SE_UNKNOWN,L.util.initPartial(e,this)}static fromBinary(e,n){return new cr().fromBinary(e,n)}static fromJson(e,n){return new cr().fromJson(e,n)}static fromJsonString(e,n){return new cr().fromJsonString(e,n)}static equals(e,n){return L.util.equals(cr,e,n)}}cr.runtime=L;cr.typeName="livekit.SubscriptionResponse";cr.fields=L.util.newFieldList(()=>[{no:1,name:"track_sid",kind:"scalar",T:9},{no:2,name:"err",kind:"enum",T:L.getEnumType(wl)}]);function HR(t){if(!(typeof t>"u"))return typeof structuredClone=="function"?structuredClone(t):JSON.parse(JSON.stringify(t))}const jR=5e3,La=[];class $ extends xi.EventEmitter{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var r;super(),this.attachedElements=[],this.isMuted=!1,this.streamState=$.StreamState.Active,this.isInBackground=!1,this._currentBitrate=0,this.log=_e,this.appVisibilityChangedListener=()=>{this.backgroundTimeout&&clearTimeout(this.backgroundTimeout),document.visibilityState==="hidden"?this.backgroundTimeout=setTimeout(()=>this.handleAppVisibilityChanged(),jR):this.handleAppVisibilityChanged()},this.log=_r((r=i.loggerName)!==null&&r!==void 0?r:Ei.Track),this.loggerContextCb=i.loggerContextCb,this.setMaxListeners(100),this.kind=n,this._mediaStreamTrack=e,this._mediaStreamID=e.id,this.source=$.Source.Unknown}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Le(this))}get currentBitrate(){return this._currentBitrate}get mediaStreamTrack(){return this._mediaStreamTrack}get mediaStreamID(){return this._mediaStreamID}attach(e){let n="audio";this.kind===$.Kind.Video&&(n="video"),this.attachedElements.length===0&&$.Kind.Video&&this.addAppVisibilityListener(),e||(n==="audio"&&(La.forEach(s=>{s.parentElement===null&&!e&&(e=s)}),e&&La.splice(La.indexOf(e),1)),e||(e=document.createElement(n))),this.attachedElements.includes(e)||this.attachedElements.push(e),go(this.mediaStreamTrack,e);const i=e.srcObject.getTracks(),r=i.some(s=>s.kind==="audio");return e.play().then(()=>{this.emit(r?re.AudioPlaybackStarted:re.VideoPlaybackStarted)}).catch(s=>{s.name==="NotAllowedError"?this.emit(r?re.AudioPlaybackFailed:re.VideoPlaybackFailed,s):s.name==="AbortError"?_e.debug("".concat(r?"audio":"video"," playback aborted, likely due to new play request")):_e.warn("could not playback ".concat(r?"audio":"video"),s),r&&e&&i.some(a=>a.kind==="video")&&s.name==="NotAllowedError"&&(e.muted=!0,e.play().catch(()=>{}))}),this.emit(re.ElementAttached,e),e}detach(e){try{if(e){Ro(this.mediaStreamTrack,e);const i=this.attachedElements.indexOf(e);return i>=0&&(this.attachedElements.splice(i,1),this.recycleElement(e),this.emit(re.ElementDetached,e)),e}const n=[];return this.attachedElements.forEach(i=>{Ro(this.mediaStreamTrack,i),n.push(i),this.recycleElement(i),this.emit(re.ElementDetached,i)}),this.attachedElements=[],n}finally{this.attachedElements.length===0&&this.removeAppVisibilityListener()}}stop(){this.stopMonitor(),this._mediaStreamTrack.stop()}enable(){this._mediaStreamTrack.enabled=!0}disable(){this._mediaStreamTrack.enabled=!1}stopMonitor(){this.monitorInterval&&clearInterval(this.monitorInterval)}updateLoggerOptions(e){e.loggerName&&(this.log=_r(e.loggerName)),e.loggerContextCb&&(this.loggerContextCb=e.loggerContextCb)}recycleElement(e){if(e instanceof HTMLAudioElement){let n=!0;e.pause(),La.forEach(i=>{i.parentElement||(n=!1)}),n&&La.push(e)}}handleAppVisibilityChanged(){return H(this,void 0,void 0,function*(){this.isInBackground=document.visibilityState==="hidden"})}addAppVisibilityListener(){Jt()?(this.isInBackground=document.visibilityState==="hidden",document.addEventListener("visibilitychange",this.appVisibilityChangedListener)):this.isInBackground=!1}removeAppVisibilityListener(){Jt()&&document.removeEventListener("visibilitychange",this.appVisibilityChangedListener)}}function go(t,e){let n;e.srcObject instanceof MediaStream?n=e.srcObject:n=new MediaStream;let i;t.kind==="audio"?i=n.getAudioTracks():i=n.getVideoTracks(),i.includes(t)||(i.forEach(r=>{n.removeTrack(r)}),n.addTrack(t)),(!Ws()||!(e instanceof HTMLVideoElement))&&(e.autoplay=!0),e.muted=n.getAudioTracks().length===0,e instanceof HTMLVideoElement&&(e.playsInline=!0),e.srcObject!==n&&(e.srcObject=n,(Ws()||Xo())&&e instanceof HTMLVideoElement&&setTimeout(()=>{e.srcObject=n,e.play().catch(()=>{})},0))}function Ro(t,e){if(e.srcObject instanceof MediaStream){const n=e.srcObject;n.removeTrack(t),n.getTracks().length>0?e.srcObject=n:e.srcObject=null}}(function(t){let e;(function(c){c.Audio="audio",c.Video="video",c.Unknown="unknown"})(e=t.Kind||(t.Kind={}));let n;(function(c){c.Camera="camera",c.Microphone="microphone",c.ScreenShare="screen_share",c.ScreenShareAudio="screen_share_audio",c.Unknown="unknown"})(n=t.Source||(t.Source={}));let i;(function(c){c.Active="active",c.Paused="paused",c.Unknown="unknown"})(i=t.StreamState||(t.StreamState={}));function r(c){switch(c){case e.Audio:return bt.AUDIO;case e.Video:return bt.VIDEO;default:return bt.DATA}}t.kindToProto=r;function s(c){switch(c){case bt.AUDIO:return e.Audio;case bt.VIDEO:return e.Video;default:return e.Unknown}}t.kindFromProto=s;function a(c){switch(c){case n.Camera:return Ve.CAMERA;case n.Microphone:return Ve.MICROPHONE;case n.ScreenShare:return Ve.SCREEN_SHARE;case n.ScreenShareAudio:return Ve.SCREEN_SHARE_AUDIO;default:return Ve.UNKNOWN}}t.sourceToProto=a;function o(c){switch(c){case Ve.CAMERA:return n.Camera;case Ve.MICROPHONE:return n.Microphone;case Ve.SCREEN_SHARE:return n.ScreenShare;case Ve.SCREEN_SHARE_AUDIO:return n.ScreenShareAudio;default:return n.Unknown}}t.sourceFromProto=o;function l(c){switch(c){case js.ACTIVE:return i.Active;case js.PAUSED:return i.Paused;default:return i.Unknown}}t.streamStateFromProto=l})($||($={}));function QC(t,e,n){var i;const r=(i=HR(t))!==null&&i!==void 0?i:{};return r.audio===!0&&(r.audio={}),r.video===!0&&(r.video={}),r.audio&&Gf(r.audio,e),r.video&&Gf(r.video,n),r}function Gf(t,e){return Object.keys(e).forEach(n=>{t[n]===void 0&&(t[n]=e[n])}),t}function ld(t){const e={};if(t.video)if(typeof t.video=="object"){const n={},i=n,r=t.video;Object.keys(r).forEach(s=>{switch(s){case"resolution":Gf(i,r.resolution);break;default:i[s]=r[s]}}),e.video=n}else e.video=t.video;else e.video=!1;return t.audio?typeof t.audio=="object"?e.audio=t.audio:e.audio=!0:e.audio=!1,e}function WR(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:200;return H(this,void 0,void 0,function*(){const n=XC();if(n){const i=n.createAnalyser();i.fftSize=2048;const r=i.frequencyBinCount,s=new Uint8Array(r);n.createMediaStreamSource(new MediaStream([t.mediaStreamTrack])).connect(i),yield hr(e),i.getByteTimeDomainData(s);const o=s.some(l=>l!==128&&l!==0);return n.close(),!o}return!1})}function XC(){const t=typeof window<"u"&&(window.AudioContext||window.webkitAudioContext);if(t)return new t({latencyHint:"interactive"})}function $R(t){return t===$.Source.Microphone?"audioinput":t===$.Source.Camera?"videoinput":void 0}function VR(t){var e,n;let i=(e=t.video)!==null&&e!==void 0?e:!0;return t.resolution&&t.resolution.width>0&&t.resolution.height>0&&(i=typeof i=="boolean"?{}:i,Ws()?i=Object.assign(Object.assign({},i),{width:{max:t.resolution.width},height:{max:t.resolution.height},frameRate:t.resolution.frameRate}):i=Object.assign(Object.assign({},i),{width:{ideal:t.resolution.width},height:{ideal:t.resolution.height},frameRate:t.resolution.frameRate})),{audio:(n=t.audio)!==null&&n!==void 0?n:!1,video:i,controller:t.controller,selfBrowserSurface:t.selfBrowserSurface,surfaceSwitching:t.surfaceSwitching,systemAudio:t.systemAudio}}function YC(t){const e=t.split("/")[1].toLowerCase();if(!KC.includes(e))throw Error("Video codec not supported: ".concat(e));return e}function GR(t){const e=[];return t.forEach(n=>{n.track!==void 0&&e.push(new zn({cid:n.track.mediaStreamID,track:n.trackInfo}))}),e}function Le(t){return t instanceof $?{trackSid:t.sid,trackSource:t.source,trackMuted:t.isMuted,trackEnabled:t.mediaStreamTrack.enabled,trackKind:t.kind}:{trackSid:t.trackSid,trackName:t.trackName,track:t.track?Le(t.track):void 0,trackEnabled:t.isEnabled,trackEncrypted:t.isEncrypted,trackMimeType:t.mimeType}}const qR="|",Av="https://aomediacodec.github.io/av1-rtp-spec/#dependency-descriptor-rtp-header-extension";function JR(t){const e=t.split(qR);return e.length>1?[e[0],t.substr(e[0].length+1)]:[t,""]}function hr(t){return H(this,void 0,void 0,function*(){return new Promise(e=>ht.setTimeout(e,t))})}function Nv(){return"addTransceiver"in RTCPeerConnection.prototype}function Bv(){return"addTrack"in RTCPeerConnection.prototype}function KR(){if(!("getCapabilities"in RTCRtpSender)||Ws())return!1;const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/AV1"){e=!0;break}}return e}function QR(){if(!("getCapabilities"in RTCRtpSender)||Xo())return!1;if(Ws()){const n=yr();if(n!=null&&n.version&&km(n.version,"16")<0)return!1}const t=RTCRtpSender.getCapabilities("video");let e=!1;if(t){for(const n of t.codecs)if(n.mimeType==="video/VP9"){e=!0;break}}return e}function tl(t){return t==="av1"||t==="vp9"}function qf(t){return document?(t||(t=document.createElement("audio")),"setSinkId"in t):!1}const XR={Chrome:"100",Safari:"15",Firefox:"100"};function YR(t){if(!Jt()||!("setCodecPreferences"in t))return!1;const e=yr();if(!(e!=null&&e.name)||!e.version)return!1;const n=XR[e.name];return n?km(e.version,n)>=0:!1}function Xo(){var t;return((t=yr())===null||t===void 0?void 0:t.name)==="Firefox"}function ZR(){var t;return((t=yr())===null||t===void 0?void 0:t.name)==="Chrome"}function Ws(){var t;return((t=yr())===null||t===void 0?void 0:t.name)==="Safari"}function ex(){const t=yr();return(t==null?void 0:t.name)==="Safari"&&t.version.startsWith("17.")}function ZC(){return Jt()?/Tablet|iPad|Mobile|Android|BlackBerry/.test(navigator.userAgent):!1}function Jt(){return typeof document<"u"}function $s(){return navigator.product=="ReactNative"}function Jf(t){return t.hostname.endsWith(".livekit.cloud")||t.hostname.endsWith(".livekit.run")}function eb(){if(global&&global.LiveKitReactNativeGlobal)return global.LiveKitReactNativeGlobal}function tb(){if(!$s())return;let t=eb();if(t)return t.platform}function Fv(){if(Jt())return window.devicePixelRatio;if($s()){let t=eb();if(t)return t.devicePixelRatio}return 1}function km(t,e){const n=t.split("."),i=e.split("."),r=Math.min(n.length,i.length);for(let s=0;s<r;++s){const a=parseInt(n[s],10),o=parseInt(i[s],10);if(a>o)return 1;if(a<o)return-1;if(s===r-1&&a===o)return 0}return t===""&&e!==""?-1:e===""?1:n.length==i.length?0:n.length<i.length?-1:1}function tx(t){for(const e of t)e.target.handleResize(e)}function nx(t){for(const e of t)e.target.handleVisibilityChanged(e)}let hh=null;const Uv=()=>(hh||(hh=new ResizeObserver(tx)),hh);let fh=null;const zv=()=>(fh||(fh=new IntersectionObserver(nx,{root:null,rootMargin:"0px"})),fh);function ix(){var t;const e=new Vi({sdk:Qo.JS,protocol:FR,version:BR});return $s()&&(e.os=(t=tb())!==null&&t!==void 0?t:""),e}function Hv(){let t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:16,e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:16,n=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1,i=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1;const r=document.createElement("canvas");r.width=t,r.height=e;const s=r.getContext("2d");s==null||s.fillRect(0,0,r.width,r.height),i&&s&&(s.beginPath(),s.arc(t/2,e/2,50,0,Math.PI*2,!0),s.closePath(),s.fillStyle="grey",s.fill());const a=r.captureStream(),[o]=a.getTracks();if(!o)throw Error("Could not get empty media stream video track");return o.enabled=n,o}let Ma;function ph(){if(!Ma){const t=new AudioContext,e=t.createOscillator(),n=t.createGain();n.gain.setValueAtTime(0,0);const i=t.createMediaStreamDestination();if(e.connect(n),n.connect(i),e.start(),[Ma]=i.stream.getAudioTracks(),!Ma)throw Error("Could not get empty media stream audio track");Ma.enabled=!1}return Ma.clone()}class nb{constructor(e,n){this.onFinally=n,this.promise=new Promise((i,r)=>H(this,void 0,void 0,function*(){this.resolve=i,this.reject=r,e&&(yield e(i,r))})).finally(()=>{var i;return(i=this.onFinally)===null||i===void 0?void 0:i.call(this)})}}class $n{constructor(){this._locking=Promise.resolve(),this._locks=0}isLocked(){return this._locks>0}lock(){this._locks+=1;let e;const n=new Promise(r=>e=()=>{this._locks-=1,r()}),i=this._locking.then(()=>e);return this._locking=this._locking.then(()=>n),i}}function rx(t){return KC.includes(t)}function Ms(t){if(typeof t=="string")return t;if(Array.isArray(t))return t[0];if(t.exact)return Array.isArray(t.exact)?t.exact[0]:t.exact;if(t.ideal)return Array.isArray(t.ideal)?t.ideal[0]:t.ideal;throw Error("could not unwrap constraint")}function sx(t){return t.startsWith("http")?t.replace(/^(http)/,"ws"):t}function jv(t){return t.startsWith("ws")?t.replace(/^(ws)/,"http"):t}const Wv="default";class Pt{static getInstance(){return this.instance===void 0&&(this.instance=new Pt),this.instance}getDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var i;return H(this,void 0,void 0,function*(){if(((i=Pt.userMediaPromiseMap)===null||i===void 0?void 0:i.size)>0){_e.debug("awaiting getUserMedia promise");try{e?yield Pt.userMediaPromiseMap.get(e):yield Promise.all(Pt.userMediaPromiseMap.values())}catch{_e.warn("error waiting for media permissons")}}let r=yield navigator.mediaDevices.enumerateDevices();if(n&&!(Ws()&&this.hasDeviceInUse(e))&&(r.length===0||r.some(a=>{const o=a.label==="",l=e?a.kind===e:!0;return o&&l}))){const a={video:e!=="audioinput"&&e!=="audiooutput",audio:e!=="videoinput"},o=yield navigator.mediaDevices.getUserMedia(a);r=yield navigator.mediaDevices.enumerateDevices(),o.getTracks().forEach(l=>{l.stop()})}return e&&(r=r.filter(s=>s.kind===e)),r})}normalizeDeviceId(e,n,i){return H(this,void 0,void 0,function*(){if(n!==Wv)return n;const s=(yield this.getDevices(e)).find(a=>a.groupId===i&&a.deviceId!==Wv);return s==null?void 0:s.deviceId})}hasDeviceInUse(e){return e?Pt.userMediaPromiseMap.has(e):Pt.userMediaPromiseMap.size>0}}Pt.mediaDeviceKinds=["audioinput","audiooutput","videoinput"];Pt.userMediaPromiseMap=new Map;const ox=1e3;class Yo extends ${get constraints(){return this._constraints}constructor(e,n,i){let r=arguments.length>3&&arguments[3]!==void 0?arguments[3]:!1,s=arguments.length>4?arguments[4]:void 0;super(e,n,s),this._isUpstreamPaused=!1,this.handleTrackMuteEvent=()=>this.debouncedTrackMuteHandler().catch(()=>this.log.debug("track mute bounce got cancelled by an unmute event",this.logContext)),this.debouncedTrackMuteHandler=bm(()=>H(this,void 0,void 0,function*(){yield this.pauseUpstream()}),5e3),this.handleTrackUnmuteEvent=()=>H(this,void 0,void 0,function*(){this.debouncedTrackMuteHandler.cancel("unmute"),yield this.resumeUpstream()}),this.handleEnded=()=>{this.isInBackground&&(this.reacquireTrack=!0),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),this.emit(re.Ended,this)},this.reacquireTrack=!1,this.providedByUser=r,this.muteLock=new $n,this.pauseUpstreamLock=new $n,this.processorLock=new $n,this.setMediaStreamTrack(e,!0),this._constraints=e.getConstraints(),i&&(this._constraints=i)}get id(){return this._mediaStreamTrack.id}get dimensions(){if(this.kind!==$.Kind.Video)return;const{width:e,height:n}=this._mediaStreamTrack.getSettings();if(e&&n)return{width:e,height:n}}get isUpstreamPaused(){return this._isUpstreamPaused}get isUserProvided(){return this.providedByUser}get mediaStreamTrack(){var e,n;return(n=(e=this.processor)===null||e===void 0?void 0:e.processedTrack)!==null&&n!==void 0?n:this._mediaStreamTrack}setMediaStreamTrack(e,n){return H(this,void 0,void 0,function*(){if(e===this._mediaStreamTrack&&!n)return;this._mediaStreamTrack&&(this.attachedElements.forEach(r=>{Ro(this._mediaStreamTrack,r)}),this.debouncedTrackMuteHandler.cancel("new-track"),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent)),this.mediaStream=new MediaStream([e]),e&&(e.addEventListener("ended",this.handleEnded),e.addEventListener("mute",this.handleTrackMuteEvent),e.addEventListener("unmute",this.handleTrackUnmuteEvent),this._constraints=e.getConstraints());let i;if(this.processor&&e&&this.processorElement){if(this.log.debug("restarting processor",this.logContext),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");go(e,this.processorElement),this.processorElement.muted=!0,yield this.processor.restart({track:e,kind:this.kind,element:this.processorElement}),i=this.processor.processedTrack}this.sender&&(yield this.sender.replaceTrack(i??e)),!this.providedByUser&&this._mediaStreamTrack!==e&&this._mediaStreamTrack.stop(),this._mediaStreamTrack=e,e&&(this._mediaStreamTrack.enabled=!this.isMuted,yield this.resumeUpstream(),this.attachedElements.forEach(r=>{go(i??e,r)}))})}waitForDimensions(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:ox;var n;return H(this,void 0,void 0,function*(){if(this.kind===$.Kind.Audio)throw new Error("cannot get dimensions for audio tracks");((n=yr())===null||n===void 0?void 0:n.os)==="iOS"&&(yield hr(10));const i=Date.now();for(;Date.now()-i<e;){const r=this.dimensions;if(r)return r;yield hr(50)}throw new ri("unable to get track dimensions after timeout")})}getDeviceId(){return H(this,void 0,void 0,function*(){if(this.source===$.Source.ScreenShare)return;const{deviceId:e,groupId:n}=this._mediaStreamTrack.getSettings(),i=this.kind===$.Kind.Audio?"audioinput":"videoinput";return Pt.getInstance().normalizeDeviceId(i,e,n)})}mute(){return H(this,void 0,void 0,function*(){return this.setTrackMuted(!0),this})}unmute(){return H(this,void 0,void 0,function*(){return this.setTrackMuted(!1),this})}replaceTrack(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return H(this,void 0,void 0,function*(){if(!this.sender)throw new ri("unable to replace an unpublished track");return this.log.debug("replace MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(e),this.providedByUser=n,this.processor&&(yield this.stopProcessor()),this})}restart(e){return H(this,void 0,void 0,function*(){e||(e=this._constraints),this.log.debug("restarting track with constraints",Object.assign(Object.assign({},this.logContext),{constraints:e}));const n={audio:!1,video:!1};this.kind===$.Kind.Video?n.video=e:n.audio=e,this.attachedElements.forEach(s=>{Ro(this.mediaStreamTrack,s)}),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.stop();const r=(yield navigator.mediaDevices.getUserMedia(n)).getTracks()[0];return r.addEventListener("ended",this.handleEnded),this.log.debug("re-acquired MediaStreamTrack",this.logContext),yield this.setMediaStreamTrack(r),this._constraints=e,this.emit(re.Restarted,this),this})}setTrackMuted(e){this.log.debug("setting ".concat(this.kind," track ").concat(e?"muted":"unmuted"),this.logContext),!(this.isMuted===e&&this._mediaStreamTrack.enabled!==e)&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?re.Muted:re.Unmuted,this))}get needsReAcquisition(){return this._mediaStreamTrack.readyState!=="live"||this._mediaStreamTrack.muted||!this._mediaStreamTrack.enabled||this.reacquireTrack}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return H(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),ZC()&&(this.log.debug("visibility changed, is in Background: ".concat(this.isInBackground),this.logContext),!this.isInBackground&&this.needsReAcquisition&&!this.isUserProvided&&!this.isMuted&&(this.log.debug("track needs to be reacquired, restarting ".concat(this.source),this.logContext),yield this.restart(),this.reacquireTrack=!1))})}stop(){var e;super.stop(),this._mediaStreamTrack.removeEventListener("ended",this.handleEnded),this._mediaStreamTrack.removeEventListener("mute",this.handleTrackMuteEvent),this._mediaStreamTrack.removeEventListener("unmute",this.handleTrackUnmuteEvent),(e=this.processor)===null||e===void 0||e.destroy(),this.processor=void 0}pauseUpstream(){return H(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!0)return;if(!this.sender){this.log.warn("unable to pause upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!0,this.emit(re.UpstreamPaused,this);const n=yr();if((n==null?void 0:n.name)==="Safari"&&km(n.version,"12.0")<0)throw new Cm("pauseUpstream is not supported on Safari < 12.");yield this.sender.replaceTrack(null)}finally{e()}})}resumeUpstream(){return H(this,void 0,void 0,function*(){const e=yield this.pauseUpstreamLock.lock();try{if(this._isUpstreamPaused===!1)return;if(!this.sender){this.log.warn("unable to resume upstream for an unpublished track",this.logContext);return}this._isUpstreamPaused=!1,this.emit(re.UpstreamResumed,this),yield this.sender.replaceTrack(this._mediaStreamTrack)}finally{e()}})}getRTCStatsReport(){var e;return H(this,void 0,void 0,function*(){return!((e=this.sender)===null||e===void 0)&&e.getStats?yield this.sender.getStats():void 0})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;var i,r;return H(this,void 0,void 0,function*(){const s=yield this.processorLock.lock();try{if(this.log.debug("setting up processor",this.logContext),this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");this.processorElement=(i=this.processorElement)!==null&&i!==void 0?i:document.createElement(this.kind),go(this._mediaStreamTrack,this.processorElement),this.processorElement.muted=!0,this.processorElement.play().catch(o=>this.log.error("failed to play processor element",Object.assign(Object.assign({},this.logContext),{error:o})));const a={kind:this.kind,track:this._mediaStreamTrack,element:this.processorElement};if(yield e.init(a),this.processor=e,this.processor.processedTrack){for(const o of this.attachedElements)o!==this.processorElement&&n&&(Ro(this._mediaStreamTrack,o),go(this.processor.processedTrack,o));yield(r=this.sender)===null||r===void 0?void 0:r.replaceTrack(this.processor.processedTrack)}}finally{s()}})}getProcessor(){return this.processor}stopProcessor(){var e,n;return H(this,void 0,void 0,function*(){this.processor&&(this.log.debug("stopping processor",this.logContext),(e=this.processor.processedTrack)===null||e===void 0||e.stop(),yield this.processor.destroy(),this.processor=void 0,(n=this.processorElement)===null||n===void 0||n.remove(),this.processorElement=void 0,yield this.restart())})}}class ax extends xi.EventEmitter{constructor(e){super(),this.onWorkerMessage=n=>{var i,r;const{kind:s,data:a}=n.data;switch(s){case"error":_e.error(a.error.message),this.emit(Vr.EncryptionError,a.error);break;case"initAck":a.enabled&&this.keyProvider.getKeys().forEach(o=>{this.postKey(o)});break;case"enable":if(this.encryptionEnabled!==a.enabled&&a.participantIdentity===((i=this.room)===null||i===void 0?void 0:i.localParticipant.identity))this.emit(Vr.ParticipantEncryptionStatusChanged,a.enabled,this.room.localParticipant),this.encryptionEnabled=a.enabled;else if(a.participantIdentity){const o=(r=this.room)===null||r===void 0?void 0:r.getParticipantByIdentity(a.participantIdentity);if(!o)throw TypeError("couldn't set encryption status, participant not found".concat(a.participantIdentity));this.emit(Vr.ParticipantEncryptionStatusChanged,a.enabled,o)}this.encryptionEnabled&&this.keyProvider.getKeys().forEach(o=>{this.postKey(o)});break;case"ratchetKey":this.keyProvider.emit(is.KeyRatcheted,a.material,a.keyIndex);break}},this.onWorkerError=n=>{_e.error("e2ee worker encountered an error:",{error:n.error}),this.emit(Vr.EncryptionError,n.error)},this.keyProvider=e.keyProvider,this.worker=e.worker,this.encryptionEnabled=!1}setup(e){if(!IR())throw new Cm("tried to setup end-to-end encryption on an unsupported browser");if(_e.info("setting up e2ee"),e!==this.room){this.room=e,this.setupEventListeners(e,this.keyProvider);const n={kind:"init",data:{keyProviderOptions:this.keyProvider.getOptions()}};this.worker&&(_e.info("initializing worker",{worker:this.worker}),this.worker.onmessage=this.onWorkerMessage,this.worker.onerror=this.onWorkerError,this.worker.postMessage(n))}}setParticipantCryptorEnabled(e,n){_e.debug("set e2ee to ".concat(e," for participant ").concat(n)),this.postEnable(e,n)}setSifTrailer(e){!e||e.length===0?_e.warn("ignoring server sent trailer as it's empty"):this.postSifTrailer(e)}setupEngine(e){e.on(ue.RTPVideoMapUpdate,n=>{this.postRTPMap(n)})}setupEventListeners(e,n){e.on(J.TrackPublished,(i,r)=>this.setParticipantCryptorEnabled(i.trackInfo.encryption!==dt.NONE,r.identity)),e.on(J.ConnectionStateChanged,i=>{i===ye.Connected&&e.participants.forEach(r=>{r.tracks.forEach(s=>{this.setParticipantCryptorEnabled(s.trackInfo.encryption!==dt.NONE,r.identity)})})}).on(J.TrackUnsubscribed,(i,r,s)=>{var a;const o={kind:"removeTransform",data:{participantIdentity:s.identity,trackId:i.mediaStreamID}};(a=this.worker)===null||a===void 0||a.postMessage(o)}).on(J.TrackSubscribed,(i,r,s)=>{this.setupE2EEReceiver(i,s.identity,r.trackInfo)}).on(J.SignalConnected,()=>{if(!this.room)throw new TypeError("expected room to be present on signal connect");this.setParticipantCryptorEnabled(this.room.localParticipant.isE2EEEnabled,this.room.localParticipant.identity),n.getKeys().forEach(i=>{this.postKey(i)})}),e.localParticipant.on(Z.LocalTrackPublished,i=>H(this,void 0,void 0,function*(){this.setupE2EESender(i.track,i.track.sender)})),n.on(is.SetKey,i=>this.postKey(i)).on(is.RatchetRequest,(i,r)=>this.postRatchetRequest(i,r))}postRatchetRequest(e,n){if(!this.worker)throw Error("could not ratchet key, worker is missing");const i={kind:"ratchetRequest",data:{participantIdentity:e,keyIndex:n}};this.worker.postMessage(i)}postKey(e){let{key:n,participantIdentity:i,keyIndex:r}=e;var s;if(!this.worker)throw Error("could not set key, worker is missing");const a={kind:"setKey",data:{participantIdentity:i,isPublisher:i===((s=this.room)===null||s===void 0?void 0:s.localParticipant.identity),key:n,keyIndex:r}};this.worker.postMessage(a)}postEnable(e,n){if(this.worker){const i={kind:"enable",data:{enabled:e,participantIdentity:n}};this.worker.postMessage(i)}else throw new ReferenceError("failed to enable e2ee, worker is not ready")}postRTPMap(e){var n;if(!this.worker)throw TypeError("could not post rtp map, worker is missing");if(!(!((n=this.room)===null||n===void 0)&&n.localParticipant.identity))throw TypeError("could not post rtp map, local participant identity is missing");const i={kind:"setRTPMap",data:{map:e,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(i)}postSifTrailer(e){if(!this.worker)throw Error("could not post SIF trailer, worker is missing");const n={kind:"setSifTrailer",data:{trailer:e}};this.worker.postMessage(n)}setupE2EEReceiver(e,n,i){if(e.receiver){if(!(i!=null&&i.mimeType)||i.mimeType==="")throw new TypeError("MimeType missing from trackInfo, cannot set up E2EE cryptor");this.handleReceiver(e.receiver,e.mediaStreamID,n,e.kind==="video"?YC(i.mimeType):void 0)}}setupE2EESender(e,n){if(!(e instanceof Yo)||!n){n||_e.warn("early return because sender is not ready");return}this.handleSender(n,e.mediaStreamID,void 0)}handleReceiver(e,n,i,r){return H(this,void 0,void 0,function*(){if(this.worker){if(Wf()){const s={kind:"decode",participantIdentity:i,trackId:n,codec:r};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{if(vc in e&&r){const l={kind:"updateCodec",data:{trackId:n,codec:r,participantIdentity:i}};this.worker.postMessage(l);return}let s=e.writableStream,a=e.readableStream;if(!s||!a){const l=e.createEncodedStreams();e.writableStream=l.writable,s=l.writable,e.readableStream=l.readable,a=l.readable}const o={kind:"decode",data:{readableStream:a,writableStream:s,trackId:n,codec:r,participantIdentity:i}};this.worker.postMessage(o,[a,s])}e[vc]=!0}})}handleSender(e,n,i){var r;if(!(vc in e||!this.worker)){if(!(!((r=this.room)===null||r===void 0)&&r.localParticipant.identity)||this.room.localParticipant.identity==="")throw TypeError("local identity needs to be known in order to set up encrypted sender");if(Wf()){_e.info("initialize script transform");const s={kind:"encode",participantIdentity:this.room.localParticipant.identity,trackId:n,codec:i};e.transform=new RTCRtpScriptTransform(this.worker,s)}else{_e.info("initialize encoded streams");const s=e.createEncodedStreams(),a={kind:"encode",data:{readableStream:s.readable,writableStream:s.writable,codec:i,trackId:n,participantIdentity:this.room.localParticipant.identity}};this.worker.postMessage(a,[s.readable,s.writable])}e[vc]=!0}}}var nl;(function(t){t[t.WAITING=0]="WAITING",t[t.RUNNING=1]="RUNNING",t[t.COMPLETED=2]="COMPLETED"})(nl||(nl={}));class lx{constructor(){this.pendingTasks=new Map,this.taskMutex=new $n,this.nextTaskIndex=0}run(e){return H(this,void 0,void 0,function*(){const n={id:this.nextTaskIndex++,enqueuedAt:Date.now(),status:nl.WAITING};this.pendingTasks.set(n.id,n);const i=yield this.taskMutex.lock();try{return n.executedAt=Date.now(),n.status=nl.RUNNING,yield e()}finally{n.status=nl.COMPLETED,this.pendingTasks.delete(n.id),i()}})}flush(){return H(this,void 0,void 0,function*(){return this.run(()=>H(this,void 0,void 0,function*(){}))})}snapshot(){return Array.from(this.pendingTasks.values())}}const cx=["syncState","trickle","offer","answer","simulate","leave"];function ux(t){const e=cx.indexOf(t.case)>=0;return _e.trace("request allowed to bypass queue:",{canPass:e,req:t}),e}var je;(function(t){t[t.CONNECTING=0]="CONNECTING",t[t.CONNECTED=1]="CONNECTED",t[t.RECONNECTING=2]="RECONNECTING",t[t.DISCONNECTING=3]="DISCONNECTING",t[t.DISCONNECTED=4]="DISCONNECTED"})(je||(je={}));class Em{get currentState(){return this.state}get isDisconnected(){return this.state===je.DISCONNECTING||this.state===je.DISCONNECTED}get isEstablishingConnection(){return this.state===je.CONNECTING||this.state===je.RECONNECTING}constructor(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!1,n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var i;this.rtt=0,this.state=je.DISCONNECTED,this.log=_e,this.resetCallbacks=()=>{this.onAnswer=void 0,this.onLeave=void 0,this.onLocalTrackPublished=void 0,this.onLocalTrackUnpublished=void 0,this.onNegotiateRequested=void 0,this.onOffer=void 0,this.onRemoteMuteChanged=void 0,this.onSubscribedQualityUpdate=void 0,this.onTokenRefresh=void 0,this.onTrickle=void 0,this.onClose=void 0},this.log=_r((i=n.loggerName)!==null&&i!==void 0?i:Ei.Signal),this.loggerContextCb=n.loggerContextCb,this.useJSON=e,this.requestQueue=new lx,this.queuedRequests=[],this.closingLock=new $n,this.connectionLock=new $n,this.state=je.DISCONNECTED}get logContext(){var e,n;return(n=(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this))!==null&&n!==void 0?n:{}}join(e,n,i,r){return H(this,void 0,void 0,function*(){return this.state=je.CONNECTING,this.options=i,yield this.connect(e,n,i,r)})}reconnect(e,n,i,r){return H(this,void 0,void 0,function*(){if(!this.options){this.log.warn("attempted to reconnect without signal options being set, ignoring",this.logContext);return}return this.state=je.RECONNECTING,this.clearPingInterval(),yield this.connect(e,n,Object.assign(Object.assign({},this.options),{reconnect:!0,sid:i,reconnectReason:r}))})}connect(e,n,i,r){this.connectOptions=i,e=sx(e),e=e.replace(/\/$/,""),e+="/rtc";const s=ix(),a=dx(n,s,i);return new Promise((o,l)=>H(this,void 0,void 0,function*(){const c=yield this.connectionLock.lock();try{const d=()=>H(this,void 0,void 0,function*(){this.close(),clearTimeout(u),l(new xe("room connection has been cancelled (signal)"))}),u=setTimeout(()=>{this.close(),l(new xe("room connection has timed out (signal)"))},i.websocketTimeout);r!=null&&r.aborted&&d(),r==null||r.addEventListener("abort",d),this.log.debug("connecting to ".concat(e+a),this.logContext),this.ws&&(yield this.close(!1)),this.ws=new WebSocket(e+a),this.ws.binaryType="arraybuffer",this.ws.onopen=()=>{clearTimeout(u)},this.ws.onerror=m=>H(this,void 0,void 0,function*(){if(this.state!==je.CONNECTED){clearTimeout(u);try{const v=yield fetch("http".concat(e.substring(2),"/validate").concat(a));if(v.status.toFixed(0).startsWith("4")){const y=yield v.text();l(new xe(y,0,v.status))}else l(new xe("Internal error",2,v.status))}catch{l(new xe("server was not reachable",1))}return}this.handleWSError(m)}),this.ws.onmessage=m=>H(this,void 0,void 0,function*(){var v,y,_,p;let f;if(typeof m.data=="string"){const h=JSON.parse(m.data);f=fi.fromJson(h)}else if(m.data instanceof ArrayBuffer)f=fi.fromBinary(new Uint8Array(m.data));else{this.log.error("could not decode websocket message: ".concat(typeof m.data),this.logContext);return}if(this.state!==je.CONNECTED){let h=!1;if(((v=f.message)===null||v===void 0?void 0:v.case)==="join"?(this.state=je.CONNECTED,r==null||r.removeEventListener("abort",d),this.pingTimeoutDuration=f.message.value.pingTimeout,this.pingIntervalDuration=f.message.value.pingInterval,this.pingTimeoutDuration&&this.pingTimeoutDuration>0&&(this.log.debug("ping config",Object.assign(Object.assign({},this.logContext),{timeout:this.pingTimeoutDuration,interval:this.pingIntervalDuration})),this.startPingInterval()),o(f.message.value)):this.state===je.RECONNECTING&&f.message.case!=="leave"?(this.state=je.CONNECTED,r==null||r.removeEventListener("abort",d),this.startPingInterval(),((y=f.message)===null||y===void 0?void 0:y.case)==="reconnect"?o((_=f.message)===null||_===void 0?void 0:_.value):(o(),h=!0)):this.isEstablishingConnection&&f.message.case==="leave"?l(new xe("Received leave request while trying to (re)connect",4)):i.reconnect||l(new xe("did not receive join response, got ".concat((p=f.message)===null||p===void 0?void 0:p.case," instead"))),!h)return}this.signalLatency&&(yield hr(this.signalLatency)),this.handleSignalResponse(f)}),this.ws.onclose=m=>{this.isEstablishingConnection&&l(new xe("Websocket got closed during a (re)connection attempt")),this.log.warn("websocket closed",Object.assign(Object.assign({},this.logContext),{reason:m.reason,state:this.state})),this.handleOnClose(m.reason)}}finally{c()}}))}close(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return H(this,void 0,void 0,function*(){const n=yield this.closingLock.lock();try{if(e&&(this.state=je.DISCONNECTING),this.ws){this.ws.onmessage=null,this.ws.onopen=null,this.ws.onclose=null;const i=new Promise(r=>{this.ws?this.ws.onclose=()=>{r()}:r()});this.ws.readyState<this.ws.CLOSING&&(this.ws.close(),yield Promise.race([i,hr(250)])),this.ws=void 0}}finally{e&&(this.state=je.DISCONNECTED),this.clearPingInterval(),n()}})}sendOffer(e){this.log.debug("sending offer",Object.assign(Object.assign({},this.logContext),{offerSdp:e.sdp})),this.sendRequest({case:"offer",value:Tu(e)})}sendAnswer(e){return this.log.debug("sending answer",Object.assign(Object.assign({},this.logContext),{answerSdp:e.sdp})),this.sendRequest({case:"answer",value:Tu(e)})}sendIceCandidate(e,n){return this.log.trace("sending ice candidate",Object.assign(Object.assign({},this.logContext),{candidate:e})),this.sendRequest({case:"trickle",value:new Fn({candidateInit:JSON.stringify(e),target:n})})}sendMuteTrack(e,n){return this.sendRequest({case:"mute",value:new Un({sid:e,muted:n})})}sendAddTrack(e){return this.sendRequest({case:"addTrack",value:e})}sendUpdateLocalMetadata(e,n){return this.sendRequest({case:"updateMetadata",value:new gi({metadata:e,name:n})})}sendUpdateTrackSettings(e){this.sendRequest({case:"trackSetting",value:e})}sendUpdateSubscription(e){return this.sendRequest({case:"subscription",value:e})}sendSyncState(e){return this.sendRequest({case:"syncState",value:e})}sendUpdateVideoLayers(e,n){return this.sendRequest({case:"updateLayers",value:new mi({trackSid:e,layers:n})})}sendUpdateSubscriptionPermissions(e,n){return this.sendRequest({case:"subscriptionPermission",value:new yi({allParticipants:e,trackPermissions:n})})}sendSimulateScenario(e){return this.sendRequest({case:"simulate",value:e})}sendPing(){return Promise.all([this.sendRequest({case:"ping",value:pe.parse(Date.now())}),this.sendRequest({case:"pingReq",value:new bi({timestamp:pe.parse(Date.now()),rtt:pe.parse(this.rtt)})})])}sendLeave(){return this.sendRequest({case:"leave",value:new _n({canReconnect:!1,reason:dr.CLIENT_INITIATED})})}sendRequest(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!1;return H(this,void 0,void 0,function*(){if(!n&&!ux(e)&&this.state===je.RECONNECTING){this.queuedRequests.push(()=>H(this,void 0,void 0,function*(){yield this.sendRequest(e,!0)}));return}if(n||(yield this.requestQueue.flush()),this.signalLatency&&(yield hr(this.signalLatency)),!this.ws||this.ws.readyState!==this.ws.OPEN){this.log.error("cannot send signal request before connected, type: ".concat(e==null?void 0:e.case),this.logContext);return}const r=new qi({message:e});try{this.useJSON?this.ws.send(r.toJsonString()):this.ws.send(r.toBinary())}catch(s){this.log.error("error sending signal message",Object.assign(Object.assign({},this.logContext),{error:s}))}})}handleSignalResponse(e){var n,i;const r=e.message;if(r==null){this.log.debug("received unsupported message",this.logContext);return}let s=!1;if(r.case==="answer"){const a=$v(r.value);this.onAnswer&&this.onAnswer(a)}else if(r.case==="offer"){const a=$v(r.value);this.onOffer&&this.onOffer(a)}else if(r.case==="trickle"){const a=JSON.parse(r.value.candidateInit);this.onTrickle&&this.onTrickle(a,r.value.target)}else r.case==="update"?this.onParticipantUpdate&&this.onParticipantUpdate((n=r.value.participants)!==null&&n!==void 0?n:[]):r.case==="trackPublished"?this.onLocalTrackPublished&&this.onLocalTrackPublished(r.value):r.case==="speakersChanged"?this.onSpeakersChanged&&this.onSpeakersChanged((i=r.value.speakers)!==null&&i!==void 0?i:[]):r.case==="leave"?this.onLeave&&this.onLeave(r.value):r.case==="mute"?this.onRemoteMuteChanged&&this.onRemoteMuteChanged(r.value.sid,r.value.muted):r.case==="roomUpdate"?this.onRoomUpdate&&r.value.room&&this.onRoomUpdate(r.value.room):r.case==="connectionQuality"?this.onConnectionQuality&&this.onConnectionQuality(r.value):r.case==="streamStateUpdate"?this.onStreamStateUpdate&&this.onStreamStateUpdate(r.value):r.case==="subscribedQualityUpdate"?this.onSubscribedQualityUpdate&&this.onSubscribedQualityUpdate(r.value):r.case==="subscriptionPermissionUpdate"?this.onSubscriptionPermissionUpdate&&this.onSubscriptionPermissionUpdate(r.value):r.case==="refreshToken"?this.onTokenRefresh&&this.onTokenRefresh(r.value):r.case==="trackUnpublished"?this.onLocalTrackUnpublished&&this.onLocalTrackUnpublished(r.value):r.case==="subscriptionResponse"?this.onSubscriptionError&&this.onSubscriptionError(r.value):r.case==="pong"||(r.case==="pongResp"?(this.rtt=Date.now()-Number.parseInt(r.value.lastPingTimestamp.toString()),this.resetPingTimeout(),s=!0):this.log.debug("unsupported message",Object.assign(Object.assign({},this.logContext),{msgCase:r.case})));s||this.resetPingTimeout()}setReconnected(){for(;this.queuedRequests.length>0;){const e=this.queuedRequests.shift();e&&this.requestQueue.run(e)}}handleOnClose(e){return H(this,void 0,void 0,function*(){if(this.state===je.DISCONNECTED)return;const n=this.onClose;yield this.close(),this.log.debug("websocket connection closed: ".concat(e),Object.assign(Object.assign({},this.logContext),{reason:e})),n&&n(e)})}handleWSError(e){this.log.error("websocket error",Object.assign(Object.assign({},this.logContext),{error:e}))}resetPingTimeout(){if(this.clearPingTimeout(),!this.pingTimeoutDuration){this.log.warn("ping timeout duration not set",this.logContext);return}this.pingTimeout=ht.setTimeout(()=>{this.log.warn("ping timeout triggered. last pong received at: ".concat(new Date(Date.now()-this.pingTimeoutDuration*1e3).toUTCString()),this.logContext),this.handleOnClose("ping timeout")},this.pingTimeoutDuration*1e3)}clearPingTimeout(){this.pingTimeout&&ht.clearTimeout(this.pingTimeout)}startPingInterval(){if(this.clearPingInterval(),this.resetPingTimeout(),!this.pingIntervalDuration){this.log.warn("ping interval duration not set",this.logContext);return}this.log.debug("start ping interval",this.logContext),this.pingInterval=ht.setInterval(()=>{this.sendPing()},this.pingIntervalDuration*1e3)}clearPingInterval(){this.log.debug("clearing ping interval",this.logContext),this.clearPingTimeout(),this.pingInterval&&ht.clearInterval(this.pingInterval)}}function $v(t){const e={type:"offer",sdp:t.sdp};switch(t.type){case"answer":case"offer":case"pranswer":case"rollback":e.type=t.type;break}return e}function Tu(t){return new Mt({sdp:t.sdp,type:t.type})}function dx(t,e,n){var i;const r=new URLSearchParams;return r.set("access_token",t),n.reconnect&&(r.set("reconnect","1"),n.sid&&r.set("sid",n.sid)),r.set("auto_subscribe",n.autoSubscribe?"1":"0"),r.set("sdk",$s()?"reactnative":"js"),r.set("version",e.version),r.set("protocol",e.protocol.toString()),e.deviceModel&&r.set("device_model",e.deviceModel),e.os&&r.set("os",e.os),e.osVersion&&r.set("os_version",e.osVersion),e.browser&&r.set("browser",e.browser),e.browserVersion&&r.set("browser_version",e.browserVersion),n.publishOnly!==void 0&&r.set("publish",n.publishOnly),n.adaptiveStream&&r.set("adaptive_stream","1"),n.reconnectReason&&r.set("reconnect_reason",n.reconnectReason.toString()),!((i=navigator.connection)===null||i===void 0)&&i.type&&r.set("network",navigator.connection.type),"?".concat(r.toString())}var ib={},rb={exports:{}},Vv=rb.exports={v:[{name:"version",reg:/^(\d*)$/}],o:[{name:"origin",reg:/^(\S*) (\d*) (\d*) (\S*) IP(\d) (\S*)/,names:["username","sessionId","sessionVersion","netType","ipVer","address"],format:"%s %s %d %s IP%d %s"}],s:[{name:"name"}],i:[{name:"description"}],u:[{name:"uri"}],e:[{name:"email"}],p:[{name:"phone"}],z:[{name:"timezones"}],r:[{name:"repeats"}],t:[{name:"timing",reg:/^(\d*) (\d*)/,names:["start","stop"],format:"%d %d"}],c:[{name:"connection",reg:/^IN IP(\d) (\S*)/,names:["version","ip"],format:"IN IP%d %s"}],b:[{push:"bandwidth",reg:/^(TIAS|AS|CT|RR|RS):(\d*)/,names:["type","limit"],format:"%s:%s"}],m:[{reg:/^(\w*) (\d*) ([\w/]*)(?: (.*))?/,names:["type","port","protocol","payloads"],format:"%s %d %s %s"}],a:[{push:"rtp",reg:/^rtpmap:(\d*) ([\w\-.]*)(?:\s*\/(\d*)(?:\s*\/(\S*))?)?/,names:["payload","codec","rate","encoding"],format:function(t){return t.encoding?"rtpmap:%d %s/%s/%s":t.rate?"rtpmap:%d %s/%s":"rtpmap:%d %s"}},{push:"fmtp",reg:/^fmtp:(\d*) ([\S| ]*)/,names:["payload","config"],format:"fmtp:%d %s"},{name:"control",reg:/^control:(.*)/,format:"control:%s"},{name:"rtcp",reg:/^rtcp:(\d*)(?: (\S*) IP(\d) (\S*))?/,names:["port","netType","ipVer","address"],format:function(t){return t.address!=null?"rtcp:%d %s IP%d %s":"rtcp:%d"}},{push:"rtcpFbTrrInt",reg:/^rtcp-fb:(\*|\d*) trr-int (\d*)/,names:["payload","value"],format:"rtcp-fb:%s trr-int %d"},{push:"rtcpFb",reg:/^rtcp-fb:(\*|\d*) ([\w-_]*)(?: ([\w-_]*))?/,names:["payload","type","subtype"],format:function(t){return t.subtype!=null?"rtcp-fb:%s %s %s":"rtcp-fb:%s %s"}},{push:"ext",reg:/^extmap:(\d+)(?:\/(\w+))?(?: (urn:ietf:params:rtp-hdrext:encrypt))? (\S*)(?: (\S*))?/,names:["value","direction","encrypt-uri","uri","config"],format:function(t){return"extmap:%d"+(t.direction?"/%s":"%v")+(t["encrypt-uri"]?" %s":"%v")+" %s"+(t.config?" %s":"")}},{name:"extmapAllowMixed",reg:/^(extmap-allow-mixed)/},{push:"crypto",reg:/^crypto:(\d*) ([\w_]*) (\S*)(?: (\S*))?/,names:["id","suite","config","sessionConfig"],format:function(t){return t.sessionConfig!=null?"crypto:%d %s %s %s":"crypto:%d %s %s"}},{name:"setup",reg:/^setup:(\w*)/,format:"setup:%s"},{name:"connectionType",reg:/^connection:(new|existing)/,format:"connection:%s"},{name:"mid",reg:/^mid:([^\s]*)/,format:"mid:%s"},{name:"msid",reg:/^msid:(.*)/,format:"msid:%s"},{name:"ptime",reg:/^ptime:(\d*(?:\.\d*)*)/,format:"ptime:%d"},{name:"maxptime",reg:/^maxptime:(\d*(?:\.\d*)*)/,format:"maxptime:%d"},{name:"direction",reg:/^(sendrecv|recvonly|sendonly|inactive)/},{name:"icelite",reg:/^(ice-lite)/},{name:"iceUfrag",reg:/^ice-ufrag:(\S*)/,format:"ice-ufrag:%s"},{name:"icePwd",reg:/^ice-pwd:(\S*)/,format:"ice-pwd:%s"},{name:"fingerprint",reg:/^fingerprint:(\S*) (\S*)/,names:["type","hash"],format:"fingerprint:%s %s"},{push:"candidates",reg:/^candidate:(\S*) (\d*) (\S*) (\d*) (\S*) (\d*) typ (\S*)(?: raddr (\S*) rport (\d*))?(?: tcptype (\S*))?(?: generation (\d*))?(?: network-id (\d*))?(?: network-cost (\d*))?/,names:["foundation","component","transport","priority","ip","port","type","raddr","rport","tcptype","generation","network-id","network-cost"],format:function(t){var e="candidate:%s %d %s %d %s %d typ %s";return e+=t.raddr!=null?" raddr %s rport %d":"%v%v",e+=t.tcptype!=null?" tcptype %s":"%v",t.generation!=null&&(e+=" generation %d"),e+=t["network-id"]!=null?" network-id %d":"%v",e+=t["network-cost"]!=null?" network-cost %d":"%v",e}},{name:"endOfCandidates",reg:/^(end-of-candidates)/},{name:"remoteCandidates",reg:/^remote-candidates:(.*)/,format:"remote-candidates:%s"},{name:"iceOptions",reg:/^ice-options:(\S*)/,format:"ice-options:%s"},{push:"ssrcs",reg:/^ssrc:(\d*) ([\w_-]*)(?::(.*))?/,names:["id","attribute","value"],format:function(t){var e="ssrc:%d";return t.attribute!=null&&(e+=" %s",t.value!=null&&(e+=":%s")),e}},{push:"ssrcGroups",reg:/^ssrc-group:([\x21\x23\x24\x25\x26\x27\x2A\x2B\x2D\x2E\w]*) (.*)/,names:["semantics","ssrcs"],format:"ssrc-group:%s %s"},{name:"msidSemantic",reg:/^msid-semantic:\s?(\w*) (\S*)/,names:["semantic","token"],format:"msid-semantic: %s %s"},{push:"groups",reg:/^group:(\w*) (.*)/,names:["type","mids"],format:"group:%s %s"},{name:"rtcpMux",reg:/^(rtcp-mux)/},{name:"rtcpRsize",reg:/^(rtcp-rsize)/},{name:"sctpmap",reg:/^sctpmap:([\w_/]*) (\S*)(?: (\S*))?/,names:["sctpmapNumber","app","maxMessageSize"],format:function(t){return t.maxMessageSize!=null?"sctpmap:%s %s %s":"sctpmap:%s %s"}},{name:"xGoogleFlag",reg:/^x-google-flag:([^\s]*)/,format:"x-google-flag:%s"},{push:"rids",reg:/^rid:([\d\w]+) (\w+)(?: ([\S| ]*))?/,names:["id","direction","params"],format:function(t){return t.params?"rid:%s %s %s":"rid:%s %s"}},{push:"imageattrs",reg:new RegExp("^imageattr:(\\d+|\\*)[\\s\\t]+(send|recv)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*)(?:[\\s\\t]+(recv|send)[\\s\\t]+(\\*|\\[\\S+\\](?:[\\s\\t]+\\[\\S+\\])*))?"),names:["pt","dir1","attrs1","dir2","attrs2"],format:function(t){return"imageattr:%s %s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast",reg:new RegExp("^simulcast:(send|recv) ([a-zA-Z0-9\\-_~;,]+)(?:\\s?(send|recv) ([a-zA-Z0-9\\-_~;,]+))?$"),names:["dir1","list1","dir2","list2"],format:function(t){return"simulcast:%s %s"+(t.dir2?" %s %s":"")}},{name:"simulcast_03",reg:/^simulcast:[\s\t]+([\S+\s\t]+)$/,names:["value"],format:"simulcast: %s"},{name:"framerate",reg:/^framerate:(\d+(?:$|\.\d+))/,format:"framerate:%s"},{name:"sourceFilter",reg:/^source-filter: *(excl|incl) (\S*) (IP4|IP6|\*) (\S*) (.*)/,names:["filterMode","netType","addressTypes","destAddress","srcList"],format:"source-filter: %s %s %s %s %s"},{name:"bundleOnly",reg:/^(bundle-only)/},{name:"label",reg:/^label:(.+)/,format:"label:%s"},{name:"sctpPort",reg:/^sctp-port:(\d+)$/,format:"sctp-port:%s"},{name:"maxMessageSize",reg:/^max-message-size:(\d+)$/,format:"max-message-size:%s"},{push:"tsRefClocks",reg:/^ts-refclk:([^\s=]*)(?:=(\S*))?/,names:["clksrc","clksrcExt"],format:function(t){return"ts-refclk:%s"+(t.clksrcExt!=null?"=%s":"")}},{name:"mediaClk",reg:/^mediaclk:(?:id=(\S*))? *([^\s=]*)(?:=(\S*))?(?: *rate=(\d+)\/(\d+))?/,names:["id","mediaClockName","mediaClockValue","rateNumerator","rateDenominator"],format:function(t){var e="mediaclk:";return e+=t.id!=null?"id=%s %s":"%v%s",e+=t.mediaClockValue!=null?"=%s":"",e+=t.rateNumerator!=null?" rate=%s":"",e+=t.rateDenominator!=null?"/%s":"",e}},{name:"keywords",reg:/^keywds:(.+)$/,format:"keywds:%s"},{name:"content",reg:/^content:(.+)/,format:"content:%s"},{name:"bfcpFloorCtrl",reg:/^floorctrl:(c-only|s-only|c-s)/,format:"floorctrl:%s"},{name:"bfcpConfId",reg:/^confid:(\d+)/,format:"confid:%s"},{name:"bfcpUserId",reg:/^userid:(\d+)/,format:"userid:%s"},{name:"bfcpFloorId",reg:/^floorid:(.+) (?:m-stream|mstrm):(.+)/,names:["id","mStream"],format:"floorid:%s mstrm:%s"},{push:"invalid",names:["value"]}]};Object.keys(Vv).forEach(function(t){var e=Vv[t];e.forEach(function(n){n.reg||(n.reg=/(.*)/),n.format||(n.format="%s")})});var sb=rb.exports;(function(t){var e=function(o){return String(Number(o))===o?Number(o):o},n=function(o,l,c,d){if(d&&!c)l[d]=e(o[1]);else for(var u=0;u<c.length;u+=1)o[u+1]!=null&&(l[c[u]]=e(o[u+1]))},i=function(o,l,c){var d=o.name&&o.names;o.push&&!l[o.push]?l[o.push]=[]:d&&!l[o.name]&&(l[o.name]={});var u=o.push?{}:d?l[o.name]:l;n(c.match(o.reg),u,o.names,o.name),o.push&&l[o.push].push(u)},r=sb,s=RegExp.prototype.test.bind(/^([a-z])=(.*)/);t.parse=function(o){var l={},c=[],d=l;return o.split(/(\r\n|\r|\n)/).filter(s).forEach(function(u){var m=u[0],v=u.slice(2);m==="m"&&(c.push({rtp:[],fmtp:[]}),d=c[c.length-1]);for(var y=0;y<(r[m]||[]).length;y+=1){var _=r[m][y];if(_.reg.test(v))return i(_,d,v)}}),l.media=c,l};var a=function(o,l){var c=l.split(/=(.+)/,2);return c.length===2?o[c[0]]=e(c[1]):c.length===1&&l.length>1&&(o[c[0]]=void 0),o};t.parseParams=function(o){return o.split(/;\s?/).reduce(a,{})},t.parseFmtpConfig=t.parseParams,t.parsePayloads=function(o){return o.toString().split(" ").map(Number)},t.parseRemoteCandidates=function(o){for(var l=[],c=o.split(" ").map(e),d=0;d<c.length;d+=3)l.push({component:c[d],ip:c[d+1],port:c[d+2]});return l},t.parseImageAttributes=function(o){return o.split(" ").map(function(l){return l.substring(1,l.length-1).split(",").reduce(a,{})})},t.parseSimulcastStreamList=function(o){return o.split(";").map(function(l){return l.split(",").map(function(c){var d,u=!1;return c[0]!=="~"?d=e(c):(d=e(c.substring(1,c.length)),u=!0),{scid:d,paused:u}})})}})(ib);var mh=sb,hx=/%[sdv%]/g,fx=function(t){var e=1,n=arguments,i=n.length;return t.replace(hx,function(r){if(e>=i)return r;var s=n[e];switch(e+=1,r){case"%%":return"%";case"%s":return String(s);case"%d":return Number(s);case"%v":return""}})},Da=function(t,e,n){var i=e.format instanceof Function?e.format(e.push?n:n[e.name]):e.format,r=[t+"="+i];if(e.names)for(var s=0;s<e.names.length;s+=1){var a=e.names[s];e.name?r.push(n[e.name][a]):r.push(n[e.names[s]])}else r.push(n[e.name]);return fx.apply(null,r)},px=["v","o","s","i","u","e","p","c","b","t","r","z","a"],mx=["i","c","b","a"],gx=function(t,e){e=e||{},t.version==null&&(t.version=0),t.name==null&&(t.name=" "),t.media.forEach(function(s){s.payloads==null&&(s.payloads="")});var n=e.outerOrder||px,i=e.innerOrder||mx,r=[];return n.forEach(function(s){mh[s].forEach(function(a){a.name in t&&t[a.name]!=null?r.push(Da(s,a,t)):a.push in t&&t[a.push]!=null&&t[a.push].forEach(function(o){r.push(Da(s,a,o))})})}),t.media.forEach(function(s){r.push(Da("m",mh.m[0],s)),i.forEach(function(a){mh[a].forEach(function(o){o.name in s&&s[o.name]!=null?r.push(Da(a,o,s)):o.push in s&&s[o.push]!=null&&s[o.push].forEach(function(l){r.push(Da(a,o,l))})})})}),r.join(`\r
`)+`\r
`},vx=ib,_x=gx,gh=_x,Ha=vx.parse;const Gv=.7,xo={NegotiationStarted:"negotiationStarted",NegotiationComplete:"negotiationComplete",RTPVideoPayloadTypes:"rtpVideoPayloadTypes"};class qv extends xi.EventEmitter{get pc(){return this._pc||(this._pc=this.createPC()),this._pc}constructor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};var r;super(),this.log=_e,this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate=!1,this.trackBitrates=[],this.remoteStereoMids=[],this.remoteNackMids=[],this.negotiate=bm(s=>H(this,void 0,void 0,function*(){this.emit(xo.NegotiationStarted);try{yield this.createAndSendOffer()}catch(a){if(s)s(a);else throw a}}),100),this.close=()=>{this._pc&&(this._pc.close(),this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc.onicegatheringstatechange=null,this._pc.ondatachannel=null,this._pc.onnegotiationneeded=null,this._pc.onsignalingstatechange=null,this._pc.onicecandidate=null,this._pc.ondatachannel=null,this._pc.ontrack=null,this._pc.onconnectionstatechange=null,this._pc.oniceconnectionstatechange=null,this._pc=null)},this.log=_r((r=i.loggerName)!==null&&r!==void 0?r:Ei.PCTransport),this.loggerOptions=i,this.config=e,this.mediaConstraints=n,this._pc=this.createPC()}createPC(){const e=ZR()?new RTCPeerConnection(this.config,this.mediaConstraints):new RTCPeerConnection(this.config);return e.onicecandidate=n=>{var i;n.candidate&&((i=this.onIceCandidate)===null||i===void 0||i.call(this,n.candidate))},e.onicecandidateerror=n=>{var i;(i=this.onIceCandidateError)===null||i===void 0||i.call(this,n)},e.oniceconnectionstatechange=()=>{var n;(n=this.onIceConnectionStateChange)===null||n===void 0||n.call(this,e.iceConnectionState)},e.onsignalingstatechange=()=>{var n;(n=this.onSignalingStatechange)===null||n===void 0||n.call(this,e.signalingState)},e.onconnectionstatechange=()=>{var n;(n=this.onConnectionStateChange)===null||n===void 0||n.call(this,e.connectionState)},e.ondatachannel=n=>{var i;(i=this.onDataChannel)===null||i===void 0||i.call(this,n)},e.ontrack=n=>{var i;(i=this.onTrack)===null||i===void 0||i.call(this,n)},e}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}get isICEConnected(){return this._pc!==null&&(this.pc.iceConnectionState==="connected"||this.pc.iceConnectionState==="completed")}addIceCandidate(e){return H(this,void 0,void 0,function*(){if(this.pc.remoteDescription&&!this.restartingIce)return this.pc.addIceCandidate(e);this.pendingCandidates.push(e)})}setRemoteDescription(e){var n;return H(this,void 0,void 0,function*(){let i;if(e.type==="offer"){let{stereoMids:r,nackMids:s}=Sx(e);this.remoteStereoMids=r,this.remoteNackMids=s}else if(e.type==="answer"){const r=Ha((n=e.sdp)!==null&&n!==void 0?n:"");r.media.forEach(s=>{s.type==="audio"&&this.trackBitrates.some(a=>{if(!a.transceiver||s.mid!=a.transceiver.mid)return!1;let o=0;if(s.rtp.some(c=>c.codec.toUpperCase()===a.codec.toUpperCase()?(o=c.payload,!0):!1),o===0)return!0;let l=!1;for(const c of s.fmtp)if(c.payload===o){c.config=c.config.split(";").filter(d=>!d.includes("maxaveragebitrate")).join(";"),a.maxbr>0&&(c.config+=";maxaveragebitrate=".concat(a.maxbr*1e3)),l=!0;break}return l||a.maxbr>0&&s.fmtp.push({payload:o,config:"maxaveragebitrate=".concat(a.maxbr*1e3)}),!0})}),i=gh(r)}yield this.setMungedSDP(e,i,!0),this.pendingCandidates.forEach(r=>{this.pc.addIceCandidate(r)}),this.pendingCandidates=[],this.restartingIce=!1,this.renegotiate?(this.renegotiate=!1,yield this.createAndSendOffer()):e.type==="answer"&&(this.emit(xo.NegotiationComplete),e.sdp&&Ha(e.sdp).media.forEach(s=>{s.type==="video"&&this.emit(xo.RTPVideoPayloadTypes,s.rtp)}))})}createAndSendOffer(e){var n;return H(this,void 0,void 0,function*(){if(this.onOffer===void 0)return;if(e!=null&&e.iceRestart&&(this.log.debug("restarting ICE",this.logContext),this.restartingIce=!0),this._pc&&this._pc.signalingState==="have-local-offer"){const s=this._pc.remoteDescription;if(e!=null&&e.iceRestart&&s)yield this._pc.setRemoteDescription(s);else{this.renegotiate=!0;return}}else if(!this._pc||this._pc.signalingState==="closed"){this.log.warn("could not createOffer with closed peer connection",this.logContext);return}this.log.debug("starting to negotiate",this.logContext);const i=yield this.pc.createOffer(e),r=Ha((n=i.sdp)!==null&&n!==void 0?n:"");r.media.forEach(s=>{s.type==="audio"?Jv(s,[],[]):s.type==="video"&&(yx(s),this.trackBitrates.some(a=>{if(!s.msid||!a.cid||!s.msid.includes(a.cid))return!1;let o=0;if(s.rtp.some(c=>c.codec.toUpperCase()===a.codec.toUpperCase()?(o=c.payload,!0):!1),o===0)return!0;let l=!1;for(const c of s.fmtp)if(c.payload===o){c.config.includes("x-google-start-bitrate")||(c.config+=";x-google-start-bitrate=".concat(Math.round(a.maxbr*Gv))),c.config.includes("x-google-max-bitrate")||(c.config+=";x-google-max-bitrate=".concat(a.maxbr)),l=!0;break}return l||s.fmtp.push({payload:o,config:"x-google-start-bitrate=".concat(Math.round(a.maxbr*Gv),";x-google-max-bitrate=").concat(a.maxbr)}),!0}))}),yield this.setMungedSDP(i,gh(r)),this.onOffer(i)})}createAndSetAnswer(){var e;return H(this,void 0,void 0,function*(){const n=yield this.pc.createAnswer(),i=Ha((e=n.sdp)!==null&&e!==void 0?e:"");return i.media.forEach(r=>{r.type==="audio"&&Jv(r,this.remoteStereoMids,this.remoteNackMids)}),yield this.setMungedSDP(n,gh(i)),n})}createDataChannel(e,n){return this.pc.createDataChannel(e,n)}addTransceiver(e,n){return this.pc.addTransceiver(e,n)}addTrack(e){if(!this._pc)throw new Ye("PC closed, cannot add track");return this._pc.addTrack(e)}setTrackCodecBitrate(e){this.trackBitrates.push(e)}setConfiguration(e){var n;if(!this._pc)throw new Ye("PC closed, cannot configure");return(n=this._pc)===null||n===void 0?void 0:n.setConfiguration(e)}canRemoveTrack(){var e;return!!(!((e=this._pc)===null||e===void 0)&&e.removeTrack)}removeTrack(e){var n;return(n=this._pc)===null||n===void 0?void 0:n.removeTrack(e)}getConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.connectionState)!==null&&n!==void 0?n:"closed"}getICEConnectionState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.iceConnectionState)!==null&&n!==void 0?n:"closed"}getSignallingState(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.signalingState)!==null&&n!==void 0?n:"closed"}getTransceivers(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getTransceivers())!==null&&n!==void 0?n:[]}getSenders(){var e,n;return(n=(e=this._pc)===null||e===void 0?void 0:e.getSenders())!==null&&n!==void 0?n:[]}getLocalDescription(){var e;return(e=this._pc)===null||e===void 0?void 0:e.localDescription}getRemoteDescription(){var e;return(e=this.pc)===null||e===void 0?void 0:e.remoteDescription}getStats(){return this.pc.getStats()}getConnectedAddress(){var e;return H(this,void 0,void 0,function*(){if(!this._pc)return;let n="";const i=new Map,r=new Map;if((yield this._pc.getStats()).forEach(o=>{switch(o.type){case"transport":n=o.selectedCandidatePairId;break;case"candidate-pair":n===""&&o.selected&&(n=o.id),i.set(o.id,o);break;case"remote-candidate":r.set(o.id,"".concat(o.address,":").concat(o.port));break}}),n==="")return;const a=(e=i.get(n))===null||e===void 0?void 0:e.remoteCandidateId;if(a!==void 0)return r.get(a)})}setMungedSDP(e,n,i){return H(this,void 0,void 0,function*(){if(n){const r=e.sdp;e.sdp=n;try{this.log.debug("setting munged ".concat(i?"remote":"local"," description"),this.logContext),i?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e);return}catch(s){this.log.warn("not able to set ".concat(e.type,", falling back to unmodified sdp"),Object.assign(Object.assign({},this.logContext),{error:s,sdp:n})),e.sdp=r}}try{i?yield this.pc.setRemoteDescription(e):yield this.pc.setLocalDescription(e)}catch(r){let s="unknown error";r instanceof Error?s=r.message:typeof r=="string"&&(s=r);const a={error:s,sdp:e.sdp};throw!i&&this.pc.remoteDescription&&(a.remoteSdp=this.pc.remoteDescription),this.log.error("unable to set ".concat(e.type),Object.assign(Object.assign({},this.logContext),{fields:a})),new $f(s)}})}}function Jv(t,e,n){let i=0;t.rtp.some(r=>r.codec==="opus"?(i=r.payload,!0):!1),i>0&&(t.rtcpFb||(t.rtcpFb=[]),n.includes(t.mid)&&!t.rtcpFb.some(r=>r.payload===i&&r.type==="nack")&&t.rtcpFb.push({payload:i,type:"nack"}),e.includes(t.mid)&&t.fmtp.some(r=>r.payload===i?(r.config.includes("stereo=1")||(r.config+=";stereo=1"),!0):!1))}function yx(t){var e,n,i,r;const s=(n=(e=t.rtp[0])===null||e===void 0?void 0:e.codec)===null||n===void 0?void 0:n.toLowerCase();if(!tl(s))return;let a=0;((i=t.ext)===null||i===void 0?void 0:i.some(l=>l.uri===Av?!0:(l.value>a&&(a=l.value),!1)))||(r=t.ext)===null||r===void 0||r.push({value:a+1,uri:Av})}function Sx(t){var e;const n=[],i=[],r=Ha((e=t.sdp)!==null&&e!==void 0?e:"");let s=0;return r.media.forEach(a=>{var o;a.type==="audio"&&(a.rtp.some(l=>l.codec==="opus"?(s=l.payload,!0):!1),!((o=a.rtcpFb)===null||o===void 0)&&o.some(l=>l.payload===s&&l.type==="nack")&&i.push(a.mid),a.fmtp.some(l=>l.payload===s?(l.config.includes("sprop-stereo=1")&&n.push(a.mid),!0):!1))}),{stereoMids:n,nackMids:i}}const Kf="vp8",Cx={audioBitrate:ku.music.maxBitrate,audioPreset:ku.music,dtx:!0,red:!0,forceStereo:!1,simulcast:!0,screenShareEncoding:wm.h1080fps15.encoding,stopMicTrackOnMute:!1,videoCodec:Kf,backupCodec:!0},ob={autoGainControl:!0,echoCancellation:!0,noiseSuppression:!0},ab={resolution:El.h720.resolution},bx={adaptiveStream:!1,dynacast:!1,stopLocalTrackOnUnpublish:!0,reconnectPolicy:new fR,disconnectOnPageLeave:!0,expWebAudioMix:!1},Tm={autoSubscribe:!0,maxRetries:1,peerConnectionTimeout:15e3,websocketTimeout:15e3};var et;(function(t){t[t.NEW=0]="NEW",t[t.CONNECTING=1]="CONNECTING",t[t.CONNECTED=2]="CONNECTED",t[t.FAILED=3]="FAILED",t[t.CLOSING=4]="CLOSING",t[t.CLOSED=5]="CLOSED"})(et||(et={}));class wx{get needsPublisher(){return this.isPublisherConnectionRequired}get needsSubscriber(){return this.isSubscriberConnectionRequired}get currentState(){return this.state}constructor(e,n,i){var r;this.peerConnectionTimeout=Tm.peerConnectionTimeout,this.log=_e,this.updateState=()=>{var a;const o=this.state,l=this.requiredTransports.map(c=>c.getConnectionState());l.every(c=>c==="connected")?this.state=et.CONNECTED:l.some(c=>c==="failed")?this.state=et.FAILED:l.some(c=>c==="connecting")?this.state=et.CONNECTING:l.every(c=>c==="closed")?this.state=et.CLOSED:l.some(c=>c==="closed")?this.state=et.CLOSING:l.every(c=>c==="new")&&(this.state=et.NEW),o!==this.state&&(this.log.debug("pc state change: from ".concat(et[o]," to ").concat(et[this.state]),this.logContext),(a=this.onStateChange)===null||a===void 0||a.call(this,this.state,this.publisher.getConnectionState(),this.subscriber.getConnectionState()))},this.log=_r((r=i.loggerName)!==null&&r!==void 0?r:Ei.PCManager),this.loggerOptions=i,this.isPublisherConnectionRequired=!n,this.isSubscriberConnectionRequired=n;const s={optional:[{googDscp:!0}]};this.publisher=new qv(e,s,i),this.subscriber=new qv(e,void 0,i),this.publisher.onConnectionStateChange=this.updateState,this.subscriber.onConnectionStateChange=this.updateState,this.publisher.onIceConnectionStateChange=this.updateState,this.subscriber.onIceConnectionStateChange=this.updateState,this.publisher.onSignalingStatechange=this.updateState,this.subscriber.onSignalingStatechange=this.updateState,this.publisher.onIceCandidate=a=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,a,wt.PUBLISHER)},this.subscriber.onIceCandidate=a=>{var o;(o=this.onIceCandidate)===null||o===void 0||o.call(this,a,wt.SUBSCRIBER)},this.subscriber.onDataChannel=a=>{var o;(o=this.onDataChannel)===null||o===void 0||o.call(this,a)},this.subscriber.onTrack=a=>{var o;(o=this.onTrack)===null||o===void 0||o.call(this,a)},this.publisher.onOffer=a=>{var o;(o=this.onPublisherOffer)===null||o===void 0||o.call(this,a)},this.state=et.NEW,this.connectionLock=new $n}get logContext(){var e,n;return Object.assign({},(n=(e=this.loggerOptions).loggerContextCb)===null||n===void 0?void 0:n.call(e))}requirePublisher(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isPublisherConnectionRequired=e,this.updateState()}requireSubscriber(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;this.isSubscriberConnectionRequired=e,this.updateState()}createAndSendPublisherOffer(e){return this.publisher.createAndSendOffer(e)}setPublisherAnswer(e){return this.publisher.setRemoteDescription(e)}removeTrack(e){return this.publisher.removeTrack(e)}close(){return H(this,void 0,void 0,function*(){if(this.publisher&&this.publisher.getSignallingState()!=="closed"){const e=this.publisher;for(const n of e.getSenders())try{e.canRemoveTrack()&&e.removeTrack(n)}catch(i){this.log.warn("could not removeTrack",Object.assign(Object.assign({},this.logContext),{error:i}))}}yield Promise.all([this.publisher.close(),this.subscriber.close()]),this.updateState()})}triggerIceRestart(){return H(this,void 0,void 0,function*(){this.subscriber.restartingIce=!0,this.needsPublisher&&(yield this.createAndSendPublisherOffer({iceRestart:!0}))})}addIceCandidate(e,n){return H(this,void 0,void 0,function*(){n===wt.PUBLISHER?yield this.publisher.addIceCandidate(e):yield this.subscriber.addIceCandidate(e)})}createSubscriberAnswerFromOffer(e){return H(this,void 0,void 0,function*(){return this.log.debug("received server offer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type,sdp:e.sdp,signalingState:this.subscriber.getSignallingState().toString()})),yield this.subscriber.setRemoteDescription(e),yield this.subscriber.createAndSetAnswer()})}updateConfiguration(e,n){this.publisher.setConfiguration(e),this.subscriber.setConfiguration(e),n&&this.triggerIceRestart()}ensurePCTransportConnection(e,n){var i;return H(this,void 0,void 0,function*(){const r=yield this.connectionLock.lock();try{this.isPublisherConnectionRequired&&this.publisher.getConnectionState()!=="connected"&&this.publisher.getConnectionState()!=="connecting"&&(this.log.debug("negotiation required, start negotiating",this.logContext),this.publisher.negotiate()),yield Promise.all((i=this.requiredTransports)===null||i===void 0?void 0:i.map(s=>this.ensureTransportConnected(s,e,n)))}finally{r()}})}negotiate(e){return H(this,void 0,void 0,function*(){return new Promise((n,i)=>H(this,void 0,void 0,function*(){const r=setTimeout(()=>{i("negotiation timed out")},this.peerConnectionTimeout),s=()=>{clearTimeout(r),i("negotiation aborted")};e.signal.addEventListener("abort",s),this.publisher.once(xo.NegotiationStarted,()=>{e.signal.aborted||this.publisher.once(xo.NegotiationComplete,()=>{clearTimeout(r),n()})}),yield this.publisher.negotiate(a=>{clearTimeout(r),i(a)})}))})}addPublisherTransceiver(e,n){return this.publisher.addTransceiver(e,n)}addPublisherTrack(e){return this.publisher.addTrack(e)}createPublisherDataChannel(e,n){return this.publisher.createDataChannel(e,n)}getConnectedAddress(e){return e===wt.PUBLISHER?this.publisher.getConnectedAddress():e===wt.SUBSCRIBER?this.publisher.getConnectedAddress():this.requiredTransports[0].getConnectedAddress()}get requiredTransports(){const e=[];return this.isPublisherConnectionRequired&&e.push(this.publisher),this.isSubscriberConnectionRequired&&e.push(this.subscriber),e}ensureTransportConnected(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:this.peerConnectionTimeout;return H(this,void 0,void 0,function*(){if(e.getConnectionState()!=="connected")return new Promise((s,a)=>H(this,void 0,void 0,function*(){const o=()=>{this.log.warn("abort transport connection",this.logContext),ht.clearTimeout(l),a(new xe("room connection has been cancelled",3))};n!=null&&n.signal.aborted&&o(),n==null||n.signal.addEventListener("abort",o);const l=ht.setTimeout(()=>{n==null||n.signal.removeEventListener("abort",o),a(new xe("could not establish pc connection"))},i);for(;this.state!==et.CONNECTED;)if(yield hr(50),n!=null&&n.signal.aborted){a(new xe("room connection has been cancelled",3));return}ht.clearTimeout(l),n==null||n.signal.removeEventListener("abort",o),s()}))})}}const Kv="_lossy",Qv="_reliable",kx=2*1e3,Xv="leave-reconnect";var Rn;(function(t){t[t.New=0]="New",t[t.Connected=1]="Connected",t[t.Disconnected=2]="Disconnected",t[t.Reconnecting=3]="Reconnecting",t[t.Closed=4]="Closed"})(Rn||(Rn={}));class Ex extends xi.EventEmitter{get isClosed(){return this._isClosed}constructor(e){var n;super(),this.options=e,this.rtcConfig={},this.peerConnectionTimeout=Tm.peerConnectionTimeout,this.fullReconnectOnNext=!1,this.subscriberPrimary=!1,this.pcState=Rn.New,this._isClosed=!0,this.pendingTrackResolvers={},this.reconnectAttempts=0,this.reconnectStart=0,this.attemptingReconnect=!1,this.joinAttempts=0,this.maxJoinAttempts=1,this.shouldFailNext=!1,this.log=_e,this.handleDataChannel=i=>{let{channel:r}=i;return H(this,void 0,void 0,function*(){if(r){if(r.label===Qv)this.reliableDCSub=r;else if(r.label===Kv)this.lossyDCSub=r;else return;this.log.debug("on data channel ".concat(r.id,", ").concat(r.label),this.logContext),r.onmessage=this.handleDataMessage}})},this.handleDataMessage=i=>H(this,void 0,void 0,function*(){var r,s;const a=yield this.dataProcessLock.lock();try{let o;if(i.data instanceof ArrayBuffer)o=i.data;else if(i.data instanceof Blob)o=yield i.data.arrayBuffer();else{this.log.error("unsupported data type",Object.assign(Object.assign({},this.logContext),{data:i.data}));return}const l=oi.fromBinary(new Uint8Array(o));((r=l.value)===null||r===void 0?void 0:r.case)==="speaker"?this.emit(ue.ActiveSpeakersUpdate,l.value.value.speakers):((s=l.value)===null||s===void 0?void 0:s.case)==="user"&&this.emit(ue.DataPacketReceived,l.value.value,l.kind)}finally{a()}}),this.handleDataError=i=>{const s=i.currentTarget.maxRetransmits===0?"lossy":"reliable";if(i instanceof ErrorEvent&&i.error){const{error:a}=i.error;this.log.error("DataChannel error on ".concat(s,": ").concat(i.message),Object.assign(Object.assign({},this.logContext),{error:a}))}else this.log.error("Unknown DataChannel error on ".concat(s),Object.assign(Object.assign({},this.logContext),{event:i}))},this.handleBufferedAmountLow=i=>{const s=i.currentTarget.maxRetransmits===0?Ze.LOSSY:Ze.RELIABLE;this.updateAndEmitDCBufferStatus(s)},this.handleDisconnect=(i,r)=>{if(this._isClosed)return;this.log.warn("".concat(i," disconnected"),this.logContext),this.reconnectAttempts===0&&(this.reconnectStart=Date.now());const s=l=>{this.log.warn("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(l,"ms. giving up"),this.logContext),this.emit(ue.Disconnected),this.close()},a=Date.now()-this.reconnectStart;let o=this.getNextRetryDelay({elapsedMs:a,retryCount:this.reconnectAttempts});if(o===null){s(a);return}i===Xv&&(o=0),this.log.debug("reconnecting in ".concat(o,"ms"),this.logContext),this.clearReconnectTimeout(),this.token&&this.regionUrlProvider&&this.regionUrlProvider.updateToken(this.token),this.reconnectTimeout=ht.setTimeout(()=>this.attemptReconnect(r),o)},this.waitForRestarted=()=>new Promise((i,r)=>{this.pcState===Rn.Connected&&i();const s=()=>{this.off(ue.Disconnected,a),i()},a=()=>{this.off(ue.Restarted,s),r()};this.once(ue.Restarted,s),this.once(ue.Disconnected,a)}),this.updateAndEmitDCBufferStatus=i=>{const r=this.isBufferStatusLow(i);typeof r<"u"&&r!==this.dcBufferStatus.get(i)&&(this.dcBufferStatus.set(i,r),this.emit(ue.DCBufferStatusChanged,r,i))},this.isBufferStatusLow=i=>{const r=this.dataChannelForKind(i);if(r)return r.bufferedAmount<=r.bufferedAmountLowThreshold},this.handleBrowserOnLine=()=>{this.client.currentState===je.RECONNECTING&&(this.clearReconnectTimeout(),this.attemptReconnect(Ai.RR_SIGNAL_DISCONNECTED))},this.log=_r((n=e.loggerName)!==null&&n!==void 0?n:Ei.Engine),this.loggerOptions={loggerName:e.loggerName,loggerContextCb:()=>this.logContext},this.client=new Em(void 0,this.loggerOptions),this.client.signalLatency=this.options.expSignalLatency,this.reconnectPolicy=this.options.reconnectPolicy,this.registerOnLineListener(),this.closingLock=new $n,this.dataProcessLock=new $n,this.dcBufferStatus=new Map([[Ze.LOSSY,!0],[Ze.RELIABLE,!0]]),this.client.onParticipantUpdate=i=>this.emit(ue.ParticipantUpdate,i),this.client.onConnectionQuality=i=>this.emit(ue.ConnectionQualityUpdate,i),this.client.onRoomUpdate=i=>this.emit(ue.RoomUpdate,i),this.client.onSubscriptionError=i=>this.emit(ue.SubscriptionError,i),this.client.onSubscriptionPermissionUpdate=i=>this.emit(ue.SubscriptionPermissionUpdate,i),this.client.onSpeakersChanged=i=>this.emit(ue.SpeakersChanged,i),this.client.onStreamStateUpdate=i=>this.emit(ue.StreamStateChanged,i)}get logContext(){var e,n,i,r,s,a;return{room:(n=(e=this.latestJoinResponse)===null||e===void 0?void 0:e.room)===null||n===void 0?void 0:n.name,roomSid:(r=(i=this.latestJoinResponse)===null||i===void 0?void 0:i.room)===null||r===void 0?void 0:r.sid,identity:(a=(s=this.latestJoinResponse)===null||s===void 0?void 0:s.participant)===null||a===void 0?void 0:a.identity}}join(e,n,i,r){return H(this,void 0,void 0,function*(){this.url=e,this.token=n,this.signalOpts=i,this.maxJoinAttempts=i.maxRetries;try{this.joinAttempts+=1,this.setupSignalClientCallbacks();const s=yield this.client.join(e,n,i,r);return this._isClosed=!1,this.latestJoinResponse=s,this.subscriberPrimary=s.subscriberPrimary,this.pcManager||(yield this.configure(s)),this.subscriberPrimary||this.negotiate(),this.clientConfiguration=s.clientConfiguration,s}catch(s){if(s instanceof xe&&s.reason===1&&(this.log.warn("Couldn't connect to server, attempt ".concat(this.joinAttempts," of ").concat(this.maxJoinAttempts),this.logContext),this.joinAttempts<this.maxJoinAttempts))return this.join(e,n,i,r);throw s}})}close(){return H(this,void 0,void 0,function*(){const e=yield this.closingLock.lock();if(this.isClosed){e();return}try{this._isClosed=!0,this.emit(ue.Closing),this.removeAllListeners(),this.deregisterOnLineListener(),this.clearPendingReconnect(),yield this.cleanupPeerConnections(),yield this.cleanupClient()}finally{e()}})}cleanupPeerConnections(){var e;return H(this,void 0,void 0,function*(){yield(e=this.pcManager)===null||e===void 0?void 0:e.close(),this.pcManager=void 0;const n=i=>{i&&(i.close(),i.onbufferedamountlow=null,i.onclose=null,i.onclosing=null,i.onerror=null,i.onmessage=null,i.onopen=null)};n(this.lossyDC),n(this.lossyDCSub),n(this.reliableDC),n(this.reliableDCSub),this.lossyDC=void 0,this.lossyDCSub=void 0,this.reliableDC=void 0,this.reliableDCSub=void 0})}cleanupClient(){return H(this,void 0,void 0,function*(){yield this.client.close(),this.client.resetCallbacks()})}addTrack(e){if(this.pendingTrackResolvers[e.cid])throw new ri("a track with the same ID has already been published");return new Promise((n,i)=>{const r=setTimeout(()=>{delete this.pendingTrackResolvers[e.cid],i(new xe("publication of local track timed out, no response from server"))},1e4);this.pendingTrackResolvers[e.cid]={resolve:s=>{clearTimeout(r),n(s)},reject:()=>{clearTimeout(r),i(new Error("Cancelled publication by calling unpublish"))}},this.client.sendAddTrack(e)})}removeTrack(e){if(e.track&&this.pendingTrackResolvers[e.track.id]){const{reject:n}=this.pendingTrackResolvers[e.track.id];n&&n(),delete this.pendingTrackResolvers[e.track.id]}try{return this.pcManager.removeTrack(e),!0}catch(n){this.log.warn("failed to remove track",Object.assign(Object.assign({},this.logContext),{error:n}))}return!1}updateMuteStatus(e,n){this.client.sendMuteTrack(e,n)}get dataSubscriberReadyState(){var e;return(e=this.reliableDCSub)===null||e===void 0?void 0:e.readyState}getConnectedServerAddress(){var e;return H(this,void 0,void 0,function*(){return(e=this.pcManager)===null||e===void 0?void 0:e.getConnectedAddress()})}setRegionUrlProvider(e){this.regionUrlProvider=e}configure(e){var n;return H(this,void 0,void 0,function*(){if(this.pcManager&&this.pcManager.currentState!==et.NEW)return;this.participantSid=(n=e.participant)===null||n===void 0?void 0:n.sid;const i=this.makeRTCConfiguration(e);this.pcManager=new wx(i,e.subscriberPrimary,this.loggerOptions),this.emit(ue.TransportsCreated,this.pcManager.publisher,this.pcManager.subscriber),this.pcManager.onIceCandidate=(r,s)=>{this.client.sendIceCandidate(r,s)},this.pcManager.onPublisherOffer=r=>{this.client.sendOffer(r)},this.pcManager.onDataChannel=this.handleDataChannel,this.pcManager.onStateChange=(r,s,a)=>H(this,void 0,void 0,function*(){if(this.log.debug("primary PC state changed ".concat(r),this.logContext),r===et.CONNECTED){const o=this.pcState===Rn.New;this.pcState=Rn.Connected,o&&this.emit(ue.Connected,e)}else r===et.FAILED&&this.pcState===Rn.Connected&&(this.pcState=Rn.Disconnected,this.handleDisconnect("peerconnection failed",a==="failed"?Ai.RR_SUBSCRIBER_FAILED:Ai.RR_PUBLISHER_FAILED))}),this.pcManager.onTrack=r=>{this.emit(ue.MediaTrackAdded,r.track,r.streams[0],r.receiver)},this.createDataChannels()})}setupSignalClientCallbacks(){this.client.onAnswer=e=>H(this,void 0,void 0,function*(){this.pcManager&&(this.log.debug("received server answer",Object.assign(Object.assign({},this.logContext),{RTCSdpType:e.type})),yield this.pcManager.setPublisherAnswer(e))}),this.client.onTrickle=(e,n)=>{this.pcManager&&(this.log.trace("got ICE candidate from peer",Object.assign(Object.assign({},this.logContext),{candidate:e,target:n})),this.pcManager.addIceCandidate(e,n))},this.client.onOffer=e=>H(this,void 0,void 0,function*(){if(!this.pcManager)return;const n=yield this.pcManager.createSubscriberAnswerFromOffer(e);this.client.sendAnswer(n)}),this.client.onLocalTrackPublished=e=>{var n;if(this.log.debug("received trackPublishedResponse",Object.assign(Object.assign({},this.logContext),{cid:e.cid,track:(n=e.track)===null||n===void 0?void 0:n.sid})),!this.pendingTrackResolvers[e.cid]){this.log.error("missing track resolver for ".concat(e.cid),Object.assign(Object.assign({},this.logContext),{cid:e.cid}));return}const{resolve:i}=this.pendingTrackResolvers[e.cid];delete this.pendingTrackResolvers[e.cid],i(e.track)},this.client.onLocalTrackUnpublished=e=>{this.emit(ue.LocalTrackUnpublished,e)},this.client.onTokenRefresh=e=>{this.token=e},this.client.onRemoteMuteChanged=(e,n)=>{this.emit(ue.RemoteMute,e,n)},this.client.onSubscribedQualityUpdate=e=>{this.emit(ue.SubscribedQualityUpdate,e)},this.client.onClose=()=>{this.handleDisconnect("signal",Ai.RR_SIGNAL_DISCONNECTED)},this.client.onLeave=e=>{e!=null&&e.canReconnect?(this.fullReconnectOnNext=!0,this.handleDisconnect(Xv)):(this.emit(ue.Disconnected,e==null?void 0:e.reason),this.close()),this.log.debug("client leave request",Object.assign(Object.assign({},this.logContext),{reason:e==null?void 0:e.reason}))}}makeRTCConfiguration(e){var n;const i=Object.assign({},this.rtcConfig);if(!((n=this.signalOpts)===null||n===void 0)&&n.e2eeEnabled&&(this.log.debug("E2EE - setting up transports with insertable streams",this.logContext),i.encodedInsertableStreams=!0),e.iceServers&&!i.iceServers){const r=[];e.iceServers.forEach(s=>{const a={urls:s.urls};s.username&&(a.username=s.username),s.credential&&(a.credential=s.credential),r.push(a)}),i.iceServers=r}return e.clientConfiguration&&e.clientConfiguration.forceRelay===qn.ENABLED&&(i.iceTransportPolicy="relay"),i.sdpSemantics="unified-plan",i.continualGatheringPolicy="gather_continually",i}createDataChannels(){this.pcManager&&(this.lossyDC&&(this.lossyDC.onmessage=null,this.lossyDC.onerror=null),this.reliableDC&&(this.reliableDC.onmessage=null,this.reliableDC.onerror=null),this.lossyDC=this.pcManager.createPublisherDataChannel(Kv,{ordered:!0,maxRetransmits:0}),this.reliableDC=this.pcManager.createPublisherDataChannel(Qv,{ordered:!0}),this.lossyDC.onmessage=this.handleDataMessage,this.reliableDC.onmessage=this.handleDataMessage,this.lossyDC.onerror=this.handleDataError,this.reliableDC.onerror=this.handleDataError,this.lossyDC.bufferedAmountLowThreshold=65535,this.reliableDC.bufferedAmountLowThreshold=65535,this.lossyDC.onbufferedamountlow=this.handleBufferedAmountLow,this.reliableDC.onbufferedamountlow=this.handleBufferedAmountLow)}setPreferredCodec(e,n,i){if(!("getCapabilities"in RTCRtpReceiver))return;const r=RTCRtpReceiver.getCapabilities(n);if(!r)return;this.log.debug("get receiver capabilities",Object.assign(Object.assign({},this.logContext),{cap:r}));const s=[],a=[],o=[];r.codecs.forEach(l=>{const c=l.mimeType.toLowerCase();if(c==="audio/opus"){s.push(l);return}if(!(c==="video/".concat(i))){o.push(l);return}if(i==="h264"){l.sdpFmtpLine&&l.sdpFmtpLine.includes("profile-level-id=42e01f")?s.push(l):a.push(l);return}s.push(l)}),YR(e)&&e.setCodecPreferences(s.concat(a,o))}createSender(e,n,i){return H(this,void 0,void 0,function*(){if(Nv())return yield this.createTransceiverRTCRtpSender(e,n,i);if(Bv())return this.log.warn("using add-track fallback",this.logContext),yield this.createRTCRtpSender(e.mediaStreamTrack);throw new Ye("Required webRTC APIs not supported on this device")})}createSimulcastSender(e,n,i,r){return H(this,void 0,void 0,function*(){if(Nv())return this.createSimulcastTransceiverSender(e,n,i,r);if(Bv())return this.log.debug("using add-track fallback",this.logContext),this.createRTCRtpSender(e.mediaStreamTrack);throw new Ye("Cannot stream on this device")})}createTransceiverRTCRtpSender(e,n,i){return H(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ye("publisher is closed");const r=[];e.mediaStream&&r.push(e.mediaStream);const s={direction:"sendonly",streams:r};i&&(s.sendEncodings=i);const a=yield this.pcManager.addPublisherTransceiver(e.mediaStreamTrack,s);return e.kind===$.Kind.Video&&n.videoCodec&&(this.setPreferredCodec(a,e.kind,n.videoCodec),e.codec=n.videoCodec),a.sender})}createSimulcastTransceiverSender(e,n,i,r){return H(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ye("publisher is closed");const s={direction:"sendonly"};r&&(s.sendEncodings=r);const a=yield this.pcManager.addPublisherTransceiver(n.mediaStreamTrack,s);if(i.videoCodec)return this.setPreferredCodec(a,e.kind,i.videoCodec),e.setSimulcastTrackSender(i.videoCodec,a.sender),a.sender})}createRTCRtpSender(e){return H(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ye("publisher is closed");return this.pcManager.addPublisherTrack(e)})}attemptReconnect(e){var n,i,r;return H(this,void 0,void 0,function*(){if(!this._isClosed){if(this.attemptingReconnect){_e.warn("already attempting reconnect, returning early",this.logContext);return}(((n=this.clientConfiguration)===null||n===void 0?void 0:n.resumeConnection)===qn.DISABLED||((r=(i=this.pcManager)===null||i===void 0?void 0:i.currentState)!==null&&r!==void 0?r:et.NEW)===et.NEW)&&(this.fullReconnectOnNext=!0);try{this.attemptingReconnect=!0,this.fullReconnectOnNext?yield this.restartConnection():yield this.resumeConnection(e),this.clearPendingReconnect(),this.fullReconnectOnNext=!1}catch(s){this.reconnectAttempts+=1;let a=!0;s instanceof Ye?(this.log.debug("received unrecoverable error",Object.assign(Object.assign({},this.logContext),{error:s})),a=!1):s instanceof eo||(this.fullReconnectOnNext=!0),a?this.handleDisconnect("reconnect",Ai.RR_UNKNOWN):(this.log.info("could not recover connection after ".concat(this.reconnectAttempts," attempts, ").concat(Date.now()-this.reconnectStart,"ms. giving up"),this.logContext),this.emit(ue.Disconnected),yield this.close())}finally{this.attemptingReconnect=!1}}})}getNextRetryDelay(e){try{return this.reconnectPolicy.nextRetryDelayInMs(e)}catch(n){this.log.warn("encountered error in reconnect policy",Object.assign(Object.assign({},this.logContext),{error:n}))}return null}restartConnection(e){var n,i,r;return H(this,void 0,void 0,function*(){try{if(!this.url||!this.token)throw new Ye("could not reconnect, url or token not saved");this.log.info("reconnecting, attempt: ".concat(this.reconnectAttempts),this.logContext),this.emit(ue.Restarting),this.client.isDisconnected||(yield this.client.sendLeave()),yield this.cleanupPeerConnections(),yield this.cleanupClient();let s;try{if(!this.signalOpts)throw this.log.warn("attempted connection restart, without signal options present",this.logContext),new eo;s=yield this.join(e??this.url,this.token,this.signalOpts)}catch(a){throw a instanceof xe&&a.reason===0?new Ye("could not reconnect, token might be expired"):new eo}if(this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(this.client.setReconnected(),this.emit(ue.SignalRestarted,s),yield this.waitForPCReconnected(),this.client.currentState!==je.CONNECTED)throw new eo("Signal connection got severed during reconnect");(n=this.regionUrlProvider)===null||n===void 0||n.resetAttempts(),this.emit(ue.Restarted)}catch(s){const a=yield(i=this.regionUrlProvider)===null||i===void 0?void 0:i.getNextBestRegionUrl();if(a){yield this.restartConnection(a);return}else throw(r=this.regionUrlProvider)===null||r===void 0||r.resetAttempts(),s}})}resumeConnection(e){var n;return H(this,void 0,void 0,function*(){if(!this.url||!this.token)throw new Ye("could not reconnect, url or token not saved");if(!this.pcManager)throw new Ye("publisher and subscriber connections unset");this.log.info("resuming signal connection, attempt ".concat(this.reconnectAttempts),this.logContext),this.emit(ue.Resuming);try{this.setupSignalClientCallbacks();const i=yield this.client.reconnect(this.url,this.token,this.participantSid,e);if(i){const r=this.makeRTCConfiguration(i);this.pcManager.updateConfiguration(r)}}catch(i){let r="";throw i instanceof Error&&(r=i.message,this.log.error(i.message,Object.assign(Object.assign({},this.logContext),{error:i}))),i instanceof xe&&i.reason===0?new Ye("could not reconnect, token might be expired"):i instanceof xe&&i.reason===4?i:new eo(r)}if(this.emit(ue.SignalResumed),this.shouldFailNext)throw this.shouldFailNext=!1,new Error("simulated failure");if(yield this.pcManager.triggerIceRestart(),yield this.waitForPCReconnected(),this.client.currentState!==je.CONNECTED)throw new eo("Signal connection got severed during reconnect");this.client.setReconnected(),((n=this.reliableDC)===null||n===void 0?void 0:n.readyState)==="open"&&this.reliableDC.id===null&&this.createDataChannels(),this.emit(ue.Resumed)})}waitForPCInitialConnection(e,n){return H(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ye("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(n,e)})}waitForPCReconnected(){return H(this,void 0,void 0,function*(){this.pcState=Rn.Reconnecting,this.log.debug("waiting for peer connection to reconnect",this.logContext);try{if(yield hr(kx),!this.pcManager)throw new Ye("PC manager is closed");yield this.pcManager.ensurePCTransportConnection(void 0,this.peerConnectionTimeout),this.pcState=Rn.Connected}catch(e){throw this.pcState=Rn.Disconnected,new xe("could not establish PC connection, ".concat(e.message))}})}sendDataPacket(e,n){return H(this,void 0,void 0,function*(){const i=e.toBinary();yield this.ensurePublisherConnected(n);const r=this.dataChannelForKind(n);r&&r.send(i),this.updateAndEmitDCBufferStatus(n)})}ensureDataTransportConnected(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.subscriberPrimary;var i;return H(this,void 0,void 0,function*(){if(!this.pcManager)throw new Ye("PC manager is closed");const r=n?this.pcManager.subscriber:this.pcManager.publisher,s=n?"Subscriber":"Publisher";if(!r)throw new xe("".concat(s," connection not set"));!n&&!this.pcManager.publisher.isICEConnected&&this.pcManager.publisher.getICEConnectionState()!=="checking"&&this.negotiate();const a=this.dataChannelForKind(e,n);if((a==null?void 0:a.readyState)==="open")return;const o=new Date().getTime()+this.peerConnectionTimeout;for(;new Date().getTime()<o;){if(r.isICEConnected&&((i=this.dataChannelForKind(e,n))===null||i===void 0?void 0:i.readyState)==="open")return;yield hr(50)}throw new xe("could not establish ".concat(s," connection, state: ").concat(r.getICEConnectionState()))})}ensurePublisherConnected(e){return H(this,void 0,void 0,function*(){yield this.ensureDataTransportConnected(e,!1)})}verifyTransport(){return!(!this.pcManager||this.pcManager.currentState!==et.CONNECTED||!this.client.ws||this.client.ws.readyState===WebSocket.CLOSED)}negotiate(){return H(this,void 0,void 0,function*(){return new Promise((e,n)=>H(this,void 0,void 0,function*(){if(!this.pcManager){n(new $f("PC manager is closed"));return}this.pcManager.requirePublisher();const i=new AbortController,r=()=>{i.abort(),this.log.debug("engine disconnected while negotiation was ongoing",this.logContext),e()};this.isClosed&&n("cannot negotiate on closed engine"),this.on(ue.Closing,r),this.pcManager.publisher.once(xo.RTPVideoPayloadTypes,s=>{const a=new Map;s.forEach(o=>{const l=o.codec.toLowerCase();rx(l)&&a.set(o.payload,l)}),this.emit(ue.RTPVideoMapUpdate,a)});try{yield this.pcManager.negotiate(i),e()}catch(s){s instanceof $f&&(this.fullReconnectOnNext=!0),this.handleDisconnect("negotiation",Ai.RR_UNKNOWN),n(s)}finally{this.off(ue.Closing,r)}}))})}dataChannelForKind(e,n){if(n){if(e===Ze.LOSSY)return this.lossyDCSub;if(e===Ze.RELIABLE)return this.reliableDCSub}else{if(e===Ze.LOSSY)return this.lossyDC;if(e===Ze.RELIABLE)return this.reliableDC}}sendSyncState(e,n){var i,r;if(!this.pcManager){this.log.warn("sync state cannot be sent without peer connection setup",this.logContext);return}const s=this.pcManager.subscriber.getLocalDescription(),a=this.pcManager.subscriber.getRemoteDescription(),o=(r=(i=this.signalOpts)===null||i===void 0?void 0:i.autoSubscribe)!==null&&r!==void 0?r:!0,l=new Array;e.forEach(c=>{c.isDesired!==o&&l.push(c.trackSid)}),this.client.sendSyncState(new Si({answer:s?Tu({sdp:s.sdp,type:s.type}):void 0,offer:a?Tu({sdp:a.sdp,type:a.type}):void 0,subscription:new vn({trackSids:l,subscribe:!o,participantTracks:[]}),publishTracks:GR(n),dataChannels:this.dataChannelsInfo()}))}failNext(){this.shouldFailNext=!0}dataChannelsInfo(){const e=[],n=(i,r)=>{(i==null?void 0:i.id)!==void 0&&i.id!==null&&e.push(new Ci({label:i.label,id:i.id,target:r}))};return n(this.dataChannelForKind(Ze.LOSSY),wt.PUBLISHER),n(this.dataChannelForKind(Ze.RELIABLE),wt.PUBLISHER),n(this.dataChannelForKind(Ze.LOSSY,!0),wt.SUBSCRIBER),n(this.dataChannelForKind(Ze.RELIABLE,!0),wt.SUBSCRIBER),e}clearReconnectTimeout(){this.reconnectTimeout&&ht.clearTimeout(this.reconnectTimeout)}clearPendingReconnect(){this.clearReconnectTimeout(),this.reconnectAttempts=0}registerOnLineListener(){Jt()&&window.addEventListener("online",this.handleBrowserOnLine)}deregisterOnLineListener(){Jt()&&window.removeEventListener("online",this.handleBrowserOnLine)}}class eo extends Error{}class Yv{constructor(e,n){this.lastUpdateAt=0,this.settingsCacheTime=3e3,this.attemptedRegions=[],this.serverUrl=new URL(e),this.token=n}updateToken(e){this.token=e}isCloud(){return Jf(this.serverUrl)}getServerUrl(){return this.serverUrl}getNextBestRegionUrl(e){return H(this,void 0,void 0,function*(){if(!this.isCloud())throw Error("region availability is only supported for LiveKit Cloud domains");(!this.regionSettings||Date.now()-this.lastUpdateAt>this.settingsCacheTime)&&(this.regionSettings=yield this.fetchRegionSettings(e));const n=this.regionSettings.regions.filter(i=>!this.attemptedRegions.find(r=>r.url===i.url));if(n.length>0){const i=n[0];return this.attemptedRegions.push(i),_e.debug("next region: ".concat(i.region)),i.url}else return null})}resetAttempts(){this.attemptedRegions=[]}fetchRegionSettings(e){return H(this,void 0,void 0,function*(){const n=yield fetch("".concat(Tx(this.serverUrl),"/regions"),{headers:{authorization:"Bearer ".concat(this.token)},signal:e});if(n.ok){const i=yield n.json();return this.lastUpdateAt=Date.now(),i}else throw new xe("Could not fetch region settings: ".concat(n.statusText),n.status===401?0:void 0,n.status)})}}function Tx(t){return"".concat(t.protocol.replace("ws","http"),"//").concat(t.host,"/settings")}const Rm=2e3;function cd(t,e){if(!e)return 0;let n,i;return"bytesReceived"in t?(n=t.bytesReceived,i=e.bytesReceived):"bytesSent"in t&&(n=t.bytesSent,i=e.bytesSent),n===void 0||i===void 0||t.timestamp===void 0||e.timestamp===void 0?0:(n-i)*8*1e3/(t.timestamp-e.timestamp)}class Zt extends Yo{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=arguments.length>3?arguments[3]:void 0,s=arguments.length>4?arguments[4]:void 0;super(e,$.Kind.Audio,n,i,s),this.stopOnMute=!1,this.monitorSender=()=>H(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let a;try{a=yield this.getSenderStats()}catch(o){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:o}));return}a&&this.prevStats&&(this._currentBitrate=cd(a,this.prevStats)),this.prevStats=a}),this.audioContext=r,this.checkForSilence()}setDeviceId(e){return H(this,void 0,void 0,function*(){return this._constraints.deviceId===e?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||Ms(e)===this.mediaStreamTrack.getSettings().deviceId)})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return H(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===$.Source.Microphone&&this.stopOnMute&&!this.isUserProvided&&(this.log.debug("stopping mic track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return H(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{const i=this._constraints.deviceId&&this._mediaStreamTrack.getSettings().deviceId!==Ms(this._constraints.deviceId);return this.source===$.Source.Microphone&&(this.stopOnMute||this._mediaStreamTrack.readyState==="ended"||i)&&!this.isUserProvided&&(this.log.debug("reacquiring mic track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}restartTrack(e){return H(this,void 0,void 0,function*(){let n;if(e){const i=ld({audio:e});typeof i.audio!="boolean"&&(n=i.audio)}yield this.restart(n)})}restart(e){const n=Object.create(null,{restart:{get:()=>super.restart}});return H(this,void 0,void 0,function*(){const i=yield n.restart.call(this,e);return this.checkForSilence(),i})}startMonitor(){Jt()&&(this.monitorInterval||(this.monitorInterval=setInterval(()=>{this.monitorSender()},Rm)))}setProcessor(e){var n;return H(this,void 0,void 0,function*(){const i=yield this.processorLock.lock();try{if(!this.audioContext)throw Error("Audio context needs to be set on LocalAudioTrack in order to enable processors");if(this.processor&&(yield this.stopProcessor()),this.kind==="unknown")throw TypeError("cannot set processor on track of unknown kind");const r={kind:this.kind,track:this._mediaStreamTrack,audioContext:this.audioContext};this.log.debug("setting up audio processor ".concat(e.name),this.logContext),yield e.init(r),this.processor=e,this.processor.processedTrack&&(yield(n=this.sender)===null||n===void 0?void 0:n.replaceTrack(this.processor.processedTrack))}finally{i()}})}setAudioContext(e){this.audioContext=e}getSenderStats(){var e;return H(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return;const n=yield this.sender.getStats();let i;return n.forEach(r=>{r.type==="outbound-rtp"&&(i={type:"audio",streamId:r.id,packetsSent:r.packetsSent,packetsLost:r.packetsLost,bytesSent:r.bytesSent,timestamp:r.timestamp,roundTripTime:r.roundTripTime,jitter:r.jitter})}),i})}checkForSilence(){return H(this,void 0,void 0,function*(){const e=yield WR(this);return e&&(this.isMuted||this.log.warn("silence detected on local audio track",this.logContext),this.emit(re.AudioSilenceDetected)),e})}}function lb(t,e,n){switch(t.kind){case"audio":return new Zt(t,e,!1,void 0,n);case"video":return new dn(t,e,!1,n);default:throw new ri("unsupported track type: ".concat(t.kind))}}const Rx=Object.values(El),xx=Object.values(Vf),Px=Object.values(wm),Ox=[El.h180,El.h360],Ix=[Vf.h180,Vf.h360],Lx=t=>[{scaleResolutionDownBy:2,fps:t.encoding.maxFramerate}].map(n=>{var i,r;return new Ee(Math.floor(t.width/n.scaleResolutionDownBy),Math.floor(t.height/n.scaleResolutionDownBy),Math.max(15e4,Math.floor(t.encoding.maxBitrate/(Math.pow(n.scaleResolutionDownBy,2)*(((i=t.encoding.maxFramerate)!==null&&i!==void 0?i:30)/((r=n.fps)!==null&&r!==void 0?r:30))))),n.fps,t.encoding.priority)}),Qf=["q","h","f"];function Xf(t,e,n,i){var r,s;let a=i==null?void 0:i.videoEncoding;t&&(a=i==null?void 0:i.screenShareEncoding);const o=i==null?void 0:i.simulcast,l=i==null?void 0:i.scalabilityMode,c=i==null?void 0:i.videoCodec;if(!a&&!o&&!l||!e||!n)return[{}];a||(a=Dx(t,e,n,c),_e.debug("using video encoding",a));const d=new Ee(e,n,a.maxBitrate,a.maxFramerate,a.priority);if(l&&tl(c)){_e.debug("using svc with scalabilityMode ".concat(l));const v=new cb(l),y=[];if(v.spatial>3)throw new Error("unsupported scalabilityMode: ".concat(l));for(let _=0;_<v.spatial;_+=1)y.push({rid:Qf[2-_],maxBitrate:a.maxBitrate/Math.pow(3,_),maxFramerate:d.encoding.maxFramerate});return y[0].scalabilityMode=l,_e.debug("encodings",y),y}if(!o)return[a];let u=[];t?u=(r=e0(i==null?void 0:i.screenShareSimulcastLayers))!==null&&r!==void 0?r:Zv(t,d):u=(s=e0(i==null?void 0:i.videoSimulcastLayers))!==null&&s!==void 0?s:Zv(t,d);let m;if(u.length>0){const v=u[0];u.length>1&&([,m]=u);const y=Math.max(e,n);if(y>=960&&m)return vh(e,n,[v,m,d]);if(y>=480)return vh(e,n,[v,d])}return vh(e,n,[d])}function Mx(t,e,n){var i,r,s,a;if(!n.backupCodec||n.backupCodec===!0||n.backupCodec.codec===n.videoCodec)return;e!==n.backupCodec.codec&&_e.warn("requested a different codec than specified as backup",{serverRequested:e,backup:n.backupCodec.codec}),n.videoCodec=e,n.videoEncoding=n.backupCodec.encoding;const o=t.mediaStreamTrack.getSettings(),l=(i=o.width)!==null&&i!==void 0?i:(r=t.dimensions)===null||r===void 0?void 0:r.width,c=(s=o.height)!==null&&s!==void 0?s:(a=t.dimensions)===null||a===void 0?void 0:a.height;return Xf(t.source===$.Source.ScreenShare,l,c,n)}function Dx(t,e,n,i){const r=Ax(t,e,n);let{encoding:s}=r[0];const a=Math.max(e,n);for(let o=0;o<r.length;o+=1){const l=r[o];if(s=l.encoding,l.width>=a)break}if(i)switch(i){case"av1":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.7;break;case"vp9":s=Object.assign({},s),s.maxBitrate=s.maxBitrate*.85;break}return s}function Ax(t,e,n){if(t)return Px;const i=e>n?e/n:n/e;return Math.abs(i-16/9)<Math.abs(i-4/3)?Rx:xx}function Zv(t,e){if(t)return Lx(e);const{width:n,height:i}=e,r=n>i?n/i:i/n;return Math.abs(r-16/9)<Math.abs(r-4/3)?Ox:Ix}function vh(t,e,n){const i=[];if(n.forEach((r,s)=>{if(s>=Qf.length)return;const a=Math.min(t,e),l={rid:Qf[s],scaleResolutionDownBy:Math.max(1,a/Math.min(r.width,r.height)),maxBitrate:r.encoding.maxBitrate};r.encoding.maxFramerate&&(l.maxFramerate=r.encoding.maxFramerate);const c=Xo()||s===0;r.encoding.priority&&c&&(l.priority=r.encoding.priority,l.networkPriority=r.encoding.priority),i.push(l)}),$s()&&tb()==="ios"){let r;i.forEach(a=>{r?a.maxFramerate&&a.maxFramerate>r&&(r=a.maxFramerate):r=a.maxFramerate});let s=!0;i.forEach(a=>{var o;a.maxFramerate!=r&&(s&&(s=!1,_e.info("Simulcast on iOS React-Native requires all encodings to share the same framerate.")),_e.info('Setting framerate of encoding "'.concat((o=a.rid)!==null&&o!==void 0?o:"",'" to ').concat(r)),a.maxFramerate=r)})}return i}function e0(t){if(t)return t.sort((e,n)=>{const{encoding:i}=e,{encoding:r}=n;return i.maxBitrate>r.maxBitrate?1:i.maxBitrate<r.maxBitrate?-1:i.maxBitrate===r.maxBitrate&&i.maxFramerate&&r.maxFramerate?i.maxFramerate>r.maxFramerate?1:-1:0})}class cb{constructor(e){const n=e.match(/^L(\d)T(\d)(h|_KEY|_KEY_SHIFT){0,1}$/);if(!n)throw new Error("invalid scalability mode");if(this.spatial=parseInt(n[1]),this.temporal=parseInt(n[2]),n.length>3)switch(n[3]){case"h":case"_KEY":case"_KEY_SHIFT":this.suffix=n[3]}}toString(){var e;return"L".concat(this.spatial,"T").concat(this.temporal).concat((e=this.suffix)!==null&&e!==void 0?e:"")}}const Nx=5e3;class dn extends Yo{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!0,r=arguments.length>3?arguments[3]:void 0;super(e,$.Kind.Video,n,i,r),this.simulcastCodecs=new Map,this.monitorSender=()=>H(this,void 0,void 0,function*(){if(!this.sender){this._currentBitrate=0;return}let s;try{s=yield this.getSenderStats()}catch(o){this.log.error("could not get audio sender stats",Object.assign(Object.assign({},this.logContext),{error:o}));return}const a=new Map(s.map(o=>[o.rid,o]));if(this.prevStats){let o=0;a.forEach((l,c)=>{var d;const u=(d=this.prevStats)===null||d===void 0?void 0:d.get(c);o+=cd(l,u)}),this._currentBitrate=o}this.prevStats=a}),this.senderLock=new $n}get isSimulcast(){return!!(this.sender&&this.sender.getParameters().encodings.length>1)}startMonitor(e){var n;if(this.signalClient=e,!Jt())return;const i=(n=this.sender)===null||n===void 0?void 0:n.getParameters();i&&(this.encodings=i.encodings),!this.monitorInterval&&(this.monitorInterval=setInterval(()=>{this.monitorSender()},Rm))}stop(){this._mediaStreamTrack.getConstraints(),this.simulcastCodecs.forEach(e=>{e.mediaStreamTrack.stop()}),super.stop()}pauseUpstream(){const e=Object.create(null,{pauseUpstream:{get:()=>super.pauseUpstream}});var n,i,r,s,a;return H(this,void 0,void 0,function*(){yield e.pauseUpstream.call(this);try{for(var o=!0,l=no(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;o=!0)s=c.value,o=!1,yield(a=s.sender)===null||a===void 0?void 0:a.replaceTrack(null)}catch(d){i={error:d}}finally{try{!o&&!n&&(r=l.return)&&(yield r.call(l))}finally{if(i)throw i.error}}})}resumeUpstream(){const e=Object.create(null,{resumeUpstream:{get:()=>super.resumeUpstream}});var n,i,r,s,a;return H(this,void 0,void 0,function*(){yield e.resumeUpstream.call(this);try{for(var o=!0,l=no(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;o=!0){s=c.value,o=!1;const d=s;yield(a=d.sender)===null||a===void 0?void 0:a.replaceTrack(d.mediaStreamTrack)}}catch(d){i={error:d}}finally{try{!o&&!n&&(r=l.return)&&(yield r.call(l))}finally{if(i)throw i.error}}})}mute(){const e=Object.create(null,{mute:{get:()=>super.mute}});return H(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===$.Source.Camera&&!this.isUserProvided&&(this.log.debug("stopping camera track",this.logContext),this._mediaStreamTrack.stop()),yield e.mute.call(this),this}finally{n()}})}unmute(){const e=Object.create(null,{unmute:{get:()=>super.unmute}});return H(this,void 0,void 0,function*(){const n=yield this.muteLock.lock();try{return this.source===$.Source.Camera&&!this.isUserProvided&&(this.log.debug("reacquiring camera track",this.logContext),yield this.restartTrack()),yield e.unmute.call(this),this}finally{n()}})}setTrackMuted(e){super.setTrackMuted(e);for(const n of this.simulcastCodecs.values())n.mediaStreamTrack.enabled=!e}getSenderStats(){var e;return H(this,void 0,void 0,function*(){if(!(!((e=this.sender)===null||e===void 0)&&e.getStats))return[];const n=[],i=yield this.sender.getStats();return i.forEach(r=>{var s;if(r.type==="outbound-rtp"){const a={type:"video",streamId:r.id,frameHeight:r.frameHeight,frameWidth:r.frameWidth,firCount:r.firCount,pliCount:r.pliCount,nackCount:r.nackCount,packetsSent:r.packetsSent,bytesSent:r.bytesSent,framesSent:r.framesSent,timestamp:r.timestamp,rid:(s=r.rid)!==null&&s!==void 0?s:r.id,retransmittedPacketsSent:r.retransmittedPacketsSent,qualityLimitationReason:r.qualityLimitationReason,qualityLimitationResolutionChanges:r.qualityLimitationResolutionChanges},o=i.get(r.remoteId);o&&(a.jitter=o.jitter,a.packetsLost=o.packetsLost,a.roundTripTime=o.roundTripTime),n.push(a)}}),n})}setPublishingQuality(e){const n=[];for(let i=it.LOW;i<=it.HIGH;i+=1)n.push(new Hn({quality:i,enabled:i<=e}));this.log.debug("setting publishing quality. max quality ".concat(e),this.logContext),this.setPublishingLayers(n)}setDeviceId(e){return H(this,void 0,void 0,function*(){return this._constraints.deviceId===e&&this._mediaStreamTrack.getSettings().deviceId===Ms(e)?!0:(this._constraints.deviceId=e,this.isMuted||(yield this.restartTrack()),this.isMuted||Ms(e)===this._mediaStreamTrack.getSettings().deviceId)})}restartTrack(e){var n,i,r,s;return H(this,void 0,void 0,function*(){let a;if(e){const d=ld({video:e});typeof d.video!="boolean"&&(a=d.video)}yield this.restart(a);try{for(var o=!0,l=no(this.simulcastCodecs.values()),c;c=yield l.next(),n=c.done,!n;o=!0){s=c.value,o=!1;const d=s;d.sender&&(d.mediaStreamTrack=this.mediaStreamTrack.clone(),yield d.sender.replaceTrack(d.mediaStreamTrack))}}catch(d){i={error:d}}finally{try{!o&&!n&&(r=l.return)&&(yield r.call(l))}finally{if(i)throw i.error}}})}setProcessor(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;const i=Object.create(null,{setProcessor:{get:()=>super.setProcessor}});var r,s,a,o,l,c;return H(this,void 0,void 0,function*(){if(yield i.setProcessor.call(this,e,n),!((l=this.processor)===null||l===void 0)&&l.processedTrack)try{for(var d=!0,u=no(this.simulcastCodecs.values()),m;m=yield u.next(),r=m.done,!r;d=!0)o=m.value,d=!1,yield(c=o.sender)===null||c===void 0?void 0:c.replaceTrack(this.processor.processedTrack)}catch(v){s={error:v}}finally{try{!d&&!r&&(a=u.return)&&(yield a.call(u))}finally{if(s)throw s.error}}})}addSimulcastTrack(e,n){if(this.simulcastCodecs.has(e))throw new Error("".concat(e," already added"));const i={codec:e,mediaStreamTrack:this.mediaStreamTrack.clone(),sender:void 0,encodings:n};return this.simulcastCodecs.set(e,i),i}setSimulcastTrackSender(e,n){const i=this.simulcastCodecs.get(e);i&&(i.sender=n,setTimeout(()=>{this.subscribedCodecs&&this.setPublishingCodecs(this.subscribedCodecs)},Nx))}setPublishingCodecs(e){var n,i,r,s,a,o,l;return H(this,void 0,void 0,function*(){if(this.log.debug("setting publishing codecs",Object.assign(Object.assign({},this.logContext),{codecs:e,currentCodec:this.codec})),!this.codec&&e.length>0)return yield this.setPublishingLayers(e[0].qualities),[];this.subscribedCodecs=e;const c=[];try{for(n=!0,i=no(e);r=yield i.next(),s=r.done,!s;n=!0){l=r.value,n=!1;const d=l;if(!this.codec||this.codec===d.codec)yield this.setPublishingLayers(d.qualities);else{const u=this.simulcastCodecs.get(d.codec);if(this.log.debug("try setPublishingCodec for ".concat(d.codec),Object.assign(Object.assign({},this.logContext),{simulcastCodecInfo:u})),!u||!u.sender){for(const m of d.qualities)if(m.enabled){c.push(d.codec);break}}else u.encodings&&(this.log.debug("try setPublishingLayersForSender ".concat(d.codec),this.logContext),yield t0(u.sender,u.encodings,d.qualities,this.senderLock,this.log,this.logContext))}}}catch(d){a={error:d}}finally{try{!n&&!s&&(o=i.return)&&(yield o.call(i))}finally{if(a)throw a.error}}return c})}setPublishingLayers(e){return H(this,void 0,void 0,function*(){this.log.debug("setting publishing layers",Object.assign(Object.assign({},this.logContext),{qualities:e})),!(!this.sender||!this.encodings)&&(yield t0(this.sender,this.encodings,e,this.senderLock,this.log,this.logContext))})}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return H(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),ZC()&&this.isInBackground&&this.source===$.Source.Camera&&(this._mediaStreamTrack.enabled=!1)})}}function t0(t,e,n,i,r,s){return H(this,void 0,void 0,function*(){const a=yield i.lock();r.debug("setPublishingLayersForSender",Object.assign(Object.assign({},s),{sender:t,qualities:n,senderEncodings:e}));try{const o=t.getParameters(),{encodings:l}=o;if(!l)return;if(l.length!==e.length){r.warn("cannot set publishing layers, encodings mismatch");return}let c=!1;!1&&l[0].scalabilityMode||l.forEach((u,m)=>{var v;let y=(v=u.rid)!==null&&v!==void 0?v:"";y===""&&(y="q");const _=ub(y),p=n.find(f=>f.quality===_);p&&u.active!==p.enabled&&(c=!0,u.active=p.enabled,r.debug("setting layer ".concat(p.quality," to ").concat(u.active?"enabled":"disabled"),s),Xo()&&(p.enabled?(u.scaleResolutionDownBy=e[m].scaleResolutionDownBy,u.maxBitrate=e[m].maxBitrate,u.maxFrameRate=e[m].maxFrameRate):(u.scaleResolutionDownBy=4,u.maxBitrate=10,u.maxFrameRate=2)))}),c&&(o.encodings=l,r.debug("setting encodings",Object.assign(Object.assign({},s),{encodings:o.encodings})),yield t.setParameters(o))}finally{a()}})}function ub(t){switch(t){case"f":return it.HIGH;case"h":return it.MEDIUM;case"q":return it.LOW;default:return it.HIGH}}function n0(t,e,n,i){if(!n)return[new Lt({quality:it.HIGH,width:t,height:e,bitrate:0,ssrc:0})];if(i){const r=n[0].scalabilityMode,s=new cb(r),a=[];for(let o=0;o<s.spatial;o+=1)a.push(new Lt({quality:it.HIGH-o,width:Math.ceil(t/Math.pow(2,o)),height:Math.ceil(e/Math.pow(2,o)),bitrate:n[0].maxBitrate?Math.ceil(n[0].maxBitrate/Math.pow(3,o)):0,ssrc:0}));return a}return n.map(r=>{var s,a,o;const l=(s=r.scaleResolutionDownBy)!==null&&s!==void 0?s:1;let c=ub((a=r.rid)!==null&&a!==void 0?a:"");return new Lt({quality:c,width:Math.ceil(t/l),height:Math.ceil(e/l),bitrate:(o=r.maxBitrate)!==null&&o!==void 0?o:0,ssrc:0})})}class db extends ${constructor(e,n,i,r,s){super(e,i,s),this.sid=n,this.receiver=r}setMuted(e){this.isMuted!==e&&(this.isMuted=e,this._mediaStreamTrack.enabled=!e,this.emit(e?re.Muted:re.Unmuted,this))}setMediaStream(e){this.mediaStream=e;const n=i=>{i.track===this._mediaStreamTrack&&(e.removeEventListener("removetrack",n),this.receiver=void 0,this._currentBitrate=0,this.emit(re.Ended,this))};e.addEventListener("removetrack",n)}start(){this.startMonitor(),super.enable()}stop(){this.stopMonitor(),super.disable()}getRTCStatsReport(){var e;return H(this,void 0,void 0,function*(){return!((e=this.receiver)===null||e===void 0)&&e.getStats?yield this.receiver.getStats():void 0})}startMonitor(){this.monitorInterval||(this.monitorInterval=setInterval(()=>this.monitorReceiver(),Rm))}}class Po extends db{constructor(e,n,i,r,s,a){super(e,n,$.Kind.Audio,i,a),this.monitorReceiver=()=>H(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const o=yield this.getReceiverStats();o&&this.prevStats&&this.receiver&&(this._currentBitrate=cd(o,this.prevStats)),this.prevStats=o}),this.audioContext=r,this.webAudioPluginNodes=[],s&&(this.sinkId=s.deviceId)}setVolume(e){var n;for(const i of this.attachedElements)this.audioContext?(n=this.gainNode)===null||n===void 0||n.gain.setTargetAtTime(e,0,.1):i.volume=e;$s()&&this._mediaStreamTrack._setVolume(e),this.elementVolume=e}getVolume(){if(this.elementVolume)return this.elementVolume;if($s())return 1;let e=0;return this.attachedElements.forEach(n=>{n.volume>e&&(e=n.volume)}),e}setSinkId(e){return H(this,void 0,void 0,function*(){this.sinkId=e,yield Promise.all(this.attachedElements.map(n=>{if(qf(n))return n.setSinkId(e)}))})}attach(e){const n=this.attachedElements.length===0;return e?super.attach(e):e=super.attach(),this.sinkId&&qf(e)&&e.setSinkId(this.sinkId),this.audioContext&&n&&(this.log.debug("using audio context mapping",this.logContext),this.connectWebAudio(this.audioContext,e),e.volume=0,e.muted=!0),this.elementVolume&&this.setVolume(this.elementVolume),e}detach(e){let n;return e?(n=super.detach(e),this.audioContext&&(this.attachedElements.length>0?this.connectWebAudio(this.audioContext,this.attachedElements[0]):this.disconnectWebAudio())):(n=super.detach(),this.disconnectWebAudio()),n}setAudioContext(e){this.audioContext=e,e&&this.attachedElements.length>0?this.connectWebAudio(e,this.attachedElements[0]):e||this.disconnectWebAudio()}setWebAudioPlugins(e){this.webAudioPluginNodes=e,this.attachedElements.length>0&&this.audioContext&&this.connectWebAudio(this.audioContext,this.attachedElements[0])}connectWebAudio(e,n){this.disconnectWebAudio(),this.sourceNode=e.createMediaStreamSource(n.srcObject);let i=this.sourceNode;this.webAudioPluginNodes.forEach(r=>{i.connect(r),i=r}),this.gainNode=e.createGain(),i.connect(this.gainNode),this.gainNode.connect(e.destination),this.elementVolume&&this.gainNode.gain.setTargetAtTime(this.elementVolume,0,.1),e.state!=="running"&&e.resume().then(()=>{e.state!=="running"&&this.emit(re.AudioPlaybackFailed,new Error("Audio Context couldn't be started automatically"))}).catch(r=>{this.emit(re.AudioPlaybackFailed,r)})}disconnectWebAudio(){var e,n;(e=this.gainNode)===null||e===void 0||e.disconnect(),(n=this.sourceNode)===null||n===void 0||n.disconnect(),this.gainNode=void 0,this.sourceNode=void 0}getReceiverStats(){return H(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n;return e.forEach(i=>{i.type==="inbound-rtp"&&(n={type:"audio",timestamp:i.timestamp,jitter:i.jitter,bytesReceived:i.bytesReceived,concealedSamples:i.concealedSamples,concealmentEvents:i.concealmentEvents,silentConcealedSamples:i.silentConcealedSamples,silentConcealmentEvents:i.silentConcealmentEvents,totalAudioEnergy:i.totalAudioEnergy,totalSamplesDuration:i.totalSamplesDuration})}),n})}}const _h=100;class il extends db{constructor(e,n,i,r,s){super(e,n,$.Kind.Video,i,s),this.elementInfos=[],this.monitorReceiver=()=>H(this,void 0,void 0,function*(){if(!this.receiver){this._currentBitrate=0;return}const a=yield this.getReceiverStats();a&&this.prevStats&&this.receiver&&(this._currentBitrate=cd(a,this.prevStats)),this.prevStats=a}),this.debouncedHandleResize=bm(()=>{this.updateDimensions()},_h),this.adaptiveStreamSettings=r}get isAdaptiveStream(){return this.adaptiveStreamSettings!==void 0}get mediaStreamTrack(){return this._mediaStreamTrack}setMuted(e){super.setMuted(e),this.attachedElements.forEach(n=>{e?Ro(this._mediaStreamTrack,n):go(this._mediaStreamTrack,n)})}attach(e){if(e?super.attach(e):e=super.attach(),this.adaptiveStreamSettings&&this.elementInfos.find(n=>n.element===e)===void 0){const n=new Bx(e);this.observeElementInfo(n)}return e}observeElementInfo(e){this.adaptiveStreamSettings&&this.elementInfos.find(n=>n===e)===void 0?(e.handleResize=()=>{this.debouncedHandleResize()},e.handleVisibilityChanged=()=>{this.updateVisibility()},this.elementInfos.push(e),e.observe(),this.debouncedHandleResize(),this.updateVisibility()):this.log.warn("visibility resize observer not triggered",this.logContext)}stopObservingElementInfo(e){if(!this.isAdaptiveStream){this.log.warn("stopObservingElementInfo ignored",this.logContext);return}const n=this.elementInfos.filter(i=>i===e);for(const i of n)i.stopObserving();this.elementInfos=this.elementInfos.filter(i=>i!==e),this.updateVisibility(),this.debouncedHandleResize()}detach(e){let n=[];if(e)return this.stopObservingElement(e),super.detach(e);n=super.detach();for(const i of n)this.stopObservingElement(i);return n}getDecoderImplementation(){var e;return(e=this.prevStats)===null||e===void 0?void 0:e.decoderImplementation}getReceiverStats(){return H(this,void 0,void 0,function*(){if(!this.receiver||!this.receiver.getStats)return;const e=yield this.receiver.getStats();let n,i="",r=new Map;return e.forEach(s=>{s.type==="inbound-rtp"?(i=s.codecId,n={type:"video",framesDecoded:s.framesDecoded,framesDropped:s.framesDropped,framesReceived:s.framesReceived,packetsReceived:s.packetsReceived,packetsLost:s.packetsLost,frameWidth:s.frameWidth,frameHeight:s.frameHeight,pliCount:s.pliCount,firCount:s.firCount,nackCount:s.nackCount,jitter:s.jitter,timestamp:s.timestamp,bytesReceived:s.bytesReceived,decoderImplementation:s.decoderImplementation}):s.type==="codec"&&r.set(s.id,s)}),n&&i!==""&&r.get(i)&&(n.mimeType=r.get(i).mimeType),n})}stopObservingElement(e){const n=this.elementInfos.filter(i=>i.element===e);for(const i of n)this.stopObservingElementInfo(i)}handleAppVisibilityChanged(){const e=Object.create(null,{handleAppVisibilityChanged:{get:()=>super.handleAppVisibilityChanged}});return H(this,void 0,void 0,function*(){yield e.handleAppVisibilityChanged.call(this),this.isAdaptiveStream&&this.updateVisibility()})}updateVisibility(){var e,n;const i=this.elementInfos.reduce((o,l)=>Math.max(o,l.visibilityChangedAt||0),0),r=!((n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pauseVideoInBackground)!==null&&n!==void 0)||n?this.isInBackground:!1,s=this.elementInfos.some(o=>o.pictureInPicture),a=this.elementInfos.some(o=>o.visible)&&!r||s;if(this.lastVisible!==a){if(!a&&Date.now()-i<_h){ht.setTimeout(()=>{this.updateVisibility()},_h);return}this.lastVisible=a,this.emit(re.VisibilityChanged,a,this)}}updateDimensions(){var e,n;let i=0,r=0;const s=this.getPixelDensity();for(const a of this.elementInfos){const o=a.width()*s,l=a.height()*s;o+l>i+r&&(i=o,r=l)}((e=this.lastDimensions)===null||e===void 0?void 0:e.width)===i&&((n=this.lastDimensions)===null||n===void 0?void 0:n.height)===r||(this.lastDimensions={width:i,height:r},this.emit(re.VideoDimensionsChanged,this.lastDimensions,this))}getPixelDensity(){var e;const n=(e=this.adaptiveStreamSettings)===null||e===void 0?void 0:e.pixelDensity;return n==="screen"?Fv():n||(Fv()>2?2:1)}}class Bx{get visible(){return this.isPiP||this.isIntersecting}get pictureInPicture(){return this.isPiP}constructor(e,n){this.onVisibilityChanged=i=>{var r;const{target:s,isIntersecting:a}=i;s===this.element&&(this.isIntersecting=a,this.visibilityChangedAt=Date.now(),(r=this.handleVisibilityChanged)===null||r===void 0||r.call(this))},this.onEnterPiP=()=>{var i;this.isPiP=!0,(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this)},this.onLeavePiP=()=>{var i;this.isPiP=!1,(i=this.handleVisibilityChanged)===null||i===void 0||i.call(this)},this.element=e,this.isIntersecting=n??i0(e),this.isPiP=Jt()&&document.pictureInPictureElement===e,this.visibilityChangedAt=0}width(){return this.element.clientWidth}height(){return this.element.clientHeight}observe(){this.isIntersecting=i0(this.element),this.isPiP=document.pictureInPictureElement===this.element,this.element.handleResize=()=>{var e;(e=this.handleResize)===null||e===void 0||e.call(this)},this.element.handleVisibilityChanged=this.onVisibilityChanged,zv().observe(this.element),Uv().observe(this.element),this.element.addEventListener("enterpictureinpicture",this.onEnterPiP),this.element.addEventListener("leavepictureinpicture",this.onLeavePiP)}stopObserving(){var e,n;(e=zv())===null||e===void 0||e.unobserve(this.element),(n=Uv())===null||n===void 0||n.unobserve(this.element),this.element.removeEventListener("enterpictureinpicture",this.onEnterPiP),this.element.removeEventListener("leavepictureinpicture",this.onLeavePiP)}}function i0(t){let e=t.offsetTop,n=t.offsetLeft;const i=t.offsetWidth,r=t.offsetHeight,{hidden:s}=t,{opacity:a,display:o}=getComputedStyle(t);for(;t.offsetParent;)t=t.offsetParent,e+=t.offsetTop,n+=t.offsetLeft;return e<window.pageYOffset+window.innerHeight&&n<window.pageXOffset+window.innerWidth&&e+r>window.pageYOffset&&n+i>window.pageXOffset&&!s&&(a!==""?parseFloat(a)>0:!0)&&o!=="none"}class Ni extends xi.EventEmitter{constructor(e,n,i,r){var s;super(),this.metadataMuted=!1,this.encryption=dt.NONE,this.log=_e,this.handleMuted=()=>{this.emit(re.Muted)},this.handleUnmuted=()=>{this.emit(re.Unmuted)},this.log=_r((s=r==null?void 0:r.loggerName)!==null&&s!==void 0?s:Ei.Publication),this.loggerContextCb=this.loggerContextCb,this.setMaxListeners(100),this.kind=e,this.trackSid=n,this.trackName=i,this.source=$.Source.Unknown}setTrack(e){this.track&&(this.track.off(re.Muted,this.handleMuted),this.track.off(re.Unmuted,this.handleUnmuted)),this.track=e,e&&(e.on(re.Muted,this.handleMuted),e.on(re.Unmuted,this.handleUnmuted))}get logContext(){var e;return Object.assign(Object.assign({},(e=this.loggerContextCb)===null||e===void 0?void 0:e.call(this)),Le(this))}get isMuted(){return this.metadataMuted}get isEnabled(){return!0}get isSubscribed(){return this.track!==void 0}get isEncrypted(){return this.encryption!==dt.NONE}get audioTrack(){if(this.track instanceof Zt||this.track instanceof Po)return this.track}get videoTrack(){if(this.track instanceof dn||this.track instanceof il)return this.track}updateInfo(e){this.trackSid=e.sid,this.trackName=e.name,this.source=$.sourceFromProto(e.source),this.mimeType=e.mimeType,this.kind===$.Kind.Video&&e.width>0&&(this.dimensions={width:e.width,height:e.height},this.simulcasted=e.simulcast),this.encryption=e.encryption,this.trackInfo=e,this.log.debug("update publication info",Object.assign(Object.assign({},this.logContext),{info:e}))}}(function(t){(function(e){e.Desired="desired",e.Subscribed="subscribed",e.Unsubscribed="unsubscribed"})(t.SubscriptionStatus||(t.SubscriptionStatus={})),function(e){e.Allowed="allowed",e.NotAllowed="not_allowed"}(t.PermissionStatus||(t.PermissionStatus={}))})(Ni||(Ni={}));class Tl extends Ni{get isUpstreamPaused(){var e;return(e=this.track)===null||e===void 0?void 0:e.isUpstreamPaused}constructor(e,n,i,r){super(e,n.sid,n.name,r),this.track=void 0,this.handleTrackEnded=()=>{this.emit(re.Ended)},this.updateInfo(n),this.setTrack(i)}setTrack(e){this.track&&this.track.off(re.Ended,this.handleTrackEnded),super.setTrack(e),e&&e.on(re.Ended,this.handleTrackEnded)}get isMuted(){return this.track?this.track.isMuted:super.isMuted}get audioTrack(){return super.audioTrack}get videoTrack(){return super.videoTrack}mute(){var e;return H(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.mute()})}unmute(){var e;return H(this,void 0,void 0,function*(){return(e=this.track)===null||e===void 0?void 0:e.unmute()})}pauseUpstream(){var e;return H(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.pauseUpstream()})}resumeUpstream(){var e;return H(this,void 0,void 0,function*(){yield(e=this.track)===null||e===void 0?void 0:e.resumeUpstream()})}}var mn;(function(t){t.Excellent="excellent",t.Good="good",t.Poor="poor",t.Lost="lost",t.Unknown="unknown"})(mn||(mn={}));function Fx(t){switch(t){case zi.EXCELLENT:return mn.Excellent;case zi.GOOD:return mn.Good;case zi.POOR:return mn.Poor;case zi.LOST:return mn.Lost;default:return mn.Unknown}}class hb extends xi.EventEmitter{get logContext(){var e,n;return Object.assign(Object.assign({},(n=(e=this.loggerOptions)===null||e===void 0?void 0:e.loggerContextCb)===null||n===void 0?void 0:n.call(e)),{participantSid:this.sid,participantId:this.identity})}get isEncrypted(){return this.tracks.size>0&&Array.from(this.tracks.values()).every(e=>e.isEncrypted)}get isAgent(){var e,n;return(n=(e=this.permissions)===null||e===void 0?void 0:e.agent)!==null&&n!==void 0?n:!1}constructor(e,n,i,r,s){var a;super(),this.audioLevel=0,this.isSpeaking=!1,this._connectionQuality=mn.Unknown,this.log=_e,this.log=_r((a=s==null?void 0:s.loggerName)!==null&&a!==void 0?a:Ei.Participant),this.loggerOptions=s,this.setMaxListeners(100),this.sid=e,this.identity=n,this.name=i,this.metadata=r,this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map}getTracks(){return Array.from(this.tracks.values())}getTrack(e){for(const[,n]of this.tracks)if(n.source===e)return n}getTrackByName(e){for(const[,n]of this.tracks)if(n.trackName===e)return n}get connectionQuality(){return this._connectionQuality}get isCameraEnabled(){var e;const n=this.getTrack($.Source.Camera);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isMicrophoneEnabled(){var e;const n=this.getTrack($.Source.Microphone);return!(!((e=n==null?void 0:n.isMuted)!==null&&e!==void 0)||e)}get isScreenShareEnabled(){return!!this.getTrack($.Source.ScreenShare)}get isLocal(){return!1}get joinedAt(){return this.participantInfo?new Date(Number.parseInt(this.participantInfo.joinedAt.toString())*1e3):new Date}updateInfo(e){return this.participantInfo&&this.participantInfo.sid===e.sid&&this.participantInfo.version>e.version?!1:(this.identity=e.identity,this.sid=e.sid,this._setName(e.name),this._setMetadata(e.metadata),e.permission&&this.setPermissions(e.permission),this.participantInfo=e,this.log.trace("update participant info",Object.assign(Object.assign({},this.logContext),{info:e})),!0)}_setMetadata(e){const n=this.metadata!==e,i=this.metadata;this.metadata=e,n&&this.emit(Z.ParticipantMetadataChanged,i)}_setName(e){const n=this.name!==e;this.name=e,n&&this.emit(Z.ParticipantNameChanged,e)}setPermissions(e){var n,i,r,s,a;const o=this.permissions,l=e.canPublish!==((n=this.permissions)===null||n===void 0?void 0:n.canPublish)||e.canSubscribe!==((i=this.permissions)===null||i===void 0?void 0:i.canSubscribe)||e.canPublishData!==((r=this.permissions)===null||r===void 0?void 0:r.canPublishData)||e.hidden!==((s=this.permissions)===null||s===void 0?void 0:s.hidden)||e.recorder!==((a=this.permissions)===null||a===void 0?void 0:a.recorder)||e.canPublishSources.length!==this.permissions.canPublishSources.length||e.canPublishSources.some((c,d)=>{var u;return c!==((u=this.permissions)===null||u===void 0?void 0:u.canPublishSources[d])});return this.permissions=e,l&&this.emit(Z.ParticipantPermissionsChanged,o),l}setIsSpeaking(e){e!==this.isSpeaking&&(this.isSpeaking=e,e&&(this.lastSpokeAt=new Date),this.emit(Z.IsSpeakingChanged,e))}setConnectionQuality(e){const n=this._connectionQuality;this._connectionQuality=Fx(e),n!==this._connectionQuality&&this.emit(Z.ConnectionQualityChanged,this._connectionQuality)}setAudioContext(e){this.audioContext=e,this.audioTracks.forEach(n=>(n.track instanceof Po||n.track instanceof Zt)&&n.track.setAudioContext(e))}addTrackPublication(e){e.on(re.Muted,()=>{this.emit(Z.TrackMuted,e)}),e.on(re.Unmuted,()=>{this.emit(Z.TrackUnmuted,e)});const n=e;switch(n.track&&(n.track.sid=e.trackSid),this.tracks.set(e.trackSid,e),e.kind){case $.Kind.Audio:this.audioTracks.set(e.trackSid,e);break;case $.Kind.Video:this.videoTracks.set(e.trackSid,e);break}}}function Ux(t){var e,n,i;if(!t.participantSid&&!t.participantIdentity)throw new Error("Invalid track permission, must provide at least one of participantIdentity and participantSid");return new _i({participantIdentity:(e=t.participantIdentity)!==null&&e!==void 0?e:"",participantSid:(n=t.participantSid)!==null&&n!==void 0?n:"",allTracks:(i=t.allowAll)!==null&&i!==void 0?i:!1,trackSids:t.allowedTrackSids||[]})}class Rl extends Ni{constructor(e,n,i,r){super(e,n.sid,n.name,r),this.track=void 0,this.allowed=!0,this.disabled=!1,this.currentVideoQuality=it.HIGH,this.handleEnded=s=>{this.setTrack(void 0),this.emit(re.Ended,s)},this.handleVisibilityChange=s=>{this.log.debug("adaptivestream video visibility ".concat(this.trackSid,", visible=").concat(s),this.logContext),this.disabled=!s,this.emitTrackUpdate()},this.handleVideoDimensionsChange=s=>{this.log.debug("adaptivestream video dimensions ".concat(s.width,"x").concat(s.height),this.logContext),this.videoDimensions=s,this.emitTrackUpdate()},this.subscribed=i,this.updateInfo(n)}setSubscribed(e){const n=this.subscriptionStatus,i=this.permissionStatus;this.subscribed=e,e&&(this.allowed=!0);const r=new vn({trackSids:[this.trackSid],subscribe:this.subscribed,participantTracks:[new ci({participantSid:"",trackSids:[this.trackSid]})]});this.emit(re.UpdateSubscription,r),this.emitSubscriptionUpdateIfChanged(n),this.emitPermissionUpdateIfChanged(i)}get subscriptionStatus(){return this.subscribed===!1?Ni.SubscriptionStatus.Unsubscribed:super.isSubscribed?Ni.SubscriptionStatus.Subscribed:Ni.SubscriptionStatus.Desired}get permissionStatus(){return this.allowed?Ni.PermissionStatus.Allowed:Ni.PermissionStatus.NotAllowed}get isSubscribed(){return this.subscribed===!1?!1:super.isSubscribed}get isDesired(){return this.subscribed!==!1}get isEnabled(){return!this.disabled}setEnabled(e){!this.isManualOperationAllowed()||this.disabled===!e||(this.disabled=!e,this.emitTrackUpdate())}setVideoQuality(e){!this.isManualOperationAllowed()||this.currentVideoQuality===e||(this.currentVideoQuality=e,this.videoDimensions=void 0,this.emitTrackUpdate())}setVideoDimensions(e){var n,i;this.isManualOperationAllowed()&&(((n=this.videoDimensions)===null||n===void 0?void 0:n.width)===e.width&&((i=this.videoDimensions)===null||i===void 0?void 0:i.height)===e.height||(this.track instanceof il&&(this.videoDimensions=e),this.currentVideoQuality=void 0,this.emitTrackUpdate()))}setVideoFPS(e){this.isManualOperationAllowed()&&this.track instanceof il&&this.fps!==e&&(this.fps=e,this.emitTrackUpdate())}get videoQuality(){return this.currentVideoQuality}setTrack(e){const n=this.subscriptionStatus,i=this.permissionStatus,r=this.track;r!==e&&(r&&(r.off(re.VideoDimensionsChanged,this.handleVideoDimensionsChange),r.off(re.VisibilityChanged,this.handleVisibilityChange),r.off(re.Ended,this.handleEnded),r.detach(),r.stopMonitor(),this.emit(re.Unsubscribed,r)),super.setTrack(e),e&&(e.sid=this.trackSid,e.on(re.VideoDimensionsChanged,this.handleVideoDimensionsChange),e.on(re.VisibilityChanged,this.handleVisibilityChange),e.on(re.Ended,this.handleEnded),this.emit(re.Subscribed,e)),this.emitPermissionUpdateIfChanged(i),this.emitSubscriptionUpdateIfChanged(n))}setAllowed(e){const n=this.subscriptionStatus,i=this.permissionStatus;this.allowed=e,this.emitPermissionUpdateIfChanged(i),this.emitSubscriptionUpdateIfChanged(n)}setSubscriptionError(e){this.emit(re.SubscriptionFailed,e)}updateInfo(e){super.updateInfo(e);const n=this.metadataMuted;this.metadataMuted=e.muted,this.track?this.track.setMuted(e.muted):n!==e.muted&&this.emit(e.muted?re.Muted:re.Unmuted)}emitSubscriptionUpdateIfChanged(e){const n=this.subscriptionStatus;e!==n&&this.emit(re.SubscriptionStatusChanged,n,e)}emitPermissionUpdateIfChanged(e){this.permissionStatus!==e&&this.emit(re.SubscriptionPermissionChanged,this.permissionStatus,e)}isManualOperationAllowed(){return this.kind===$.Kind.Video&&this.isAdaptiveStream?(this.log.warn("adaptive stream is enabled, cannot change video track settings",this.logContext),!1):this.isDesired?!0:(this.log.warn("cannot update track settings when not subscribed",this.logContext),!1)}get isAdaptiveStream(){return this.track instanceof il&&this.track.isAdaptiveStream}emitTrackUpdate(){const e=new pi({trackSids:[this.trackSid],disabled:this.disabled,fps:this.fps});this.videoDimensions?(e.width=Math.ceil(this.videoDimensions.width),e.height=Math.ceil(this.videoDimensions.height)):this.currentVideoQuality!==void 0?e.quality=this.currentVideoQuality:e.quality=it.HIGH,this.emit(re.UpdateSettings,e)}}class xl extends hb{static fromParticipantInfo(e,n){return new xl(e,n.sid,n.identity,n.name,n.metadata)}constructor(e,n,i,r,s,a){super(n,i||"",r,s,a),this.signalClient=e,this.tracks=new Map,this.audioTracks=new Map,this.videoTracks=new Map,this.volumeMap=new Map}addTrackPublication(e){super.addTrackPublication(e),e.on(re.UpdateSettings,n=>{this.log.debug("send update settings",Object.assign(Object.assign({},this.logContext),Le(e))),this.signalClient.sendUpdateTrackSettings(n)}),e.on(re.UpdateSubscription,n=>{n.participantTracks.forEach(i=>{i.participantSid=this.sid}),this.signalClient.sendUpdateSubscription(n)}),e.on(re.SubscriptionPermissionChanged,n=>{this.emit(Z.TrackSubscriptionPermissionChanged,e,n)}),e.on(re.SubscriptionStatusChanged,n=>{this.emit(Z.TrackSubscriptionStatusChanged,e,n)}),e.on(re.Subscribed,n=>{this.emit(Z.TrackSubscribed,n,e)}),e.on(re.Unsubscribed,n=>{this.emit(Z.TrackUnsubscribed,n,e)}),e.on(re.SubscriptionFailed,n=>{this.emit(Z.TrackSubscriptionFailed,e.trackSid,n)})}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setVolume(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:$.Source.Microphone;this.volumeMap.set(n,e);const i=this.getTrack(n);i&&i.track&&i.track.setVolume(e)}getVolume(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:$.Source.Microphone;const n=this.getTrack(e);return n&&n.track?n.track.getVolume():this.volumeMap.get(e)}addSubscribedMediaTrack(e,n,i,r,s,a){let o=this.getTrackPublication(n);if(o||n.startsWith("TR")||this.tracks.forEach(d=>{!o&&e.kind===d.kind.toString()&&(o=d)}),!o){if(a===0){this.log.error("could not find published track",Object.assign(Object.assign({},this.logContext),{trackSid:n})),this.emit(Z.TrackSubscriptionFailed,n);return}a===void 0&&(a=20),setTimeout(()=>{this.addSubscribedMediaTrack(e,n,i,r,s,a-1)},150);return}if(e.readyState==="ended"){this.log.error("unable to subscribe because MediaStreamTrack is ended. Do not call MediaStreamTrack.stop()",Object.assign(Object.assign({},this.logContext),Le(o))),this.emit(Z.TrackSubscriptionFailed,n);return}const l=e.kind==="video";let c;return l?c=new il(e,n,r,s):c=new Po(e,n,r,this.audioContext,this.audioOutput),c.source=o.source,c.isMuted=o.isMuted,c.setMediaStream(i),c.start(),o.setTrack(c),this.volumeMap.has(o.source)&&c instanceof Po&&c.setVolume(this.volumeMap.get(o.source)),o}get hasMetadata(){return!!this.participantInfo}getTrackPublication(e){return this.tracks.get(e)}updateInfo(e){if(!super.updateInfo(e))return!1;const n=new Map,i=new Map;return e.tracks.forEach(r=>{var s,a;let o=this.getTrackPublication(r.sid);if(o)o.updateInfo(r);else{const l=$.kindFromProto(r.type);if(!l)return;o=new Rl(l,r,(s=this.signalClient.connectOptions)===null||s===void 0?void 0:s.autoSubscribe,{loggerContextCb:()=>this.logContext,loggerName:(a=this.loggerOptions)===null||a===void 0?void 0:a.loggerName}),o.updateInfo(r),i.set(r.sid,o);const c=Array.from(this.tracks.values()).find(d=>d.source===(o==null?void 0:o.source));c&&o.source!==$.Source.Unknown&&this.log.debug("received a second track publication for ".concat(this.identity," with the same source: ").concat(o.source),Object.assign(Object.assign({},this.logContext),{oldTrack:Le(c),newTrack:Le(o)})),this.addTrackPublication(o)}n.set(r.sid,o)}),this.tracks.forEach(r=>{n.has(r.trackSid)||(this.log.trace("detected removed track on remote participant, unpublishing",Object.assign(Object.assign({},this.logContext),Le(r))),this.unpublishTrack(r.trackSid,!0))}),i.forEach(r=>{this.emit(Z.TrackPublished,r)}),!0}unpublishTrack(e,n){const i=this.tracks.get(e);if(!i)return;const{track:r}=i;switch(r&&(r.stop(),i.setTrack(void 0)),this.tracks.delete(e),i.kind){case $.Kind.Audio:this.audioTracks.delete(e);break;case $.Kind.Video:this.videoTracks.delete(e);break}n&&this.emit(Z.TrackUnpublished,i)}setAudioOutput(e){return H(this,void 0,void 0,function*(){this.audioOutput=e;const n=[];this.audioTracks.forEach(i=>{var r;i.track instanceof Po&&n.push(i.track.setSinkId((r=e.deviceId)!==null&&r!==void 0?r:"default"))}),yield Promise.all(n)})}emit(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return this.log.trace("participant event",Object.assign(Object.assign({},this.logContext),{event:e,args:i})),super.emit(e,...i)}}class Pl extends hb{constructor(e,n,i,r){super(e,n,void 0,void 0,{loggerName:r.loggerName,loggerContextCb:()=>this.engine.logContext}),this.pendingPublishing=new Set,this.pendingPublishPromises=new Map,this.participantTrackPermissions=[],this.allParticipantsAllowedToSubscribe=!0,this.encryptionType=dt.NONE,this.handleReconnecting=()=>{this.reconnectFuture||(this.reconnectFuture=new nb)},this.handleReconnected=()=>{var s,a;(a=(s=this.reconnectFuture)===null||s===void 0?void 0:s.resolve)===null||a===void 0||a.call(s),this.reconnectFuture=void 0,this.updateTrackSubscriptionPermissions()},this.handleDisconnected=()=>{var s,a;this.reconnectFuture&&(this.reconnectFuture.promise.catch(o=>this.log.warn(o.message,this.logContext)),(a=(s=this.reconnectFuture)===null||s===void 0?void 0:s.reject)===null||a===void 0||a.call(s,"Got disconnected during reconnection attempt"),this.reconnectFuture=void 0)},this.updateTrackSubscriptionPermissions=()=>{this.log.debug("updating track subscription permissions",Object.assign(Object.assign({},this.logContext),{allParticipantsAllowed:this.allParticipantsAllowedToSubscribe,participantTrackPermissions:this.participantTrackPermissions})),this.engine.client.sendUpdateSubscriptionPermissions(this.allParticipantsAllowedToSubscribe,this.participantTrackPermissions.map(s=>Ux(s)))},this.onTrackUnmuted=s=>{this.onTrackMuted(s,s.isUpstreamPaused)},this.onTrackMuted=(s,a)=>{if(a===void 0&&(a=!0),!s.sid){this.log.error("could not update mute status for unpublished track",Object.assign(Object.assign({},this.logContext),Le(s)));return}this.engine.updateMuteStatus(s.sid,a)},this.onTrackUpstreamPaused=s=>{this.log.debug("upstream paused",Object.assign(Object.assign({},this.logContext),Le(s))),this.onTrackMuted(s,!0)},this.onTrackUpstreamResumed=s=>{this.log.debug("upstream resumed",Object.assign(Object.assign({},this.logContext),Le(s))),this.onTrackMuted(s,s.isMuted)},this.handleSubscribedQualityUpdate=s=>H(this,void 0,void 0,function*(){var a,o,l,c,d,u;if(!(!((d=this.roomOptions)===null||d===void 0)&&d.dynacast))return;const m=this.videoTracks.get(s.trackSid);if(!m){this.log.warn("received subscribed quality update for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}if(s.subscribedCodecs.length>0){if(!m.videoTrack)return;const p=yield m.videoTrack.setPublishingCodecs(s.subscribedCodecs);try{for(var v=!0,y=no(p),_;_=yield y.next(),a=_.done,!a;v=!0){c=_.value,v=!1;const f=c;zR(f)&&(this.log.debug("publish ".concat(f," for ").concat(m.videoTrack.sid),Object.assign(Object.assign({},this.logContext),Le(m))),yield this.publishAdditionalCodecForTrack(m.videoTrack,f,m.options))}}catch(f){o={error:f}}finally{try{!v&&!a&&(l=y.return)&&(yield l.call(y))}finally{if(o)throw o.error}}}else s.subscribedQualities.length>0&&(yield(u=m.videoTrack)===null||u===void 0?void 0:u.setPublishingLayers(s.subscribedQualities))}),this.handleLocalTrackUnpublished=s=>{const a=this.tracks.get(s.trackSid);if(!a){this.log.warn("received unpublished event for unknown track",Object.assign(Object.assign({},this.logContext),{trackSid:s.trackSid}));return}this.unpublishTrack(a.track)},this.handleTrackEnded=s=>H(this,void 0,void 0,function*(){if(s.source===$.Source.ScreenShare||s.source===$.Source.ScreenShareAudio)this.log.debug("unpublishing local track due to TrackEnded",Object.assign(Object.assign({},this.logContext),Le(s))),this.unpublishTrack(s);else if(s.isUserProvided)yield s.mute();else if(s instanceof Zt||s instanceof dn)try{if(Jt())try{const a=yield navigator==null?void 0:navigator.permissions.query({name:s.source===$.Source.Camera?"camera":"microphone"});if(a&&a.state==="denied")throw this.log.warn("user has revoked access to ".concat(s.source),Object.assign(Object.assign({},this.logContext),Le(s))),a.onchange=()=>{a.state!=="denied"&&(s.isMuted||s.restartTrack(),a.onchange=null)},new Error("GetUserMedia Permission denied")}catch{}s.isMuted||(this.log.debug("track ended, attempting to use a different device",Object.assign(Object.assign({},this.logContext),Le(s))),yield s.restartTrack())}catch{this.log.warn("could not restart track, muting instead",Object.assign(Object.assign({},this.logContext),Le(s))),yield s.mute()}}),this.audioTracks=new Map,this.videoTracks=new Map,this.tracks=new Map,this.engine=i,this.roomOptions=r,this.setupEngine(i),this.activeDeviceMap=new Map}get lastCameraError(){return this.cameraError}get lastMicrophoneError(){return this.microphoneError}get isE2EEEnabled(){return this.encryptionType!==dt.NONE}getTrack(e){const n=super.getTrack(e);if(n)return n}getTrackByName(e){const n=super.getTrackByName(e);if(n)return n}setupEngine(e){this.engine=e,this.engine.on(ue.RemoteMute,(n,i)=>{const r=this.tracks.get(n);!r||!r.track||(i?r.mute():r.unmute())}),this.engine.on(ue.Connected,this.handleReconnected).on(ue.SignalRestarted,this.handleReconnected).on(ue.SignalResumed,this.handleReconnected).on(ue.Restarting,this.handleReconnecting).on(ue.Resuming,this.handleReconnecting).on(ue.LocalTrackUnpublished,this.handleLocalTrackUnpublished).on(ue.SubscribedQualityUpdate,this.handleSubscribedQualityUpdate).on(ue.Disconnected,this.handleDisconnected)}setMetadata(e){var n;this.engine.client.sendUpdateLocalMetadata(e,(n=this.name)!==null&&n!==void 0?n:"")}setName(e){var n;this.engine.client.sendUpdateLocalMetadata((n=this.metadata)!==null&&n!==void 0?n:"",e)}setCameraEnabled(e,n,i){return this.setTrackEnabled($.Source.Camera,e,n,i)}setMicrophoneEnabled(e,n,i){return this.setTrackEnabled($.Source.Microphone,e,n,i)}setScreenShareEnabled(e,n,i){return this.setTrackEnabled($.Source.ScreenShare,e,n,i)}setPermissions(e){const n=this.permissions,i=super.setPermissions(e);return i&&n&&this.emit(Z.ParticipantPermissionsChanged,n),i}setE2EEEnabled(e){return H(this,void 0,void 0,function*(){this.encryptionType=e?dt.GCM:dt.NONE,yield this.republishAllTracks(void 0,!1)})}setTrackEnabled(e,n,i,r){var s,a;return H(this,void 0,void 0,function*(){this.log.debug("setTrackEnabled",Object.assign(Object.assign({},this.logContext),{source:e,enabled:n}));let o=this.getTrack(e);if(n)if(o)yield o.unmute();else{let l;if(this.pendingPublishing.has(e)){this.log.info("skipping duplicate published source",Object.assign(Object.assign({},this.logContext),{source:e}));return}this.pendingPublishing.add(e);try{switch(e){case $.Source.Camera:l=yield this.createTracks({video:(s=i)!==null&&s!==void 0?s:!0});break;case $.Source.Microphone:l=yield this.createTracks({audio:(a=i)!==null&&a!==void 0?a:!0});break;case $.Source.ScreenShare:l=yield this.createScreenTracks(Object.assign({},i));break;default:throw new ri(e)}const c=[];for(const u of l)this.log.info("publishing track",Object.assign(Object.assign({},this.logContext),Le(u))),c.push(this.publishTrack(u,r));[o]=yield Promise.all(c)}catch(c){throw l==null||l.forEach(d=>{d.stop()}),c instanceof Error&&!(c instanceof ri)&&this.emit(Z.MediaDevicesError,c),c}finally{this.pendingPublishing.delete(e)}}else if(o&&o.track)if(e===$.Source.ScreenShare){o=yield this.unpublishTrack(o.track);const l=this.getTrack($.Source.ScreenShareAudio);l&&l.track&&this.unpublishTrack(l.track)}else yield o.mute();return o})}enableCameraAndMicrophone(){return H(this,void 0,void 0,function*(){if(!(this.pendingPublishing.has($.Source.Camera)||this.pendingPublishing.has($.Source.Microphone))){this.pendingPublishing.add($.Source.Camera),this.pendingPublishing.add($.Source.Microphone);try{const e=yield this.createTracks({audio:!0,video:!0});yield Promise.all(e.map(n=>this.publishTrack(n)))}finally{this.pendingPublishing.delete($.Source.Camera),this.pendingPublishing.delete($.Source.Microphone)}}})}createTracks(e){var n,i;return H(this,void 0,void 0,function*(){const r=QC(e,(n=this.roomOptions)===null||n===void 0?void 0:n.audioCaptureDefaults,(i=this.roomOptions)===null||i===void 0?void 0:i.videoCaptureDefaults),s=ld(r);let a;try{a=yield navigator.mediaDevices.getUserMedia(s)}catch(o){throw o instanceof Error&&(s.audio&&(this.microphoneError=o),s.video&&(this.cameraError=o)),o}return s.audio&&(this.microphoneError=void 0,this.emit(Z.AudioStreamAcquired)),s.video&&(this.cameraError=void 0),a.getTracks().map(o=>{const l=o.kind==="audio";l?e.audio:e.video;let c;const d=l?s.audio:s.video;typeof d!="boolean"&&(c=d);const u=lb(o,c,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});return u.kind===$.Kind.Video?u.source=$.Source.Camera:u.kind===$.Kind.Audio&&(u.source=$.Source.Microphone),u.mediaStream=a,u})})}createScreenTracks(e){return H(this,void 0,void 0,function*(){if(e===void 0&&(e={}),navigator.mediaDevices.getDisplayMedia===void 0)throw new Cm("getDisplayMedia not supported");e.resolution===void 0&&!ex()&&(e.resolution=wm.h1080fps30.resolution);const n=VR(e),i=yield navigator.mediaDevices.getDisplayMedia(n),r=i.getVideoTracks();if(r.length===0)throw new ri("no video track found");const s=new dn(r[0],void 0,!1,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});s.source=$.Source.ScreenShare,e.contentHint&&(s.mediaStreamTrack.contentHint=e.contentHint);const a=[s];if(i.getAudioTracks().length>0){this.emit(Z.AudioStreamAcquired);const o=new Zt(i.getAudioTracks()[0],void 0,!1,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});o.source=$.Source.ScreenShareAudio,a.push(o)}return a})}publishTrack(e,n){var i,r,s,a;return H(this,void 0,void 0,function*(){yield(i=this.reconnectFuture)===null||i===void 0?void 0:i.promise,e instanceof Yo&&this.pendingPublishPromises.has(e)&&(yield this.pendingPublishPromises.get(e));let o;if(e instanceof MediaStreamTrack)o=e.getConstraints();else{o=e.constraints;let v;switch(e.source){case $.Source.Microphone:v="audioinput";break;case $.Source.Camera:v="videoinput"}v&&this.activeDeviceMap.has(v)&&(o=Object.assign(Object.assign({},o),{deviceId:this.activeDeviceMap.get(v)}))}if(e instanceof MediaStreamTrack)switch(e.kind){case"audio":e=new Zt(e,o,!0,this.audioContext,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;case"video":e=new dn(e,o,!0,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});break;default:throw new ri("unsupported MediaStreamTrack kind ".concat(e.kind))}else e.updateLoggerOptions({loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});e instanceof Zt&&e.setAudioContext(this.audioContext);let l;if(this.tracks.forEach(v=>{v.track&&v.track===e&&(l=v)}),l)return this.log.warn("track has already been published, skipping",Object.assign(Object.assign({},this.logContext),Le(l))),l;const c="channelCount"in e.mediaStreamTrack.getSettings()&&e.mediaStreamTrack.getSettings().channelCount===2||e.mediaStreamTrack.getConstraints().channelCount===2,d=(r=n==null?void 0:n.forceStereo)!==null&&r!==void 0?r:c;d&&(n||(n={}),n.dtx===void 0&&this.log.info("Opus DTX will be disabled for stereo tracks by default. Enable them explicitly to make it work.",Object.assign(Object.assign({},this.logContext),Le(e))),n.red===void 0&&this.log.info("Opus RED will be disabled for stereo tracks by default. Enable them explicitly to make it work."),(s=n.dtx)!==null&&s!==void 0||(n.dtx=!1),(a=n.red)!==null&&a!==void 0||(n.red=!1));const u=Object.assign(Object.assign({},this.roomOptions.publishDefaults),n);Ws()&&this.roomOptions.e2ee&&(this.log.info("End-to-end encryption is set up, simulcast publishing will be disabled on Safari",Object.assign({},this.logContext)),u.simulcast=!1),u.source&&(e.source=u.source);const m=this.publish(e,u,d);this.pendingPublishPromises.set(e,m);try{return yield m}catch(v){throw v}finally{this.pendingPublishPromises.delete(e)}})}publish(e,n,i){var r,s,a,o,l,c,d,u,m,v,y,_,p;return H(this,void 0,void 0,function*(){Array.from(this.tracks.values()).find(C=>e instanceof Yo&&C.source===e.source)&&e.source!==$.Source.Unknown&&this.log.info("publishing a second track with the same source: ".concat(e.source),Object.assign(Object.assign({},this.logContext),Le(e))),n.stopMicTrackOnMute&&e instanceof Zt&&(e.stopOnMute=!0),e.source===$.Source.ScreenShare&&Xo()&&(n.simulcast=!1),n.videoCodec==="av1"&&!KR()&&(n.videoCodec=void 0),n.videoCodec==="vp9"&&!QR()&&(n.videoCodec=void 0),n.videoCodec===void 0&&(n.videoCodec=Kf);const h=n.videoCodec;e.on(re.Muted,this.onTrackMuted),e.on(re.Unmuted,this.onTrackUnmuted),e.on(re.Ended,this.handleTrackEnded),e.on(re.UpstreamPaused,this.onTrackUpstreamPaused),e.on(re.UpstreamResumed,this.onTrackUpstreamResumed);const g=new Bn({cid:e.mediaStreamTrack.id,name:n.name,type:$.kindToProto(e.kind),muted:e.isMuted,source:$.sourceToProto(e.source),disableDtx:!(!((r=n.dtx)!==null&&r!==void 0)||r),encryption:this.encryptionType,stereo:i,disableRed:this.isE2EEEnabled||!(!((s=n.red)!==null&&s!==void 0)||s),stream:n==null?void 0:n.stream});let S;if(e.kind===$.Kind.Video){let C={width:0,height:0};try{C=yield e.waitForDimensions()}catch{const x=(o=(a=this.roomOptions.videoCaptureDefaults)===null||a===void 0?void 0:a.resolution)!==null&&o!==void 0?o:El.h720.resolution;C={width:x.width,height:x.height},this.log.error("could not determine track dimensions, using defaults",Object.assign(Object.assign(Object.assign({},this.logContext),Le(e)),{dims:C}))}g.width=C.width,g.height=C.height,e instanceof dn&&(tl(h)&&(e.source===$.Source.ScreenShare&&h==="vp9"&&(n.scalabilityMode="L1T3"),n.scalabilityMode=(l=n.scalabilityMode)!==null&&l!==void 0?l:"L3T3_KEY"),g.simulcastCodecs=[new Nn({codec:h,cid:e.mediaStreamTrack.id})],n.backupCodec===!0&&(n.backupCodec={codec:Kf}),n.backupCodec&&h!==n.backupCodec.codec&&g.encryption===dt.NONE&&(this.roomOptions.dynacast||(this.roomOptions.dynacast=!0),g.simulcastCodecs.push(new Nn({codec:n.backupCodec.codec,cid:""})))),S=Xf(e.source===$.Source.ScreenShare,g.width,g.height,n),g.layers=n0(g.width,g.height,S,tl(n.videoCodec))}else e.kind===$.Kind.Audio&&(S=[{maxBitrate:(d=(c=n.audioPreset)===null||c===void 0?void 0:c.maxBitrate)!==null&&d!==void 0?d:n.audioBitrate,priority:(m=(u=n.audioPreset)===null||u===void 0?void 0:u.priority)!==null&&m!==void 0?m:"high",networkPriority:(y=(v=n.audioPreset)===null||v===void 0?void 0:v.priority)!==null&&y!==void 0?y:"high"}]);if(!this.engine||this.engine.isClosed)throw new Ye("cannot publish track when not connected");const b=yield this.engine.addTrack(g);let w;if(b.codecs.forEach(C=>{w===void 0&&(w=C.mimeType)}),w&&e.kind===$.Kind.Video){const C=YC(w);C!==h&&(this.log.debug("falling back to server selected codec",Object.assign(Object.assign(Object.assign({},this.logContext),Le(e)),{codec:C})),n.videoCodec=C,S=Xf(e.source===$.Source.ScreenShare,g.width,g.height,n))}const k=new Tl(e.kind,b,e,{loggerName:this.roomOptions.loggerName,loggerContextCb:()=>this.logContext});if(k.options=n,e.sid=b.sid,!this.engine.pcManager)throw new Ye("pcManager is not ready");if(this.log.debug("publishing ".concat(e.kind," with encodings"),Object.assign(Object.assign({},this.logContext),{encodings:S,trackInfo:b})),e.sender=yield this.engine.createSender(e,n,S),S)if(Xo()&&e.kind===$.Kind.Audio){let C;for(const E of this.engine.pcManager.publisher.getTransceivers())if(E.sender===e.sender){C=E;break}C&&this.engine.pcManager.publisher.setTrackCodecBitrate({transceiver:C,codec:"opus",maxbr:!((_=S[0])===null||_===void 0)&&_.maxBitrate?S[0].maxBitrate/1e3:0})}else e.codec&&tl(e.codec)&&(!((p=S[0])===null||p===void 0)&&p.maxBitrate)&&this.engine.pcManager.publisher.setTrackCodecBitrate({cid:g.cid,codec:e.codec,maxbr:S[0].maxBitrate/1e3});return yield this.engine.negotiate(),e instanceof dn?e.startMonitor(this.engine.client):e instanceof Zt&&e.startMonitor(),this.addTrackPublication(k),this.emit(Z.LocalTrackPublished,k),k})}get isLocal(){return!0}publishAdditionalCodecForTrack(e,n,i){var r;return H(this,void 0,void 0,function*(){if(this.encryptionType!==dt.NONE)return;let s;if(this.tracks.forEach(u=>{u.track&&u.track===e&&(s=u)}),!s)throw new ri("track is not published");if(!(e instanceof dn))throw new ri("track is not a video track");const a=Object.assign(Object.assign({},(r=this.roomOptions)===null||r===void 0?void 0:r.publishDefaults),i),o=Mx(e,n,a);if(!o){this.log.info("backup codec has been disabled, ignoring request to add additional codec for track",Object.assign(Object.assign({},this.logContext),Le(e)));return}const l=e.addSimulcastTrack(n,o),c=new Bn({cid:l.mediaStreamTrack.id,type:$.kindToProto(e.kind),muted:e.isMuted,source:$.sourceToProto(e.source),sid:e.sid,simulcastCodecs:[{codec:a.videoCodec,cid:l.mediaStreamTrack.id}]});if(c.layers=n0(c.width,c.height,o),!this.engine||this.engine.isClosed)throw new Ye("cannot publish track when not connected");const d=yield this.engine.addTrack(c);yield this.engine.createSimulcastSender(e,l,a,o),yield this.engine.negotiate(),this.log.debug("published ".concat(n," for track ").concat(e.sid),Object.assign(Object.assign({},this.logContext),{encodings:o,trackInfo:d}))})}unpublishTrack(e,n){var i,r;return H(this,void 0,void 0,function*(){const s=this.getPublicationForTrack(e),a=s?Le(s):void 0;if(this.log.debug("unpublishing track",Object.assign(Object.assign({},this.logContext),a)),!s||!s.track){this.log.warn("track was not unpublished because no publication was found",Object.assign(Object.assign({},this.logContext),a));return}e=s.track,e.off(re.Muted,this.onTrackMuted),e.off(re.Unmuted,this.onTrackUnmuted),e.off(re.Ended,this.handleTrackEnded),e.off(re.UpstreamPaused,this.onTrackUpstreamPaused),e.off(re.UpstreamResumed,this.onTrackUpstreamResumed),n===void 0&&(n=(r=(i=this.roomOptions)===null||i===void 0?void 0:i.stopLocalTrackOnUnpublish)!==null&&r!==void 0?r:!0),n&&e.stop();let o=!1;const l=e.sender;if(e.sender=void 0,this.engine.pcManager&&this.engine.pcManager.currentState<et.FAILED&&l)try{for(const c of this.engine.pcManager.publisher.getTransceivers())c.sender===l&&(c.direction="inactive",o=!0);if(this.engine.removeTrack(l)&&(o=!0),e instanceof dn){for(const[,c]of e.simulcastCodecs)c.sender&&(this.engine.removeTrack(c.sender)&&(o=!0),c.sender=void 0);e.simulcastCodecs.clear()}}catch(c){this.log.warn("failed to unpublish track",Object.assign(Object.assign(Object.assign({},this.logContext),a),{error:c}))}switch(this.tracks.delete(s.trackSid),s.kind){case $.Kind.Audio:this.audioTracks.delete(s.trackSid);break;case $.Kind.Video:this.videoTracks.delete(s.trackSid);break}return this.emit(Z.LocalTrackUnpublished,s),s.setTrack(void 0),o&&(yield this.engine.negotiate()),s})}unpublishTracks(e){return H(this,void 0,void 0,function*(){return(yield Promise.all(e.map(i=>this.unpublishTrack(i)))).filter(i=>i instanceof Tl)})}republishAllTracks(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return H(this,void 0,void 0,function*(){const i=[];this.tracks.forEach(r=>{r.track&&(e&&(r.options=Object.assign(Object.assign({},r.options),e)),i.push(r))}),yield Promise.all(i.map(r=>H(this,void 0,void 0,function*(){const s=r.track;yield this.unpublishTrack(s,!1),n&&!s.isMuted&&s.source!==$.Source.ScreenShare&&s.source!==$.Source.ScreenShareAudio&&(s instanceof Zt||s instanceof dn)&&!s.isUserProvided&&(this.log.debug("restarting existing track",Object.assign(Object.assign({},this.logContext),{track:r.trackSid})),yield s.restartTrack()),yield this.publishTrack(s,r.options)})))})}publishData(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};return H(this,void 0,void 0,function*(){const r=Array.isArray(i)?i:i==null?void 0:i.destination,s=[],a=Array.isArray(i)?void 0:i.topic;r!==void 0&&r.forEach(l=>{l instanceof xl?s.push(l.sid):s.push(l)});const o=new oi({kind:n,value:{case:"user",value:new li({participantSid:this.sid,payload:e,destinationSids:s,topic:a})}});yield this.engine.sendDataPacket(o,n)})}setTrackSubscriptionPermissions(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:[];this.participantTrackPermissions=n,this.allParticipantsAllowedToSubscribe=e,this.engine.client.isDisconnected||this.updateTrackSubscriptionPermissions()}updateInfo(e){return e.sid!==this.sid||!super.updateInfo(e)?!1:(e.tracks.forEach(n=>{var i,r;const s=this.tracks.get(n.sid);if(s){const a=s.isMuted||((r=(i=s.track)===null||i===void 0?void 0:i.isUpstreamPaused)!==null&&r!==void 0?r:!1);a!==n.muted&&(this.log.debug("updating server mute state after reconcile",Object.assign(Object.assign(Object.assign({},this.logContext),Le(s)),{mutedOnServer:a})),this.engine.client.sendMuteTrack(n.sid,a))}}),!0)}getPublicationForTrack(e){let n;return this.tracks.forEach(i=>{const r=i.track;r&&(e instanceof MediaStreamTrack?(r instanceof Zt||r instanceof dn)&&r.mediaStreamTrack===e&&(n=i):e===r&&(n=i))}),n}}var ye;(function(t){t.Disconnected="disconnected",t.Connecting="connecting",t.Connected="connected",t.Reconnecting="reconnecting"})(ye||(ye={}));const zx=2*1e3;class Ru extends xi.EventEmitter{constructor(e){var n,i,r;super(),n=this,this.state=ye.Disconnected,this.activeSpeakers=[],this.isE2EEEnabled=!1,this.audioEnabled=!0,this.isVideoPlaybackBlocked=!1,this.log=_e,this.bufferedEvents=[],this.connect=(s,a,o)=>H(this,void 0,void 0,function*(){var l;const c=yield this.disconnectLock.lock();if(this.state===ye.Connected)return this.log.info("already connected to room ".concat(this.name),this.logContext),c(),Promise.resolve();if(this.connectFuture)return c(),this.connectFuture.promise;this.setAndEmitConnectionState(ye.Connecting),((l=this.regionUrlProvider)===null||l===void 0?void 0:l.getServerUrl().toString())!==s&&(this.regionUrl=void 0,this.regionUrlProvider=void 0),Jf(new URL(s))&&(this.regionUrlProvider===void 0?this.regionUrlProvider=new Yv(s,a):this.regionUrlProvider.updateToken(a),this.regionUrlProvider.fetchRegionSettings().catch(m=>{this.log.warn("could not fetch region settings",Object.assign(Object.assign({},this.logContext),{error:m}))}));const d=(m,v,y)=>H(this,void 0,void 0,function*(){var _;this.abortController&&this.abortController.abort();const p=new AbortController;this.abortController=p,c==null||c();try{yield this.attemptConnection(y??s,a,o,p),this.abortController=void 0,m()}catch(f){if(this.regionUrlProvider&&f instanceof xe&&f.reason!==3&&f.reason!==0){let h=null;try{h=yield this.regionUrlProvider.getNextBestRegionUrl((_=this.abortController)===null||_===void 0?void 0:_.signal)}catch(g){if(g instanceof xe&&(g.status===401||g.reason===3)){this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),v(g);return}}h?(this.log.info("Initial connection failed with ConnectionError: ".concat(f.message,". Retrying with another region: ").concat(h),this.logContext),yield d(m,v,h)):(this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),v(f))}else this.handleDisconnect(this.options.stopLocalTrackOnUnpublish),v(f)}}),u=this.regionUrl;return this.regionUrl=void 0,this.connectFuture=new nb((m,v)=>{d(m,v,u)},()=>{this.clearConnectionFutures()}),this.connectFuture.promise}),this.connectSignal=(s,a,o,l,c,d)=>H(this,void 0,void 0,function*(){var u,m,v;const y=yield o.join(s,a,{autoSubscribe:l.autoSubscribe,publishOnly:l.publishOnly,adaptiveStream:typeof c.adaptiveStream=="object"?!0:c.adaptiveStream,maxRetries:l.maxRetries,e2eeEnabled:!!this.e2eeManager,websocketTimeout:l.websocketTimeout},d.signal);let _=y.serverInfo;if(_||(_={version:y.serverVersion,region:y.serverRegion}),this.log.debug("connected to Livekit Server ".concat(Object.entries(_).map(p=>{let[f,h]=p;return"".concat(f,": ").concat(h)}).join(", ")),{room:(u=y.room)===null||u===void 0?void 0:u.name,roomSid:(m=y.room)===null||m===void 0?void 0:m.sid,identity:(v=y.participant)===null||v===void 0?void 0:v.identity}),!y.serverVersion)throw new MR("unknown server version");return y.serverVersion==="0.15.1"&&this.options.dynacast&&(this.log.debug("disabling dynacast due to server version",this.logContext),c.dynacast=!1),y}),this.applyJoinResponse=s=>{const a=s.participant;this.localParticipant.sid=a.sid,this.localParticipant.identity=a.identity,this.handleParticipantUpdates([a,...s.otherParticipants]),s.room&&this.handleRoomUpdate(s.room),this.options.e2ee&&this.e2eeManager&&this.e2eeManager.setSifTrailer(s.sifTrailer)},this.attemptConnection=(s,a,o,l)=>H(this,void 0,void 0,function*(){var c,d;this.state===ye.Reconnecting?(this.log.info("Reconnection attempt replaced by new connection attempt",this.logContext),this.recreateEngine()):this.maybeCreateEngine(),!((c=this.regionUrlProvider)===null||c===void 0)&&c.isCloud()&&this.engine.setRegionUrlProvider(this.regionUrlProvider),this.acquireAudioContext(),this.connOptions=Object.assign(Object.assign({},Tm),o),this.connOptions.rtcConfig&&(this.engine.rtcConfig=this.connOptions.rtcConfig),this.connOptions.peerConnectionTimeout&&(this.engine.peerConnectionTimeout=this.connOptions.peerConnectionTimeout);try{const u=yield this.connectSignal(s,a,this.engine,this.connOptions,this.options,l);this.applyJoinResponse(u),this.setupLocalParticipantEvents(),this.emit(J.SignalConnected)}catch(u){yield this.engine.close(),this.recreateEngine();const m=new xe("could not establish signal connection");throw u instanceof Error&&(m.message="".concat(m.message,": ").concat(u.message)),u instanceof xe&&(m.reason=u.reason,m.status=u.status),this.log.debug("error trying to establish signal connection",Object.assign(Object.assign({},this.logContext),{error:u})),m}if(l.signal.aborted)throw yield this.engine.close(),this.recreateEngine(),new xe("Connection attempt aborted");try{yield this.engine.waitForPCInitialConnection(this.connOptions.peerConnectionTimeout,l)}catch(u){throw yield this.engine.close(),this.recreateEngine(),u}Jt()&&this.options.disconnectOnPageLeave&&(window.addEventListener("pagehide",this.onPageLeave),window.addEventListener("beforeunload",this.onPageLeave)),Jt()&&(document.addEventListener("freeze",this.onPageLeave),(d=navigator.mediaDevices)===null||d===void 0||d.addEventListener("devicechange",this.handleDeviceChange)),this.setAndEmitConnectionState(ye.Connected),this.emit(J.Connected),this.registerConnectionReconcile()}),this.disconnect=function(){let s=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0;return H(n,void 0,void 0,function*(){var a,o,l,c;const d=yield this.disconnectLock.lock();try{if(this.state===ye.Disconnected){this.log.debug("already disconnected",this.logContext);return}this.log.info("disconnect from room",Object.assign({},this.logContext)),(this.state===ye.Connecting||this.state===ye.Reconnecting)&&(this.log.warn("abort connection attempt",this.logContext),(a=this.abortController)===null||a===void 0||a.abort(),(l=(o=this.connectFuture)===null||o===void 0?void 0:o.reject)===null||l===void 0||l.call(o,new xe("Client initiated disconnect")),this.connectFuture=void 0),!((c=this.engine)===null||c===void 0)&&c.client.isDisconnected||(yield this.engine.client.sendLeave()),this.engine&&(yield this.engine.close()),this.handleDisconnect(s,dr.CLIENT_INITIATED),this.engine=void 0}finally{d()}})},this.onPageLeave=()=>H(this,void 0,void 0,function*(){yield this.disconnect()}),this.startAudio=()=>H(this,void 0,void 0,function*(){const s=[],a=yr();if(a&&a.os==="iOS"){const o="livekit-dummy-audio-el";let l=document.getElementById(o);if(!l){l=document.createElement("audio"),l.id=o,l.autoplay=!0,l.hidden=!0;const c=ph();c.enabled=!0;const d=new MediaStream([c]);l.srcObject=d,document.addEventListener("visibilitychange",()=>{l&&(l.srcObject=document.hidden?null:d,document.hidden||(this.log.debug("page visible again, triggering startAudio to resume playback and update playback status",this.logContext),this.startAudio()))}),document.body.append(l),this.once(J.Disconnected,()=>{l==null||l.remove(),l=null})}s.push(l)}this.participants.forEach(o=>{o.audioTracks.forEach(l=>{l.track&&l.track.attachedElements.forEach(c=>{s.push(c)})})});try{yield Promise.all([this.acquireAudioContext(),...s.map(o=>(o.muted=!1,o.play()))]),this.handleAudioPlaybackStarted()}catch(o){throw this.handleAudioPlaybackFailed(o),o}}),this.startVideo=()=>H(this,void 0,void 0,function*(){const s=[];for(const a of this.participants.values())a.videoTracks.forEach(o=>{var l;(l=o.track)===null||l===void 0||l.attachedElements.forEach(c=>{s.includes(c)||s.push(c)})});yield Promise.all(s.map(a=>a.play())).then(()=>{this.handleVideoPlaybackStarted()}).catch(a=>{a.name==="NotAllowedError"?this.handleVideoPlaybackFailed():this.log.warn("Resuming video playback failed, make sure you call `startVideo` directly in a user gesture handler",this.logContext)})}),this.handleRestarting=()=>{this.clearConnectionReconcile();for(const s of this.participants.values())this.handleParticipantDisconnected(s.sid,s);this.setAndEmitConnectionState(ye.Reconnecting)&&this.emit(J.Reconnecting)},this.handleSignalRestarted=s=>H(this,void 0,void 0,function*(){this.log.debug("signal reconnected to server, region ".concat(s.serverRegion),Object.assign(Object.assign({},this.logContext),{region:s.serverRegion})),this.bufferedEvents=[],this.applyJoinResponse(s);try{yield this.localParticipant.republishAllTracks(void 0,!0)}catch(a){this.log.error("error trying to re-publish tracks after reconnection",Object.assign(Object.assign({},this.logContext),{error:a}))}try{yield this.engine.waitForRestarted(),this.log.debug("fully reconnected to server",Object.assign(Object.assign({},this.logContext),{region:s.serverRegion}))}catch{return}this.setAndEmitConnectionState(ye.Connected),this.emit(J.Reconnected),this.registerConnectionReconcile(),this.emitBufferedEvents()}),this.handleParticipantUpdates=s=>{s.forEach(a=>{if(a.identity===this.localParticipant.identity){this.localParticipant.updateInfo(a);return}const o=this.identityToSid.get(a.identity);o&&o!==a.sid&&this.handleParticipantDisconnected(o,this.participants.get(o));let l=this.participants.get(a.sid);const c=!l;a.state===Hs.DISCONNECTED?this.handleParticipantDisconnected(a.sid,l):(l=this.getOrCreateParticipant(a.sid,a),c||l.updateInfo(a))})},this.handleActiveSpeakersUpdate=s=>{const a=[],o={};s.forEach(l=>{if(o[l.sid]=!0,l.sid===this.localParticipant.sid)this.localParticipant.audioLevel=l.level,this.localParticipant.setIsSpeaking(!0),a.push(this.localParticipant);else{const c=this.participants.get(l.sid);c&&(c.audioLevel=l.level,c.setIsSpeaking(!0),a.push(c))}}),o[this.localParticipant.sid]||(this.localParticipant.audioLevel=0,this.localParticipant.setIsSpeaking(!1)),this.participants.forEach(l=>{o[l.sid]||(l.audioLevel=0,l.setIsSpeaking(!1))}),this.activeSpeakers=a,this.emitWhenConnected(J.ActiveSpeakersChanged,a)},this.handleSpeakersChanged=s=>{const a=new Map;this.activeSpeakers.forEach(l=>{a.set(l.sid,l)}),s.forEach(l=>{let c=this.participants.get(l.sid);l.sid===this.localParticipant.sid&&(c=this.localParticipant),c&&(c.audioLevel=l.level,c.setIsSpeaking(l.active),l.active?a.set(l.sid,c):a.delete(l.sid))});const o=Array.from(a.values());o.sort((l,c)=>c.audioLevel-l.audioLevel),this.activeSpeakers=o,this.emitWhenConnected(J.ActiveSpeakersChanged,o)},this.handleStreamStateUpdate=s=>{s.streamStates.forEach(a=>{const o=this.participants.get(a.participantSid);if(!o)return;const l=o.getTrackPublication(a.trackSid);!l||!l.track||(l.track.streamState=$.streamStateFromProto(a.state),o.emit(Z.TrackStreamStateChanged,l,l.track.streamState),this.emitWhenConnected(J.TrackStreamStateChanged,l,l.track.streamState,o))})},this.handleSubscriptionPermissionUpdate=s=>{const a=this.participants.get(s.participantSid);if(!a)return;const o=a.getTrackPublication(s.trackSid);o&&o.setAllowed(s.allowed)},this.handleSubscriptionError=s=>{const a=Array.from(this.participants.values()).find(l=>l.tracks.has(s.trackSid));if(!a)return;const o=a.getTrackPublication(s.trackSid);o&&o.setSubscriptionError(s.err)},this.handleDataPacket=(s,a)=>{const o=this.participants.get(s.participantSid);this.emit(J.DataReceived,s.payload,o,a,s.topic),o==null||o.emit(Z.DataReceived,s.payload,a)},this.handleAudioPlaybackStarted=()=>{this.canPlaybackAudio||(this.audioEnabled=!0,this.emit(J.AudioPlaybackStatusChanged,!0))},this.handleAudioPlaybackFailed=s=>{this.log.warn("could not playback audio",Object.assign(Object.assign({},this.logContext),{error:s})),this.canPlaybackAudio&&(this.audioEnabled=!1,this.emit(J.AudioPlaybackStatusChanged,!1))},this.handleVideoPlaybackStarted=()=>{this.isVideoPlaybackBlocked&&(this.isVideoPlaybackBlocked=!1,this.emit(J.VideoPlaybackStatusChanged,!0))},this.handleVideoPlaybackFailed=()=>{this.isVideoPlaybackBlocked||(this.isVideoPlaybackBlocked=!0,this.emit(J.VideoPlaybackStatusChanged,!1))},this.handleDeviceChange=()=>H(this,void 0,void 0,function*(){this.emit(J.MediaDevicesChanged)}),this.handleRoomUpdate=s=>{const a=this.roomInfo;this.roomInfo=s,a&&a.metadata!==s.metadata&&this.emitWhenConnected(J.RoomMetadataChanged,s.metadata),(a==null?void 0:a.activeRecording)!==s.activeRecording&&this.emitWhenConnected(J.RecordingStatusChanged,s.activeRecording)},this.handleConnectionQualityUpdate=s=>{s.updates.forEach(a=>{if(a.participantSid===this.localParticipant.sid){this.localParticipant.setConnectionQuality(a.quality);return}const o=this.participants.get(a.participantSid);o&&o.setConnectionQuality(a.quality)})},this.onLocalParticipantMetadataChanged=s=>{this.emit(J.ParticipantMetadataChanged,s,this.localParticipant)},this.onLocalParticipantNameChanged=s=>{this.emit(J.ParticipantNameChanged,s,this.localParticipant)},this.onLocalTrackMuted=s=>{this.emit(J.TrackMuted,s,this.localParticipant)},this.onLocalTrackUnmuted=s=>{this.emit(J.TrackUnmuted,s,this.localParticipant)},this.onLocalTrackPublished=s=>H(this,void 0,void 0,function*(){var a;this.emit(J.LocalTrackPublished,s,this.localParticipant),s.track instanceof Zt&&(yield s.track.checkForSilence())&&this.emit(J.LocalAudioSilenceDetected,s);const o=yield(a=s.track)===null||a===void 0?void 0:a.getDeviceId(),l=$R(s.source);l&&o&&o!==this.localParticipant.activeDeviceMap.get(l)&&(this.localParticipant.activeDeviceMap.set(l,o),this.emit(J.ActiveDeviceChanged,l,o))}),this.onLocalTrackUnpublished=s=>{this.emit(J.LocalTrackUnpublished,s,this.localParticipant)},this.onLocalConnectionQualityChanged=s=>{this.emit(J.ConnectionQualityChanged,s,this.localParticipant)},this.onMediaDevicesError=s=>{this.emit(J.MediaDevicesError,s)},this.onLocalParticipantPermissionsChanged=s=>{this.emit(J.ParticipantPermissionsChanged,s,this.localParticipant)},this.setMaxListeners(100),this.participants=new Map,this.identityToSid=new Map,this.options=Object.assign(Object.assign({},bx),e),this.log=_r((i=this.options.loggerName)!==null&&i!==void 0?i:Ei.Room),this.options.audioCaptureDefaults=Object.assign(Object.assign({},ob),e==null?void 0:e.audioCaptureDefaults),this.options.videoCaptureDefaults=Object.assign(Object.assign({},ab),e==null?void 0:e.videoCaptureDefaults),this.options.publishDefaults=Object.assign(Object.assign({},Cx),e==null?void 0:e.publishDefaults),this.maybeCreateEngine(),this.disconnectLock=new $n,this.localParticipant=new Pl("","",this.engine,this.options),this.options.videoCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("videoinput",Ms(this.options.videoCaptureDefaults.deviceId)),this.options.audioCaptureDefaults.deviceId&&this.localParticipant.activeDeviceMap.set("audioinput",Ms(this.options.audioCaptureDefaults.deviceId)),!((r=this.options.audioOutput)===null||r===void 0)&&r.deviceId&&this.switchActiveDevice("audiooutput",Ms(this.options.audioOutput.deviceId)).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),this.options.e2ee&&this.setupE2EE()}setE2EEEnabled(e){return H(this,void 0,void 0,function*(){if(this.e2eeManager)yield Promise.all([this.localParticipant.setE2EEEnabled(e)]),this.localParticipant.identity!==""&&this.e2eeManager.setParticipantCryptorEnabled(e,this.localParticipant.identity);else throw Error("e2ee not configured, please set e2ee settings within the room options")})}setupE2EE(){var e;this.options.e2ee&&(this.e2eeManager=new ax(this.options.e2ee),this.e2eeManager.on(Vr.ParticipantEncryptionStatusChanged,(n,i)=>{i instanceof Pl&&(this.isE2EEEnabled=n),this.emit(J.ParticipantEncryptionStatusChanged,n,i)}),this.e2eeManager.on(Vr.EncryptionError,n=>this.emit(J.EncryptionError,n)),(e=this.e2eeManager)===null||e===void 0||e.setup(this))}get logContext(){return{room:this.name,roomSid:this.sid,identity:this.localParticipant.identity}}get isRecording(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.activeRecording)!==null&&n!==void 0?n:!1}get sid(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.sid)!==null&&n!==void 0?n:""}get name(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.name)!==null&&n!==void 0?n:""}get metadata(){var e;return(e=this.roomInfo)===null||e===void 0?void 0:e.metadata}get numParticipants(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numParticipants)!==null&&n!==void 0?n:0}get numPublishers(){var e,n;return(n=(e=this.roomInfo)===null||e===void 0?void 0:e.numPublishers)!==null&&n!==void 0?n:0}maybeCreateEngine(){this.engine&&!this.engine.isClosed||(this.engine=new Ex(this.options),this.engine.on(ue.ParticipantUpdate,this.handleParticipantUpdates).on(ue.RoomUpdate,this.handleRoomUpdate).on(ue.SpeakersChanged,this.handleSpeakersChanged).on(ue.StreamStateChanged,this.handleStreamStateUpdate).on(ue.ConnectionQualityUpdate,this.handleConnectionQualityUpdate).on(ue.SubscriptionError,this.handleSubscriptionError).on(ue.SubscriptionPermissionUpdate,this.handleSubscriptionPermissionUpdate).on(ue.MediaTrackAdded,(e,n,i)=>{this.onTrackAdded(e,n,i)}).on(ue.Disconnected,e=>{this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,e)}).on(ue.ActiveSpeakersUpdate,this.handleActiveSpeakersUpdate).on(ue.DataPacketReceived,this.handleDataPacket).on(ue.Resuming,()=>{this.clearConnectionReconcile(),this.setAndEmitConnectionState(ye.Reconnecting)&&this.emit(J.Reconnecting)}).on(ue.Resumed,()=>{this.setAndEmitConnectionState(ye.Connected),this.emit(J.Reconnected),this.registerConnectionReconcile(),this.updateSubscriptions(),this.emitBufferedEvents()}).on(ue.SignalResumed,()=>{this.bufferedEvents=[],this.state===ye.Reconnecting&&this.sendSyncState()}).on(ue.Restarting,this.handleRestarting).on(ue.SignalRestarted,this.handleSignalRestarted).on(ue.DCBufferStatusChanged,(e,n)=>{this.emit(J.DCBufferStatusChanged,e,n)}),this.localParticipant&&this.localParticipant.setupEngine(this.engine),this.e2eeManager&&this.e2eeManager.setupEngine(this.engine))}static getLocalDevices(e){let n=arguments.length>1&&arguments[1]!==void 0?arguments[1]:!0;return Pt.getInstance().getDevices(e,n)}prepareConnection(e,n){return H(this,void 0,void 0,function*(){if(this.state===ye.Disconnected){this.log.debug("prepareConnection to ".concat(e),this.logContext);try{if(Jf(new URL(e))&&n){this.regionUrlProvider=new Yv(e,n);const i=yield this.regionUrlProvider.getNextBestRegionUrl();i&&this.state===ye.Disconnected&&(this.regionUrl=i,yield fetch(jv(i),{method:"HEAD"}),this.log.debug("prepared connection to ".concat(i),this.logContext))}else yield fetch(jv(e),{method:"HEAD"})}catch(i){this.log.warn("could not prepare connection",Object.assign(Object.assign({},this.logContext),{error:i}))}}})}getParticipantByIdentity(e){if(this.localParticipant.identity===e)return this.localParticipant;const n=this.identityToSid.get(e);if(n)return this.participants.get(n)}clearConnectionFutures(){this.connectFuture=void 0}simulateScenario(e,n){return H(this,void 0,void 0,function*(){let i=()=>{},r;switch(e){case"signal-reconnect":yield this.engine.client.handleOnClose("simulate disconnect");break;case"speaker":r=new ut({scenario:{case:"speakerUpdate",value:3}});break;case"node-failure":r=new ut({scenario:{case:"nodeFailure",value:!0}});break;case"server-leave":r=new ut({scenario:{case:"serverLeave",value:!0}});break;case"migration":r=new ut({scenario:{case:"migration",value:!0}});break;case"resume-reconnect":this.engine.failNext(),yield this.engine.client.handleOnClose("simulate resume-disconnect");break;case"disconnect-signal-on-resume":i=()=>H(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),r=new ut({scenario:{case:"disconnectSignalOnResume",value:!0}});break;case"disconnect-signal-on-resume-no-messages":i=()=>H(this,void 0,void 0,function*(){yield this.engine.client.handleOnClose("simulate resume-disconnect")}),r=new ut({scenario:{case:"disconnectSignalOnResumeNoMessages",value:!0}});break;case"full-reconnect":this.engine.fullReconnectOnNext=!0,yield this.engine.client.handleOnClose("simulate full-reconnect");break;case"force-tcp":case"force-tls":r=new ut({scenario:{case:"switchCandidateProtocol",value:e==="force-tls"?2:1}}),i=()=>H(this,void 0,void 0,function*(){const s=this.engine.client.onLeave;s&&s(new _n({reason:dr.CLIENT_INITIATED,canReconnect:!0}))});break;case"subscriber-bandwidth":if(n===void 0||typeof n!="number")throw new Error("subscriber-bandwidth requires a number as argument");r=new ut({scenario:{case:"subscriberBandwidth",value:BigInt(n)}});break}r&&(yield this.engine.client.sendSimulateScenario(r),yield i())})}get canPlaybackAudio(){return this.audioEnabled}get canPlaybackVideo(){return!this.isVideoPlaybackBlocked}getActiveAudioOutputDevice(){var e,n;return(n=(e=this.options.audioOutput)===null||e===void 0?void 0:e.deviceId)!==null&&n!==void 0?n:""}getActiveDevice(e){return this.localParticipant.activeDeviceMap.get(e)}switchActiveDevice(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:!1;var r,s,a;return H(this,void 0,void 0,function*(){let o=!1,l=!0;const c=i?{exact:n}:n;if(e==="audioinput"){const d=this.options.audioCaptureDefaults.deviceId;this.options.audioCaptureDefaults.deviceId=c,o=d!==c;const u=Array.from(this.localParticipant.audioTracks.values()).filter(m=>m.source===$.Source.Microphone);try{l=(yield Promise.all(u.map(m=>{var v;return(v=m.audioTrack)===null||v===void 0?void 0:v.setDeviceId(c)}))).every(m=>m===!0)}catch(m){throw this.options.audioCaptureDefaults.deviceId=d,m}}else if(e==="videoinput"){const d=this.options.videoCaptureDefaults.deviceId;this.options.videoCaptureDefaults.deviceId=c,o=d!==c;const u=Array.from(this.localParticipant.videoTracks.values()).filter(m=>m.source===$.Source.Camera);try{l=(yield Promise.all(u.map(m=>{var v;return(v=m.videoTrack)===null||v===void 0?void 0:v.setDeviceId(c)}))).every(m=>m===!0)}catch(m){throw this.options.videoCaptureDefaults.deviceId=d,m}}else if(e==="audiooutput"){if(!qf()&&!this.options.expWebAudioMix||this.options.expWebAudioMix&&this.audioContext&&!("setSinkId"in this.audioContext))throw new Error("cannot switch audio output, setSinkId not supported");(r=(a=this.options).audioOutput)!==null&&r!==void 0||(a.audioOutput={});const d=this.options.audioOutput.deviceId;this.options.audioOutput.deviceId=n,o=d!==c;try{this.options.expWebAudioMix?(s=this.audioContext)===null||s===void 0||s.setSinkId(n):yield Promise.all(Array.from(this.participants.values()).map(u=>u.setAudioOutput({deviceId:n})))}catch(u){throw this.options.audioOutput.deviceId=d,u}}return o&&l&&(this.localParticipant.activeDeviceMap.set(e,n),this.emit(J.ActiveDeviceChanged,e,n)),l})}setupLocalParticipantEvents(){this.localParticipant.on(Z.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).on(Z.ParticipantNameChanged,this.onLocalParticipantNameChanged).on(Z.TrackMuted,this.onLocalTrackMuted).on(Z.TrackUnmuted,this.onLocalTrackUnmuted).on(Z.LocalTrackPublished,this.onLocalTrackPublished).on(Z.LocalTrackUnpublished,this.onLocalTrackUnpublished).on(Z.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).on(Z.MediaDevicesError,this.onMediaDevicesError).on(Z.AudioStreamAcquired,this.startAudio).on(Z.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged)}recreateEngine(){var e;(e=this.engine)===null||e===void 0||e.close(),this.engine=void 0,this.participants.clear(),this.bufferedEvents=[],this.maybeCreateEngine()}onTrackAdded(e,n,i){if(this.state===ye.Connecting||this.state===ye.Reconnecting){const d=()=>{this.onTrackAdded(e,n,i),u()},u=()=>{this.off(J.Reconnected,d),this.off(J.Connected,d),this.off(J.Disconnected,u)};this.once(J.Reconnected,d),this.once(J.Connected,d),this.once(J.Disconnected,u);return}if(this.state===ye.Disconnected){this.log.warn("skipping incoming track after Room disconnected",this.logContext);return}const r=JR(n.id),s=r[0];let a=r[1],o=e.id;if(a&&a.startsWith("TR")&&(o=a),s===this.localParticipant.sid){this.log.warn("tried to create RemoteParticipant for local participant",this.logContext);return}const l=this.participants.get(s);if(!l){this.log.error("Tried to add a track for a participant, that's not present. Sid: ".concat(s),this.logContext);return}let c;this.options.adaptiveStream&&(typeof this.options.adaptiveStream=="object"?c=this.options.adaptiveStream:c={}),l.addSubscribedMediaTrack(e,o,n,i,c)}handleDisconnect(){let e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,n=arguments.length>1?arguments[1]:void 0;var i;if(this.clearConnectionReconcile(),this.bufferedEvents=[],this.state!==ye.Disconnected){this.regionUrl=void 0;try{this.participants.forEach(r=>{r.tracks.forEach(s=>{r.unpublishTrack(s.trackSid)})}),this.localParticipant.tracks.forEach(r=>{var s,a;r.track&&this.localParticipant.unpublishTrack(r.track,e),e&&((s=r.track)===null||s===void 0||s.detach(),(a=r.track)===null||a===void 0||a.stop())}),this.localParticipant.off(Z.ParticipantMetadataChanged,this.onLocalParticipantMetadataChanged).off(Z.ParticipantNameChanged,this.onLocalParticipantNameChanged).off(Z.TrackMuted,this.onLocalTrackMuted).off(Z.TrackUnmuted,this.onLocalTrackUnmuted).off(Z.LocalTrackPublished,this.onLocalTrackPublished).off(Z.LocalTrackUnpublished,this.onLocalTrackUnpublished).off(Z.ConnectionQualityChanged,this.onLocalConnectionQualityChanged).off(Z.MediaDevicesError,this.onMediaDevicesError).off(Z.AudioStreamAcquired,this.startAudio).off(Z.ParticipantPermissionsChanged,this.onLocalParticipantPermissionsChanged),this.localParticipant.tracks.clear(),this.localParticipant.videoTracks.clear(),this.localParticipant.audioTracks.clear(),this.participants.clear(),this.activeSpeakers=[],this.audioContext&&typeof this.options.expWebAudioMix=="boolean"&&(this.audioContext.close(),this.audioContext=void 0),Jt()&&(window.removeEventListener("beforeunload",this.onPageLeave),window.removeEventListener("pagehide",this.onPageLeave),window.removeEventListener("freeze",this.onPageLeave),(i=navigator.mediaDevices)===null||i===void 0||i.removeEventListener("devicechange",this.handleDeviceChange))}finally{this.setAndEmitConnectionState(ye.Disconnected),this.emit(J.Disconnected,n)}}}handleParticipantDisconnected(e,n){this.participants.delete(e),n&&(this.identityToSid.delete(n.identity),n.tracks.forEach(i=>{n.unpublishTrack(i.trackSid,!0)}),this.emit(J.ParticipantDisconnected,n))}acquireAudioContext(){var e,n;return H(this,void 0,void 0,function*(){if(typeof this.options.expWebAudioMix!="boolean"&&this.options.expWebAudioMix.audioContext?this.audioContext=this.options.expWebAudioMix.audioContext:(!this.audioContext||this.audioContext.state==="closed")&&(this.audioContext=(e=XC())!==null&&e!==void 0?e:void 0),this.audioContext&&this.audioContext.state==="suspended")try{yield this.audioContext.resume()}catch(r){this.log.warn("Could not resume audio context",Object.assign(Object.assign({},this.logContext),{error:r}))}this.options.expWebAudioMix&&this.participants.forEach(r=>r.setAudioContext(this.audioContext)),this.localParticipant.setAudioContext(this.audioContext);const i=((n=this.audioContext)===null||n===void 0?void 0:n.state)==="running";i!==this.canPlaybackAudio&&(this.audioEnabled=i,this.emit(J.AudioPlaybackStatusChanged,i))})}createParticipant(e,n){var i;let r;return n?r=xl.fromParticipantInfo(this.engine.client,n):r=new xl(this.engine.client,e,"",void 0,void 0,{loggerContextCb:()=>this.logContext,loggerName:this.options.loggerName}),this.options.expWebAudioMix&&r.setAudioContext(this.audioContext),!((i=this.options.audioOutput)===null||i===void 0)&&i.deviceId&&r.setAudioOutput(this.options.audioOutput).catch(s=>this.log.warn("Could not set audio output: ".concat(s.message),this.logContext)),r}getOrCreateParticipant(e,n){if(this.participants.has(e))return this.participants.get(e);const i=this.createParticipant(e,n);return this.participants.set(e,i),this.identityToSid.set(n.identity,n.sid),this.emitWhenConnected(J.ParticipantConnected,i),i.on(Z.TrackPublished,r=>{this.emitWhenConnected(J.TrackPublished,r,i)}).on(Z.TrackSubscribed,(r,s)=>{r.kind===$.Kind.Audio?(r.on(re.AudioPlaybackStarted,this.handleAudioPlaybackStarted),r.on(re.AudioPlaybackFailed,this.handleAudioPlaybackFailed)):r.kind===$.Kind.Video&&(r.on(re.VideoPlaybackFailed,this.handleVideoPlaybackFailed),r.on(re.VideoPlaybackStarted,this.handleVideoPlaybackStarted)),this.emit(J.TrackSubscribed,r,s,i)}).on(Z.TrackUnpublished,r=>{this.emit(J.TrackUnpublished,r,i)}).on(Z.TrackUnsubscribed,(r,s)=>{this.emit(J.TrackUnsubscribed,r,s,i)}).on(Z.TrackSubscriptionFailed,r=>{this.emit(J.TrackSubscriptionFailed,r,i)}).on(Z.TrackMuted,r=>{this.emitWhenConnected(J.TrackMuted,r,i)}).on(Z.TrackUnmuted,r=>{this.emitWhenConnected(J.TrackUnmuted,r,i)}).on(Z.ParticipantMetadataChanged,r=>{this.emitWhenConnected(J.ParticipantMetadataChanged,r,i)}).on(Z.ParticipantNameChanged,r=>{this.emitWhenConnected(J.ParticipantNameChanged,r,i)}).on(Z.ConnectionQualityChanged,r=>{this.emitWhenConnected(J.ConnectionQualityChanged,r,i)}).on(Z.ParticipantPermissionsChanged,r=>{this.emitWhenConnected(J.ParticipantPermissionsChanged,r,i)}).on(Z.TrackSubscriptionStatusChanged,(r,s)=>{this.emitWhenConnected(J.TrackSubscriptionStatusChanged,r,s,i)}).on(Z.TrackSubscriptionFailed,(r,s)=>{this.emit(J.TrackSubscriptionFailed,r,i,s)}).on(Z.TrackSubscriptionPermissionChanged,(r,s)=>{this.emitWhenConnected(J.TrackSubscriptionPermissionChanged,r,s,i)}),n&&i.updateInfo(n),i}sendSyncState(){const e=Array.from(this.participants.values()).reduce((i,r)=>(i.push(...r.getTracks()),i),[]),n=this.localParticipant.getTracks();this.engine.sendSyncState(e,n)}updateSubscriptions(){for(const e of this.participants.values())for(const n of e.videoTracks.values())n.isSubscribed&&n instanceof Rl&&n.emitTrackUpdate()}registerConnectionReconcile(){this.clearConnectionReconcile();let e=0;this.connectionReconcileInterval=ht.setInterval(()=>{!this.engine||this.engine.isClosed||!this.engine.verifyTransport()?(e++,this.log.warn("detected connection state mismatch",Object.assign(Object.assign({},this.logContext),{numFailures:e,engine:{closed:this.engine.isClosed,transportsConnected:this.engine.verifyTransport()}})),e>=3&&(this.recreateEngine(),this.handleDisconnect(this.options.stopLocalTrackOnUnpublish,dr.STATE_MISMATCH))):e=0},zx)}clearConnectionReconcile(){this.connectionReconcileInterval&&ht.clearInterval(this.connectionReconcileInterval)}setAndEmitConnectionState(e){return e===this.state?!1:(this.state=e,this.emit(J.ConnectionStateChanged,this.state),!0)}emitBufferedEvents(){this.bufferedEvents.forEach(e=>{let[n,i]=e;this.emit(n,...i)}),this.bufferedEvents=[]}emitWhenConnected(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];return this.state===ye.Connected?this.emit(e,...i):(this.state===ye.Reconnecting&&this.bufferedEvents.push([e,i]),!1)}simulateParticipants(e){var n,i;return H(this,void 0,void 0,function*(){const r=Object.assign({audio:!0,video:!0,useRealTracks:!1},e.publish),s=Object.assign({count:9,audio:!1,video:!0,aspectRatios:[1.66,1.7,1.3]},e.participants);if(this.handleDisconnect(),this.roomInfo=new la({sid:"RM_SIMULATED",name:"simulated-room",emptyTimeout:0,maxParticipants:0,creationTime:pe.parse(new Date().getTime()),metadata:"",numParticipants:1,numPublishers:1,turnPassword:"",enabledCodecs:[],activeRecording:!1}),this.localParticipant.updateInfo(new nn({identity:"simulated-local",name:"local-name"})),this.setupLocalParticipantEvents(),this.emit(J.SignalConnected),this.emit(J.Connected),this.setAndEmitConnectionState(ye.Connected),r.video){const a=new Tl($.Kind.Video,new $t({source:Ve.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:bt.AUDIO,name:"video-dummy"}),new dn(r.useRealTracks?(yield window.navigator.mediaDevices.getUserMedia({video:!0})).getVideoTracks()[0]:Hv(160*((n=s.aspectRatios[0])!==null&&n!==void 0?n:1),160,!0,!0),void 0,!1,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(a),this.localParticipant.emit(Z.LocalTrackPublished,a)}if(r.audio){const a=new Tl($.Kind.Audio,new $t({source:Ve.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:bt.AUDIO}),new Zt(r.useRealTracks?(yield navigator.mediaDevices.getUserMedia({audio:!0})).getAudioTracks()[0]:ph(),void 0,!1,this.audioContext,{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext}),{loggerName:this.options.loggerName,loggerContextCb:()=>this.logContext});this.localParticipant.addTrackPublication(a),this.localParticipant.emit(Z.LocalTrackPublished,a)}for(let a=0;a<s.count-1;a+=1){let o=new nn({sid:Math.floor(Math.random()*1e4).toString(),identity:"simulated-".concat(a),state:Hs.ACTIVE,tracks:[],joinedAt:pe.parse(Date.now())});const l=this.getOrCreateParticipant(o.identity,o);if(s.video){const c=Hv(160*((i=s.aspectRatios[a%s.aspectRatios.length])!==null&&i!==void 0?i:1),160,!1,!0),d=new $t({source:Ve.CAMERA,sid:Math.floor(Math.random()*1e4).toString(),type:bt.AUDIO});l.addSubscribedMediaTrack(c,d.sid,new MediaStream([c])),o.tracks=[...o.tracks,d]}if(s.audio){const c=ph(),d=new $t({source:Ve.MICROPHONE,sid:Math.floor(Math.random()*1e4).toString(),type:bt.AUDIO});l.addSubscribedMediaTrack(c,d.sid,new MediaStream([c])),o.tracks=[...o.tracks,d]}l.updateInfo(o)}})}emit(e){for(var n=arguments.length,i=new Array(n>1?n-1:0),r=1;r<n;r++)i[r-1]=arguments[r];if(e!==J.ActiveSpeakersChanged){const s=fb(i).filter(a=>a!==void 0);this.log.debug("room event ".concat(e),Object.assign(Object.assign({},this.logContext),{event:e,args:s}))}return super.emit(e,...i)}}function fb(t){return t.map(e=>{if(e)return Array.isArray(e)?fb(e):typeof e=="object"?"logContext"in e&&e.logContext:e})}var Ln;(function(t){t[t.IDLE=0]="IDLE",t[t.RUNNING=1]="RUNNING",t[t.SKIPPED=2]="SKIPPED",t[t.SUCCESS=3]="SUCCESS",t[t.FAILED=4]="FAILED"})(Ln||(Ln={}));class ua extends xi.EventEmitter{constructor(e,n){let i=arguments.length>2&&arguments[2]!==void 0?arguments[2]:{};super(),this.status=Ln.IDLE,this.logs=[],this.errorsAsWarnings=!1,this.url=e,this.token=n,this.name=this.constructor.name,this.room=new Ru(i.roomOptions),this.connectOptions=i.connectOptions,i.errorsAsWarnings&&(this.errorsAsWarnings=i.errorsAsWarnings)}run(e){return H(this,void 0,void 0,function*(){if(this.status!==Ln.IDLE)throw Error("check is running already");this.setStatus(Ln.RUNNING);try{yield this.perform()}catch(n){n instanceof Error&&(this.errorsAsWarnings?this.appendWarning(n.message):this.appendError(n.message))}return yield this.disconnect(),yield new Promise(n=>setTimeout(n,500)),this.status!==Ln.SKIPPED&&this.setStatus(this.isSuccess()?Ln.SUCCESS:Ln.FAILED),e&&e(),this.getInfo()})}isSuccess(){return!this.logs.some(e=>e.level==="error")}connect(){return H(this,void 0,void 0,function*(){return this.room.state===ye.Connected?this.room:(yield this.room.connect(this.url,this.token),this.room)})}disconnect(){return H(this,void 0,void 0,function*(){this.room&&this.room.state!==ye.Disconnected&&(yield this.room.disconnect(),yield new Promise(e=>setTimeout(e,500)))})}skip(){this.setStatus(Ln.SKIPPED)}appendMessage(e){this.logs.push({level:"info",message:e}),this.emit("update",this.getInfo())}appendWarning(e){this.logs.push({level:"warning",message:e}),this.emit("update",this.getInfo())}appendError(e){this.logs.push({level:"error",message:e}),this.emit("update",this.getInfo())}setStatus(e){this.status=e,this.emit("update",this.getInfo())}get engine(){var e;return(e=this.room)===null||e===void 0?void 0:e.engine}getInfo(){return{logs:this.logs,name:this.name,status:this.status,description:this.description}}}function pb(t){var e,n;return H(this,void 0,void 0,function*(){t??(t={}),(e=t.audio)!==null&&e!==void 0||(t.audio=!0),(n=t.video)!==null&&n!==void 0||(t.video=!0);const i=QC(t,ob,ab),r=ld(i),s=navigator.mediaDevices.getUserMedia(r);t.audio&&(Pt.userMediaPromiseMap.set("audioinput",s),s.catch(()=>Pt.userMediaPromiseMap.delete("audioinput"))),t.video&&(Pt.userMediaPromiseMap.set("videoinput",s),s.catch(()=>Pt.userMediaPromiseMap.delete("videoinput")));const a=yield s;return a.getTracks().map(o=>{const l=o.kind==="audio";l?t.audio:t.video;let c;const d=l?r.audio:r.video;typeof d!="boolean"&&(c=d),c?c.deviceId=o.getSettings().deviceId:c={deviceId:o.getSettings().deviceId};const u=lb(o,c);return u.kind===$.Kind.Video?u.source=$.Source.Camera:u.kind===$.Kind.Audio&&(u.source=$.Source.Microphone),u.mediaStream=a,u})})}function Hx(t){return H(this,void 0,void 0,function*(){return(yield pb({audio:!1,video:t}))[0]})}function jx(t){return H(this,void 0,void 0,function*(){return(yield pb({audio:t,video:!1}))[0]})}class Wx extends ua{get description(){return"Can publish audio"}perform(){var e;return H(this,void 0,void 0,function*(){const n=yield this.connect(),i=yield jx();n.localParticipant.publishTrack(i),yield new Promise(a=>setTimeout(a,3e3));const r=yield(e=i.sender)===null||e===void 0?void 0:e.getStats();if(!r)throw new Error("Could not get RTCStats");let s=0;if(r.forEach(a=>{a.type==="outbound-rtp"&&a.mediaType==="audio"&&(s=a.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," audio packets"))})}}class $x extends ua{get description(){return"Can publish video"}perform(){var e;return H(this,void 0,void 0,function*(){const n=yield this.connect(),i=yield Hx();n.localParticipant.publishTrack(i),yield new Promise(a=>setTimeout(a,3e3));const r=yield(e=i.sender)===null||e===void 0?void 0:e.getStats();if(!r)throw new Error("Could not get RTCStats");let s=0;if(r.forEach(a=>{a.type==="outbound-rtp"&&a.mediaType==="video"&&(s=a.packetsSent)}),s===0)throw new Error("Could not determine packets are sent");this.appendMessage("published ".concat(s," video packets"))})}}class Vx extends ua{get description(){return"Resuming connection after interruption"}perform(){var e;return H(this,void 0,void 0,function*(){const n=yield this.connect();let i=!1,r=!1,s;const a=new Promise(l=>{setTimeout(l,5e3),s=l});n.on(J.Reconnecting,()=>{i=!0}).on(J.Reconnected,()=>{r=!0,s(!0)}),(e=n.engine.client.ws)===null||e===void 0||e.close();const o=n.engine.client.onClose;if(o&&o(""),yield a,i){if(!r||n.state!==ye.Connected)throw this.appendWarning("reconnection is only possible in Redis-based configurations"),new Error("Not able to reconnect")}else throw new Error("Did not attempt to reconnect")})}}class Gx extends ua{get description(){return"Can connect via TURN"}perform(){var e,n;return H(this,void 0,void 0,function*(){const i=new Em,r=yield i.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});let s=!1,a=!1,o=!1;for(let l of r.iceServers)for(let c of l.urls)c.startsWith("turn:")?(a=!0,o=!0):c.startsWith("turns:")&&(a=!0,o=!0,s=!0),c.startsWith("stun:")&&(o=!0);o?a&&!s&&this.appendWarning("TURN is configured server side, but TURN/TLS is unavailable."):this.appendWarning("No STUN servers configured on server side."),yield i.close(),!((n=(e=this.connectOptions)===null||e===void 0?void 0:e.rtcConfig)===null||n===void 0)&&n.iceServers||a?yield this.room.connect(this.url,this.token,{rtcConfig:{iceTransportPolicy:"relay"}}):(this.appendWarning("No TURN servers configured."),this.skip(),yield new Promise(l=>setTimeout(l,0)))})}}class qx extends ua{get description(){return"Establishing WebRTC connection"}perform(){return H(this,void 0,void 0,function*(){let e=!1,n=!1;this.room.on(J.SignalConnected,()=>{const i=this.room.engine.client.onTrickle;this.room.engine.client.onTrickle=(r,s)=>{if(r.candidate){const a=new RTCIceCandidate(r);let o="".concat(a.protocol," ").concat(a.address,":").concat(a.port," ").concat(a.type);a.address&&(Jx(a.address)?o+=" (private)":a.protocol==="tcp"&&a.tcpType==="passive"?(e=!0,o+=" (passive)"):a.protocol==="udp"&&(n=!0)),this.appendMessage(o)}i&&i(r,s)},this.room.engine.pcManager&&(this.room.engine.pcManager.subscriber.onIceCandidateError=r=>{r instanceof RTCPeerConnectionIceErrorEvent&&this.appendWarning("error with ICE candidate: ".concat(r.errorCode," ").concat(r.errorText," ").concat(r.url))})});try{yield this.connect(),_e.info("now the room is connected")}catch(i){throw this.appendWarning("ports need to be open on firewall in order to connect."),i}e||this.appendWarning("Server is not configured for ICE/TCP"),n||this.appendWarning("No public IPv4 UDP candidates were found. Your server is likely not configured correctly")})}}function Jx(t){const e=t.split(".");if(e.length===4){if(e[0]==="10")return!0;if(e[0]==="192"&&e[1]==="168")return!0;if(e[0]==="172"){const n=parseInt(e[1],10);if(n>=16&&n<=31)return!0}}return!1}class Kx extends ua{get description(){return"Connecting to signal connection via WebSocket"}perform(){var e,n,i;return H(this,void 0,void 0,function*(){(this.url.startsWith("ws:")||this.url.startsWith("http:"))&&this.appendWarning("Server is insecure, clients may block connections to it");let r=new Em;const s=yield r.join(this.url,this.token,{autoSubscribe:!0,maxRetries:0,e2eeEnabled:!1,websocketTimeout:15e3});this.appendMessage("Connected to server, version ".concat(s.serverVersion,".")),((e=s.serverInfo)===null||e===void 0?void 0:e.edition)===Ko.Cloud&&(!((n=s.serverInfo)===null||n===void 0)&&n.region)&&this.appendMessage("LiveKit Cloud: ".concat((i=s.serverInfo)===null||i===void 0?void 0:i.region)),yield r.close()})}}class LN extends xi.EventEmitter{constructor(e,n){super(),this.checkResults=new Map,this.url=e,this.token=n}getNextCheckId(){const e=this.checkResults.size;return this.checkResults.set(e,{logs:[],status:Ln.IDLE,name:"",description:""}),e}updateCheck(e,n){this.checkResults.set(e,n),this.emit("checkUpdate",e,n)}isSuccess(){return Array.from(this.checkResults.values()).every(e=>e.status!==Ln.FAILED)}getResults(){return Array.from(this.checkResults.values())}createAndRunCheck(e){return H(this,void 0,void 0,function*(){const n=this.getNextCheckId(),i=new e(this.url,this.token),r=a=>{this.updateCheck(n,a)};i.on("update",r);const s=yield i.run();return i.off("update",r),s})}checkWebsocket(){return H(this,void 0,void 0,function*(){return this.createAndRunCheck(Kx)})}checkWebRTC(){return H(this,void 0,void 0,function*(){return this.createAndRunCheck(qx)})}checkTURN(){return H(this,void 0,void 0,function*(){return this.createAndRunCheck(Gx)})}checkReconnect(){return H(this,void 0,void 0,function*(){return this.createAndRunCheck(Vx)})}checkPublishAudio(){return H(this,void 0,void 0,function*(){return this.createAndRunCheck(Wx)})}checkPublishVideo(){return H(this,void 0,void 0,function*(){return this.createAndRunCheck($x)})}}function Qx(t){let e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};var n;const i=t instanceof Yo?t.mediaStreamTrack:t,r=i.getSettings();let s={facingMode:(n=e.defaultFacingMode)!==null&&n!==void 0?n:"user",confidence:"low"};if("facingMode"in r){const a=r.facingMode;_e.debug("rawFacingMode",{rawFacingMode:a}),a&&typeof a=="string"&&Zx(a)&&(s={facingMode:a,confidence:"high"})}if(["low","medium"].includes(s.confidence)){_e.debug("Try to get facing mode from device label: (".concat(i.label,")"));const a=Yx(i.label);a!==void 0&&(s=a)}return s}const r0=new Map([["obs virtual camera",{facingMode:"environment",confidence:"medium"}]]),Xx=new Map([["iphone",{facingMode:"environment",confidence:"medium"}],["ipad",{facingMode:"environment",confidence:"medium"}]]);function Yx(t){var e;const n=t.trim().toLowerCase();if(n!=="")return r0.has(n)?r0.get(n):(e=Array.from(Xx.entries()).find(i=>{let[r]=i;return n.includes(r)}))===null||e===void 0?void 0:e[1]}function Zx(t){return t===void 0||["user","environment","left","right"].includes(t)}const Yf=Math.min,Oo=Math.max,xu=Math.round,cs=t=>({x:t,y:t}),eP={left:"right",right:"left",bottom:"top",top:"bottom"},tP={start:"end",end:"start"};function s0(t,e,n){return Oo(t,Yf(e,n))}function ud(t,e){return typeof t=="function"?t(e):t}function Vs(t){return t.split("-")[0]}function dd(t){return t.split("-")[1]}function mb(t){return t==="x"?"y":"x"}function gb(t){return t==="y"?"height":"width"}function Zo(t){return["top","bottom"].includes(Vs(t))?"y":"x"}function vb(t){return mb(Zo(t))}function nP(t,e,n){n===void 0&&(n=!1);const i=dd(t),r=vb(t),s=gb(r);let a=r==="x"?i===(n?"end":"start")?"right":"left":i==="start"?"bottom":"top";return e.reference[s]>e.floating[s]&&(a=Pu(a)),[a,Pu(a)]}function iP(t){const e=Pu(t);return[Zf(t),e,Zf(e)]}function Zf(t){return t.replace(/start|end/g,e=>tP[e])}function rP(t,e,n){const i=["left","right"],r=["right","left"],s=["top","bottom"],a=["bottom","top"];switch(t){case"top":case"bottom":return n?e?r:i:e?i:r;case"left":case"right":return e?s:a;default:return[]}}function sP(t,e,n,i){const r=dd(t);let s=rP(Vs(t),n==="start",i);return r&&(s=s.map(a=>a+"-"+r),e&&(s=s.concat(s.map(Zf)))),s}function Pu(t){return t.replace(/left|right|bottom|top/g,e=>eP[e])}function oP(t){return{top:0,right:0,bottom:0,left:0,...t}}function aP(t){return typeof t!="number"?oP(t):{top:t,right:t,bottom:t,left:t}}function Ou(t){const{x:e,y:n,width:i,height:r}=t;return{width:i,height:r,top:n,left:e,right:e+i,bottom:n+r,x:e,y:n}}function o0(t,e,n){let{reference:i,floating:r}=t;const s=Zo(e),a=vb(e),o=gb(a),l=Vs(e),c=s==="y",d=i.x+i.width/2-r.width/2,u=i.y+i.height/2-r.height/2,m=i[o]/2-r[o]/2;let v;switch(l){case"top":v={x:d,y:i.y-r.height};break;case"bottom":v={x:d,y:i.y+i.height};break;case"right":v={x:i.x+i.width,y:u};break;case"left":v={x:i.x-r.width,y:u};break;default:v={x:i.x,y:i.y}}switch(dd(e)){case"start":v[a]-=m*(n&&c?-1:1);break;case"end":v[a]+=m*(n&&c?-1:1);break}return v}const lP=async(t,e,n)=>{const{placement:i="bottom",strategy:r="absolute",middleware:s=[],platform:a}=n,o=s.filter(Boolean),l=await(a.isRTL==null?void 0:a.isRTL(e));let c=await a.getElementRects({reference:t,floating:e,strategy:r}),{x:d,y:u}=o0(c,i,l),m=i,v={},y=0;for(let _=0;_<o.length;_++){const{name:p,fn:f}=o[_],{x:h,y:g,data:S,reset:b}=await f({x:d,y:u,initialPlacement:i,placement:m,strategy:r,middlewareData:v,rects:c,platform:a,elements:{reference:t,floating:e}});d=h??d,u=g??u,v={...v,[p]:{...v[p],...S}},b&&y<=50&&(y++,typeof b=="object"&&(b.placement&&(m=b.placement),b.rects&&(c=b.rects===!0?await a.getElementRects({reference:t,floating:e,strategy:r}):b.rects),{x:d,y:u}=o0(c,m,l)),_=-1)}return{x:d,y:u,placement:m,strategy:r,middlewareData:v}};async function _b(t,e){var n;e===void 0&&(e={});const{x:i,y:r,platform:s,rects:a,elements:o,strategy:l}=t,{boundary:c="clippingAncestors",rootBoundary:d="viewport",elementContext:u="floating",altBoundary:m=!1,padding:v=0}=ud(e,t),y=aP(v),p=o[m?u==="floating"?"reference":"floating":u],f=Ou(await s.getClippingRect({element:(n=await(s.isElement==null?void 0:s.isElement(p)))==null||n?p:p.contextElement||await(s.getDocumentElement==null?void 0:s.getDocumentElement(o.floating)),boundary:c,rootBoundary:d,strategy:l})),h=u==="floating"?{x:i,y:r,width:a.floating.width,height:a.floating.height}:a.reference,g=await(s.getOffsetParent==null?void 0:s.getOffsetParent(o.floating)),S=await(s.isElement==null?void 0:s.isElement(g))?await(s.getScale==null?void 0:s.getScale(g))||{x:1,y:1}:{x:1,y:1},b=Ou(s.convertOffsetParentRelativeRectToViewportRelativeRect?await s.convertOffsetParentRelativeRectToViewportRelativeRect({elements:o,rect:h,offsetParent:g,strategy:l}):h);return{top:(f.top-b.top+y.top)/S.y,bottom:(b.bottom-f.bottom+y.bottom)/S.y,left:(f.left-b.left+y.left)/S.x,right:(b.right-f.right+y.right)/S.x}}const cP=function(t){return t===void 0&&(t={}),{name:"flip",options:t,async fn(e){var n,i;const{placement:r,middlewareData:s,rects:a,initialPlacement:o,platform:l,elements:c}=e,{mainAxis:d=!0,crossAxis:u=!0,fallbackPlacements:m,fallbackStrategy:v="bestFit",fallbackAxisSideDirection:y="none",flipAlignment:_=!0,...p}=ud(t,e);if((n=s.arrow)!=null&&n.alignmentOffset)return{};const f=Vs(r),h=Zo(o),g=Vs(o)===o,S=await(l.isRTL==null?void 0:l.isRTL(c.floating)),b=m||(g||!_?[Pu(o)]:iP(o)),w=y!=="none";!m&&w&&b.push(...sP(o,_,y,S));const k=[o,...b],C=await _b(e,p),E=[];let x=((i=s.flip)==null?void 0:i.overflows)||[];if(d&&E.push(C[f]),u){const F=nP(r,a,S);E.push(C[F[0]],C[F[1]])}if(x=[...x,{placement:r,overflows:E}],!E.every(F=>F<=0)){var I,A;const F=(((I=s.flip)==null?void 0:I.index)||0)+1,B=k[F];if(B)return{data:{index:F,overflows:x},reset:{placement:B}};let j=(A=x.filter(X=>X.overflows[0]<=0).sort((X,U)=>X.overflows[1]-U.overflows[1])[0])==null?void 0:A.placement;if(!j)switch(v){case"bestFit":{var P;const X=(P=x.filter(U=>{if(w){const R=Zo(U.placement);return R===h||R==="y"}return!0}).map(U=>[U.placement,U.overflows.filter(R=>R>0).reduce((R,M)=>R+M,0)]).sort((U,R)=>U[1]-R[1])[0])==null?void 0:P[0];X&&(j=X);break}case"initialPlacement":j=o;break}if(r!==j)return{reset:{placement:j}}}return{}}}};async function uP(t,e){const{placement:n,platform:i,elements:r}=t,s=await(i.isRTL==null?void 0:i.isRTL(r.floating)),a=Vs(n),o=dd(n),l=Zo(n)==="y",c=["left","top"].includes(a)?-1:1,d=s&&l?-1:1,u=ud(e,t);let{mainAxis:m,crossAxis:v,alignmentAxis:y}=typeof u=="number"?{mainAxis:u,crossAxis:0,alignmentAxis:null}:{mainAxis:u.mainAxis||0,crossAxis:u.crossAxis||0,alignmentAxis:u.alignmentAxis};return o&&typeof y=="number"&&(v=o==="end"?y*-1:y),l?{x:v*d,y:m*c}:{x:m*c,y:v*d}}const dP=function(t){return t===void 0&&(t=0),{name:"offset",options:t,async fn(e){var n,i;const{x:r,y:s,placement:a,middlewareData:o}=e,l=await uP(e,t);return a===((n=o.offset)==null?void 0:n.placement)&&(i=o.arrow)!=null&&i.alignmentOffset?{}:{x:r+l.x,y:s+l.y,data:{...l,placement:a}}}}},hP=function(t){return t===void 0&&(t={}),{name:"shift",options:t,async fn(e){const{x:n,y:i,placement:r}=e,{mainAxis:s=!0,crossAxis:a=!1,limiter:o={fn:p=>{let{x:f,y:h}=p;return{x:f,y:h}}},...l}=ud(t,e),c={x:n,y:i},d=await _b(e,l),u=Zo(Vs(r)),m=mb(u);let v=c[m],y=c[u];if(s){const p=m==="y"?"top":"left",f=m==="y"?"bottom":"right",h=v+d[p],g=v-d[f];v=s0(h,v,g)}if(a){const p=u==="y"?"top":"left",f=u==="y"?"bottom":"right",h=y+d[p],g=y-d[f];y=s0(h,y,g)}const _=o.fn({...e,[m]:v,[u]:y});return{..._,data:{x:_.x-n,y:_.y-i,enabled:{[m]:s,[u]:a}}}}}};function hd(){return typeof window<"u"}function us(t){return yb(t)?(t.nodeName||"").toLowerCase():"#document"}function sn(t){var e;return(t==null||(e=t.ownerDocument)==null?void 0:e.defaultView)||window}function gs(t){var e;return(e=(yb(t)?t.ownerDocument:t.document)||window.document)==null?void 0:e.documentElement}function yb(t){return hd()?t instanceof Node||t instanceof sn(t).Node:!1}function Ti(t){return hd()?t instanceof Element||t instanceof sn(t).Element:!1}function Ri(t){return hd()?t instanceof HTMLElement||t instanceof sn(t).HTMLElement:!1}function a0(t){return!hd()||typeof ShadowRoot>"u"?!1:t instanceof ShadowRoot||t instanceof sn(t).ShadowRoot}function Wl(t){const{overflow:e,overflowX:n,overflowY:i,display:r}=wn(t);return/auto|scroll|overlay|hidden|clip/.test(e+i+n)&&!["inline","contents"].includes(r)}function fP(t){return["table","td","th"].includes(us(t))}function pP(t){return[":popover-open",":modal"].some(e=>{try{return t.matches(e)}catch{return!1}})}function xm(t){const e=Pm(),n=Ti(t)?wn(t):t;return n.transform!=="none"||n.perspective!=="none"||(n.containerType?n.containerType!=="normal":!1)||!e&&(n.backdropFilter?n.backdropFilter!=="none":!1)||!e&&(n.filter?n.filter!=="none":!1)||["transform","perspective","filter"].some(i=>(n.willChange||"").includes(i))||["paint","layout","strict","content"].some(i=>(n.contain||"").includes(i))}function mP(t){let e=ea(t);for(;Ri(e)&&!fd(e);){if(xm(e))return e;if(pP(e))return null;e=ea(e)}return null}function Pm(){return typeof CSS>"u"||!CSS.supports?!1:CSS.supports("-webkit-backdrop-filter","none")}function fd(t){return["html","body","#document"].includes(us(t))}function wn(t){return sn(t).getComputedStyle(t)}function pd(t){return Ti(t)?{scrollLeft:t.scrollLeft,scrollTop:t.scrollTop}:{scrollLeft:t.scrollX,scrollTop:t.scrollY}}function ea(t){if(us(t)==="html")return t;const e=t.assignedSlot||t.parentNode||a0(t)&&t.host||gs(t);return a0(e)?e.host:e}function Sb(t){const e=ea(t);return fd(e)?t.ownerDocument?t.ownerDocument.body:t.body:Ri(e)&&Wl(e)?e:Sb(e)}function ep(t,e,n){var i;e===void 0&&(e=[]),n===void 0&&(n=!0);const r=Sb(t),s=r===((i=t.ownerDocument)==null?void 0:i.body),a=sn(r);if(s){const o=gP(a);return e.concat(a,a.visualViewport||[],Wl(r)?r:[],o&&n?ep(o):[])}return e.concat(r,ep(r,[],n))}function gP(t){return t.parent&&Object.getPrototypeOf(t.parent)?t.frameElement:null}function Cb(t){const e=wn(t);let n=parseFloat(e.width)||0,i=parseFloat(e.height)||0;const r=Ri(t),s=r?t.offsetWidth:n,a=r?t.offsetHeight:i,o=xu(n)!==s||xu(i)!==a;return o&&(n=s,i=a),{width:n,height:i,$:o}}function bb(t){return Ti(t)?t:t.contextElement}function Io(t){const e=bb(t);if(!Ri(e))return cs(1);const n=e.getBoundingClientRect(),{width:i,height:r,$:s}=Cb(e);let a=(s?xu(n.width):n.width)/i,o=(s?xu(n.height):n.height)/r;return(!a||!Number.isFinite(a))&&(a=1),(!o||!Number.isFinite(o))&&(o=1),{x:a,y:o}}const vP=cs(0);function wb(t){const e=sn(t);return!Pm()||!e.visualViewport?vP:{x:e.visualViewport.offsetLeft,y:e.visualViewport.offsetTop}}function _P(t,e,n){return e===void 0&&(e=!1),!n||e&&n!==sn(t)?!1:e}function Ol(t,e,n,i){e===void 0&&(e=!1),n===void 0&&(n=!1);const r=t.getBoundingClientRect(),s=bb(t);let a=cs(1);e&&(i?Ti(i)&&(a=Io(i)):a=Io(t));const o=_P(s,n,i)?wb(s):cs(0);let l=(r.left+o.x)/a.x,c=(r.top+o.y)/a.y,d=r.width/a.x,u=r.height/a.y;if(s){const m=sn(s),v=i&&Ti(i)?sn(i):i;let y=m.frameElement;for(;y&&i&&v!==m;){const _=Io(y),p=y.getBoundingClientRect(),f=wn(y),h=p.left+(y.clientLeft+parseFloat(f.paddingLeft))*_.x,g=p.top+(y.clientTop+parseFloat(f.paddingTop))*_.y;l*=_.x,c*=_.y,d*=_.x,u*=_.y,l+=h,c+=g,y=sn(y).frameElement}}return Ou({width:d,height:u,x:l,y:c})}function yP(t){let{rect:e,offsetParent:n,strategy:i}=t;const r=Ri(n),s=gs(n);if(n===s)return e;let a={scrollLeft:0,scrollTop:0},o=cs(1);const l=cs(0);if((r||!r&&i!=="fixed")&&((us(n)!=="body"||Wl(s))&&(a=pd(n)),Ri(n))){const c=Ol(n);o=Io(n),l.x=c.x+n.clientLeft,l.y=c.y+n.clientTop}return{width:e.width*o.x,height:e.height*o.y,x:e.x*o.x-a.scrollLeft*o.x+l.x,y:e.y*o.y-a.scrollTop*o.y+l.y}}function SP(t){return Array.from(t.getClientRects())}function kb(t){return Ol(gs(t)).left+pd(t).scrollLeft}function CP(t){const e=gs(t),n=pd(t),i=t.ownerDocument.body,r=Oo(e.scrollWidth,e.clientWidth,i.scrollWidth,i.clientWidth),s=Oo(e.scrollHeight,e.clientHeight,i.scrollHeight,i.clientHeight);let a=-n.scrollLeft+kb(t);const o=-n.scrollTop;return wn(i).direction==="rtl"&&(a+=Oo(e.clientWidth,i.clientWidth)-r),{width:r,height:s,x:a,y:o}}function bP(t,e){const n=sn(t),i=gs(t),r=n.visualViewport;let s=i.clientWidth,a=i.clientHeight,o=0,l=0;if(r){s=r.width,a=r.height;const c=Pm();(!c||c&&e==="fixed")&&(o=r.offsetLeft,l=r.offsetTop)}return{width:s,height:a,x:o,y:l}}function wP(t,e){const n=Ol(t,!0,e==="fixed"),i=n.top+t.clientTop,r=n.left+t.clientLeft,s=Ri(t)?Io(t):cs(1),a=t.clientWidth*s.x,o=t.clientHeight*s.y,l=r*s.x,c=i*s.y;return{width:a,height:o,x:l,y:c}}function l0(t,e,n){let i;if(e==="viewport")i=bP(t,n);else if(e==="document")i=CP(gs(t));else if(Ti(e))i=wP(e,n);else{const r=wb(t);i={...e,x:e.x-r.x,y:e.y-r.y}}return Ou(i)}function Eb(t,e){const n=ea(t);return n===e||!Ti(n)||fd(n)?!1:wn(n).position==="fixed"||Eb(n,e)}function kP(t,e){const n=e.get(t);if(n)return n;let i=ep(t,[],!1).filter(o=>Ti(o)&&us(o)!=="body"),r=null;const s=wn(t).position==="fixed";let a=s?ea(t):t;for(;Ti(a)&&!fd(a);){const o=wn(a),l=xm(a);!l&&o.position==="fixed"&&(r=null),(s?!l&&!r:!l&&o.position==="static"&&!!r&&["absolute","fixed"].includes(r.position)||Wl(a)&&!l&&Eb(t,a))?i=i.filter(d=>d!==a):r=o,a=ea(a)}return e.set(t,i),i}function EP(t){let{element:e,boundary:n,rootBoundary:i,strategy:r}=t;const a=[...n==="clippingAncestors"?kP(e,this._c):[].concat(n),i],o=a[0],l=a.reduce((c,d)=>{const u=l0(e,d,r);return c.top=Oo(u.top,c.top),c.right=Yf(u.right,c.right),c.bottom=Yf(u.bottom,c.bottom),c.left=Oo(u.left,c.left),c},l0(e,o,r));return{width:l.right-l.left,height:l.bottom-l.top,x:l.left,y:l.top}}function TP(t){const{width:e,height:n}=Cb(t);return{width:e,height:n}}function RP(t,e,n){const i=Ri(e),r=gs(e),s=n==="fixed",a=Ol(t,!0,s,e);let o={scrollLeft:0,scrollTop:0};const l=cs(0);if(i||!i&&!s)if((us(e)!=="body"||Wl(r))&&(o=pd(e)),i){const c=Ol(e,!0,s,e);l.x=c.x+e.clientLeft,l.y=c.y+e.clientTop}else r&&(l.x=kb(r));return{x:a.left+o.scrollLeft-l.x,y:a.top+o.scrollTop-l.y,width:a.width,height:a.height}}function c0(t,e){return!Ri(t)||wn(t).position==="fixed"?null:e?e(t):t.offsetParent}function Tb(t,e){const n=sn(t);if(!Ri(t))return n;let i=c0(t,e);for(;i&&fP(i)&&wn(i).position==="static";)i=c0(i,e);return i&&(us(i)==="html"||us(i)==="body"&&wn(i).position==="static"&&!xm(i))?n:i||mP(t)||n}const xP=async function(t){let{reference:e,floating:n,strategy:i}=t;const r=this.getOffsetParent||Tb,s=this.getDimensions;return{reference:RP(e,await r(n),i),floating:{x:0,y:0,...await s(n)}}};function PP(t){return wn(t).direction==="rtl"}const OP={convertOffsetParentRelativeRectToViewportRelativeRect:yP,getDocumentElement:gs,getClippingRect:EP,getOffsetParent:Tb,getElementRects:xP,getClientRects:SP,getDimensions:TP,getScale:Io,isElement:Ti,isRTL:PP},IP=hP,LP=cP,MP=(t,e,n)=>{const i=new Map,r={platform:OP,...n},s={...r.platform,_c:i};return lP(t,e,{...r,platform:s})};var Rb={exports:{}};(function(t){(function(e,n){t.exports?t.exports=n():e.log=n()})(tk,function(){var e=function(){},n="undefined",i=typeof window!==n&&typeof window.navigator!==n&&/Trident\/|MSIE /.test(window.navigator.userAgent),r=["trace","debug","info","warn","error"];function s(_,p){var f=_[p];if(typeof f.bind=="function")return f.bind(_);try{return Function.prototype.bind.call(f,_)}catch{return function(){return Function.prototype.apply.apply(f,[_,arguments])}}}function a(){console.log&&(console.log.apply?console.log.apply(console,arguments):Function.prototype.apply.apply(console.log,[console,arguments])),console.trace&&console.trace()}function o(_){return _==="debug"&&(_="log"),typeof console===n?!1:_==="trace"&&i?a:console[_]!==void 0?s(console,_):console.log!==void 0?s(console,"log"):e}function l(_,p){for(var f=0;f<r.length;f++){var h=r[f];this[h]=f<_?e:this.methodFactory(h,_,p)}this.log=this.debug}function c(_,p,f){return function(){typeof console!==n&&(l.call(this,p,f),this[_].apply(this,arguments))}}function d(_,p,f){return o(_)||c.apply(this,arguments)}function u(_,p,f){var h=this,g;p=p??"WARN";var S="loglevel";typeof _=="string"?S+=":"+_:typeof _=="symbol"&&(S=void 0);function b(E){var x=(r[E]||"silent").toUpperCase();if(!(typeof window===n||!S)){try{window.localStorage[S]=x;return}catch{}try{window.document.cookie=encodeURIComponent(S)+"="+x+";"}catch{}}}function w(){var E;if(!(typeof window===n||!S)){try{E=window.localStorage[S]}catch{}if(typeof E===n)try{var x=window.document.cookie,I=x.indexOf(encodeURIComponent(S)+"=");I!==-1&&(E=/^([^;]+)/.exec(x.slice(I))[1])}catch{}return h.levels[E]===void 0&&(E=void 0),E}}function k(){if(!(typeof window===n||!S)){try{window.localStorage.removeItem(S);return}catch{}try{window.document.cookie=encodeURIComponent(S)+"=; expires=Thu, 01 Jan 1970 00:00:00 UTC"}catch{}}}h.name=_,h.levels={TRACE:0,DEBUG:1,INFO:2,WARN:3,ERROR:4,SILENT:5},h.methodFactory=f||d,h.getLevel=function(){return g},h.setLevel=function(E,x){if(typeof E=="string"&&h.levels[E.toUpperCase()]!==void 0&&(E=h.levels[E.toUpperCase()]),typeof E=="number"&&E>=0&&E<=h.levels.SILENT){if(g=E,x!==!1&&b(E),l.call(h,E,_),typeof console===n&&E<h.levels.SILENT)return"No console available for logging"}else throw"log.setLevel() called with invalid level: "+E},h.setDefaultLevel=function(E){p=E,w()||h.setLevel(E,!1)},h.resetLevel=function(){h.setLevel(p,!1),k()},h.enableAll=function(E){h.setLevel(h.levels.TRACE,E)},h.disableAll=function(E){h.setLevel(h.levels.SILENT,E)};var C=w();C==null&&(C=p),h.setLevel(C,!1)}var m=new u,v={};m.getLogger=function(p){if(typeof p!="symbol"&&typeof p!="string"||p==="")throw new TypeError("You must supply a name when creating a logger.");var f=v[p];return f||(f=v[p]=new u(p,m.getLevel(),m.methodFactory)),f};var y=typeof window!==n?window.log:void 0;return m.noConflict=function(){return typeof window!==n&&window.log===m&&(window.log=y),m},m.getLoggers=function(){return v},m.default=m,m})})(Rb);var DP=Rb.exports;const AP=A_(DP);var tp=function(t,e){return tp=Object.setPrototypeOf||{__proto__:[]}instanceof Array&&function(n,i){n.__proto__=i}||function(n,i){for(var r in i)Object.prototype.hasOwnProperty.call(i,r)&&(n[r]=i[r])},tp(t,e)};function Cr(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Class extends value "+String(e)+" is not a constructor or null");tp(t,e);function n(){this.constructor=t}t.prototype=e===null?Object.create(e):(n.prototype=e.prototype,new n)}function NP(t,e,n,i){function r(s){return s instanceof n?s:new n(function(a){a(s)})}return new(n||(n=Promise))(function(s,a){function o(d){try{c(i.next(d))}catch(u){a(u)}}function l(d){try{c(i.throw(d))}catch(u){a(u)}}function c(d){d.done?s(d.value):r(d.value).then(o,l)}c((i=i.apply(t,e||[])).next())})}function xb(t,e){var n={label:0,sent:function(){if(s[0]&1)throw s[1];return s[1]},trys:[],ops:[]},i,r,s,a=Object.create((typeof Iterator=="function"?Iterator:Object).prototype);return a.next=o(0),a.throw=o(1),a.return=o(2),typeof Symbol=="function"&&(a[Symbol.iterator]=function(){return this}),a;function o(c){return function(d){return l([c,d])}}function l(c){if(i)throw new TypeError("Generator is already executing.");for(;a&&(a=0,c[0]&&(n=0)),n;)try{if(i=1,r&&(s=c[0]&2?r.return:c[0]?r.throw||((s=r.return)&&s.call(r),0):r.next)&&!(s=s.call(r,c[1])).done)return s;switch(r=0,s&&(c=[c[0]&2,s.value]),c[0]){case 0:case 1:s=c;break;case 4:return n.label++,{value:c[1],done:!1};case 5:n.label++,r=c[1],c=[0];continue;case 7:c=n.ops.pop(),n.trys.pop();continue;default:if(s=n.trys,!(s=s.length>0&&s[s.length-1])&&(c[0]===6||c[0]===2)){n=0;continue}if(c[0]===3&&(!s||c[1]>s[0]&&c[1]<s[3])){n.label=c[1];break}if(c[0]===6&&n.label<s[1]){n.label=s[1],s=c;break}if(s&&n.label<s[2]){n.label=s[2],n.ops.push(c);break}s[2]&&n.ops.pop(),n.trys.pop();continue}c=e.call(t,n)}catch(d){c=[6,d],r=0}finally{i=s=0}if(c[0]&5)throw c[1];return{value:c[0]?c[1]:void 0,done:!0}}}function ta(t){var e=typeof Symbol=="function"&&Symbol.iterator,n=e&&t[e],i=0;if(n)return n.call(t);if(t&&typeof t.length=="number")return{next:function(){return t&&i>=t.length&&(t=void 0),{value:t&&t[i++],done:!t}}};throw new TypeError(e?"Object is not iterable.":"Symbol.iterator is not defined.")}function ds(t,e){var n=typeof Symbol=="function"&&t[Symbol.iterator];if(!n)return t;var i=n.call(t),r,s=[],a;try{for(;(e===void 0||e-- >0)&&!(r=i.next()).done;)s.push(r.value)}catch(o){a={error:o}}finally{try{r&&!r.done&&(n=i.return)&&n.call(i)}finally{if(a)throw a.error}}return s}function Gs(t,e,n){if(n||arguments.length===2)for(var i=0,r=e.length,s;i<r;i++)(s||!(i in e))&&(s||(s=Array.prototype.slice.call(e,0,i)),s[i]=e[i]);return t.concat(s||Array.prototype.slice.call(e))}function Lo(t){return this instanceof Lo?(this.v=t,this):new Lo(t)}function BP(t,e,n){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var i=n.apply(t,e||[]),r,s=[];return r=Object.create((typeof AsyncIterator=="function"?AsyncIterator:Object).prototype),o("next"),o("throw"),o("return",a),r[Symbol.asyncIterator]=function(){return this},r;function a(v){return function(y){return Promise.resolve(y).then(v,u)}}function o(v,y){i[v]&&(r[v]=function(_){return new Promise(function(p,f){s.push([v,_,p,f])>1||l(v,_)})},y&&(r[v]=y(r[v])))}function l(v,y){try{c(i[v](y))}catch(_){m(s[0][3],_)}}function c(v){v.value instanceof Lo?Promise.resolve(v.value.v).then(d,u):m(s[0][2],v)}function d(v){l("next",v)}function u(v){l("throw",v)}function m(v,y){v(y),s.shift(),s.length&&l(s[0][0],s[0][1])}}function FP(t){if(!Symbol.asyncIterator)throw new TypeError("Symbol.asyncIterator is not defined.");var e=t[Symbol.asyncIterator],n;return e?e.call(t):(t=typeof ta=="function"?ta(t):t[Symbol.iterator](),n={},i("next"),i("throw"),i("return"),n[Symbol.asyncIterator]=function(){return this},n);function i(s){n[s]=t[s]&&function(a){return new Promise(function(o,l){a=t[s](a),r(o,l,a.done,a.value)})}}function r(s,a,o,l){Promise.resolve(l).then(function(c){s({value:c,done:o})},a)}}function Oe(t){return typeof t=="function"}function Om(t){var e=function(i){Error.call(i),i.stack=new Error().stack},n=t(e);return n.prototype=Object.create(Error.prototype),n.prototype.constructor=n,n}var yh=Om(function(t){return function(n){t(this),this.message=n?n.length+` errors occurred during unsubscription:
`+n.map(function(i,r){return r+1+") "+i.toString()}).join(`
  `):"",this.name="UnsubscriptionError",this.errors=n}});function Iu(t,e){if(t){var n=t.indexOf(e);0<=n&&t.splice(n,1)}}var $l=function(){function t(e){this.initialTeardown=e,this.closed=!1,this._parentage=null,this._finalizers=null}return t.prototype.unsubscribe=function(){var e,n,i,r,s;if(!this.closed){this.closed=!0;var a=this._parentage;if(a)if(this._parentage=null,Array.isArray(a))try{for(var o=ta(a),l=o.next();!l.done;l=o.next()){var c=l.value;c.remove(this)}}catch(_){e={error:_}}finally{try{l&&!l.done&&(n=o.return)&&n.call(o)}finally{if(e)throw e.error}}else a.remove(this);var d=this.initialTeardown;if(Oe(d))try{d()}catch(_){s=_ instanceof yh?_.errors:[_]}var u=this._finalizers;if(u){this._finalizers=null;try{for(var m=ta(u),v=m.next();!v.done;v=m.next()){var y=v.value;try{u0(y)}catch(_){s=s??[],_ instanceof yh?s=Gs(Gs([],ds(s)),ds(_.errors)):s.push(_)}}}catch(_){i={error:_}}finally{try{v&&!v.done&&(r=m.return)&&r.call(m)}finally{if(i)throw i.error}}}if(s)throw new yh(s)}},t.prototype.add=function(e){var n;if(e&&e!==this)if(this.closed)u0(e);else{if(e instanceof t){if(e.closed||e._hasParent(this))return;e._addParent(this)}(this._finalizers=(n=this._finalizers)!==null&&n!==void 0?n:[]).push(e)}},t.prototype._hasParent=function(e){var n=this._parentage;return n===e||Array.isArray(n)&&n.includes(e)},t.prototype._addParent=function(e){var n=this._parentage;this._parentage=Array.isArray(n)?(n.push(e),n):n?[n,e]:e},t.prototype._removeParent=function(e){var n=this._parentage;n===e?this._parentage=null:Array.isArray(n)&&Iu(n,e)},t.prototype.remove=function(e){var n=this._finalizers;n&&Iu(n,e),e instanceof t&&e._removeParent(this)},t.EMPTY=function(){var e=new t;return e.closed=!0,e}(),t}(),Pb=$l.EMPTY;function Ob(t){return t instanceof $l||t&&"closed"in t&&Oe(t.remove)&&Oe(t.add)&&Oe(t.unsubscribe)}function u0(t){Oe(t)?t():t.unsubscribe()}var Ib={onUnhandledError:null,onStoppedNotification:null,Promise:void 0,useDeprecatedSynchronousErrorHandling:!1,useDeprecatedNextContext:!1},np={setTimeout:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=np.delegate;return r!=null&&r.setTimeout?r.setTimeout.apply(r,Gs([t,e],ds(n))):setTimeout.apply(void 0,Gs([t,e],ds(n)))},clearTimeout:function(t){var e=np.delegate;return((e==null?void 0:e.clearTimeout)||clearTimeout)(t)},delegate:void 0};function Lb(t){np.setTimeout(function(){throw t})}function Lu(){}function qc(t){t()}var Im=function(t){Cr(e,t);function e(n){var i=t.call(this)||this;return i.isStopped=!1,n?(i.destination=n,Ob(n)&&n.add(i)):i.destination=jP,i}return e.create=function(n,i,r){return new ip(n,i,r)},e.prototype.next=function(n){this.isStopped||this._next(n)},e.prototype.error=function(n){this.isStopped||(this.isStopped=!0,this._error(n))},e.prototype.complete=function(){this.isStopped||(this.isStopped=!0,this._complete())},e.prototype.unsubscribe=function(){this.closed||(this.isStopped=!0,t.prototype.unsubscribe.call(this),this.destination=null)},e.prototype._next=function(n){this.destination.next(n)},e.prototype._error=function(n){try{this.destination.error(n)}finally{this.unsubscribe()}},e.prototype._complete=function(){try{this.destination.complete()}finally{this.unsubscribe()}},e}($l),UP=Function.prototype.bind;function Sh(t,e){return UP.call(t,e)}var zP=function(){function t(e){this.partialObserver=e}return t.prototype.next=function(e){var n=this.partialObserver;if(n.next)try{n.next(e)}catch(i){_c(i)}},t.prototype.error=function(e){var n=this.partialObserver;if(n.error)try{n.error(e)}catch(i){_c(i)}else _c(e)},t.prototype.complete=function(){var e=this.partialObserver;if(e.complete)try{e.complete()}catch(n){_c(n)}},t}(),ip=function(t){Cr(e,t);function e(n,i,r){var s=t.call(this)||this,a;if(Oe(n)||!n)a={next:n??void 0,error:i??void 0,complete:r??void 0};else{var o;s&&Ib.useDeprecatedNextContext?(o=Object.create(n),o.unsubscribe=function(){return s.unsubscribe()},a={next:n.next&&Sh(n.next,o),error:n.error&&Sh(n.error,o),complete:n.complete&&Sh(n.complete,o)}):a=n}return s.destination=new zP(a),s}return e}(Im);function _c(t){Lb(t)}function HP(t){throw t}var jP={closed:!0,next:Lu,error:HP,complete:Lu},Lm=function(){return typeof Symbol=="function"&&Symbol.observable||"@@observable"}();function Mm(t){return t}function WP(t){return t.length===0?Mm:t.length===1?t[0]:function(n){return t.reduce(function(i,r){return r(i)},n)}}var gt=function(){function t(e){e&&(this._subscribe=e)}return t.prototype.lift=function(e){var n=new t;return n.source=this,n.operator=e,n},t.prototype.subscribe=function(e,n,i){var r=this,s=VP(e)?e:new ip(e,n,i);return qc(function(){var a=r,o=a.operator,l=a.source;s.add(o?o.call(s,l):l?r._subscribe(s):r._trySubscribe(s))}),s},t.prototype._trySubscribe=function(e){try{return this._subscribe(e)}catch(n){e.error(n)}},t.prototype.forEach=function(e,n){var i=this;return n=d0(n),new n(function(r,s){var a=new ip({next:function(o){try{e(o)}catch(l){s(l),a.unsubscribe()}},error:s,complete:r});i.subscribe(a)})},t.prototype._subscribe=function(e){var n;return(n=this.source)===null||n===void 0?void 0:n.subscribe(e)},t.prototype[Lm]=function(){return this},t.prototype.pipe=function(){for(var e=[],n=0;n<arguments.length;n++)e[n]=arguments[n];return WP(e)(this)},t.prototype.toPromise=function(e){var n=this;return e=d0(e),new e(function(i,r){var s;n.subscribe(function(a){return s=a},function(a){return r(a)},function(){return i(s)})})},t.create=function(e){return new t(e)},t}();function d0(t){var e;return(e=t??Ib.Promise)!==null&&e!==void 0?e:Promise}function $P(t){return t&&Oe(t.next)&&Oe(t.error)&&Oe(t.complete)}function VP(t){return t&&t instanceof Im||$P(t)&&Ob(t)}function GP(t){return Oe(t==null?void 0:t.lift)}function kn(t){return function(e){if(GP(e))return e.lift(function(n){try{return t(n,this)}catch(i){this.error(i)}});throw new TypeError("Unable to lift unknown Observable type")}}function Jn(t,e,n,i,r){return new qP(t,e,n,i,r)}var qP=function(t){Cr(e,t);function e(n,i,r,s,a,o){var l=t.call(this,n)||this;return l.onFinalize=a,l.shouldUnsubscribe=o,l._next=i?function(c){try{i(c)}catch(d){n.error(d)}}:t.prototype._next,l._error=s?function(c){try{s(c)}catch(d){n.error(d)}finally{this.unsubscribe()}}:t.prototype._error,l._complete=r?function(){try{r()}catch(c){n.error(c)}finally{this.unsubscribe()}}:t.prototype._complete,l}return e.prototype.unsubscribe=function(){var n;if(!this.shouldUnsubscribe||this.shouldUnsubscribe()){var i=this.closed;t.prototype.unsubscribe.call(this),!i&&((n=this.onFinalize)===null||n===void 0||n.call(this))}},e}(Im),JP=Om(function(t){return function(){t(this),this.name="ObjectUnsubscribedError",this.message="object unsubscribed"}}),hs=function(t){Cr(e,t);function e(){var n=t.call(this)||this;return n.closed=!1,n.currentObservers=null,n.observers=[],n.isStopped=!1,n.hasError=!1,n.thrownError=null,n}return e.prototype.lift=function(n){var i=new h0(this,this);return i.operator=n,i},e.prototype._throwIfClosed=function(){if(this.closed)throw new JP},e.prototype.next=function(n){var i=this;qc(function(){var r,s;if(i._throwIfClosed(),!i.isStopped){i.currentObservers||(i.currentObservers=Array.from(i.observers));try{for(var a=ta(i.currentObservers),o=a.next();!o.done;o=a.next()){var l=o.value;l.next(n)}}catch(c){r={error:c}}finally{try{o&&!o.done&&(s=a.return)&&s.call(a)}finally{if(r)throw r.error}}}})},e.prototype.error=function(n){var i=this;qc(function(){if(i._throwIfClosed(),!i.isStopped){i.hasError=i.isStopped=!0,i.thrownError=n;for(var r=i.observers;r.length;)r.shift().error(n)}})},e.prototype.complete=function(){var n=this;qc(function(){if(n._throwIfClosed(),!n.isStopped){n.isStopped=!0;for(var i=n.observers;i.length;)i.shift().complete()}})},e.prototype.unsubscribe=function(){this.isStopped=this.closed=!0,this.observers=this.currentObservers=null},Object.defineProperty(e.prototype,"observed",{get:function(){var n;return((n=this.observers)===null||n===void 0?void 0:n.length)>0},enumerable:!1,configurable:!0}),e.prototype._trySubscribe=function(n){return this._throwIfClosed(),t.prototype._trySubscribe.call(this,n)},e.prototype._subscribe=function(n){return this._throwIfClosed(),this._checkFinalizedStatuses(n),this._innerSubscribe(n)},e.prototype._innerSubscribe=function(n){var i=this,r=this,s=r.hasError,a=r.isStopped,o=r.observers;return s||a?Pb:(this.currentObservers=null,o.push(n),new $l(function(){i.currentObservers=null,Iu(o,n)}))},e.prototype._checkFinalizedStatuses=function(n){var i=this,r=i.hasError,s=i.thrownError,a=i.isStopped;r?n.error(s):a&&n.complete()},e.prototype.asObservable=function(){var n=new gt;return n.source=this,n},e.create=function(n,i){return new h0(n,i)},e}(gt),h0=function(t){Cr(e,t);function e(n,i){var r=t.call(this)||this;return r.destination=n,r.source=i,r}return e.prototype.next=function(n){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.next)===null||r===void 0||r.call(i,n)},e.prototype.error=function(n){var i,r;(r=(i=this.destination)===null||i===void 0?void 0:i.error)===null||r===void 0||r.call(i,n)},e.prototype.complete=function(){var n,i;(i=(n=this.destination)===null||n===void 0?void 0:n.complete)===null||i===void 0||i.call(n)},e.prototype._subscribe=function(n){var i,r;return(r=(i=this.source)===null||i===void 0?void 0:i.subscribe(n))!==null&&r!==void 0?r:Pb},e}(hs),Mb=function(t){Cr(e,t);function e(n){var i=t.call(this)||this;return i._value=n,i}return Object.defineProperty(e.prototype,"value",{get:function(){return this.getValue()},enumerable:!1,configurable:!0}),e.prototype._subscribe=function(n){var i=t.prototype._subscribe.call(this,n);return!i.closed&&n.next(this._value),i},e.prototype.getValue=function(){var n=this,i=n.hasError,r=n.thrownError,s=n._value;if(i)throw r;return this._throwIfClosed(),s},e.prototype.next=function(n){t.prototype.next.call(this,this._value=n)},e}(hs),Db={now:function(){return(Db.delegate||Date).now()},delegate:void 0},KP=function(t){Cr(e,t);function e(n,i){return t.call(this)||this}return e.prototype.schedule=function(n,i){return this},e}($l),Mu={setInterval:function(t,e){for(var n=[],i=2;i<arguments.length;i++)n[i-2]=arguments[i];var r=Mu.delegate;return r!=null&&r.setInterval?r.setInterval.apply(r,Gs([t,e],ds(n))):setInterval.apply(void 0,Gs([t,e],ds(n)))},clearInterval:function(t){var e=Mu.delegate;return((e==null?void 0:e.clearInterval)||clearInterval)(t)},delegate:void 0},QP=function(t){Cr(e,t);function e(n,i){var r=t.call(this,n,i)||this;return r.scheduler=n,r.work=i,r.pending=!1,r}return e.prototype.schedule=function(n,i){var r;if(i===void 0&&(i=0),this.closed)return this;this.state=n;var s=this.id,a=this.scheduler;return s!=null&&(this.id=this.recycleAsyncId(a,s,i)),this.pending=!0,this.delay=i,this.id=(r=this.id)!==null&&r!==void 0?r:this.requestAsyncId(a,this.id,i),this},e.prototype.requestAsyncId=function(n,i,r){return r===void 0&&(r=0),Mu.setInterval(n.flush.bind(n,this),r)},e.prototype.recycleAsyncId=function(n,i,r){if(r===void 0&&(r=0),r!=null&&this.delay===r&&this.pending===!1)return i;i!=null&&Mu.clearInterval(i)},e.prototype.execute=function(n,i){if(this.closed)return new Error("executing a cancelled action");this.pending=!1;var r=this._execute(n,i);if(r)return r;this.pending===!1&&this.id!=null&&(this.id=this.recycleAsyncId(this.scheduler,this.id,null))},e.prototype._execute=function(n,i){var r=!1,s;try{this.work(n)}catch(a){r=!0,s=a||new Error("Scheduled action threw falsy error")}if(r)return this.unsubscribe(),s},e.prototype.unsubscribe=function(){if(!this.closed){var n=this,i=n.id,r=n.scheduler,s=r.actions;this.work=this.state=this.scheduler=null,this.pending=!1,Iu(s,this),i!=null&&(this.id=this.recycleAsyncId(r,i,null)),this.delay=null,t.prototype.unsubscribe.call(this)}},e}(KP),f0=function(){function t(e,n){n===void 0&&(n=t.now),this.schedulerActionCtor=e,this.now=n}return t.prototype.schedule=function(e,n,i){return n===void 0&&(n=0),new this.schedulerActionCtor(this,e).schedule(i,n)},t.now=Db.now,t}(),XP=function(t){Cr(e,t);function e(n,i){i===void 0&&(i=f0.now);var r=t.call(this,n,i)||this;return r.actions=[],r._active=!1,r}return e.prototype.flush=function(n){var i=this.actions;if(this._active){i.push(n);return}var r;this._active=!0;do if(r=n.execute(n.state,n.delay))break;while(n=i.shift());if(this._active=!1,r){for(;n=i.shift();)n.unsubscribe();throw r}},e}(f0),YP=new XP(QP);function ZP(t){return t&&Oe(t.schedule)}function e2(t){return t[t.length-1]}function Dm(t){return ZP(e2(t))?t.pop():void 0}var Am=function(t){return t&&typeof t.length=="number"&&typeof t!="function"};function Ab(t){return Oe(t==null?void 0:t.then)}function Nb(t){return Oe(t[Lm])}function Bb(t){return Symbol.asyncIterator&&Oe(t==null?void 0:t[Symbol.asyncIterator])}function Fb(t){return new TypeError("You provided "+(t!==null&&typeof t=="object"?"an invalid object":"'"+t+"'")+" where a stream was expected. You can provide an Observable, Promise, ReadableStream, Array, AsyncIterable, or Iterable.")}function t2(){return typeof Symbol!="function"||!Symbol.iterator?"@@iterator":Symbol.iterator}var Ub=t2();function zb(t){return Oe(t==null?void 0:t[Ub])}function Hb(t){return BP(this,arguments,function(){var n,i,r,s;return xb(this,function(a){switch(a.label){case 0:n=t.getReader(),a.label=1;case 1:a.trys.push([1,,9,10]),a.label=2;case 2:return[4,Lo(n.read())];case 3:return i=a.sent(),r=i.value,s=i.done,s?[4,Lo(void 0)]:[3,5];case 4:return[2,a.sent()];case 5:return[4,Lo(r)];case 6:return[4,a.sent()];case 7:return a.sent(),[3,2];case 8:return[3,10];case 9:return n.releaseLock(),[7];case 10:return[2]}})})}function jb(t){return Oe(t==null?void 0:t.getReader)}function br(t){if(t instanceof gt)return t;if(t!=null){if(Nb(t))return n2(t);if(Am(t))return i2(t);if(Ab(t))return r2(t);if(Bb(t))return Wb(t);if(zb(t))return s2(t);if(jb(t))return o2(t)}throw Fb(t)}function n2(t){return new gt(function(e){var n=t[Lm]();if(Oe(n.subscribe))return n.subscribe(e);throw new TypeError("Provided object does not correctly implement Symbol.observable")})}function i2(t){return new gt(function(e){for(var n=0;n<t.length&&!e.closed;n++)e.next(t[n]);e.complete()})}function r2(t){return new gt(function(e){t.then(function(n){e.closed||(e.next(n),e.complete())},function(n){return e.error(n)}).then(null,Lb)})}function s2(t){return new gt(function(e){var n,i;try{for(var r=ta(t),s=r.next();!s.done;s=r.next()){var a=s.value;if(e.next(a),e.closed)return}}catch(o){n={error:o}}finally{try{s&&!s.done&&(i=r.return)&&i.call(r)}finally{if(n)throw n.error}}e.complete()})}function Wb(t){return new gt(function(e){a2(t,e).catch(function(n){return e.error(n)})})}function o2(t){return Wb(Hb(t))}function a2(t,e){var n,i,r,s;return NP(this,void 0,void 0,function(){var a,o;return xb(this,function(l){switch(l.label){case 0:l.trys.push([0,5,6,11]),n=FP(t),l.label=1;case 1:return[4,n.next()];case 2:if(i=l.sent(),!!i.done)return[3,4];if(a=i.value,e.next(a),e.closed)return[2];l.label=3;case 3:return[3,1];case 4:return[3,11];case 5:return o=l.sent(),r={error:o},[3,11];case 6:return l.trys.push([6,,9,10]),i&&!i.done&&(s=n.return)?[4,s.call(n)]:[3,8];case 7:l.sent(),l.label=8;case 8:return[3,10];case 9:if(r)throw r.error;return[7];case 10:return[7];case 11:return e.complete(),[2]}})})}function fr(t,e,n,i,r){i===void 0&&(i=0),r===void 0&&(r=!1);var s=e.schedule(function(){n(),r?t.add(this.schedule(null,i)):this.unsubscribe()},i);if(t.add(s),!r)return s}function $b(t,e){return e===void 0&&(e=0),kn(function(n,i){n.subscribe(Jn(i,function(r){return fr(i,t,function(){return i.next(r)},e)},function(){return fr(i,t,function(){return i.complete()},e)},function(r){return fr(i,t,function(){return i.error(r)},e)}))})}function Vb(t,e){return e===void 0&&(e=0),kn(function(n,i){i.add(t.schedule(function(){return n.subscribe(i)},e))})}function l2(t,e){return br(t).pipe(Vb(e),$b(e))}function c2(t,e){return br(t).pipe(Vb(e),$b(e))}function u2(t,e){return new gt(function(n){var i=0;return e.schedule(function(){i===t.length?n.complete():(n.next(t[i++]),n.closed||this.schedule())})})}function d2(t,e){return new gt(function(n){var i;return fr(n,e,function(){i=t[Ub](),fr(n,e,function(){var r,s,a;try{r=i.next(),s=r.value,a=r.done}catch(o){n.error(o);return}a?n.complete():n.next(s)},0,!0)}),function(){return Oe(i==null?void 0:i.return)&&i.return()}})}function Gb(t,e){if(!t)throw new Error("Iterable cannot be null");return new gt(function(n){fr(n,e,function(){var i=t[Symbol.asyncIterator]();fr(n,e,function(){i.next().then(function(r){r.done?n.complete():n.next(r.value)})},0,!0)})})}function h2(t,e){return Gb(Hb(t),e)}function f2(t,e){if(t!=null){if(Nb(t))return l2(t,e);if(Am(t))return u2(t,e);if(Ab(t))return c2(t,e);if(Bb(t))return Gb(t,e);if(zb(t))return d2(t,e);if(jb(t))return h2(t,e)}throw Fb(t)}function qb(t,e){return e?f2(t,e):br(t)}function p0(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Dm(t);return qb(t,n)}function p2(t){return t instanceof Date&&!isNaN(t)}var m2=Om(function(t){return function(n){n===void 0&&(n=null),t(this),this.message="Timeout has occurred",this.name="TimeoutError",this.info=n}});function g2(t,e){var n=p2(t)?{first:t}:typeof t=="number"?{each:t}:t,i=n.first,r=n.each,s=n.with,a=s===void 0?v2:s,o=n.scheduler,l=o===void 0?e??YP:o,c=n.meta,d=c===void 0?null:c;if(i==null&&r==null)throw new TypeError("No timeout provided.");return kn(function(u,m){var v,y,_=null,p=0,f=function(h){y=fr(m,l,function(){try{v.unsubscribe(),br(a({meta:d,lastValue:_,seen:p})).subscribe(m)}catch(g){m.error(g)}},h)};v=u.subscribe(Jn(m,function(h){y==null||y.unsubscribe(),p++,m.next(_=h),r>0&&f(r)},void 0,void 0,function(){y!=null&&y.closed||y==null||y.unsubscribe(),_=null})),!p&&f(i!=null?typeof i=="number"?i:+i-l.now():r)})}function v2(t){throw new m2(t)}function rt(t,e){return kn(function(n,i){var r=0;n.subscribe(Jn(i,function(s){i.next(t.call(e,s,r++))}))})}var _2=Array.isArray;function y2(t,e){return _2(e)?t.apply(void 0,Gs([],ds(e))):t(e)}function S2(t){return rt(function(e){return y2(t,e)})}function C2(t,e,n,i,r,s,a,o){var l=[],c=0,d=0,u=!1,m=function(){u&&!l.length&&!c&&e.complete()},v=function(_){return c<i?y(_):l.push(_)},y=function(_){s&&e.next(_),c++;var p=!1;br(n(_,d++)).subscribe(Jn(e,function(f){r==null||r(f),s?v(f):e.next(f)},function(){p=!0},void 0,function(){if(p)try{c--;for(var f=function(){var h=l.shift();a?fr(e,a,function(){return y(h)}):y(h)};l.length&&c<i;)f();m()}catch(h){e.error(h)}}))};return t.subscribe(Jn(e,v,function(){u=!0,m()})),function(){o==null||o()}}function Nm(t,e,n){return n===void 0&&(n=1/0),Oe(e)?Nm(function(i,r){return rt(function(s,a){return e(i,s,r,a)})(br(t(i,r)))},n):(typeof e=="number"&&(n=e),kn(function(i,r){return C2(i,r,t,n)}))}function b2(t){return t===void 0&&(t=1/0),Nm(Mm,t)}function w2(){return b2(1)}function Du(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];return w2()(qb(t,Dm(t)))}var k2=["addListener","removeListener"],E2=["addEventListener","removeEventListener"],T2=["on","off"];function rp(t,e,n,i){if(Oe(n)&&(i=n,n=void 0),i)return rp(t,e,n).pipe(S2(i));var r=ds(P2(t)?E2.map(function(o){return function(l){return t[o](e,l,n)}}):R2(t)?k2.map(m0(t,e)):x2(t)?T2.map(m0(t,e)):[],2),s=r[0],a=r[1];if(!s&&Am(t))return Nm(function(o){return rp(o,e,n)})(br(t));if(!s)throw new TypeError("Invalid event target");return new gt(function(o){var l=function(){for(var c=[],d=0;d<arguments.length;d++)c[d]=arguments[d];return o.next(1<c.length?c:c[0])};return s(l),function(){return a(l)}})}function m0(t,e){return function(n){return function(i){return t[n](e,i)}}}function R2(t){return Oe(t.addListener)&&Oe(t.removeListener)}function x2(t){return Oe(t.on)&&Oe(t.off)}function P2(t){return Oe(t.addEventListener)&&Oe(t.removeEventListener)}function Bm(t,e){return kn(function(n,i){var r=0;n.subscribe(Jn(i,function(s){return t.call(e,s,r++)&&i.next(s)}))})}function O2(t,e,n,i,r){return function(s,a){var o=n,l=e,c=0;s.subscribe(Jn(a,function(d){var u=c++;l=o?t(l,d,u):(o=!0,d),i&&a.next(l)},r&&function(){o&&a.next(l),a.complete()}))}}function I2(t,e){return e===void 0&&(e=Mm),t=t??L2,kn(function(n,i){var r,s=!0;n.subscribe(Jn(i,function(a){var o=e(a);(s||!t(r,o))&&(s=!1,r=o,i.next(a))}))})}function L2(t,e){return t===e}function M2(t){return kn(function(e,n){try{e.subscribe(n)}finally{n.add(t)}})}function D2(t,e){return kn(O2(t,e,arguments.length>=2,!0))}function A2(t){return kn(function(e,n){var i=!1,r=Jn(n,function(){r==null||r.unsubscribe(),i=!0},Lu);br(t).subscribe(r),e.subscribe(Jn(n,function(s){return i&&n.next(s)}))})}function En(){for(var t=[],e=0;e<arguments.length;e++)t[e]=arguments[e];var n=Dm(t);return kn(function(i,r){(n?Du(t,i,n):Du(t,i)).subscribe(r)})}function g0(t){return kn(function(e,n){br(t).subscribe(Jn(n,function(){return n.complete()},Lu)),!n.closed&&e.subscribe(n)})}var N2=Object.defineProperty,B2=Object.defineProperties,F2=Object.getOwnPropertyDescriptors,Au=Object.getOwnPropertySymbols,Jb=Object.prototype.hasOwnProperty,Kb=Object.prototype.propertyIsEnumerable,v0=(t,e,n)=>e in t?N2(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,sp=(t,e)=>{for(var n in e||(e={}))Jb.call(e,n)&&v0(t,n,e[n]);if(Au)for(var n of Au(e))Kb.call(e,n)&&v0(t,n,e[n]);return t},U2=(t,e)=>B2(t,F2(e)),z2=(t,e)=>{var n={};for(var i in t)Jb.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&Au)for(var i of Au(t))e.indexOf(i)<0&&Kb.call(t,i)&&(n[i]=t[i]);return n},Pi=(t,e,n)=>new Promise((i,r)=>{var s=l=>{try{o(n.next(l))}catch(c){r(c)}},a=l=>{try{o(n.throw(l))}catch(c){r(c)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,a);o((n=n.apply(t,e)).next())}),Qb="lk";function pt(t){return typeof t>"u"?!1:H2(t)||j2(t)}function H2(t){var e;return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("track")&&typeof((e=t.publication)==null?void 0:e.track)<"u":!1}function j2(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&t.hasOwnProperty("publication")&&typeof t.publication<"u":!1}function Il(t){return t?t.hasOwnProperty("participant")&&t.hasOwnProperty("source")&&typeof t.publication>"u":!1}function at(t){if(typeof t=="string"||typeof t=="number")return`${t}`;if(Il(t))return`${t.participant.identity}_${t.source}_placeholder`;if(pt(t))return`${t.participant.identity}_${t.publication.source}_${t.publication.trackSid}`;throw new Error(`Can't generate a id for the given track reference: ${t}`)}function W2(t,e){return t===void 0||e===void 0?!1:pt(t)&&pt(e)?t.publication.trackSid===e.publication.trackSid:at(t)===at(e)}function op(t,e){return typeof e>"u"?!1:pt(t)?e.some(n=>n.participant.identity===t.participant.identity&&pt(n)&&n.publication.trackSid===t.publication.trackSid):Il(t)?e.some(n=>n.participant.identity===t.participant.identity&&Il(n)&&n.source===t.source):!1}function $2(t,e){return Il(t)&&pt(e)&&e.participant.identity===t.participant.identity&&e.source===t.source}function Xb(t){return t instanceof Pl}function V2(){const t=document.createElement("p");t.style.width="100%",t.style.height="200px";const e=document.createElement("div");e.style.position="absolute",e.style.top="0px",e.style.left="0px",e.style.visibility="hidden",e.style.width="200px",e.style.height="150px",e.style.overflow="hidden",e.appendChild(t),document.body.appendChild(e);const n=t.offsetWidth;e.style.overflow="scroll";let i=t.offsetWidth;return n===i&&(i=e.clientWidth),document.body.removeChild(e),n-i}function G2(){return typeof document<"u"}function q2(t,e){return Pi(this,null,function*(){const{x:n,y:i}=yield MP(t,e,{placement:"top",middleware:[dP(6),LP(),IP({padding:5})]});return{x:n,y:i}})}function J2(t,e){return!t.contains(e.target)}var K2=[J.ConnectionStateChanged,J.RoomMetadataChanged,J.ActiveSpeakersChanged,J.ConnectionQualityChanged,J.ParticipantConnected,J.ParticipantDisconnected,J.ParticipantPermissionsChanged,J.ParticipantMetadataChanged,J.TrackMuted,J.TrackUnmuted,J.TrackPublished,J.TrackUnpublished,J.TrackStreamStateChanged,J.TrackSubscriptionFailed,J.TrackSubscriptionPermissionChanged,J.TrackSubscriptionStatusChanged],Q2=[...K2,J.LocalTrackPublished,J.LocalTrackUnpublished],X2=[Z.ConnectionQualityChanged,Z.IsSpeakingChanged,Z.ParticipantMetadataChanged,Z.ParticipantPermissionsChanged,Z.TrackMuted,Z.TrackUnmuted,Z.TrackPublished,Z.TrackUnpublished,Z.TrackStreamStateChanged,Z.TrackSubscriptionFailed,Z.TrackSubscriptionPermissionChanged,Z.TrackSubscriptionStatusChanged];[...X2,Z.LocalTrackPublished,Z.LocalTrackUnpublished];var ge=AP.getLogger("lk-components-js");ge.setDefaultLevel("WARN");var _0=[{columns:1,rows:1,name:"1x1",minTiles:1,maxTiles:1,minWidth:0,minHeight:0},{columns:1,rows:2,name:"1x2",minTiles:2,maxTiles:2,minWidth:0,minHeight:0},{columns:2,rows:1,name:"2x1",minTiles:2,maxTiles:2,minWidth:900,minHeight:0},{columns:2,rows:2,name:"2x2",minTiles:3,maxTiles:4,minWidth:560,minHeight:0},{columns:3,rows:3,name:"3x3",minTiles:5,maxTiles:9,minWidth:700,minHeight:0},{columns:4,rows:4,name:"4x4",minTiles:10,maxTiles:16,minWidth:960,minHeight:0},{columns:5,rows:5,name:"5x5",minTiles:17,maxTiles:25,minWidth:1100,minHeight:0}];function Yb(t,e,n,i){let r=0,s=t.find((a,o,l)=>{r=o;const c=l.findIndex((d,u)=>{const m=u>o,v=d.maxTiles===a.maxTiles;return m&&v})!==-1;return a.maxTiles>=e&&!c});if(s===void 0)if(s=t[t.length-1],s)ge.warn(`No layout found for: participantCount: ${e}, width/height: ${n}/${i} fallback to biggest available layout (${s.name}).`);else throw new Error("No layout or fallback layout found.");if((n<s.minWidth||i<s.minHeight)&&r>0){const a=t[r-1];s=Yb(t.slice(0,r),a.maxTiles,n,i)}return s}function Y2(){return typeof navigator<"u"&&navigator.mediaDevices&&!!navigator.mediaDevices.getDisplayMedia}var Zb=[],ew={showChat:!1,unreadMessages:0};function tw(t){return typeof t=="object"}function nw(t){return Array.isArray(t)&&t.filter(tw).length>0}function Z2(t,e){return e.audioLevel-t.audioLevel}function eO(t,e){return t.isSpeaking===e.isSpeaking?0:t.isSpeaking?-1:1}function tO(t,e){var n,i,r,s;return t.lastSpokeAt!==void 0||e.lastSpokeAt!==void 0?((i=(n=e.lastSpokeAt)==null?void 0:n.getTime())!=null?i:0)-((s=(r=t.lastSpokeAt)==null?void 0:r.getTime())!=null?s:0):0}function ap(t,e){var n,i,r,s;return((i=(n=t.joinedAt)==null?void 0:n.getTime())!=null?i:0)-((s=(r=e.joinedAt)==null?void 0:r.getTime())!=null?s:0)}function nO(t,e){return pt(t)?pt(e)?0:-1:pt(e)?1:0}function iO(t,e){const n=t.participant.isCameraEnabled,i=e.participant.isCameraEnabled;return n!==i?n?-1:1:0}function rO(t){const e=[],n=[],i=[],r=[];t.forEach(o=>{o.participant.isLocal&&o.source===$.Source.Camera?e.push(o):o.source===$.Source.ScreenShare?n.push(o):o.source===$.Source.Camera?i.push(o):r.push(o)});const s=sO(n),a=oO(i);return[...e,...s,...a,...r]}function sO(t){const e=[],n=[];return t.forEach(r=>{r.participant.isLocal?e.push(r):n.push(r)}),e.sort((r,s)=>ap(r.participant,s.participant)),n.sort((r,s)=>ap(r.participant,s.participant)),[...n,...e]}function oO(t){const e=[],n=[];return t.forEach(i=>{i.participant.isLocal?e.push(i):n.push(i)}),n.sort((i,r)=>i.participant.isSpeaking&&r.participant.isSpeaking?Z2(i.participant,r.participant):i.participant.isSpeaking!==r.participant.isSpeaking?eO(i.participant,r.participant):i.participant.lastSpokeAt!==r.participant.lastSpokeAt?tO(i.participant,r.participant):pt(i)!==pt(r)?nO(i,r):i.participant.isCameraEnabled!==r.participant.isCameraEnabled?iO(i,r):ap(i.participant,r.participant)),[...e,...n]}function aO(t,e){return t.reduce((n,i,r)=>r%e===0?[...n,[i]]:[...n.slice(0,-1),[...n.slice(-1)[0],i]],[])}function y0(t,e){const n=Math.max(t.length,e.length);return new Array(n).fill([]).map((i,r)=>[t[r],e[r]])}function Nu(t,e,n){return t.filter(i=>!e.map(r=>n(r)).includes(n(i)))}function lp(t){return t.map(e=>typeof e=="string"||typeof e=="number"?`${e}`:at(e))}function lO(t,e){return{dropped:Nu(t,e,at),added:Nu(e,t,at)}}function cO(t){return t.added.length!==0||t.dropped.length!==0}function cp(t,e){const n=e.findIndex(i=>at(i)===at(t));if(n===-1)throw new Error(`Element not part of the array: ${at(t)} not in ${lp(e)}`);return n}function uO(t,e,n){const i=cp(t,n),r=cp(e,n);return n.splice(i,1,e),n.splice(r,1,t),n}function dO(t,e){const n=cp(t,e);return e.splice(n,1),e}function hO(t,e){return[...e,t]}function Ch(t,e){return aO(t,e)}function fO(t,e,n){let i=pO(t,e);if(i.length<e.length){const a=Nu(e,i,at);i=[...i,...a]}const r=Ch(i,n),s=Ch(e,n);if(y0(r,s).forEach(([a,o],l)=>{if(a&&o){const c=Ch(i,n)[l],d=lO(c,o);cO(d)&&(ge.debug(`Detected visual changes on page: ${l}, current: ${lp(a)}, next: ${lp(o)}`,{changes:d}),d.added.length===d.dropped.length&&y0(d.added,d.dropped).forEach(([u,m])=>{if(u&&m)i=uO(u,m,i);else throw new Error(`For a swap action we need a addition and a removal one is missing: ${u}, ${m}`)}),d.added.length===0&&d.dropped.length>0&&d.dropped.forEach(u=>{i=dO(u,i)}),d.added.length>0&&d.dropped.length===0&&d.added.forEach(u=>{i=hO(u,i)}))}}),i.length>e.length){const a=Nu(i,e,at);i=i.filter(o=>!a.map(at).includes(at(o)))}return i}function pO(t,e){return t.map(n=>{const i=e.find(r=>at(n)===at(r)||typeof n!="number"&&Il(n)&&pt(r)&&$2(n,r));return i??n})}function Fm(t,...e){return new gt(i=>{const r=()=>{i.next(t)};return e.forEach(a=>{t.on(a,r)}),()=>{e.forEach(a=>{t.off(a,r)})}}).pipe(En(t))}function md(t,e){return new gt(i=>{const r=(...a)=>{i.next(a)};return t.on(e,r),()=>{t.off(e,r)}})}function mO(t){return md(t,J.ConnectionStateChanged).pipe(rt(([e])=>e),En(t.state))}function gO(t,e,n=!0){var i;const r=()=>Pi(this,null,function*(){try{const o=yield Ru.getLocalDevices(t,n);s.next(o)}catch(o){e==null||e(o)}}),s=new hs,a=s.pipe(M2(()=>{var o;(o=navigator==null?void 0:navigator.mediaDevices)==null||o.removeEventListener("devicechange",r)}));if(typeof window<"u"){if(!window.isSecureContext)throw new Error("Accessing media devices is available only in secure contexts (HTTPS and localhost), in some or all supporting browsers. See: https://developer.mozilla.org/en-US/docs/Web/API/Navigator/mediaDevices");(i=navigator==null?void 0:navigator.mediaDevices)==null||i.addEventListener("devicechange",r)}return Du(Ru.getLocalDevices(t,n).catch(o=>e==null?void 0:e(o)),a)}function vO(t){return md(t,J.DataReceived)}function _O(t){return Fm(t,J.AudioPlaybackStatusChanged).pipe(rt(n=>({canPlayAudio:n.canPlaybackAudio})))}function yO(t){return Fm(t,J.VideoPlaybackStatusChanged).pipe(rt(n=>({canPlayVideo:n.canPlaybackVideo})))}function SO(t,e){return md(t,J.ActiveDeviceChanged).pipe(Bm(([n])=>n===e),rt(([n,i])=>(ge.debug("activeDeviceObservable | RoomEvent.ActiveDeviceChanged",{kind:n,deviceId:i}),i)),En(t.getActiveDevice(e)))}function CO(t,e){return md(t,J.ParticipantEncryptionStatusChanged).pipe(Bm(([,n])=>e.identity===(n==null?void 0:n.identity)||!n&&e.identity===t.localParticipant.identity),rt(([n])=>n),En(e instanceof Pl?e.isE2EEEnabled:e.isEncrypted))}function Kt(t){return`${Qb}-${t}`}function bO(t){const e=up(t),n=zm(t.participant).pipe(rt(()=>up(t)),En(e));return{className:Kt(t.source===$.Source.Camera||t.source===$.Source.ScreenShare?"participant-media-video":"participant-media-audio"),trackObserver:n}}function up(t){if(pt(t))return t.publication;{const{source:e,name:n,participant:i}=t;if(e&&n)return i.getTracks().find(r=>r.source===e&&r.trackName===n);if(n)return i.getTrackByName(n);if(e)return i.getTrack(e);throw new Error("At least one of source and name needs to be defined")}}function Um(t,...e){return new gt(i=>{const r=()=>{i.next(t)};return e.forEach(a=>{t.on(a,r)}),()=>{e.forEach(a=>{t.off(a,r)})}}).pipe(En(t))}function zm(t){return Um(t,Z.TrackMuted,Z.TrackUnmuted,Z.ParticipantPermissionsChanged,Z.TrackPublished,Z.TrackUnpublished,Z.LocalTrackPublished,Z.LocalTrackUnpublished,Z.MediaDevicesError,Z.TrackSubscriptionStatusChanged).pipe(rt(n=>{const{isMicrophoneEnabled:i,isCameraEnabled:r,isScreenShareEnabled:s}=n,a=n.getTrack($.Source.Microphone),o=n.getTrack($.Source.Camera);return{isCameraEnabled:r,isMicrophoneEnabled:i,isScreenShareEnabled:s,cameraTrack:o,microphoneTrack:a,participant:n}}))}function wO(t){return Um(t,Z.ParticipantMetadataChanged).pipe(rt(({name:n,identity:i,metadata:r})=>({name:n,identity:i,metadata:r})),En({name:t.name,identity:t.identity,metadata:t.metadata}))}function kO(t){return Hm(t,Z.ConnectionQualityChanged).pipe(rt(([n])=>n),En(t.connectionQuality))}function Hm(t,e){return new gt(i=>{const r=(...a)=>{i.next(a)};return t.on(e,r),()=>{t.off(e,r)}})}function iw(t){var e,n,i,r;return Um(t.participant,Z.TrackMuted,Z.TrackUnmuted,Z.TrackSubscribed,Z.TrackUnsubscribed,Z.LocalTrackPublished,Z.LocalTrackUnpublished).pipe(rt(s=>{var a,o;const l=(a=t.publication)!=null?a:s.getTrack(t.source);return(o=l==null?void 0:l.isMuted)!=null?o:!0}),En((r=(i=(e=t.publication)==null?void 0:e.isMuted)!=null?i:(n=t.participant.getTrack(t.source))==null?void 0:n.isMuted)!=null?r:!0))}function EO(t){return Hm(t,Z.IsSpeakingChanged).pipe(rt(([e])=>e))}function TO(t){return Hm(t,Z.ParticipantPermissionsChanged).pipe(rt(()=>t.permissions),En(t.permissions))}function RO(t,e,n){const{localParticipant:i}=e,r=(c,d)=>{let u=!1;switch(c){case $.Source.Camera:u=d.isCameraEnabled;break;case $.Source.Microphone:u=d.isMicrophoneEnabled;break;case $.Source.ScreenShare:u=d.isScreenShareEnabled;break}return u},s=zm(i).pipe(rt(c=>r(t,c.participant)),En(r(t,i))),a=new hs,o=(c,d)=>Pi(this,null,function*(){try{switch(d??(d=n),a.next(!0),t){case $.Source.Camera:yield i.setCameraEnabled(c??!i.isCameraEnabled,d);break;case $.Source.Microphone:yield i.setMicrophoneEnabled(c??!i.isMicrophoneEnabled,d);break;case $.Source.ScreenShare:yield i.setScreenShareEnabled(c??!i.isScreenShareEnabled,d);break;default:break}}finally{a.next(!1)}});return{className:Kt("button"),toggle:o,enabledObserver:s,pendingObserver:a.asObservable()}}function xO(){let t=!1;const e=new hs,n=new hs,i=s=>Pi(this,null,function*(){n.next(!0),t=s??!t,e.next(t),n.next(!1)});return{className:Kt("button"),toggle:i,enabledObserver:e.asObservable(),pendingObserver:n.asObservable()}}function PO(t,e,n){const i=new Mb(void 0),r=e?SO(e,t):i.asObservable(),s=(o,...l)=>Pi(this,[o,...l],function*(c,d={}){var u,m,v;if(e){ge.debug(`Switching active device of kind "${t}" with id ${c}.`),yield e.switchActiveDevice(t,c,d.exact);const y=(u=e.getActiveDevice(t))!=null?u:c;y!==c&&c!=="default"&&ge.info(`We tried to select the device with id (${c}), but the browser decided to select the device with id (${y}) instead.`);let _;t==="audioinput"?_=(m=e.localParticipant.getTrack($.Source.Microphone))==null?void 0:m.track:t==="videoinput"&&(_=(v=e.localParticipant.getTrack($.Source.Camera))==null?void 0:v.track);const p=c==="default"&&!_||c==="default"&&(_==null?void 0:_.mediaStreamTrack.label.startsWith("Default"));i.next(p?c:y)}else if(n){yield n.setDeviceId(d.exact?{exact:c}:c);const y=yield n.getDeviceId();i.next(c==="default"&&n.mediaStreamTrack.label.startsWith("Default")?c:y)}else i.value!==c&&(ge.warn("device switch skipped, please provide either a room or a local track to switch on. "),i.next(c))});return{className:Kt("media-device-select"),activeDeviceObservable:r,setActiveMediaDevice:s}}function OO(t){const e=i=>{t.disconnect(i)};return{className:Kt("disconnect-button"),disconnect:e}}function IO(t){const e=Kt("connection-quality"),n=kO(t);return{className:e,connectionQualityObserver:n}}function LO(t){let e="track-muted-indicator-camera";switch(t.source){case $.Source.Camera:e="track-muted-indicator-camera";break;case $.Source.Microphone:e="track-muted-indicator-microphone";break}const n=Kt(e),i=iw(t);return{className:n,mediaMutedObserver:i}}function MO(t){return{className:"lk-participant-name",infoObserver:wO(t)}}function DO(){return{className:Kt("participant-tile")}}var AO={CHAT:"lk-chat-topic"};function rw(t,e,n){return Pi(this,arguments,function*(i,r,s,a={}){const{kind:o,destination:l}=a;yield i.publishData(r,o??Ze.RELIABLE,{destination:l,topic:s})})}function NO(t,e,n){const i=vO(t).pipe(Bm(([,,,o])=>e===void 0||o===e),rt(([o,l,,c])=>{const d={payload:o,topic:c,from:l};return n==null||n(d),d}));let r;const s=new gt(o=>{r=o});return{messageObservable:i,isSendingObservable:s,send:(o,...l)=>Pi(this,[o,...l],function*(c,d={}){r.next(!0);try{yield rw(t.localParticipant,c,e,d)}finally{r.next(!1)}})}}var BO=new TextEncoder,FO=new TextDecoder,yc=new Map,UO=t=>BO.encode(JSON.stringify({message:t.message,timestamp:t.timestamp})),zO=t=>JSON.parse(FO.decode(t));function HO(t,e){var n,i;const r=new hs,{messageDecoder:s,messageEncoder:a,channelTopic:o}=e??{},l=o??AO.CHAT;let c=!1;yc.has(t)||(c=!0);const d=(n=yc.get(t))!=null?n:new Map,u=(i=d.get(l))!=null?i:new hs;if(d.set(l,u),yc.set(t,d),c){const{messageObservable:h}=NO(t,l);h.pipe(g0(r)).subscribe(u)}const m=s??zO,v=u.pipe(rt(h=>{const g=m(h.payload);return U2(sp({},g),{from:h.from})}),D2((h,g)=>[...h,g],[]),g0(r)),y=new Mb(!1),_=a??UO,p=h=>Pi(this,null,function*(){const g=Date.now(),S=_({message:h,timestamp:g});y.next(!0);try{yield rw(t.localParticipant,S,l,{kind:Ze.RELIABLE}),u.next({payload:S,topic:l,from:t.localParticipant})}finally{y.next(!1)}});function f(){r.next(),r.complete(),yc.clear()}return t.once(J.Disconnected,f),{messageObservable:v,isSendingObservable:y,send:p}}function jO(){const t=n=>Pi(this,null,function*(){ge.info("Start Audio for room: ",n),yield n.startAudio()});return{className:Kt("start-audio-button"),roomAudioPlaybackAllowedObservable:_O,handleStartAudioPlayback:t}}function WO(){const t=n=>Pi(this,null,function*(){ge.info("Start Video for room: ",n),yield n.startVideo()});return{className:Kt("start-audio-button"),roomVideoPlaybackAllowedObservable:yO,handleStartVideoPlayback:t}}function $O(){return{className:[Kt("button"),Kt("chat-toggle")].join(" ")}}function VO(){return{className:[Kt("button"),Kt("focus-toggle-button")].join(" ")}}function GO(){return{className:"lk-room-container"}}function S0(t,e,n=!0){const r=[t.localParticipant,...Array.from(t.participants.values())],s=[];return r.forEach(a=>{e.forEach(o=>{const l=Array.from(a.tracks.values()).filter(c=>c.source===o&&(!n||c.track)).map(c=>({participant:a,publication:c,source:c.source}));s.push(...l)})}),{trackReferences:s,participants:r}}function qO(t,e,n){var i,r;const s=(i=n.additionalRoomEvents)!=null?i:Q2,a=(r=n.onlySubscribed)!=null?r:!0,o=Array.from(new Set([J.ParticipantConnected,J.ParticipantDisconnected,J.ConnectionStateChanged,J.LocalTrackPublished,J.LocalTrackUnpublished,J.TrackPublished,J.TrackUnpublished,J.TrackSubscriptionStatusChanged,...s]).values());return Fm(t,...o).pipe(rt(c=>{const d=S0(c,e,a);return ge.debug(`TrackReference[] was updated. (length ${d.trackReferences.length})`,d),d}),En(S0(t,e,a)))}function JO(t,e=1e3){if(t===null)return p0(!1);const n=rp(t,"mousemove",{passive:!0}).pipe(rt(()=>!0)),i=n.pipe(g2({each:e,with:()=>Du(p0(!1),i.pipe(A2(n)))}),I2());return i}function KO(t,e){if(typeof localStorage>"u"){ge.error("Local storage is not available.");return}try{localStorage.setItem(t,JSON.stringify(e))}catch(n){ge.error(`Error setting item to local storage: ${n}`)}}function QO(t){if(typeof localStorage>"u"){ge.error("Local storage is not available.");return}try{const e=localStorage.getItem(t);if(!e){ge.warn(`Item with key ${t} does not exist in local storage.`);return}return JSON.parse(e)}catch(e){ge.error(`Error getting item from local storage: ${e}`);return}}function XO(t){return{load:()=>QO(t),save:e=>KO(t,e)}}var YO=`${Qb}-user-choices`,ys={videoEnabled:!0,audioEnabled:!0,videoDeviceId:"",audioDeviceId:"",username:"",e2ee:!1,sharedPassphrase:""},{load:ZO,save:eI}=XO(YO);function tI(t,e=!1){if(e===!0)return;const n=t,i=z2(n,["e2ee","sharedPassphrase"]);eI(i)}function nI(t,e=!1){var n,i,r,s,a,o,l;const c={videoEnabled:(n=t==null?void 0:t.videoEnabled)!=null?n:ys.videoEnabled,audioEnabled:(i=t==null?void 0:t.audioEnabled)!=null?i:ys.audioEnabled,videoDeviceId:(r=t==null?void 0:t.videoDeviceId)!=null?r:ys.videoDeviceId,audioDeviceId:(s=t==null?void 0:t.audioDeviceId)!=null?s:ys.audioDeviceId,username:(a=t==null?void 0:t.username)!=null?a:ys.username,e2ee:(o=t==null?void 0:t.e2ee)!=null?o:ys.e2ee,sharedPassphrase:(l=t==null?void 0:t.sharedPassphrase)!=null?l:ys.sharedPassphrase};if(e)return c;{const d=ZO();return sp(sp({},c),d??{})}}function sw(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t)){var r=t.length;for(e=0;e<r;e++)t[e]&&(n=sw(t[e]))&&(i&&(i+=" "),i+=n)}else for(n in t)t[n]&&(i&&(i+=" "),i+=n);return i}function iI(){for(var t,e,n=0,i="",r=arguments.length;n<r;n++)(t=arguments[n])&&(e=sw(t))&&(i&&(i+=" "),i+=e);return i}globalThis&&globalThis.__awaiter;function rI(t,e){const[n,i]=T.useState(t);return T.useEffect(()=>{const r=setTimeout(()=>i(t),e||500);return()=>{clearTimeout(r)}},[t,e]),n}globalThis&&globalThis.__awaiter;function sI(t,{threshold:e=0,root:n=null,rootMargin:i="0%",freezeOnceVisible:r=!1}){const[s,a]=T.useState(),o=(s==null?void 0:s.isIntersecting)&&r,l=([c])=>{a(c)};return T.useEffect(()=>{const c=t==null?void 0:t.current;if(!!!window.IntersectionObserver||o||!c)return;const u={threshold:e,root:n,rootMargin:i},m=new IntersectionObserver(l,u);return m.observe(c),()=>m.disconnect()},[t==null?void 0:t.current,JSON.stringify(e),n,i,o]),s}var oI=Object.defineProperty,aI=Object.defineProperties,lI=Object.getOwnPropertyDescriptors,Bu=Object.getOwnPropertySymbols,ow=Object.prototype.hasOwnProperty,aw=Object.prototype.propertyIsEnumerable,C0=(t,e,n)=>e in t?oI(t,e,{enumerable:!0,configurable:!0,writable:!0,value:n}):t[e]=n,le=(t,e)=>{for(var n in e||(e={}))ow.call(e,n)&&C0(t,n,e[n]);if(Bu)for(var n of Bu(e))aw.call(e,n)&&C0(t,n,e[n]);return t},kt=(t,e)=>aI(t,lI(e)),qe=(t,e)=>{var n={};for(var i in t)ow.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&Bu)for(var i of Bu(t))e.indexOf(i)<0&&aw.call(t,i)&&(n[i]=t[i]);return n},lw=(t,e,n)=>new Promise((i,r)=>{var s=l=>{try{o(n.next(l))}catch(c){r(c)}},a=l=>{try{o(n.throw(l))}catch(c){r(c)}},o=l=>l.done?i(l.value):Promise.resolve(l.value).then(s,a);o((n=n.apply(t,e)).next())});function cI(t,e){const n=dI(),i=wT(e);return T.useLayoutEffect(()=>{let r=!1;const s=t.current;if(!s)return;function a(o,l){r||i.current(o,l)}return n==null||n.subscribe(s,a),()=>{r=!0,n==null||n.unsubscribe(s,a)}},[t.current,n,i]),n==null?void 0:n.observer}function uI(){let t=!1,e=[];const n=new Map;if(typeof window>"u")return;const i=new ResizeObserver((r,s)=>{e=e.concat(r),t||window.requestAnimationFrame(()=>{const a=new Set;for(let o=0;o<e.length;o++){if(a.has(e[o].target))continue;a.add(e[o].target);const l=n.get(e[o].target);l==null||l.forEach(c=>c(e[o],s))}e=[],t=!1}),t=!0});return{observer:i,subscribe(r,s){var a;i.observe(r);const o=(a=n.get(r))!=null?a:[];o.push(s),n.set(r,o)},unsubscribe(r,s){var a;const o=(a=n.get(r))!=null?a:[];if(o.length===1){i.unobserve(r),n.delete(r);return}const l=o.indexOf(s);l!==-1&&o.splice(l,1),n.set(r,o)}}}var bh,dI=()=>bh||(bh=uI()),cw=t=>{const[e,n]=T.useState({width:0,height:0});T.useLayoutEffect(()=>{if(t.current){const{width:r,height:s}=t.current.getBoundingClientRect();n({width:r,height:s})}},[t.current]);const i=T.useCallback(r=>n(r.contentRect),[]);return cI(t,i),e};function Qt(t,e){const[n,i]=T.useState(e);return T.useEffect(()=>{if(typeof window>"u"||!t)return;const r=t.subscribe(i);return()=>r.unsubscribe()},[t]),n}function hI(t){const e=s=>typeof window<"u"?window.matchMedia(s).matches:!1,[n,i]=T.useState(e(t));function r(){i(e(t))}return T.useEffect(()=>{const s=window.matchMedia(t);return r(),s.addListener?s.addListener(r):s.addEventListener("change",r),()=>{s.removeListener?s.removeListener(r):s.removeEventListener("change",r)}},[t]),n}function uw(t,e){if(e.msg==="show_chat")return kt(le({},t),{showChat:!0,unreadMessages:0});if(e.msg==="hide_chat")return kt(le({},t),{showChat:!1});if(e.msg==="toggle_chat"){const n=kt(le({},t),{showChat:!t.showChat});return n.showChat===!0&&(n.unreadMessages=0),n}else return e.msg==="unread_msg"?kt(le({},t),{unreadMessages:e.count}):le({},t)}function dw(t,e){return e.msg==="set_pin"?[e.trackReference]:e.msg==="clear_pin"?[]:le({},t)}var gd=T.createContext(void 0);function fI(){const t=T.useContext(gd);if(!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function pI(t){const e=Vl();if(t??(t=e),!t)throw Error("Tried to access LayoutContext context outside a LayoutContextProvider provider.");return t}function mI(){const[t,e]=T.useReducer(dw,Zb),[n,i]=T.useReducer(uw,ew);return{pin:{dispatch:e,state:t},widget:{dispatch:i,state:n}}}function gI(t){const[e,n]=T.useReducer(dw,Zb),[i,r]=T.useReducer(uw,ew);return t??{pin:{dispatch:n,state:e},widget:{dispatch:r,state:i}}}function Vl(){return T.useContext(gd)}var jm=T.createContext(void 0);function vs(){return T.useContext(jm)}var hw=T.createContext(void 0);function Wm(){return T.useContext(hw)}function Oi(t){var e;const n=Wm(),i=vs(),r=(e=t??n)!=null?e:i==null?void 0:i.participant;if(!r)throw new Error("No participant provided, make sure you are inside a participant context or pass the participant explicitly");return r}var $m=T.createContext(void 0);function vd(){const t=T.useContext($m);if(!t)throw Error("tried to access room context outside of livekit room component");return t}function _d(){return T.useContext($m)}function da(t){const e=_d(),n=t??e;if(!n)throw new Error("No room provided, make sure you are inside a Room context or pass the room explicitly");return n}var fw=T.createContext(void 0);function vI(t){const e=T.useContext(fw);if(t===!0){if(e)return e;throw Error("tried to access feature context, but none is present")}return e}function _I(...t){return(...e)=>{for(const n of t)typeof n=="function"&&n(...e)}}function wr(...t){const e=le({},t[0]);for(let n=1;n<t.length;n++){const i=t[n];for(const r in i){const s=e[r],a=i[r];typeof s=="function"&&typeof a=="function"&&r[0]==="o"&&r[1]==="n"&&r.charCodeAt(2)>=65&&r.charCodeAt(2)<=90?e[r]=_I(s,a):(r==="className"||r==="UNSAFE_className")&&typeof s=="string"&&typeof a=="string"?e[r]=iI(s,a):e[r]=a!==void 0?a:s}}return e}function yI(t={}){const e=Oi(t.participant),{className:n,connectionQualityObserver:i}=T.useMemo(()=>IO(e),[e]),r=Qt(i,mn.Unknown);return{className:n,quality:r}}function pw(t){const e=da(t),n=T.useMemo(()=>mO(e),[e]);return Qt(n,e.state)}function SI(t){const e=vd(),n=pw(e);return{buttonProps:T.useMemo(()=>{const{className:r,disconnect:s}=OO(e);return wr(t,{className:r,onClick:()=>{var o;return s((o=t.stopTracks)!=null?o:!0)},disabled:n===ye.Disconnected})},[e,t,n])}}function CI(t){if(t.publication instanceof Tl){const e=t.publication.track;if(e){const{facingMode:n}=Qx(e);return n}}return"undefined"}function bI({trackRef:t,trackSource:e,participant:n,props:i}){const r=Oi(n);if(!t&&!e)throw new Error("trackRef or trackSource must be defined.");const s=Vl(),{className:a}=T.useMemo(()=>VO(),[]),o=T.useMemo(()=>{if(t)return op(t,s==null?void 0:s.pin.state);if(e){const c=r.getTrack(e);return s!=null&&s.pin.state&&c?op({participant:r,source:e,publication:c},s.pin.state):!1}else throw new Error("trackRef or trackSource and participant must be defined.")},[t,s==null?void 0:s.pin.state,r,e]);return{mergedProps:T.useMemo(()=>wr(i,{className:a,onClick:c=>{var d,u,m,v,y;if((d=i.onClick)==null||d.call(i,c),t)o?(m=s==null?void 0:(u=s.pin).dispatch)==null||m.call(u,{msg:"clear_pin"}):(y=s==null?void 0:(v=s.pin).dispatch)==null||y.call(v,{msg:"set_pin",trackReference:t});else if(e){const _=r.getTrack(e);s!=null&&s.pin.dispatch&&_&&(o?s.pin.dispatch({msg:"clear_pin"}):s.pin.dispatch({msg:"set_pin",trackReference:{participant:r,publication:_,source:_.source}}))}}}),[i,a,t,e,o,s==null?void 0:s.pin,r]),inFocus:o}}function wI(t,e){const{width:n,height:i}=cw(t),r=n>0&&i>0?Yb(_0,e,n,i):_0[0];return T.useEffect(()=>{t.current&&r&&(t.current.style.setProperty("--lk-col-count",r==null?void 0:r.columns.toString()),t.current.style.setProperty("--lk-row-count",r==null?void 0:r.rows.toString()))},[t,r]),{layout:r}}function b0(t,e={}){var n,i;const r=typeof t=="string"?e.participant:t.participant,s=Oi(r),a=typeof t=="string"?{participant:s,source:t}:t,[o,l]=T.useState(!!((n=a.publication)!=null&&n.isMuted||(i=s.getTrack(a.source))!=null&&i.isMuted));return T.useEffect(()=>{const c=iw(a).subscribe(l);return()=>c.unsubscribe()},[at(a)]),o}function kI(t){const e=Oi(t),n=T.useMemo(()=>EO(e),[e]);return Qt(n,e.isSpeaking)}var EI={connect:!0,audio:!1,video:!1};function TI(t){const e=le(le({},EI),t),{token:n,serverUrl:i,options:r,room:s,connectOptions:a,connect:o,audio:l,video:c,screen:d,onConnected:u,onDisconnected:m,onError:v,onMediaDeviceFailure:y,onEncryptionError:_,simulateParticipants:p}=e,f=qe(e,["token","serverUrl","options","room","connectOptions","connect","audio","video","screen","onConnected","onDisconnected","onError","onMediaDeviceFailure","onEncryptionError","simulateParticipants"]);r&&s&&ge.warn("when using a manually created room, the options object will be ignored. set the desired options directly when creating the room instead.");const[h,g]=T.useState();T.useEffect(()=>{g(s??new Ru(r))},[s]);const S=T.useMemo(()=>{const{className:b}=GO();return wr(f,{className:b})},[f]);return T.useEffect(()=>{if(!h)return;const b=()=>{const C=h.localParticipant;ge.debug("trying to publish local tracks"),Promise.all([C.setMicrophoneEnabled(!!l,typeof l!="boolean"?l:void 0),C.setCameraEnabled(!!c,typeof c!="boolean"?c:void 0),C.setScreenShareEnabled(!!d,typeof d!="boolean"?d:void 0)]).catch(E=>{ge.warn(E),v==null||v(E)})},w=C=>{const E=kl.getFailure(C);y==null||y(E)},k=C=>{_==null||_(C)};return h.on(J.SignalConnected,b).on(J.MediaDevicesError,w).on(J.EncryptionError,k),()=>{h.off(J.SignalConnected,b).off(J.MediaDevicesError,w).off(J.EncryptionError,k)}},[h,l,c,d,v,_,y]),T.useEffect(()=>{if(h){if(p){h.simulateParticipants({participants:{count:p},publish:{audio:!0,useRealTracks:!0}});return}if(!n){ge.debug("no token yet");return}if(!i){ge.warn("no livekit url provided"),v==null||v(Error("no livekit url provided"));return}o?(ge.debug("connecting"),h.connect(i,n,a).catch(b=>{ge.warn(b),v==null||v(b)})):(ge.debug("disconnecting because connect is false"),h.disconnect())}},[o,n,JSON.stringify(a),h,v,i,p]),T.useEffect(()=>{if(!h)return;const b=w=>{switch(w){case ye.Disconnected:m&&m();break;case ye.Connected:u&&u();break}};return h.on(J.ConnectionStateChanged,b),()=>{h.off(J.ConnectionStateChanged,b)}},[n,u,m,h]),T.useEffect(()=>{if(h)return()=>{ge.info("disconnecting on onmount"),h.disconnect()}},[h]),{room:h,htmlProps:S}}function RI(t={}){const e=da(t.room),[n,i]=T.useState(e.localParticipant),[r,s]=T.useState(n.isMicrophoneEnabled),[a,o]=T.useState(n.isMicrophoneEnabled),[l,c]=T.useState(n.lastMicrophoneError),[d,u]=T.useState(n.lastCameraError),[m,v]=T.useState(n.isMicrophoneEnabled),[y,_]=T.useState(void 0),[p,f]=T.useState(void 0),h=g=>{o(g.isCameraEnabled),s(g.isMicrophoneEnabled),v(g.isScreenShareEnabled),f(g.cameraTrack),_(g.microphoneTrack),c(g.participant.lastMicrophoneError),u(g.participant.lastCameraError),i(g.participant)};return T.useEffect(()=>{const g=zm(e.localParticipant).subscribe(h);return()=>g.unsubscribe()},[e]),{isMicrophoneEnabled:r,isScreenShareEnabled:m,isCameraEnabled:a,microphoneTrack:y,cameraTrack:p,lastMicrophoneError:l,lastCameraError:d,localParticipant:n}}function xI(){const t=vd(),e=T.useMemo(()=>TO(t.localParticipant),[t]);return Qt(e,t.localParticipant.permissions)}function PI({kind:t,room:e,track:n,requestPermissions:i,onError:r}){const s=_d(),a=T.useMemo(()=>gO(t,r,i),[t,i,r]),o=Qt(a,[]),[l,c]=T.useState(""),{className:d,activeDeviceObservable:u,setActiveMediaDevice:m}=T.useMemo(()=>PO(t,e??s,n),[t,e,s,n]);return T.useEffect(()=>{const v=u.subscribe(y=>{ge.info("setCurrentDeviceId",y),y&&c(y)});return()=>{v==null||v.unsubscribe()}},[u]),{devices:o,className:d,activeDeviceId:l,setActiveMediaDevice:m}}function OI(t){return t!==void 0}function kr(...t){return wr(...t.filter(OI))}function mw(t,e,n){return T.Children.map(t,i=>T.isValidElement(i)&&T.Children.only(t)?T.cloneElement(i,kt(le({},e),{key:n})):i)}function II(t){var e,n;if((((e=process==null?void 0:process.env)==null?void 0:e.NODE_ENV)==="dev"||((n=process==null?void 0:process.env)==null?void 0:n.NODE_ENV)==="development")&&typeof window<"u"){const i=t??document.querySelector(".lk-room-container");i&&!getComputedStyle(i).getPropertyValue("--lk-has-imported-styles")&&ge.warn("It looks like you're not using the `@livekit/components-styles package`. To render the UI with the default styling, please import it in your layout or page.")}}function gw(t,e={}){var n;const[i,r]=T.useState(up(t)),[s,a]=T.useState(i==null?void 0:i.isMuted),[o,l]=T.useState(i==null?void 0:i.isSubscribed),[c,d]=T.useState(i==null?void 0:i.track),[u,m]=T.useState("landscape"),v=T.useRef(),{className:y,trackObserver:_}=T.useMemo(()=>bO(t),[(n=t.participant.sid)!=null?n:t.participant.identity,t.source,pt(t)&&t.publication.trackSid]);return T.useEffect(()=>{const p=_.subscribe(f=>{ge.debug("update track",f),r(f),a(f==null?void 0:f.isMuted),l(f==null?void 0:f.isSubscribed),d(f==null?void 0:f.track)});return()=>p==null?void 0:p.unsubscribe()},[_]),T.useEffect(()=>{var p,f;return c&&(v.current&&c.detach(v.current),(p=e.element)!=null&&p.current&&!(Xb(t.participant)&&(c==null?void 0:c.kind)==="audio")&&c.attach(e.element.current)),v.current=(f=e.element)==null?void 0:f.current,()=>{v.current&&(c==null||c.detach(v.current))}},[c,e.element]),T.useEffect(()=>{var p,f;if(typeof((p=i==null?void 0:i.dimensions)==null?void 0:p.width)=="number"&&typeof((f=i==null?void 0:i.dimensions)==null?void 0:f.height)=="number"){const h=i.dimensions.width>i.dimensions.height?"landscape":"portrait";m(h)}},[i]),{publication:i,isMuted:s,isSubscribed:o,track:c,elementProps:kr(e.props,le({className:y,"data-lk-local-participant":t.participant.isLocal,"data-lk-source":i==null?void 0:i.source},(i==null?void 0:i.kind)==="video"&&{"data-lk-orientation":u}))}}function vw(t,e,n={}){const i=T.useRef([]),r=T.useRef(-1),s=e!==r.current,a=typeof n.customSortFunction=="function"?n.customSortFunction(t):rO(t);let o=[...a];if(s===!1)try{o=fO(i.current,a,e)}catch(l){ge.error("Error while running updatePages(): ",l)}return s?i.current=a:i.current=o,r.current=e,o}function LI(t,e){const[n,i]=T.useState(1),r=Math.max(Math.ceil(e.length/t),1);n>r&&i(r);const s=n*t,a=s-t,o=u=>{i(m=>u==="next"?m===r?m:m+1:m===1?m:m-1)},l=u=>{u>r?i(r):u<1?i(1):i(u)},d=vw(e,t).slice(a,s);return{totalPageCount:r,nextPage:()=>o("next"),prevPage:()=>o("previous"),setPage:l,firstItemIndex:a,lastItemIndex:s,tracks:d,currentPage:n}}function MI({trackRef:t,participant:e,source:n,publication:i,onParticipantClick:r,disableSpeakingIndicator:s,htmlProps:a}){const o=vs(),l=Oi(e),c=T.useMemo(()=>{var _,p,f,h,g,S;const b=(p=(_=t==null?void 0:t.source)!=null?_:o==null?void 0:o.source)!=null?p:n;if(b===void 0)throw new Error("Missing track `source`, provided it via `trackRef`, `source` property or via `TrackRefContext`.");return{participant:(h=(f=t==null?void 0:t.participant)!=null?f:o==null?void 0:o.participant)!=null?h:l,publication:(S=(g=t==null?void 0:t.publication)!=null?g:o==null?void 0:o.publication)!=null?S:i,source:b}},[t==null?void 0:t.participant,t==null?void 0:t.source,t==null?void 0:t.publication,o==null?void 0:o.participant,o==null?void 0:o.source,o==null?void 0:o.publication,l,n,i]),d=T.useMemo(()=>{const{className:_}=DO();return wr(a,{className:_,onClick:p=>{var f,h;if((f=a.onClick)==null||f.call(a,p),typeof r=="function"){const g=(h=c.publication)!=null?h:c.participant.getTrack(c.source);r({participant:c.participant,track:g})}}})},[a,r,c.publication,c.source,c.participant]),u=b0($.Source.Camera,{participant:c.participant}),m=b0($.Source.Microphone,{participant:c.participant}),v=kI(c.participant),y=CI(c);return{elementProps:le({"data-lk-audio-muted":m,"data-lk-video-muted":u,"data-lk-speaking":s===!0?!1:v,"data-lk-local-participant":c.participant.isLocal,"data-lk-source":c.source,"data-lk-facing-mode":y},d)}}function DI(t){return t=pI(t),T.useMemo(()=>(t==null?void 0:t.pin.state)!==void 0&&t.pin.state.length>=1?t.pin.state:[],[t.pin.state])}function AI({room:t,props:e}){const n=da(t),{className:i,roomAudioPlaybackAllowedObservable:r,handleStartAudioPlayback:s}=T.useMemo(()=>jO(),[]),a=T.useMemo(()=>r(n),[n,r]),{canPlayAudio:o}=Qt(a,{canPlayAudio:n.canPlaybackAudio});return{mergedProps:T.useMemo(()=>wr(e,{className:i,onClick:()=>{s(n)},style:{display:o?"none":"block"}}),[e,i,o,s,n]),canPlayAudio:o}}function NI({room:t,props:e}){const n=da(t),{className:i,roomVideoPlaybackAllowedObservable:r,handleStartVideoPlayback:s}=T.useMemo(()=>WO(),[]),a=T.useMemo(()=>r(n),[n,r]),{canPlayVideo:o}=Qt(a,{canPlayVideo:n.canPlaybackVideo});return{mergedProps:T.useMemo(()=>wr(e,{className:i,onClick:()=>{s(n)},style:{display:o?"none":"block"}}),[e,i,o,s,n]),canPlayVideo:o}}function BI(t,e={}){var n;const i=T.useRef(null),r=T.useRef(null),s=(n=e.minSwipeDistance)!=null?n:50,a=c=>{r.current=null,i.current=c.targetTouches[0].clientX},o=c=>{r.current=c.targetTouches[0].clientX},l=T.useCallback(()=>{if(!i.current||!r.current)return;const c=i.current-r.current,d=c>s,u=c<-s;d&&e.onLeftSwipe&&e.onLeftSwipe(),u&&e.onRightSwipe&&e.onRightSwipe()},[s,e]);T.useEffect(()=>{const c=t.current;return c&&(c.addEventListener("touchstart",a,{passive:!0}),c.addEventListener("touchmove",o,{passive:!0}),c.addEventListener("touchend",l,{passive:!0})),()=>{c&&(c.removeEventListener("touchstart",a),c.removeEventListener("touchmove",o),c.removeEventListener("touchend",l))}},[t,l])}function FI({props:t}){const{dispatch:e,state:n}=fI().widget,{className:i}=T.useMemo(()=>$O(),[]);return{mergedProps:T.useMemo(()=>wr(t,{className:i,onClick:()=>{e&&e({msg:"toggle_chat"})},"aria-pressed":n!=null&&n.showChat?"true":"false","data-lk-unread-msgs":n?n.unreadMessages<10?n.unreadMessages.toFixed(0):"9+":"0"}),[t,i,e,n])}}function UI(t,e={}){var n,i,r,s;let a=vs();const o=(i=(n=Wm())!=null?n:e.participant)!=null?i:a==null?void 0:a.participant;if(typeof t=="string"){if(!o)throw Error("Participant missing, either provide it via context or pass it in directly");a={participant:o,source:t}}else if(t)a=t;else throw Error("No track reference found, either provide it via context or pass it in directly");const{className:l,mediaMutedObserver:c}=T.useMemo(()=>LO(a),[at(a)]);return{isMuted:Qt(c,!!((r=a.publication)!=null&&r.isMuted||(s=a.participant.getTrack(a.source))!=null&&s.isMuted)),className:l}}function zI(t){var e=t,{source:n,onChange:i,initialState:r,captureOptions:s}=e,a=qe(e,["source","onChange","initialState","captureOptions"]),o;const l=_d(),c=(o=l==null?void 0:l.localParticipant)==null?void 0:o.getTrack(n),d=T.useRef(!1),{toggle:u,className:m,pendingObserver:v,enabledObserver:y}=T.useMemo(()=>l?RO(n,l,s):xO(),[l,n,JSON.stringify(s)]),_=Qt(v,!1),p=Qt(y,r??!!(c!=null&&c.isEnabled));T.useEffect(()=>{i==null||i(p,d.current),d.current=!1},[p,i]),T.useEffect(()=>{r!==void 0&&(ge.debug("forcing initial toggle state",n,r),u(r))},[]);const f=T.useMemo(()=>wr(a,{className:m}),[a,m]),h=T.useCallback(g=>{var S;d.current=!0,u().finally(()=>d.current=!1),(S=a.onClick)==null||S.call(a,g)},[a,u]);return{toggle:u,enabled:p,pending:_,track:c,buttonProps:kt(le({},f),{"aria-pressed":p,"data-lk-source":n,"data-lk-enabled":p,disabled:_,onClick:h})}}function _w(t=[$.Source.Camera,$.Source.Microphone,$.Source.ScreenShare,$.Source.ScreenShareAudio,$.Source.Unknown],e={}){const n=da(e.room),[i,r]=T.useState([]),[s,a]=T.useState([]),o=T.useMemo(()=>t.map(c=>tw(c)?c.source:c),[JSON.stringify(t)]);return T.useEffect(()=>{const c=qO(n,o,{additionalRoomEvents:e.updateOnlyOn,onlySubscribed:e.onlySubscribed}).subscribe(({trackReferences:d,participants:u})=>{ge.debug("setting track bundles",d,u),r(d),a(u)});return()=>c.unsubscribe()},[n,JSON.stringify(e.updateOnlyOn),JSON.stringify(t)]),T.useMemo(()=>{if(nw(t)){const c=jI(t,s),d=Array.from(i);return s.forEach(u=>{var m;c.has(u.identity)&&((m=c.get(u.identity))!=null?m:[]).forEach(y=>{if(i.find(({participant:p,publication:f})=>u.identity===p.identity&&f.source===y))return;ge.debug(`Add ${y} placeholder for participant ${u.identity}.`);const _={participant:u,source:y};d.push(_)})}),d}else return i},[i,s,t])}function HI(t,e){const n=new Set(t);for(const i of e)n.delete(i);return n}function jI(t,e){const n=new Map;if(nw(t)){const i=t.filter(r=>r.withPlaceholder).map(r=>r.source);e.forEach(r=>{const s=r.getTracks().map(o=>{var l;return(l=o.track)==null?void 0:l.source}).filter(o=>o!==void 0),a=Array.from(HI(new Set(i),new Set(s)));a.length>0&&n.set(r.identity,a)})}return n}function WI(t){const e=vd(),[n,i]=T.useState(),r=Qt(n==null?void 0:n.isSendingObservable,!1),s=Qt(n==null?void 0:n.messageObservable,[]);return T.useEffect(()=>{const a=HO(e,t);i(a)},[e,t]),{send:n==null?void 0:n.send,update:n==null?void 0:n.update,chatMessages:s,isSending:r}}function $I(t={}){var e;const[n,i]=T.useState(nI(t.defaults,(e=t.preventLoad)!=null?e:!1)),r=T.useCallback(c=>{i(d=>kt(le({},d),{audioEnabled:c}))},[]),s=T.useCallback(c=>{i(d=>kt(le({},d),{videoEnabled:c}))},[]),a=T.useCallback(c=>{i(d=>kt(le({},d),{audioDeviceId:c}))},[]),o=T.useCallback(c=>{i(d=>kt(le({},d),{videoDeviceId:c}))},[]),l=T.useCallback(c=>{i(d=>kt(le({},d),{username:c}))},[]);return T.useEffect(()=>{var c;tI(n,(c=t.preventSave)!=null?c:!1)},[n,t.preventSave]),{userChoices:n,saveAudioInputEnabled:r,saveVideoInputEnabled:s,saveAudioInputDeviceId:a,saveVideoInputDeviceId:o,saveUsername:l}}function VI(t){const e=Oi(t),n=da(),i=T.useMemo(()=>CO(n,e),[n,e]);return Qt(i,e instanceof Pl?e.isE2EEEnabled:e.isEncrypted)}function yw(t){const{mergedProps:e}=FI({props:t});return T.createElement("button",le({},e),t.children)}function GI(t){const{buttonProps:e}=SI(t);return T.createElement("button",le({},e),t.children)}var qI=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),T.createElement("path",{d:"M1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708L11 10.293V4.5A1.5 1.5 0 0 0 9.5 3H3.707zM0 4.5a1.5 1.5 0 0 1 .943-1.393l9.532 9.533c-.262.224-.603.36-.975.36h-8A1.5 1.5 0 0 1 0 11.5z"}),T.createElement("path",{d:"m15.2 3.6-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),JI=qI,KI=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),T.createElement("path",{d:"M0 4.5A1.5 1.5 0 0 1 1.5 3h8A1.5 1.5 0 0 1 11 4.5v7A1.5 1.5 0 0 1 9.5 13h-8A1.5 1.5 0 0 1 0 11.5zM15.2 3.6l-2.8 2.1a1 1 0 0 0-.4.8v3a1 1 0 0 0 .4.8l2.8 2.1a.5.5 0 0 0 .8-.4V4a.5.5 0 0 0-.8-.4z"})),QI=KI,XI=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,viewBox:"0 0 24 24"},t),T.createElement("path",{fill:"#FFF",d:"M4.99 3.99a1 1 0 0 0-.697 1.717L10.586 12l-6.293 6.293a1 1 0 1 0 1.414 1.414L12 13.414l6.293 6.293a1 1 0 1 0 1.414-1.414L13.414 12l6.293-6.293a1 1 0 0 0-.727-1.717 1 1 0 0 0-.687.303L12 10.586 5.707 4.293a1 1 0 0 0-.717-.303z"})),YI=XI,ZI=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:18,fill:"none"},t),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h10.5A2.75 2.75 0 0 1 16 2.75v13.594a.75.75 0 0 1-1.234.572l-3.691-3.12a1.25 1.25 0 0 0-.807-.296H2.75A2.75 2.75 0 0 1 0 10.75v-8ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v8c0 .69.56 1.25 1.25 1.25h7.518c.65 0 1.279.23 1.775.65l2.457 2.077V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M3 4.5a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h9a.5.5 0 0 1 0 1h-9a.5.5 0 0 1-.5-.5Zm0 2a.5.5 0 0 1 .5-.5h5a.5.5 0 0 1 0 1h-5a.5.5 0 0 1-.5-.5Z",clipRule:"evenodd"})),eL=ZI,tL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),T.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M5.293 2.293a1 1 0 0 1 1.414 0l4.823 4.823a1.25 1.25 0 0 1 0 1.768l-4.823 4.823a1 1 0 0 1-1.414-1.414L9.586 8 5.293 3.707a1 1 0 0 1 0-1.414z",clipRule:"evenodd"})),w0=tL,nL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),T.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},T.createElement("path",{d:"M10 1.75h4.25m0 0V6m0-4.25L9 7M6 14.25H1.75m0 0V10m0 4.25L7 9"}))),iL=nL,rL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M2 2.75A2.75 2.75 0 0 1 4.75 0h6.5A2.75 2.75 0 0 1 14 2.75v10.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-.5a.75.75 0 0 1 1.5 0v.5c0 .69.56 1.25 1.25 1.25h6.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25h-6.5c-.69 0-1.25.56-1.25 1.25v.5a.75.75 0 0 1-1.5 0v-.5Z",clipRule:"evenodd"}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8.78 7.47a.75.75 0 0 1 0 1.06l-2.25 2.25a.75.75 0 1 1-1.06-1.06l.97-.97H1.75a.75.75 0 0 1 0-1.5h4.69l-.97-.97a.75.75 0 0 1 1.06-1.06l2.25 2.25Z",clipRule:"evenodd"})),sL=rL,oL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),T.createElement("path",{fill:"currentcolor",fillRule:"evenodd",d:"M4 6.104V4a4 4 0 1 1 8 0v2.104c1.154.326 2 1.387 2 2.646v4.5A2.75 2.75 0 0 1 11.25 16h-6.5A2.75 2.75 0 0 1 2 13.25v-4.5c0-1.259.846-2.32 2-2.646ZM5.5 4a2.5 2.5 0 0 1 5 0v2h-5V4Z",clipRule:"evenodd"})),aL=oL,lL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),T.createElement("path",{d:"M12.227 11.52a5.477 5.477 0 0 0 1.246-2.97.5.5 0 0 0-.995-.1 4.478 4.478 0 0 1-.962 2.359l-1.07-1.07C10.794 9.247 11 8.647 11 8V3a3 3 0 0 0-6 0v1.293L1.354.646a.5.5 0 1 0-.708.708l14 14a.5.5 0 0 0 .708-.708zM8 12.5c.683 0 1.33-.152 1.911-.425l.743.743c-.649.359-1.378.59-2.154.66V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .995-.098A4.5 4.5 0 0 0 8 12.5z"}),T.createElement("path",{d:"M8.743 10.907 5 7.164V8a3 3 0 0 0 3.743 2.907z"})),cL=lL,uL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),T.createElement("path",{fillRule:"evenodd",d:"M2.975 8.002a.5.5 0 0 1 .547.449 4.5 4.5 0 0 0 8.956 0 .5.5 0 1 1 .995.098A5.502 5.502 0 0 1 8.5 13.478V15h2a.5.5 0 0 1 0 1h-5a.5.5 0 0 1 0-1h2v-1.522a5.502 5.502 0 0 1-4.973-4.929.5.5 0 0 1 .448-.547z",clipRule:"evenodd"}),T.createElement("path",{d:"M5 3a3 3 0 1 1 6 0v5a3 3 0 0 1-6 0z"})),dL=uL,hL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),T.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),T.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"})),fL=hL,pL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),T.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),T.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),T.createElement("g",{opacity:.25},T.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),T.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),mL=pL,gL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentcolor"},t),T.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),T.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),T.createElement("g",{opacity:.25},T.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),T.createElement("path",{d:"M6 6.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}),T.createElement("path",{d:"M12 .5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5z"}))),vL=gL,_L=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"currentColor"},t),T.createElement("g",{opacity:.25},T.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}),T.createElement("path",{d:"M0 11.5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v4a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-4Zm6-5a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v9a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5v-9Zm6-6a.5.5 0 0 1 .5-.5h3a.5.5 0 0 1 .5.5v15a.5.5 0 0 1-.5.5h-3a.5.5 0 0 1-.5-.5V.5Z"}))),yL=_L,SL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M0 2.75A2.75 2.75 0 0 1 2.75 0h14.5A2.75 2.75 0 0 1 20 2.75v10.5A2.75 2.75 0 0 1 17.25 16H2.75A2.75 2.75 0 0 1 0 13.25V2.75ZM2.75 1.5c-.69 0-1.25.56-1.25 1.25v10.5c0 .69.56 1.25 1.25 1.25h14.5c.69 0 1.25-.56 1.25-1.25V2.75c0-.69-.56-1.25-1.25-1.25H2.75Z",clipRule:"evenodd"}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M9.47 4.22a.75.75 0 0 1 1.06 0l2.25 2.25a.75.75 0 0 1-1.06 1.06l-.97-.97v4.69a.75.75 0 0 1-1.5 0V6.56l-.97.97a.75.75 0 0 1-1.06-1.06l2.25-2.25Z",clipRule:"evenodd"})),Sw=SL,CL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:20,height:16,fill:"none"},t),T.createElement("g",{fill:"currentColor"},T.createElement("path",{d:"M7.28 4.22a.75.75 0 0 0-1.06 1.06L8.94 8l-2.72 2.72a.75.75 0 1 0 1.06 1.06L10 9.06l2.72 2.72a.75.75 0 1 0 1.06-1.06L11.06 8l2.72-2.72a.75.75 0 0 0-1.06-1.06L10 6.94z"}),T.createElement("path",{fillRule:"evenodd",d:"M2.75 0A2.75 2.75 0 0 0 0 2.75v10.5A2.75 2.75 0 0 0 2.75 16h14.5A2.75 2.75 0 0 0 20 13.25V2.75A2.75 2.75 0 0 0 17.25 0zM1.5 2.75c0-.69.56-1.25 1.25-1.25h14.5c.69 0 1.25.56 1.25 1.25v10.5c0 .69-.56 1.25-1.25 1.25H2.75c-.69 0-1.25-.56-1.25-1.25z",clipRule:"evenodd"}))),bL=CL,wL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 0a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0V.75A.75.75 0 0 1 8 0Z",clipRule:"evenodd"}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M8 12a.75.75 0 0 1 .75.75v2.5a.75.75 0 0 1-1.5 0v-2.5A.75.75 0 0 1 8 12Z",clipRule:"evenodd",opacity:.7}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 1.072a.75.75 0 0 1 .274 1.024l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 12 1.072Z",clipRule:"evenodd"}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 11.464a.75.75 0 0 1 .274 1.025l-1.25 2.165a.75.75 0 0 1-1.299-.75l1.25-2.165A.75.75 0 0 1 6 11.464Z",clipRule:"evenodd",opacity:.6}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 4a.75.75 0 0 1-.274 1.025l-2.165 1.25a.75.75 0 1 1-.75-1.3l2.165-1.25A.75.75 0 0 1 14.928 4Z",clipRule:"evenodd"}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 10a.75.75 0 0 1-.275 1.024l-2.165 1.25a.75.75 0 0 1-.75-1.298l2.165-1.25A.75.75 0 0 1 4.536 10Z",clipRule:"evenodd",opacity:.5}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M16 8a.75.75 0 0 1-.75.75h-2.5a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 16 8Z",clipRule:"evenodd"}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4 8a.75.75 0 0 1-.75.75H.75a.75.75 0 0 1 0-1.5h2.5A.75.75 0 0 1 4 8Z",clipRule:"evenodd",opacity:.4}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M14.928 12a.75.75 0 0 1-1.024.274l-2.165-1.25a.75.75 0 0 1 .75-1.299l2.165 1.25A.75.75 0 0 1 14.928 12Z",clipRule:"evenodd",opacity:.9}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M4.536 6a.75.75 0 0 1-1.025.275l-2.165-1.25a.75.75 0 1 1 .75-1.3l2.165 1.25A.75.75 0 0 1 4.536 6Z",clipRule:"evenodd",opacity:.3}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M12 14.928a.75.75 0 0 1-1.024-.274l-1.25-2.165a.75.75 0 0 1 1.298-.75l1.25 2.165A.75.75 0 0 1 12 14.928Z",clipRule:"evenodd",opacity:.8}),T.createElement("path",{fill:"currentColor",fillRule:"evenodd",d:"M6 4.536a.75.75 0 0 1-1.024-.275l-1.25-2.165a.75.75 0 1 1 1.299-.75l1.25 2.165A.75.75 0 0 1 6 4.536Z",clipRule:"evenodd",opacity:.2})),k0=wL,kL=t=>T.createElement("svg",le({xmlns:"http://www.w3.org/2000/svg",width:16,height:16,fill:"none"},t),T.createElement("g",{stroke:"currentColor",strokeLinecap:"round",strokeLinejoin:"round",strokeWidth:1.5},T.createElement("path",{d:"M13.25 7H9m0 0V2.75M9 7l5.25-5.25M2.75 9H7m0 0v4.25M7 9l-5.25 5.25"}))),EL=kL;function TL(t){var e=t,{trackRef:n,trackSource:i,participant:r}=e,s=qe(e,["trackRef","trackSource","participant"]);const a=vs(),{mergedProps:o,inFocus:l}=bI({trackRef:n??a,trackSource:i,participant:r,props:s});return T.createElement(gd.Consumer,null,c=>c!==void 0&&T.createElement("button",le({},o),s.children?s.children:l?T.createElement(EL,null):T.createElement(iL,null)))}function wh(t){var e=t,{kind:n,initialSelection:i,onActiveDeviceChange:r,onDeviceListChange:s,onDeviceSelectError:a,exactMatch:o,track:l,requestPermissions:c,onError:d}=e,u=qe(e,["kind","initialSelection","onActiveDeviceChange","onDeviceListChange","onDeviceSelectError","exactMatch","track","requestPermissions","onError"]);const m=_d(),v=T.useCallback(b=>{m&&m.emit(J.MediaDevicesError,b),d==null||d(b)},[m,d]),{devices:y,activeDeviceId:_,setActiveMediaDevice:p,className:f}=PI({kind:n,room:m,track:l,requestPermissions:c,onError:v});T.useEffect(()=>{i!==void 0&&p(i)},[p]),T.useEffect(()=>{typeof s=="function"&&s(y)},[s,y]),T.useEffect(()=>{_&&_!==""&&(r==null||r(_))},[_]);const h=b=>lw(this,null,function*(){try{yield p(b,{exact:o})}catch(w){if(w instanceof Error)a==null||a(w);else throw w}}),g=T.useMemo(()=>kr(u,{className:f},{className:"lk-list"}),[f,u]);function S(b,w,k){return b===w||k===0&&w==="default"}return T.createElement("ul",le({},g),y.map((b,w)=>T.createElement("li",{key:b.deviceId,id:b.deviceId,"data-lk-active":S(b.deviceId,_,w),"aria-selected":S(b.deviceId,_,w),role:"option"},T.createElement("button",{className:"lk-button",onClick:()=>h(b.deviceId)},b.label))))}function Cw(t,e){switch(t){case $.Source.Microphone:return e?T.createElement(dL,null):T.createElement(cL,null);case $.Source.Camera:return e?T.createElement(QI,null):T.createElement(JI,null);case $.Source.ScreenShare:return e?T.createElement(bL,null):T.createElement(Sw,null);default:return}}function RL(t){switch(t){case mn.Excellent:return T.createElement(fL,null);case mn.Good:return T.createElement(mL,null);case mn.Poor:return T.createElement(vL,null);default:return T.createElement(yL,null)}}function kh(t){var e=t,{showIcon:n}=e,i=qe(e,["showIcon"]);const{buttonProps:r,enabled:s}=zI(i);return T.createElement("button",le({},r),(n??!0)&&Cw(i.source,s),i.children)}function xL(t){var e;const{className:n,quality:i}=yI(t),r=T.useMemo(()=>kt(le({},kr(t,{className:n})),{"data-lk-quality":i}),[i,t,n]);return T.createElement("div",le({},r),(e=t.children)!=null?e:RL(i))}function E0(t){var e=t,{participant:n}=e,i=qe(e,["participant"]);const r=Oi(n),{className:s,infoObserver:a}=T.useMemo(()=>MO(r),[r]),{identity:o,name:l}=Qt(a,{name:r.name,identity:r.identity,metadata:r.metadata}),c=T.useMemo(()=>kr(i,{className:s,"data-lk-participant-name":l}),[i,s,l]);return T.createElement("span",le({},c),l!==""?l:o,i.children)}function PL(t){var e=t,{source:n,participant:i,trackRef:r,show:s="always"}=e,a=qe(e,["source","participant","trackRef","show"]),o,l;const{className:c,isMuted:d}=UI(r??n,{participant:i}),u=s==="always"||s==="muted"&&d||s==="unmuted"&&!d,m=T.useMemo(()=>kr(a,{className:c}),[c,a]);return u?T.createElement("div",kt(le({},m),{"data-lk-muted":d}),(l=a.children)!=null?l:Cw((o=r==null?void 0:r.source)!=null?o:n,!d)):null}var OL=t=>T.createElement("svg",le({width:320,height:320,viewBox:"0 0 320 320",preserveAspectRatio:"xMidYMid meet",fill:"none",xmlns:"http://www.w3.org/2000/svg"},t),T.createElement("path",{d:"M160 180C204.182 180 240 144.183 240 100C240 55.8172 204.182 20 160 20C115.817 20 79.9997 55.8172 79.9997 100C79.9997 144.183 115.817 180 160 180Z",fill:"white",fillOpacity:.25}),T.createElement("path",{d:"M97.6542 194.614C103.267 191.818 109.841 192.481 115.519 195.141C129.025 201.466 144.1 205 159.999 205C175.899 205 190.973 201.466 204.48 195.141C210.158 192.481 216.732 191.818 222.345 194.614C262.703 214.719 291.985 253.736 298.591 300.062C300.15 310.997 291.045 320 280 320H39.9997C28.954 320 19.8495 310.997 21.4087 300.062C28.014 253.736 57.2966 214.72 97.6542 194.614Z",fill:"white",fillOpacity:.25})),IL=OL;function LL(t){var e=t,{onTrackClick:n,onClick:i,onSubscriptionStatusChanged:r,trackRef:s,name:a,publication:o,source:l,participant:c,manageSubscription:d}=e,u=qe(e,["onTrackClick","onClick","onSubscriptionStatusChanged","trackRef","name","publication","source","participant","manageSubscription"]),m,v,y,_,p,f,h,g,S,b;const w=vs(),k=(_=(y=(m=s==null?void 0:s.publication)==null?void 0:m.trackName)!=null?y:(v=w==null?void 0:w.publication)==null?void 0:v.trackName)!=null?_:a,C=(f=(p=s==null?void 0:s.source)!=null?p:w==null?void 0:w.source)!=null?f:l,E=(g=(h=s==null?void 0:s.publication)!=null?h:w==null?void 0:w.publication)!=null?g:o,x=(b=(S=s==null?void 0:s.participant)!=null?S:w==null?void 0:w.participant)!=null?b:c;if(C===void 0)throw new Error("VideoTrack: You must provide a trackRef or source property.");const I=Oi(x),A=T.useRef(null),P=sI(A,{}),F=rI(P,3e3);T.useEffect(()=>{d&&E instanceof Rl&&(F==null?void 0:F.isIntersecting)===!1&&(P==null?void 0:P.isIntersecting)===!1&&E.setSubscribed(!1)},[F,E,d]),T.useEffect(()=>{d&&E instanceof Rl&&(P==null?void 0:P.isIntersecting)===!0&&E.setSubscribed(!0)},[P,E,d]);const{elementProps:B,publication:j,isSubscribed:X}=gw({participant:I,name:k,source:C,publication:E},{element:A,props:u});T.useEffect(()=>{r==null||r(!!X)},[X,r]);const U=R=>{i==null||i(R),n==null||n({participant:I,track:j})};return T.createElement("video",kt(le({ref:A},B),{muted:!0,onClick:U}))}function bw(t){var e=t,{trackRef:n,onSubscriptionStatusChanged:i,volume:r,source:s,name:a,publication:o,participant:l}=e,c=qe(e,["trackRef","onSubscriptionStatusChanged","volume","source","name","publication","participant"]),d,u,m,v,y,_,p,f,h,g;const S=vs(),b=(v=(m=(d=n==null?void 0:n.publication)==null?void 0:d.trackName)!=null?m:(u=S==null?void 0:S.publication)==null?void 0:u.trackName)!=null?v:a,w=(_=(y=n==null?void 0:n.source)!=null?y:S==null?void 0:S.source)!=null?_:s,k=(f=(p=n==null?void 0:n.publication)!=null?p:S==null?void 0:S.publication)!=null?f:o,C=(g=(h=n==null?void 0:n.participant)!=null?h:S==null?void 0:S.participant)!=null?g:l;if(w===void 0)throw new Error("The AudioTrack component expects a trackRef or source property.");const E=T.useRef(null),x=Oi(C),{elementProps:I,isSubscribed:A,track:P,publication:F}=gw({source:w,name:b,participant:x,publication:k},{element:E,props:c});return T.useEffect(()=>{i==null||i(!!A)},[A,i]),T.useEffect(()=>{P===void 0||r===void 0||(P instanceof Po?P.setVolume(r):ge.warn("Volume can only be set on remote audio tracks."))},[r,P]),T.useEffect(()=>{F===void 0||c.muted===void 0||(F instanceof Rl?F.setEnabled(!c.muted):ge.warn("Can only call setEnabled on remote track publications."))},[c.muted,F,P]),T.createElement("audio",le({ref:E},I))}function ML(t){const e=!!Wm();return t.participant&&!e?T.createElement(hw.Provider,{value:t.participant},t.children):T.createElement(T.Fragment,null,t.children)}function DL(t){const e=!!vs();return t.trackRef&&!e?T.createElement(jm.Provider,{value:t.trackRef},t.children):T.createElement(T.Fragment,null,t.children)}function dp(t){var e=t,{trackRef:n,participant:i,children:r,source:s=$.Source.Camera,onParticipantClick:a,publication:o,disableSpeakingIndicator:l}=e,c=qe(e,["trackRef","participant","children","source","onParticipantClick","publication","disableSpeakingIndicator"]),d,u;const m=vs(),v=Oi(i),y=T.useMemo(()=>{var S,b,w,k,C,E;return{participant:(b=(S=n==null?void 0:n.participant)!=null?S:m==null?void 0:m.participant)!=null?b:v,source:(k=(w=n==null?void 0:n.source)!=null?w:m==null?void 0:m.source)!=null?k:s,publication:(E=(C=n==null?void 0:n.publication)!=null?C:m==null?void 0:m.publication)!=null?E:o}},[m,v,o,s,n]),{elementProps:_}=MI({participant:y.participant,htmlProps:c,source:y.source,publication:y.publication,disableSpeakingIndicator:l,onParticipantClick:a}),p=VI(v),f=Vl(),h=(d=vI())==null?void 0:d.autoSubscription,g=T.useCallback(S=>{y.source&&!S&&f&&f.pin.dispatch&&op(y,f.pin.state)&&f.pin.dispatch({msg:"clear_pin"})},[y,f]);return T.createElement("div",le({style:{position:"relative"}},_),T.createElement(DL,{trackRef:y},T.createElement(ML,{participant:y.participant},r??T.createElement(T.Fragment,null,pt(y)&&(((u=y.publication)==null?void 0:u.kind)==="video"||y.source===$.Source.Camera||y.source===$.Source.ScreenShare)?T.createElement(LL,{trackRef:y,onSubscriptionStatusChanged:g,manageSubscription:h}):pt(y)&&T.createElement(bw,{trackRef:y,onSubscriptionStatusChanged:g}),T.createElement("div",{className:"lk-participant-placeholder"},T.createElement(IL,null)),T.createElement("div",{className:"lk-participant-metadata"},T.createElement("div",{className:"lk-participant-metadata-item"},y.source===$.Source.Camera?T.createElement(T.Fragment,null,p&&T.createElement(aL,{style:{marginRight:"0.25rem"}}),T.createElement(PL,{source:$.Source.Microphone,show:"muted"}),T.createElement(E0,null)):T.createElement(T.Fragment,null,T.createElement(Sw,{style:{marginRight:"0.25rem"}}),T.createElement(E0,null,"'s screen"))),T.createElement(xL,{className:"lk-participant-metadata-item"}))),T.createElement(TL,{trackRef:y}))))}function AL(t){const e=kr(t,{className:"lk-focus-layout"});return T.createElement("div",le({},e),t.children)}function NL(t){var e=t,{trackRef:n,track:i}=e,r=qe(e,["trackRef","track"]);const s=n??i;return T.createElement(dp,le(le({},s),r))}function ww(t){var e=t,{tracks:n}=e,i=qe(e,["tracks"]);return T.createElement(T.Fragment,null,n.map(r=>T.createElement(jm.Provider,{value:r,key:at(r)},mw(i.children))))}function BL({totalPageCount:t,nextPage:e,prevPage:n,currentPage:i,pagesContainer:r}){const[s,a]=T.useState(!1);return T.useEffect(()=>{let o;return r&&(o=JO(r.current,2e3).subscribe(a)),()=>{o&&o.unsubscribe()}},[r]),T.createElement("div",{className:"lk-pagination-control","data-lk-user-interaction":s},T.createElement("button",{className:"lk-button",onClick:n},T.createElement(w0,null)),T.createElement("span",{className:"lk-pagination-count"},`${i} of ${t}`),T.createElement("button",{className:"lk-button",onClick:e},T.createElement(w0,null)))}function FL({totalPageCount:t,currentPage:e}){const n=new Array(t).fill("").map((i,r)=>r+1===e?T.createElement("span",{"data-lk-active":!0,key:r}):T.createElement("span",{key:r}));return T.createElement("div",{className:"lk-pagination-indicator"},n)}function UL(t){var e=t,{tracks:n}=e,i=qe(e,["tracks"]);const r=T.createRef(),s=T.useMemo(()=>kr(i,{className:"lk-grid-layout"}),[i]),{layout:a}=wI(r,n.length),o=LI(a.maxTiles,n);return BI(r,{onLeftSwipe:o.nextPage,onRightSwipe:o.prevPage}),T.createElement("div",le({ref:r,"data-lk-pagination":o.totalPageCount>1},s),T.createElement(ww,{tracks:o.tracks},i.children),n.length>a.maxTiles&&T.createElement(T.Fragment,null,T.createElement(FL,{totalPageCount:o.totalPageCount,currentPage:o.currentPage}),T.createElement(BL,le({pagesContainer:r},o))))}var zL=130,HL=140,T0=1,kw=16/10,jL=(1-kw)*-1;function WL(t){var e=t,{tracks:n,orientation:i}=e,r=qe(e,["tracks","orientation"]);const s=T.useRef(null),[a,o]=T.useState(0),{width:l,height:c}=cw(s),d=i||(c>=l?"vertical":"horizontal"),u=d==="vertical"?Math.max(l*jL,zL):Math.max(c*kw,HL),m=V2(),v=Math.max(d==="vertical"?(c-m)/u:(l-m)/u,T0);let y=Math.round(v);Math.abs(v-a)<.5?y=Math.round(a):a!==v&&o(v);const _=vw(n,y);return T.useLayoutEffect(()=>{s.current&&(s.current.dataset.lkOrientation=d,s.current.style.setProperty("--lk-max-visible-tiles",y.toString()))},[y,d]),T.createElement("aside",le({key:d,className:"lk-carousel",ref:s},r),T.createElement(ww,{tracks:_},r.children))}function $L({value:t,onPinChange:e,onWidgetChange:n,children:i}){const r=gI(t);return T.useEffect(()=>{ge.debug("PinState Updated",{state:r.pin.state}),e&&r.pin.state&&e(r.pin.state)},[r.pin.state,e]),T.useEffect(()=>{ge.debug("Widget Updated",{widgetState:r.widget.state}),n&&r.widget.state&&n(r.widget.state)},[n,r.widget.state]),T.createElement(gd.Provider,{value:r},i)}function VL(t){const{room:e,htmlProps:n}=TI(t);return T.createElement("div",le({},n),e&&T.createElement($m.Provider,{value:e},T.createElement(fw.Provider,{value:t.featureFlags},t.children)))}function Ew({volume:t,muted:e}){const n=_w([$.Source.Microphone,$.Source.ScreenShareAudio,$.Source.Unknown],{updateOnlyOn:[],onlySubscribed:!1}).filter(i=>!Xb(i.participant)&&i.publication.kind===$.Kind.Audio);return T.useEffect(()=>{for(const i of n)i.publication.setSubscribed(!0)},[n]),T.createElement("div",{style:{display:"none"}},n.map(i=>T.createElement(bw,{key:at(i),trackRef:i,volume:t,muted:e})))}function GL(t){const e=T.useMemo(()=>kr(t,{className:"lk-toast"}),[t]);return T.createElement("div",le({},e),t.children)}function qL(t){const[e,n]=T.useState(void 0),i=pw(t.room);return T.useEffect(()=>{switch(i){case ye.Reconnecting:n(T.createElement(T.Fragment,null,T.createElement(k0,{className:"lk-spinner"})," Reconnecting"));break;case ye.Connecting:n(T.createElement(T.Fragment,null,T.createElement(k0,{className:"lk-spinner"})," Connecting"));break;case ye.Disconnected:n(T.createElement(T.Fragment,null,"Disconnected"));break;default:n(void 0);break}},[i]),e?T.createElement(GL,{className:"lk-toast-connection-state"},e):T.createElement(T.Fragment,null)}function JL(t){var e=t,{entry:n,hideName:i=!1,hideTimestamp:r=!1,messageFormatter:s}=e,a=qe(e,["entry","hideName","hideTimestamp","messageFormatter"]),o,l,c,d;const u=T.useMemo(()=>s?s(n.message):n.message,[n.message,s]),m=!!n.editTimestamp,v=new Date(n.timestamp),y=navigator?navigator.language:"en-US";return T.createElement("li",le({className:"lk-chat-entry",title:v.toLocaleTimeString(y,{timeStyle:"full"}),"data-lk-message-origin":(o=n.from)!=null&&o.isLocal?"local":"remote"},a),(!r||!i||m)&&T.createElement("span",{className:"lk-meta-data"},!i&&T.createElement("strong",{className:"lk-participant-name"},(d=(l=n.from)==null?void 0:l.name)!=null?d:(c=n.from)==null?void 0:c.identity),(!r||m)&&T.createElement("span",{className:"lk-timestamp"},m&&"edited ",v.toLocaleTimeString(y,{timeStyle:"short"}))),T.createElement("span",{className:"lk-message-body"},u))}function KL(t){var e=t,{messageFormatter:n,messageDecoder:i,messageEncoder:r,channelTopic:s}=e,a=qe(e,["messageFormatter","messageDecoder","messageEncoder","channelTopic"]);const o=T.useRef(null),l=T.useRef(null),c=T.useMemo(()=>({messageDecoder:i,messageEncoder:r,channelTopic:s}),[i,r,s]),{send:d,chatMessages:u,isSending:m}=WI(c),v=Vl(),y=T.useRef(0);function _(p){return lw(this,null,function*(){p.preventDefault(),o.current&&o.current.value.trim()!==""&&d&&(yield d(o.current.value),o.current.value="",o.current.focus())})}return T.useEffect(()=>{var p;l&&((p=l.current)==null||p.scrollTo({top:l.current.scrollHeight}))},[l,u]),T.useEffect(()=>{var p,f,h,g,S;if(!v||u.length===0)return;if((p=v.widget.state)!=null&&p.showChat&&u.length>0&&y.current!==((f=u[u.length-1])==null?void 0:f.timestamp)){y.current=(h=u[u.length-1])==null?void 0:h.timestamp;return}const b=u.filter(k=>!y.current||k.timestamp>y.current).length,{widget:w}=v;b>0&&((g=w.state)==null?void 0:g.unreadMessages)!==b&&((S=w.dispatch)==null||S.call(w,{msg:"unread_msg",count:b}))},[u,v==null?void 0:v.widget]),T.createElement("div",kt(le({},a),{className:"lk-chat"}),T.createElement("div",{className:"lk-chat-header"},"Messages",T.createElement(yw,{className:"lk-close-button"},T.createElement(YI,null))),T.createElement("ul",{className:"lk-list lk-chat-messages",ref:l},a.children?u.map((p,f)=>{var h;return mw(a.children,{entry:p,key:(h=p.id)!=null?h:f,messageFormatter:n})}):u.map((p,f,h)=>{var g;const S=f>=1&&h[f-1].from===p.from,b=f>=1&&p.timestamp-h[f-1].timestamp<6e4;return T.createElement(JL,{key:(g=p.id)!=null?g:f,hideName:S,hideTimestamp:S===!1?!1:b,entry:p,messageFormatter:n})})),T.createElement("form",{className:"lk-chat-form",onSubmit:_},T.createElement("input",{className:"lk-form-control lk-chat-form-input",disabled:m,ref:o,type:"text",placeholder:"Enter a message..."}),T.createElement("button",{type:"submit",className:"lk-button lk-chat-form-button",disabled:m},"Send")))}function R0(t){var e=t,{kind:n,initialSelection:i,onActiveDeviceChange:r,tracks:s,requestPermissions:a=!1}=e,o=qe(e,["kind","initialSelection","onActiveDeviceChange","tracks","requestPermissions"]);const[l,c]=T.useState(!1),[d,u]=T.useState([]),[m,v]=T.useState(!0),y=(h,g)=>{ge.debug("handle device change"),c(!1),r==null||r(h,g)},_=T.useRef(null),p=T.useRef(null);T.useLayoutEffect(()=>{_.current&&p.current&&(d||m)&&q2(_.current,p.current).then(({x:h,y:g})=>{p.current&&Object.assign(p.current.style,{left:`${h}px`,top:`${g}px`})}),v(!1)},[_,p,d,m]);const f=T.useCallback(h=>{p.current&&h.target!==_.current&&l&&J2(p.current,h)&&c(!1)},[l,p,_]);return T.useEffect(()=>(document.addEventListener("click",f),window.addEventListener("resize",()=>v(!0)),()=>{document.removeEventListener("click",f),window.removeEventListener("resize",()=>v(!0))}),[f,v]),T.createElement(T.Fragment,null,T.createElement("button",kt(le({className:"lk-button lk-button-menu","aria-pressed":l},o),{onClick:()=>c(!l),ref:_}),o.children),!o.disabled&&T.createElement("div",{className:"lk-device-menu",ref:p,style:{visibility:l?"visible":"hidden"}},n?T.createElement(wh,{initialSelection:i,onActiveDeviceChange:h=>y(n,h),onDeviceListChange:u,kind:n,track:s==null?void 0:s[n],requestPermissions:a}):T.createElement(T.Fragment,null,T.createElement("div",{className:"lk-device-menu-heading"},"Audio inputs"),T.createElement(wh,{kind:"audioinput",onActiveDeviceChange:h=>y("audioinput",h),onDeviceListChange:u,track:s==null?void 0:s.audioinput,requestPermissions:a}),T.createElement("div",{className:"lk-device-menu-heading"},"Video inputs"),T.createElement(wh,{kind:"videoinput",onActiveDeviceChange:h=>y("videoinput",h),onDeviceListChange:u,track:s==null?void 0:s.videoinput,requestPermissions:a}))))}function QL(){T.useEffect(()=>{II()},[])}function XL(t){var e=t,{label:n}=e,i=qe(e,["label"]);const r=vd(),{mergedProps:s,canPlayAudio:a}=AI({room:r,props:i}),{mergedProps:o,canPlayVideo:l}=NI({room:r,props:s}),c=o,{style:d}=c,u=qe(c,["style"]);return d.display=a&&l?"none":"block",T.createElement("button",le({style:d},u),n??`Start ${a?"Video":"Audio"}`)}function YL(t){var e=t,{variation:n,controls:i,saveUserChoices:r=!0}=e,s=qe(e,["variation","controls","saveUserChoices"]),a,o,l,c,d;const[u,m]=T.useState(!1),v=Vl();T.useEffect(()=>{var B,j;((B=v==null?void 0:v.widget.state)==null?void 0:B.showChat)!==void 0&&m((j=v==null?void 0:v.widget.state)==null?void 0:j.showChat)},[(a=v==null?void 0:v.widget.state)==null?void 0:a.showChat]);const _=hI(`(max-width: ${u?1e3:760}px)`)?"minimal":"verbose";n??(n=_);const p=le({leave:!0},i),f=xI();f?((o=p.camera)!=null||(p.camera=f.canPublish),(l=p.microphone)!=null||(p.microphone=f.canPublish),(c=p.screenShare)!=null||(p.screenShare=f.canPublish),(d=p.chat)!=null||(p.chat=f.canPublishData&&(i==null?void 0:i.chat))):(p.camera=!1,p.chat=!1,p.microphone=!1,p.screenShare=!1);const h=T.useMemo(()=>n==="minimal"||n==="verbose",[n]),g=T.useMemo(()=>n==="textOnly"||n==="verbose",[n]),S=Y2(),[b,w]=T.useState(!1),k=T.useCallback(B=>{w(B)},[w]),C=kr({className:"lk-control-bar"},s),{saveAudioInputEnabled:E,saveVideoInputEnabled:x,saveAudioInputDeviceId:I,saveVideoInputDeviceId:A}=$I({preventSave:!r}),P=T.useCallback((B,j)=>j?E(B):null,[E]),F=T.useCallback((B,j)=>j?x(B):null,[x]);return T.createElement("div",le({},C),p.microphone&&T.createElement("div",{className:"lk-button-group"},T.createElement(kh,{source:$.Source.Microphone,showIcon:h,onChange:P},g&&"Microphone"),T.createElement("div",{className:"lk-button-group-menu"},T.createElement(R0,{kind:"audioinput",onActiveDeviceChange:(B,j)=>I(j??"")}))),p.camera&&T.createElement("div",{className:"lk-button-group"},T.createElement(kh,{source:$.Source.Camera,showIcon:h,onChange:F},g&&"Camera"),T.createElement("div",{className:"lk-button-group-menu"},T.createElement(R0,{kind:"videoinput",onActiveDeviceChange:(B,j)=>A(j??"")}))),p.screenShare&&S&&T.createElement(kh,{source:$.Source.ScreenShare,captureOptions:{audio:!0,selfBrowserSurface:"include"},showIcon:h,onChange:k},g&&(b?"Stop screen share":"Share screen")),p.chat&&T.createElement(yw,null,h&&T.createElement(eL,null),g&&"Chat"),p.leave&&T.createElement(GI,null,h&&T.createElement(sL,null),g&&"Leave"),T.createElement(XL,null))}function ZL(t){var e=t,{chatMessageFormatter:n,chatMessageDecoder:i,chatMessageEncoder:r}=e,s=qe(e,["chatMessageFormatter","chatMessageDecoder","chatMessageEncoder"]),a,o;const[l,c]=T.useState({showChat:!1,unreadMessages:0}),d=T.useRef(null),u=_w([{source:$.Source.Camera,withPlaceholder:!0},{source:$.Source.ScreenShare,withPlaceholder:!1}],{updateOnlyOn:[J.ActiveSpeakersChanged],onlySubscribed:!1}),m=f=>{ge.debug("updating widget state",f),c(f)},v=mI(),y=u.filter(pt).filter(f=>f.publication.source===$.Source.ScreenShare),_=(a=DI(v))==null?void 0:a[0],p=u.filter(f=>!W2(f,_));return T.useEffect(()=>{var f,h,g,S;y.some(b=>b.publication.isSubscribed)&&d.current===null?(ge.debug("Auto set screen share focus:",{newScreenShareTrack:y[0]}),(h=(f=v.pin).dispatch)==null||h.call(f,{msg:"set_pin",trackReference:y[0]}),d.current=y[0]):d.current&&!y.some(b=>{var w,k;return b.publication.trackSid===((k=(w=d.current)==null?void 0:w.publication)==null?void 0:k.trackSid)})&&(ge.debug("Auto clearing screen share focus."),(S=(g=v.pin).dispatch)==null||S.call(g,{msg:"clear_pin"}),d.current=null)},[y.map(f=>`${f.publication.trackSid}_${f.publication.isSubscribed}`).join(),(o=_==null?void 0:_.publication)==null?void 0:o.trackSid]),QL(),T.createElement("div",le({className:"lk-video-conference"},s),G2()&&T.createElement($L,{value:v,onWidgetChange:m},T.createElement("div",{className:"lk-video-conference-inner"},_?T.createElement("div",{className:"lk-focus-layout-wrapper"},T.createElement(AL,null,T.createElement(WL,{tracks:p},T.createElement(dp,null)),_&&T.createElement(NL,{trackRef:_}))):T.createElement("div",{className:"lk-grid-layout-wrapper"},T.createElement(UL,{tracks:u},T.createElement(dp,null))),T.createElement(YL,{controls:{chat:!0}})),T.createElement(KL,{style:{display:l.showChat?"grid":"none"},messageFormatter:n,messageEncoder:r,messageDecoder:i})),T.createElement(Ew,null),T.createElement(qL,null))}function Tw(t,e){return function(){return t.apply(e,arguments)}}const{toString:eM}=Object.prototype,{getPrototypeOf:Vm}=Object,yd=(t=>e=>{const n=eM.call(e);return t[n]||(t[n]=n.slice(8,-1).toLowerCase())})(Object.create(null)),Kn=t=>(t=t.toLowerCase(),e=>yd(e)===t),Sd=t=>e=>typeof e===t,{isArray:ha}=Array,Ll=Sd("undefined");function tM(t){return t!==null&&!Ll(t)&&t.constructor!==null&&!Ll(t.constructor)&&on(t.constructor.isBuffer)&&t.constructor.isBuffer(t)}const Rw=Kn("ArrayBuffer");function nM(t){let e;return typeof ArrayBuffer<"u"&&ArrayBuffer.isView?e=ArrayBuffer.isView(t):e=t&&t.buffer&&Rw(t.buffer),e}const iM=Sd("string"),on=Sd("function"),xw=Sd("number"),Cd=t=>t!==null&&typeof t=="object",rM=t=>t===!0||t===!1,Jc=t=>{if(yd(t)!=="object")return!1;const e=Vm(t);return(e===null||e===Object.prototype||Object.getPrototypeOf(e)===null)&&!(Symbol.toStringTag in t)&&!(Symbol.iterator in t)},sM=Kn("Date"),oM=Kn("File"),aM=Kn("Blob"),lM=Kn("FileList"),cM=t=>Cd(t)&&on(t.pipe),uM=t=>{let e;return t&&(typeof FormData=="function"&&t instanceof FormData||on(t.append)&&((e=yd(t))==="formdata"||e==="object"&&on(t.toString)&&t.toString()==="[object FormData]"))},dM=Kn("URLSearchParams"),[hM,fM,pM,mM]=["ReadableStream","Request","Response","Headers"].map(Kn),gM=t=>t.trim?t.trim():t.replace(/^[\s\uFEFF\xA0]+|[\s\uFEFF\xA0]+$/g,"");function Gl(t,e,{allOwnKeys:n=!1}={}){if(t===null||typeof t>"u")return;let i,r;if(typeof t!="object"&&(t=[t]),ha(t))for(i=0,r=t.length;i<r;i++)e.call(null,t[i],i,t);else{const s=n?Object.getOwnPropertyNames(t):Object.keys(t),a=s.length;let o;for(i=0;i<a;i++)o=s[i],e.call(null,t[o],o,t)}}function Pw(t,e){e=e.toLowerCase();const n=Object.keys(t);let i=n.length,r;for(;i-- >0;)if(r=n[i],e===r.toLowerCase())return r;return null}const Ts=(()=>typeof globalThis<"u"?globalThis:typeof self<"u"?self:typeof window<"u"?window:global)(),Ow=t=>!Ll(t)&&t!==Ts;function hp(){const{caseless:t}=Ow(this)&&this||{},e={},n=(i,r)=>{const s=t&&Pw(e,r)||r;Jc(e[s])&&Jc(i)?e[s]=hp(e[s],i):Jc(i)?e[s]=hp({},i):ha(i)?e[s]=i.slice():e[s]=i};for(let i=0,r=arguments.length;i<r;i++)arguments[i]&&Gl(arguments[i],n);return e}const vM=(t,e,n,{allOwnKeys:i}={})=>(Gl(e,(r,s)=>{n&&on(r)?t[s]=Tw(r,n):t[s]=r},{allOwnKeys:i}),t),_M=t=>(t.charCodeAt(0)===65279&&(t=t.slice(1)),t),yM=(t,e,n,i)=>{t.prototype=Object.create(e.prototype,i),t.prototype.constructor=t,Object.defineProperty(t,"super",{value:e.prototype}),n&&Object.assign(t.prototype,n)},SM=(t,e,n,i)=>{let r,s,a;const o={};if(e=e||{},t==null)return e;do{for(r=Object.getOwnPropertyNames(t),s=r.length;s-- >0;)a=r[s],(!i||i(a,t,e))&&!o[a]&&(e[a]=t[a],o[a]=!0);t=n!==!1&&Vm(t)}while(t&&(!n||n(t,e))&&t!==Object.prototype);return e},CM=(t,e,n)=>{t=String(t),(n===void 0||n>t.length)&&(n=t.length),n-=e.length;const i=t.indexOf(e,n);return i!==-1&&i===n},bM=t=>{if(!t)return null;if(ha(t))return t;let e=t.length;if(!xw(e))return null;const n=new Array(e);for(;e-- >0;)n[e]=t[e];return n},wM=(t=>e=>t&&e instanceof t)(typeof Uint8Array<"u"&&Vm(Uint8Array)),kM=(t,e)=>{const i=(t&&t[Symbol.iterator]).call(t);let r;for(;(r=i.next())&&!r.done;){const s=r.value;e.call(t,s[0],s[1])}},EM=(t,e)=>{let n;const i=[];for(;(n=t.exec(e))!==null;)i.push(n);return i},TM=Kn("HTMLFormElement"),RM=t=>t.toLowerCase().replace(/[-_\s]([a-z\d])(\w*)/g,function(n,i,r){return i.toUpperCase()+r}),x0=(({hasOwnProperty:t})=>(e,n)=>t.call(e,n))(Object.prototype),xM=Kn("RegExp"),Iw=(t,e)=>{const n=Object.getOwnPropertyDescriptors(t),i={};Gl(n,(r,s)=>{let a;(a=e(r,s,t))!==!1&&(i[s]=a||r)}),Object.defineProperties(t,i)},PM=t=>{Iw(t,(e,n)=>{if(on(t)&&["arguments","caller","callee"].indexOf(n)!==-1)return!1;const i=t[n];if(on(i)){if(e.enumerable=!1,"writable"in e){e.writable=!1;return}e.set||(e.set=()=>{throw Error("Can not rewrite read-only method '"+n+"'")})}})},OM=(t,e)=>{const n={},i=r=>{r.forEach(s=>{n[s]=!0})};return ha(t)?i(t):i(String(t).split(e)),n},IM=()=>{},LM=(t,e)=>t!=null&&Number.isFinite(t=+t)?t:e;function MM(t){return!!(t&&on(t.append)&&t[Symbol.toStringTag]==="FormData"&&t[Symbol.iterator])}const DM=t=>{const e=new Array(10),n=(i,r)=>{if(Cd(i)){if(e.indexOf(i)>=0)return;if(!("toJSON"in i)){e[r]=i;const s=ha(i)?[]:{};return Gl(i,(a,o)=>{const l=n(a,r+1);!Ll(l)&&(s[o]=l)}),e[r]=void 0,s}}return i};return n(t,0)},AM=Kn("AsyncFunction"),NM=t=>t&&(Cd(t)||on(t))&&on(t.then)&&on(t.catch),Lw=((t,e)=>t?setImmediate:e?((n,i)=>(Ts.addEventListener("message",({source:r,data:s})=>{r===Ts&&s===n&&i.length&&i.shift()()},!1),r=>{i.push(r),Ts.postMessage(n,"*")}))(`axios@${Math.random()}`,[]):n=>setTimeout(n))(typeof setImmediate=="function",on(Ts.postMessage)),BM=typeof queueMicrotask<"u"?queueMicrotask.bind(Ts):typeof process<"u"&&process.nextTick||Lw,V={isArray:ha,isArrayBuffer:Rw,isBuffer:tM,isFormData:uM,isArrayBufferView:nM,isString:iM,isNumber:xw,isBoolean:rM,isObject:Cd,isPlainObject:Jc,isReadableStream:hM,isRequest:fM,isResponse:pM,isHeaders:mM,isUndefined:Ll,isDate:sM,isFile:oM,isBlob:aM,isRegExp:xM,isFunction:on,isStream:cM,isURLSearchParams:dM,isTypedArray:wM,isFileList:lM,forEach:Gl,merge:hp,extend:vM,trim:gM,stripBOM:_M,inherits:yM,toFlatObject:SM,kindOf:yd,kindOfTest:Kn,endsWith:CM,toArray:bM,forEachEntry:kM,matchAll:EM,isHTMLForm:TM,hasOwnProperty:x0,hasOwnProp:x0,reduceDescriptors:Iw,freezeMethods:PM,toObjectSet:OM,toCamelCase:RM,noop:IM,toFiniteNumber:LM,findKey:Pw,global:Ts,isContextDefined:Ow,isSpecCompliantForm:MM,toJSONObject:DM,isAsyncFn:AM,isThenable:NM,setImmediate:Lw,asap:BM};function fe(t,e,n,i,r){Error.call(this),Error.captureStackTrace?Error.captureStackTrace(this,this.constructor):this.stack=new Error().stack,this.message=t,this.name="AxiosError",e&&(this.code=e),n&&(this.config=n),i&&(this.request=i),r&&(this.response=r,this.status=r.status?r.status:null)}V.inherits(fe,Error,{toJSON:function(){return{message:this.message,name:this.name,description:this.description,number:this.number,fileName:this.fileName,lineNumber:this.lineNumber,columnNumber:this.columnNumber,stack:this.stack,config:V.toJSONObject(this.config),code:this.code,status:this.status}}});const Mw=fe.prototype,Dw={};["ERR_BAD_OPTION_VALUE","ERR_BAD_OPTION","ECONNABORTED","ETIMEDOUT","ERR_NETWORK","ERR_FR_TOO_MANY_REDIRECTS","ERR_DEPRECATED","ERR_BAD_RESPONSE","ERR_BAD_REQUEST","ERR_CANCELED","ERR_NOT_SUPPORT","ERR_INVALID_URL"].forEach(t=>{Dw[t]={value:t}});Object.defineProperties(fe,Dw);Object.defineProperty(Mw,"isAxiosError",{value:!0});fe.from=(t,e,n,i,r,s)=>{const a=Object.create(Mw);return V.toFlatObject(t,a,function(l){return l!==Error.prototype},o=>o!=="isAxiosError"),fe.call(a,t.message,e,n,i,r),a.cause=t,a.name=t.name,s&&Object.assign(a,s),a};const FM=null;function fp(t){return V.isPlainObject(t)||V.isArray(t)}function Aw(t){return V.endsWith(t,"[]")?t.slice(0,-2):t}function P0(t,e,n){return t?t.concat(e).map(function(r,s){return r=Aw(r),!n&&s?"["+r+"]":r}).join(n?".":""):e}function UM(t){return V.isArray(t)&&!t.some(fp)}const zM=V.toFlatObject(V,{},null,function(e){return/^is[A-Z]/.test(e)});function bd(t,e,n){if(!V.isObject(t))throw new TypeError("target must be an object");e=e||new FormData,n=V.toFlatObject(n,{metaTokens:!0,dots:!1,indexes:!1},!1,function(_,p){return!V.isUndefined(p[_])});const i=n.metaTokens,r=n.visitor||d,s=n.dots,a=n.indexes,l=(n.Blob||typeof Blob<"u"&&Blob)&&V.isSpecCompliantForm(e);if(!V.isFunction(r))throw new TypeError("visitor must be a function");function c(y){if(y===null)return"";if(V.isDate(y))return y.toISOString();if(!l&&V.isBlob(y))throw new fe("Blob is not supported. Use a Buffer instead.");return V.isArrayBuffer(y)||V.isTypedArray(y)?l&&typeof Blob=="function"?new Blob([y]):Buffer.from(y):y}function d(y,_,p){let f=y;if(y&&!p&&typeof y=="object"){if(V.endsWith(_,"{}"))_=i?_:_.slice(0,-2),y=JSON.stringify(y);else if(V.isArray(y)&&UM(y)||(V.isFileList(y)||V.endsWith(_,"[]"))&&(f=V.toArray(y)))return _=Aw(_),f.forEach(function(g,S){!(V.isUndefined(g)||g===null)&&e.append(a===!0?P0([_],S,s):a===null?_:_+"[]",c(g))}),!1}return fp(y)?!0:(e.append(P0(p,_,s),c(y)),!1)}const u=[],m=Object.assign(zM,{defaultVisitor:d,convertValue:c,isVisitable:fp});function v(y,_){if(!V.isUndefined(y)){if(u.indexOf(y)!==-1)throw Error("Circular reference detected in "+_.join("."));u.push(y),V.forEach(y,function(f,h){(!(V.isUndefined(f)||f===null)&&r.call(e,f,V.isString(h)?h.trim():h,_,m))===!0&&v(f,_?_.concat(h):[h])}),u.pop()}}if(!V.isObject(t))throw new TypeError("data must be an object");return v(t),e}function O0(t){const e={"!":"%21","'":"%27","(":"%28",")":"%29","~":"%7E","%20":"+","%00":"\0"};return encodeURIComponent(t).replace(/[!'()~]|%20|%00/g,function(i){return e[i]})}function Gm(t,e){this._pairs=[],t&&bd(t,this,e)}const Nw=Gm.prototype;Nw.append=function(e,n){this._pairs.push([e,n])};Nw.toString=function(e){const n=e?function(i){return e.call(this,i,O0)}:O0;return this._pairs.map(function(r){return n(r[0])+"="+n(r[1])},"").join("&")};function HM(t){return encodeURIComponent(t).replace(/%3A/gi,":").replace(/%24/g,"$").replace(/%2C/gi,",").replace(/%20/g,"+").replace(/%5B/gi,"[").replace(/%5D/gi,"]")}function Bw(t,e,n){if(!e)return t;const i=n&&n.encode||HM;V.isFunction(n)&&(n={serialize:n});const r=n&&n.serialize;let s;if(r?s=r(e,n):s=V.isURLSearchParams(e)?e.toString():new Gm(e,n).toString(i),s){const a=t.indexOf("#");a!==-1&&(t=t.slice(0,a)),t+=(t.indexOf("?")===-1?"?":"&")+s}return t}class jM{constructor(){this.handlers=[]}use(e,n,i){return this.handlers.push({fulfilled:e,rejected:n,synchronous:i?i.synchronous:!1,runWhen:i?i.runWhen:null}),this.handlers.length-1}eject(e){this.handlers[e]&&(this.handlers[e]=null)}clear(){this.handlers&&(this.handlers=[])}forEach(e){V.forEach(this.handlers,function(i){i!==null&&e(i)})}}const I0=jM,Fw={silentJSONParsing:!0,forcedJSONParsing:!0,clarifyTimeoutError:!1},WM=typeof URLSearchParams<"u"?URLSearchParams:Gm,$M=typeof FormData<"u"?FormData:null,VM=typeof Blob<"u"?Blob:null,GM={isBrowser:!0,classes:{URLSearchParams:WM,FormData:$M,Blob:VM},protocols:["http","https","file","blob","url","data"]},qm=typeof window<"u"&&typeof document<"u",pp=typeof navigator=="object"&&navigator||void 0,qM=qm&&(!pp||["ReactNative","NativeScript","NS"].indexOf(pp.product)<0),JM=(()=>typeof WorkerGlobalScope<"u"&&self instanceof WorkerGlobalScope&&typeof self.importScripts=="function")(),KM=qm&&window.location.href||"http://localhost",QM=Object.freeze(Object.defineProperty({__proto__:null,hasBrowserEnv:qm,hasStandardBrowserEnv:qM,hasStandardBrowserWebWorkerEnv:JM,navigator:pp,origin:KM},Symbol.toStringTag,{value:"Module"})),Et={...QM,...GM};function XM(t,e){return bd(t,new Et.classes.URLSearchParams,Object.assign({visitor:function(n,i,r,s){return Et.isNode&&V.isBuffer(n)?(this.append(i,n.toString("base64")),!1):s.defaultVisitor.apply(this,arguments)}},e))}function YM(t){return V.matchAll(/\w+|\[(\w*)]/g,t).map(e=>e[0]==="[]"?"":e[1]||e[0])}function ZM(t){const e={},n=Object.keys(t);let i;const r=n.length;let s;for(i=0;i<r;i++)s=n[i],e[s]=t[s];return e}function Uw(t){function e(n,i,r,s){let a=n[s++];if(a==="__proto__")return!0;const o=Number.isFinite(+a),l=s>=n.length;return a=!a&&V.isArray(r)?r.length:a,l?(V.hasOwnProp(r,a)?r[a]=[r[a],i]:r[a]=i,!o):((!r[a]||!V.isObject(r[a]))&&(r[a]=[]),e(n,i,r[a],s)&&V.isArray(r[a])&&(r[a]=ZM(r[a])),!o)}if(V.isFormData(t)&&V.isFunction(t.entries)){const n={};return V.forEachEntry(t,(i,r)=>{e(YM(i),r,n,0)}),n}return null}function eD(t,e,n){if(V.isString(t))try{return(e||JSON.parse)(t),V.trim(t)}catch(i){if(i.name!=="SyntaxError")throw i}return(n||JSON.stringify)(t)}const Jm={transitional:Fw,adapter:["xhr","http","fetch"],transformRequest:[function(e,n){const i=n.getContentType()||"",r=i.indexOf("application/json")>-1,s=V.isObject(e);if(s&&V.isHTMLForm(e)&&(e=new FormData(e)),V.isFormData(e))return r?JSON.stringify(Uw(e)):e;if(V.isArrayBuffer(e)||V.isBuffer(e)||V.isStream(e)||V.isFile(e)||V.isBlob(e)||V.isReadableStream(e))return e;if(V.isArrayBufferView(e))return e.buffer;if(V.isURLSearchParams(e))return n.setContentType("application/x-www-form-urlencoded;charset=utf-8",!1),e.toString();let o;if(s){if(i.indexOf("application/x-www-form-urlencoded")>-1)return XM(e,this.formSerializer).toString();if((o=V.isFileList(e))||i.indexOf("multipart/form-data")>-1){const l=this.env&&this.env.FormData;return bd(o?{"files[]":e}:e,l&&new l,this.formSerializer)}}return s||r?(n.setContentType("application/json",!1),eD(e)):e}],transformResponse:[function(e){const n=this.transitional||Jm.transitional,i=n&&n.forcedJSONParsing,r=this.responseType==="json";if(V.isResponse(e)||V.isReadableStream(e))return e;if(e&&V.isString(e)&&(i&&!this.responseType||r)){const a=!(n&&n.silentJSONParsing)&&r;try{return JSON.parse(e)}catch(o){if(a)throw o.name==="SyntaxError"?fe.from(o,fe.ERR_BAD_RESPONSE,this,null,this.response):o}}return e}],timeout:0,xsrfCookieName:"XSRF-TOKEN",xsrfHeaderName:"X-XSRF-TOKEN",maxContentLength:-1,maxBodyLength:-1,env:{FormData:Et.classes.FormData,Blob:Et.classes.Blob},validateStatus:function(e){return e>=200&&e<300},headers:{common:{Accept:"application/json, text/plain, */*","Content-Type":void 0}}};V.forEach(["delete","get","head","post","put","patch"],t=>{Jm.headers[t]={}});const Km=Jm,tD=V.toObjectSet(["age","authorization","content-length","content-type","etag","expires","from","host","if-modified-since","if-unmodified-since","last-modified","location","max-forwards","proxy-authorization","referer","retry-after","user-agent"]),nD=t=>{const e={};let n,i,r;return t&&t.split(`
`).forEach(function(a){r=a.indexOf(":"),n=a.substring(0,r).trim().toLowerCase(),i=a.substring(r+1).trim(),!(!n||e[n]&&tD[n])&&(n==="set-cookie"?e[n]?e[n].push(i):e[n]=[i]:e[n]=e[n]?e[n]+", "+i:i)}),e},L0=Symbol("internals");function Aa(t){return t&&String(t).trim().toLowerCase()}function Kc(t){return t===!1||t==null?t:V.isArray(t)?t.map(Kc):String(t)}function iD(t){const e=Object.create(null),n=/([^\s,;=]+)\s*(?:=\s*([^,;]+))?/g;let i;for(;i=n.exec(t);)e[i[1]]=i[2];return e}const rD=t=>/^[-_a-zA-Z0-9^`|~,!#$%&'*+.]+$/.test(t.trim());function Eh(t,e,n,i,r){if(V.isFunction(i))return i.call(this,e,n);if(r&&(e=n),!!V.isString(e)){if(V.isString(i))return e.indexOf(i)!==-1;if(V.isRegExp(i))return i.test(e)}}function sD(t){return t.trim().toLowerCase().replace(/([a-z\d])(\w*)/g,(e,n,i)=>n.toUpperCase()+i)}function oD(t,e){const n=V.toCamelCase(" "+e);["get","set","has"].forEach(i=>{Object.defineProperty(t,i+n,{value:function(r,s,a){return this[i].call(this,e,r,s,a)},configurable:!0})})}class wd{constructor(e){e&&this.set(e)}set(e,n,i){const r=this;function s(o,l,c){const d=Aa(l);if(!d)throw new Error("header name must be a non-empty string");const u=V.findKey(r,d);(!u||r[u]===void 0||c===!0||c===void 0&&r[u]!==!1)&&(r[u||l]=Kc(o))}const a=(o,l)=>V.forEach(o,(c,d)=>s(c,d,l));if(V.isPlainObject(e)||e instanceof this.constructor)a(e,n);else if(V.isString(e)&&(e=e.trim())&&!rD(e))a(nD(e),n);else if(V.isHeaders(e))for(const[o,l]of e.entries())s(l,o,i);else e!=null&&s(n,e,i);return this}get(e,n){if(e=Aa(e),e){const i=V.findKey(this,e);if(i){const r=this[i];if(!n)return r;if(n===!0)return iD(r);if(V.isFunction(n))return n.call(this,r,i);if(V.isRegExp(n))return n.exec(r);throw new TypeError("parser must be boolean|regexp|function")}}}has(e,n){if(e=Aa(e),e){const i=V.findKey(this,e);return!!(i&&this[i]!==void 0&&(!n||Eh(this,this[i],i,n)))}return!1}delete(e,n){const i=this;let r=!1;function s(a){if(a=Aa(a),a){const o=V.findKey(i,a);o&&(!n||Eh(i,i[o],o,n))&&(delete i[o],r=!0)}}return V.isArray(e)?e.forEach(s):s(e),r}clear(e){const n=Object.keys(this);let i=n.length,r=!1;for(;i--;){const s=n[i];(!e||Eh(this,this[s],s,e,!0))&&(delete this[s],r=!0)}return r}normalize(e){const n=this,i={};return V.forEach(this,(r,s)=>{const a=V.findKey(i,s);if(a){n[a]=Kc(r),delete n[s];return}const o=e?sD(s):String(s).trim();o!==s&&delete n[s],n[o]=Kc(r),i[o]=!0}),this}concat(...e){return this.constructor.concat(this,...e)}toJSON(e){const n=Object.create(null);return V.forEach(this,(i,r)=>{i!=null&&i!==!1&&(n[r]=e&&V.isArray(i)?i.join(", "):i)}),n}[Symbol.iterator](){return Object.entries(this.toJSON())[Symbol.iterator]()}toString(){return Object.entries(this.toJSON()).map(([e,n])=>e+": "+n).join(`
`)}get[Symbol.toStringTag](){return"AxiosHeaders"}static from(e){return e instanceof this?e:new this(e)}static concat(e,...n){const i=new this(e);return n.forEach(r=>i.set(r)),i}static accessor(e){const i=(this[L0]=this[L0]={accessors:{}}).accessors,r=this.prototype;function s(a){const o=Aa(a);i[o]||(oD(r,a),i[o]=!0)}return V.isArray(e)?e.forEach(s):s(e),this}}wd.accessor(["Content-Type","Content-Length","Accept","Accept-Encoding","User-Agent","Authorization"]);V.reduceDescriptors(wd.prototype,({value:t},e)=>{let n=e[0].toUpperCase()+e.slice(1);return{get:()=>t,set(i){this[n]=i}}});V.freezeMethods(wd);const Vn=wd;function Th(t,e){const n=this||Km,i=e||n,r=Vn.from(i.headers);let s=i.data;return V.forEach(t,function(o){s=o.call(n,s,r.normalize(),e?e.status:void 0)}),r.normalize(),s}function zw(t){return!!(t&&t.__CANCEL__)}function fa(t,e,n){fe.call(this,t??"canceled",fe.ERR_CANCELED,e,n),this.name="CanceledError"}V.inherits(fa,fe,{__CANCEL__:!0});function Hw(t,e,n){const i=n.config.validateStatus;!n.status||!i||i(n.status)?t(n):e(new fe("Request failed with status code "+n.status,[fe.ERR_BAD_REQUEST,fe.ERR_BAD_RESPONSE][Math.floor(n.status/100)-4],n.config,n.request,n))}function aD(t){const e=/^([-+\w]{1,25})(:?\/\/|:)/.exec(t);return e&&e[1]||""}function lD(t,e){t=t||10;const n=new Array(t),i=new Array(t);let r=0,s=0,a;return e=e!==void 0?e:1e3,function(l){const c=Date.now(),d=i[s];a||(a=c),n[r]=l,i[r]=c;let u=s,m=0;for(;u!==r;)m+=n[u++],u=u%t;if(r=(r+1)%t,r===s&&(s=(s+1)%t),c-a<e)return;const v=d&&c-d;return v?Math.round(m*1e3/v):void 0}}function cD(t,e){let n=0,i=1e3/e,r,s;const a=(c,d=Date.now())=>{n=d,r=null,s&&(clearTimeout(s),s=null),t.apply(null,c)};return[(...c)=>{const d=Date.now(),u=d-n;u>=i?a(c,d):(r=c,s||(s=setTimeout(()=>{s=null,a(r)},i-u)))},()=>r&&a(r)]}const Fu=(t,e,n=3)=>{let i=0;const r=lD(50,250);return cD(s=>{const a=s.loaded,o=s.lengthComputable?s.total:void 0,l=a-i,c=r(l),d=a<=o;i=a;const u={loaded:a,total:o,progress:o?a/o:void 0,bytes:l,rate:c||void 0,estimated:c&&o&&d?(o-a)/c:void 0,event:s,lengthComputable:o!=null,[e?"download":"upload"]:!0};t(u)},n)},M0=(t,e)=>{const n=t!=null;return[i=>e[0]({lengthComputable:n,total:t,loaded:i}),e[1]]},D0=t=>(...e)=>V.asap(()=>t(...e)),uD=Et.hasStandardBrowserEnv?((t,e)=>n=>(n=new URL(n,Et.origin),t.protocol===n.protocol&&t.host===n.host&&(e||t.port===n.port)))(new URL(Et.origin),Et.navigator&&/(msie|trident)/i.test(Et.navigator.userAgent)):()=>!0,dD=Et.hasStandardBrowserEnv?{write(t,e,n,i,r,s){const a=[t+"="+encodeURIComponent(e)];V.isNumber(n)&&a.push("expires="+new Date(n).toGMTString()),V.isString(i)&&a.push("path="+i),V.isString(r)&&a.push("domain="+r),s===!0&&a.push("secure"),document.cookie=a.join("; ")},read(t){const e=document.cookie.match(new RegExp("(^|;\\s*)("+t+")=([^;]*)"));return e?decodeURIComponent(e[3]):null},remove(t){this.write(t,"",Date.now()-864e5)}}:{write(){},read(){return null},remove(){}};function hD(t){return/^([a-z][a-z\d+\-.]*:)?\/\//i.test(t)}function fD(t,e){return e?t.replace(/\/?\/$/,"")+"/"+e.replace(/^\/+/,""):t}function jw(t,e,n){let i=!hD(e);return t&&(i||n==!1)?fD(t,e):e}const A0=t=>t instanceof Vn?{...t}:t;function qs(t,e){e=e||{};const n={};function i(c,d,u,m){return V.isPlainObject(c)&&V.isPlainObject(d)?V.merge.call({caseless:m},c,d):V.isPlainObject(d)?V.merge({},d):V.isArray(d)?d.slice():d}function r(c,d,u,m){if(V.isUndefined(d)){if(!V.isUndefined(c))return i(void 0,c,u,m)}else return i(c,d,u,m)}function s(c,d){if(!V.isUndefined(d))return i(void 0,d)}function a(c,d){if(V.isUndefined(d)){if(!V.isUndefined(c))return i(void 0,c)}else return i(void 0,d)}function o(c,d,u){if(u in e)return i(c,d);if(u in t)return i(void 0,c)}const l={url:s,method:s,data:s,baseURL:a,transformRequest:a,transformResponse:a,paramsSerializer:a,timeout:a,timeoutMessage:a,withCredentials:a,withXSRFToken:a,adapter:a,responseType:a,xsrfCookieName:a,xsrfHeaderName:a,onUploadProgress:a,onDownloadProgress:a,decompress:a,maxContentLength:a,maxBodyLength:a,beforeRedirect:a,transport:a,httpAgent:a,httpsAgent:a,cancelToken:a,socketPath:a,responseEncoding:a,validateStatus:o,headers:(c,d,u)=>r(A0(c),A0(d),u,!0)};return V.forEach(Object.keys(Object.assign({},t,e)),function(d){const u=l[d]||r,m=u(t[d],e[d],d);V.isUndefined(m)&&u!==o||(n[d]=m)}),n}const Ww=t=>{const e=qs({},t);let{data:n,withXSRFToken:i,xsrfHeaderName:r,xsrfCookieName:s,headers:a,auth:o}=e;e.headers=a=Vn.from(a),e.url=Bw(jw(e.baseURL,e.url,e.allowAbsoluteUrls),t.params,t.paramsSerializer),o&&a.set("Authorization","Basic "+btoa((o.username||"")+":"+(o.password?unescape(encodeURIComponent(o.password)):"")));let l;if(V.isFormData(n)){if(Et.hasStandardBrowserEnv||Et.hasStandardBrowserWebWorkerEnv)a.setContentType(void 0);else if((l=a.getContentType())!==!1){const[c,...d]=l?l.split(";").map(u=>u.trim()).filter(Boolean):[];a.setContentType([c||"multipart/form-data",...d].join("; "))}}if(Et.hasStandardBrowserEnv&&(i&&V.isFunction(i)&&(i=i(e)),i||i!==!1&&uD(e.url))){const c=r&&s&&dD.read(s);c&&a.set(r,c)}return e},pD=typeof XMLHttpRequest<"u",mD=pD&&function(t){return new Promise(function(n,i){const r=Ww(t);let s=r.data;const a=Vn.from(r.headers).normalize();let{responseType:o,onUploadProgress:l,onDownloadProgress:c}=r,d,u,m,v,y;function _(){v&&v(),y&&y(),r.cancelToken&&r.cancelToken.unsubscribe(d),r.signal&&r.signal.removeEventListener("abort",d)}let p=new XMLHttpRequest;p.open(r.method.toUpperCase(),r.url,!0),p.timeout=r.timeout;function f(){if(!p)return;const g=Vn.from("getAllResponseHeaders"in p&&p.getAllResponseHeaders()),b={data:!o||o==="text"||o==="json"?p.responseText:p.response,status:p.status,statusText:p.statusText,headers:g,config:t,request:p};Hw(function(k){n(k),_()},function(k){i(k),_()},b),p=null}"onloadend"in p?p.onloadend=f:p.onreadystatechange=function(){!p||p.readyState!==4||p.status===0&&!(p.responseURL&&p.responseURL.indexOf("file:")===0)||setTimeout(f)},p.onabort=function(){p&&(i(new fe("Request aborted",fe.ECONNABORTED,t,p)),p=null)},p.onerror=function(){i(new fe("Network Error",fe.ERR_NETWORK,t,p)),p=null},p.ontimeout=function(){let S=r.timeout?"timeout of "+r.timeout+"ms exceeded":"timeout exceeded";const b=r.transitional||Fw;r.timeoutErrorMessage&&(S=r.timeoutErrorMessage),i(new fe(S,b.clarifyTimeoutError?fe.ETIMEDOUT:fe.ECONNABORTED,t,p)),p=null},s===void 0&&a.setContentType(null),"setRequestHeader"in p&&V.forEach(a.toJSON(),function(S,b){p.setRequestHeader(b,S)}),V.isUndefined(r.withCredentials)||(p.withCredentials=!!r.withCredentials),o&&o!=="json"&&(p.responseType=r.responseType),c&&([m,y]=Fu(c,!0),p.addEventListener("progress",m)),l&&p.upload&&([u,v]=Fu(l),p.upload.addEventListener("progress",u),p.upload.addEventListener("loadend",v)),(r.cancelToken||r.signal)&&(d=g=>{p&&(i(!g||g.type?new fa(null,t,p):g),p.abort(),p=null)},r.cancelToken&&r.cancelToken.subscribe(d),r.signal&&(r.signal.aborted?d():r.signal.addEventListener("abort",d)));const h=aD(r.url);if(h&&Et.protocols.indexOf(h)===-1){i(new fe("Unsupported protocol "+h+":",fe.ERR_BAD_REQUEST,t));return}p.send(s||null)})},gD=(t,e)=>{const{length:n}=t=t?t.filter(Boolean):[];if(e||n){let i=new AbortController,r;const s=function(c){if(!r){r=!0,o();const d=c instanceof Error?c:this.reason;i.abort(d instanceof fe?d:new fa(d instanceof Error?d.message:d))}};let a=e&&setTimeout(()=>{a=null,s(new fe(`timeout ${e} of ms exceeded`,fe.ETIMEDOUT))},e);const o=()=>{t&&(a&&clearTimeout(a),a=null,t.forEach(c=>{c.unsubscribe?c.unsubscribe(s):c.removeEventListener("abort",s)}),t=null)};t.forEach(c=>c.addEventListener("abort",s));const{signal:l}=i;return l.unsubscribe=()=>V.asap(o),l}},vD=gD,_D=function*(t,e){let n=t.byteLength;if(!e||n<e){yield t;return}let i=0,r;for(;i<n;)r=i+e,yield t.slice(i,r),i=r},yD=async function*(t,e){for await(const n of SD(t))yield*_D(n,e)},SD=async function*(t){if(t[Symbol.asyncIterator]){yield*t;return}const e=t.getReader();try{for(;;){const{done:n,value:i}=await e.read();if(n)break;yield i}}finally{await e.cancel()}},N0=(t,e,n,i)=>{const r=yD(t,e);let s=0,a,o=l=>{a||(a=!0,i&&i(l))};return new ReadableStream({async pull(l){try{const{done:c,value:d}=await r.next();if(c){o(),l.close();return}let u=d.byteLength;if(n){let m=s+=u;n(m)}l.enqueue(new Uint8Array(d))}catch(c){throw o(c),c}},cancel(l){return o(l),r.return()}},{highWaterMark:2})},kd=typeof fetch=="function"&&typeof Request=="function"&&typeof Response=="function",$w=kd&&typeof ReadableStream=="function",CD=kd&&(typeof TextEncoder=="function"?(t=>e=>t.encode(e))(new TextEncoder):async t=>new Uint8Array(await new Response(t).arrayBuffer())),Vw=(t,...e)=>{try{return!!t(...e)}catch{return!1}},bD=$w&&Vw(()=>{let t=!1;const e=new Request(Et.origin,{body:new ReadableStream,method:"POST",get duplex(){return t=!0,"half"}}).headers.has("Content-Type");return t&&!e}),B0=64*1024,mp=$w&&Vw(()=>V.isReadableStream(new Response("").body)),Uu={stream:mp&&(t=>t.body)};kd&&(t=>{["text","arrayBuffer","blob","formData","stream"].forEach(e=>{!Uu[e]&&(Uu[e]=V.isFunction(t[e])?n=>n[e]():(n,i)=>{throw new fe(`Response type '${e}' is not supported`,fe.ERR_NOT_SUPPORT,i)})})})(new Response);const wD=async t=>{if(t==null)return 0;if(V.isBlob(t))return t.size;if(V.isSpecCompliantForm(t))return(await new Request(Et.origin,{method:"POST",body:t}).arrayBuffer()).byteLength;if(V.isArrayBufferView(t)||V.isArrayBuffer(t))return t.byteLength;if(V.isURLSearchParams(t)&&(t=t+""),V.isString(t))return(await CD(t)).byteLength},kD=async(t,e)=>{const n=V.toFiniteNumber(t.getContentLength());return n??wD(e)},ED=kd&&(async t=>{let{url:e,method:n,data:i,signal:r,cancelToken:s,timeout:a,onDownloadProgress:o,onUploadProgress:l,responseType:c,headers:d,withCredentials:u="same-origin",fetchOptions:m}=Ww(t);c=c?(c+"").toLowerCase():"text";let v=vD([r,s&&s.toAbortSignal()],a),y;const _=v&&v.unsubscribe&&(()=>{v.unsubscribe()});let p;try{if(l&&bD&&n!=="get"&&n!=="head"&&(p=await kD(d,i))!==0){let b=new Request(e,{method:"POST",body:i,duplex:"half"}),w;if(V.isFormData(i)&&(w=b.headers.get("content-type"))&&d.setContentType(w),b.body){const[k,C]=M0(p,Fu(D0(l)));i=N0(b.body,B0,k,C)}}V.isString(u)||(u=u?"include":"omit");const f="credentials"in Request.prototype;y=new Request(e,{...m,signal:v,method:n.toUpperCase(),headers:d.normalize().toJSON(),body:i,duplex:"half",credentials:f?u:void 0});let h=await fetch(y);const g=mp&&(c==="stream"||c==="response");if(mp&&(o||g&&_)){const b={};["status","statusText","headers"].forEach(E=>{b[E]=h[E]});const w=V.toFiniteNumber(h.headers.get("content-length")),[k,C]=o&&M0(w,Fu(D0(o),!0))||[];h=new Response(N0(h.body,B0,k,()=>{C&&C(),_&&_()}),b)}c=c||"text";let S=await Uu[V.findKey(Uu,c)||"text"](h,t);return!g&&_&&_(),await new Promise((b,w)=>{Hw(b,w,{data:S,headers:Vn.from(h.headers),status:h.status,statusText:h.statusText,config:t,request:y})})}catch(f){throw _&&_(),f&&f.name==="TypeError"&&/fetch/i.test(f.message)?Object.assign(new fe("Network Error",fe.ERR_NETWORK,t,y),{cause:f.cause||f}):fe.from(f,f&&f.code,t,y)}}),gp={http:FM,xhr:mD,fetch:ED};V.forEach(gp,(t,e)=>{if(t){try{Object.defineProperty(t,"name",{value:e})}catch{}Object.defineProperty(t,"adapterName",{value:e})}});const F0=t=>`- ${t}`,TD=t=>V.isFunction(t)||t===null||t===!1,Gw={getAdapter:t=>{t=V.isArray(t)?t:[t];const{length:e}=t;let n,i;const r={};for(let s=0;s<e;s++){n=t[s];let a;if(i=n,!TD(n)&&(i=gp[(a=String(n)).toLowerCase()],i===void 0))throw new fe(`Unknown adapter '${a}'`);if(i)break;r[a||"#"+s]=i}if(!i){const s=Object.entries(r).map(([o,l])=>`adapter ${o} `+(l===!1?"is not supported by the environment":"is not available in the build"));let a=e?s.length>1?`since :
`+s.map(F0).join(`
`):" "+F0(s[0]):"as no adapter specified";throw new fe("There is no suitable adapter to dispatch the request "+a,"ERR_NOT_SUPPORT")}return i},adapters:gp};function Rh(t){if(t.cancelToken&&t.cancelToken.throwIfRequested(),t.signal&&t.signal.aborted)throw new fa(null,t)}function U0(t){return Rh(t),t.headers=Vn.from(t.headers),t.data=Th.call(t,t.transformRequest),["post","put","patch"].indexOf(t.method)!==-1&&t.headers.setContentType("application/x-www-form-urlencoded",!1),Gw.getAdapter(t.adapter||Km.adapter)(t).then(function(i){return Rh(t),i.data=Th.call(t,t.transformResponse,i),i.headers=Vn.from(i.headers),i},function(i){return zw(i)||(Rh(t),i&&i.response&&(i.response.data=Th.call(t,t.transformResponse,i.response),i.response.headers=Vn.from(i.response.headers))),Promise.reject(i)})}const qw="1.8.4",Ed={};["object","boolean","number","function","string","symbol"].forEach((t,e)=>{Ed[t]=function(i){return typeof i===t||"a"+(e<1?"n ":" ")+t}});const z0={};Ed.transitional=function(e,n,i){function r(s,a){return"[Axios v"+qw+"] Transitional option '"+s+"'"+a+(i?". "+i:"")}return(s,a,o)=>{if(e===!1)throw new fe(r(a," has been removed"+(n?" in "+n:"")),fe.ERR_DEPRECATED);return n&&!z0[a]&&(z0[a]=!0,console.warn(r(a," has been deprecated since v"+n+" and will be removed in the near future"))),e?e(s,a,o):!0}};Ed.spelling=function(e){return(n,i)=>(console.warn(`${i} is likely a misspelling of ${e}`),!0)};function RD(t,e,n){if(typeof t!="object")throw new fe("options must be an object",fe.ERR_BAD_OPTION_VALUE);const i=Object.keys(t);let r=i.length;for(;r-- >0;){const s=i[r],a=e[s];if(a){const o=t[s],l=o===void 0||a(o,s,t);if(l!==!0)throw new fe("option "+s+" must be "+l,fe.ERR_BAD_OPTION_VALUE);continue}if(n!==!0)throw new fe("Unknown option "+s,fe.ERR_BAD_OPTION)}}const Qc={assertOptions:RD,validators:Ed},Yn=Qc.validators;class zu{constructor(e){this.defaults=e,this.interceptors={request:new I0,response:new I0}}async request(e,n){try{return await this._request(e,n)}catch(i){if(i instanceof Error){let r={};Error.captureStackTrace?Error.captureStackTrace(r):r=new Error;const s=r.stack?r.stack.replace(/^.+\n/,""):"";try{i.stack?s&&!String(i.stack).endsWith(s.replace(/^.+\n.+\n/,""))&&(i.stack+=`
`+s):i.stack=s}catch{}}throw i}}_request(e,n){typeof e=="string"?(n=n||{},n.url=e):n=e||{},n=qs(this.defaults,n);const{transitional:i,paramsSerializer:r,headers:s}=n;i!==void 0&&Qc.assertOptions(i,{silentJSONParsing:Yn.transitional(Yn.boolean),forcedJSONParsing:Yn.transitional(Yn.boolean),clarifyTimeoutError:Yn.transitional(Yn.boolean)},!1),r!=null&&(V.isFunction(r)?n.paramsSerializer={serialize:r}:Qc.assertOptions(r,{encode:Yn.function,serialize:Yn.function},!0)),n.allowAbsoluteUrls!==void 0||(this.defaults.allowAbsoluteUrls!==void 0?n.allowAbsoluteUrls=this.defaults.allowAbsoluteUrls:n.allowAbsoluteUrls=!0),Qc.assertOptions(n,{baseUrl:Yn.spelling("baseURL"),withXsrfToken:Yn.spelling("withXSRFToken")},!0),n.method=(n.method||this.defaults.method||"get").toLowerCase();let a=s&&V.merge(s.common,s[n.method]);s&&V.forEach(["delete","get","head","post","put","patch","common"],y=>{delete s[y]}),n.headers=Vn.concat(a,s);const o=[];let l=!0;this.interceptors.request.forEach(function(_){typeof _.runWhen=="function"&&_.runWhen(n)===!1||(l=l&&_.synchronous,o.unshift(_.fulfilled,_.rejected))});const c=[];this.interceptors.response.forEach(function(_){c.push(_.fulfilled,_.rejected)});let d,u=0,m;if(!l){const y=[U0.bind(this),void 0];for(y.unshift.apply(y,o),y.push.apply(y,c),m=y.length,d=Promise.resolve(n);u<m;)d=d.then(y[u++],y[u++]);return d}m=o.length;let v=n;for(u=0;u<m;){const y=o[u++],_=o[u++];try{v=y(v)}catch(p){_.call(this,p);break}}try{d=U0.call(this,v)}catch(y){return Promise.reject(y)}for(u=0,m=c.length;u<m;)d=d.then(c[u++],c[u++]);return d}getUri(e){e=qs(this.defaults,e);const n=jw(e.baseURL,e.url,e.allowAbsoluteUrls);return Bw(n,e.params,e.paramsSerializer)}}V.forEach(["delete","get","head","options"],function(e){zu.prototype[e]=function(n,i){return this.request(qs(i||{},{method:e,url:n,data:(i||{}).data}))}});V.forEach(["post","put","patch"],function(e){function n(i){return function(s,a,o){return this.request(qs(o||{},{method:e,headers:i?{"Content-Type":"multipart/form-data"}:{},url:s,data:a}))}}zu.prototype[e]=n(),zu.prototype[e+"Form"]=n(!0)});const Xc=zu;class Qm{constructor(e){if(typeof e!="function")throw new TypeError("executor must be a function.");let n;this.promise=new Promise(function(s){n=s});const i=this;this.promise.then(r=>{if(!i._listeners)return;let s=i._listeners.length;for(;s-- >0;)i._listeners[s](r);i._listeners=null}),this.promise.then=r=>{let s;const a=new Promise(o=>{i.subscribe(o),s=o}).then(r);return a.cancel=function(){i.unsubscribe(s)},a},e(function(s,a,o){i.reason||(i.reason=new fa(s,a,o),n(i.reason))})}throwIfRequested(){if(this.reason)throw this.reason}subscribe(e){if(this.reason){e(this.reason);return}this._listeners?this._listeners.push(e):this._listeners=[e]}unsubscribe(e){if(!this._listeners)return;const n=this._listeners.indexOf(e);n!==-1&&this._listeners.splice(n,1)}toAbortSignal(){const e=new AbortController,n=i=>{e.abort(i)};return this.subscribe(n),e.signal.unsubscribe=()=>this.unsubscribe(n),e.signal}static source(){let e;return{token:new Qm(function(r){e=r}),cancel:e}}}const xD=Qm;function PD(t){return function(n){return t.apply(null,n)}}function OD(t){return V.isObject(t)&&t.isAxiosError===!0}const vp={Continue:100,SwitchingProtocols:101,Processing:102,EarlyHints:103,Ok:200,Created:201,Accepted:202,NonAuthoritativeInformation:203,NoContent:204,ResetContent:205,PartialContent:206,MultiStatus:207,AlreadyReported:208,ImUsed:226,MultipleChoices:300,MovedPermanently:301,Found:302,SeeOther:303,NotModified:304,UseProxy:305,Unused:306,TemporaryRedirect:307,PermanentRedirect:308,BadRequest:400,Unauthorized:401,PaymentRequired:402,Forbidden:403,NotFound:404,MethodNotAllowed:405,NotAcceptable:406,ProxyAuthenticationRequired:407,RequestTimeout:408,Conflict:409,Gone:410,LengthRequired:411,PreconditionFailed:412,PayloadTooLarge:413,UriTooLong:414,UnsupportedMediaType:415,RangeNotSatisfiable:416,ExpectationFailed:417,ImATeapot:418,MisdirectedRequest:421,UnprocessableEntity:422,Locked:423,FailedDependency:424,TooEarly:425,UpgradeRequired:426,PreconditionRequired:428,TooManyRequests:429,RequestHeaderFieldsTooLarge:431,UnavailableForLegalReasons:451,InternalServerError:500,NotImplemented:501,BadGateway:502,ServiceUnavailable:503,GatewayTimeout:504,HttpVersionNotSupported:505,VariantAlsoNegotiates:506,InsufficientStorage:507,LoopDetected:508,NotExtended:510,NetworkAuthenticationRequired:511};Object.entries(vp).forEach(([t,e])=>{vp[e]=t});const ID=vp;function Jw(t){const e=new Xc(t),n=Tw(Xc.prototype.request,e);return V.extend(n,Xc.prototype,e,{allOwnKeys:!0}),V.extend(n,e,null,{allOwnKeys:!0}),n.create=function(r){return Jw(qs(t,r))},n}const Xe=Jw(Km);Xe.Axios=Xc;Xe.CanceledError=fa;Xe.CancelToken=xD;Xe.isCancel=zw;Xe.VERSION=qw;Xe.toFormData=bd;Xe.AxiosError=fe;Xe.Cancel=Xe.CanceledError;Xe.all=function(e){return Promise.all(e)};Xe.spread=PD;Xe.isAxiosError=OD;Xe.mergeConfig=qs;Xe.AxiosHeaders=Vn;Xe.formToJSON=t=>Uw(V.isHTMLForm(t)?new FormData(t):t);Xe.getAdapter=Gw.getAdapter;Xe.HttpStatusCode=ID;Xe.default=Xe;const _s=Xe,LD="/api/livekit",MD=async(t,e)=>{try{return(await _s.post(`${LD}/token`,{roomName:t,participantName:e})).data.token}catch(n){throw console.error("Error fetching LiveKit token:",n),new Error("Failed to fetch room token")}},DD=({roomName:t,username:e})=>{const[n,i]=T.useState(""),[r,s]=T.useState("");return T.useEffect(()=>{(async()=>{try{if(t&&e){const o=await MD(t,e);i(o)}}catch(o){s("Failed to get room token. Please try again."),console.error("Error fetching token:",o)}})()},[t,e]),r?te.createElement("div",{className:"error-message"},r):n?te.createElement("div",{className:"video-chat-container"},te.createElement(VL,{video:!0,audio:!0,token:n,serverUrl:{}.VITE_LIVEKIT_SERVER_URL||"ws://localhost:7880","data-lk-theme":"default",style:{height:"100%",width:"100%"}},te.createElement(ZL,null),te.createElement(Ew,null))):te.createElement("div",null,"Loading...")},AD=()=>{const[t,e]=T.useState(!1),{localParticipant:n}=RI(),i=async()=>{if(n)if(t)n.tracks.forEach(r=>{r.track&&r.track.source===$.Source.ScreenShare&&(r.track.stop(),n.unpublishTrack(r.track))}),e(!1);else try{if(!(n!=null&&n.room)){console.error("Room not available");return}const r=await n.room.localParticipant.createScreenShareTrack({audio:!0,resolution:{width:1920,height:1080}});await n.publishTrack(r),e(!0)}catch(r){console.error("Error sharing screen:",r),e(!1)}};return te.createElement("button",{className:`screen-share-button ${t?"active":""}`,onClick:i,"aria-label":"Toggle screen sharing","aria-pressed":t},t?"Stop Sharing":"Share Screen")};function ND(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function H0(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function j0(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?H0(Object(n),!0).forEach(function(i){ND(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):H0(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function BD(t,e){if(t==null)return{};var n={},i=Object.keys(t),r,s;for(s=0;s<i.length;s++)r=i[s],!(e.indexOf(r)>=0)&&(n[r]=t[r]);return n}function FD(t,e){if(t==null)return{};var n=BD(t,e),i,r;if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(r=0;r<s.length;r++)i=s[r],!(e.indexOf(i)>=0)&&Object.prototype.propertyIsEnumerable.call(t,i)&&(n[i]=t[i])}return n}function UD(t,e){return zD(t)||HD(t,e)||jD(t,e)||WD()}function zD(t){if(Array.isArray(t))return t}function HD(t,e){if(!(typeof Symbol>"u"||!(Symbol.iterator in Object(t)))){var n=[],i=!0,r=!1,s=void 0;try{for(var a=t[Symbol.iterator](),o;!(i=(o=a.next()).done)&&(n.push(o.value),!(e&&n.length===e));i=!0);}catch(l){r=!0,s=l}finally{try{!i&&a.return!=null&&a.return()}finally{if(r)throw s}}return n}}function jD(t,e){if(t){if(typeof t=="string")return W0(t,e);var n=Object.prototype.toString.call(t).slice(8,-1);if(n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set")return Array.from(t);if(n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n))return W0(t,e)}}function W0(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=new Array(e);n<e;n++)i[n]=t[n];return i}function WD(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function $D(t,e,n){return e in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function $0(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function V0(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?$0(Object(n),!0).forEach(function(i){$D(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):$0(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function VD(){for(var t=arguments.length,e=new Array(t),n=0;n<t;n++)e[n]=arguments[n];return function(i){return e.reduceRight(function(r,s){return s(r)},i)}}function ja(t){return function e(){for(var n=this,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return r.length>=t.length?t.apply(this,r):function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return e.apply(n,[].concat(r,o))}}}function Hu(t){return{}.toString.call(t).includes("Object")}function GD(t){return!Object.keys(t).length}function Ml(t){return typeof t=="function"}function qD(t,e){return Object.prototype.hasOwnProperty.call(t,e)}function JD(t,e){return Hu(e)||rs("changeType"),Object.keys(e).some(function(n){return!qD(t,n)})&&rs("changeField"),e}function KD(t){Ml(t)||rs("selectorType")}function QD(t){Ml(t)||Hu(t)||rs("handlerType"),Hu(t)&&Object.values(t).some(function(e){return!Ml(e)})&&rs("handlersType")}function XD(t){t||rs("initialIsRequired"),Hu(t)||rs("initialType"),GD(t)&&rs("initialContent")}function YD(t,e){throw new Error(t[e]||t.default)}var ZD={initialIsRequired:"initial state is required",initialType:"initial state should be an object",initialContent:"initial state shouldn't be an empty object",handlerType:"handler should be an object or a function",handlersType:"all handlers should be a functions",selectorType:"selector should be a function",changeType:"provided value of changes should be an object",changeField:'it seams you want to change a field in the state which is not specified in the "initial" state',default:"an unknown error accured in `state-local` package"},rs=ja(YD)(ZD),Sc={changes:JD,selector:KD,handler:QD,initial:XD};function eA(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{};Sc.initial(t),Sc.handler(e);var n={current:t},i=ja(iA)(n,e),r=ja(nA)(n),s=ja(Sc.changes)(t),a=ja(tA)(n);function o(){var c=arguments.length>0&&arguments[0]!==void 0?arguments[0]:function(d){return d};return Sc.selector(c),c(n.current)}function l(c){VD(i,r,s,a)(c)}return[o,l]}function tA(t,e){return Ml(e)?e(t.current):e}function nA(t,e){return t.current=V0(V0({},t.current),e),e}function iA(t,e,n){return Ml(e)?e(t.current):Object.keys(n).forEach(function(i){var r;return(r=e[i])===null||r===void 0?void 0:r.call(e,t.current[i])}),n}var rA={create:eA},sA={paths:{vs:"https://cdn.jsdelivr.net/npm/monaco-editor@0.52.2/min/vs"}};function oA(t){return function e(){for(var n=this,i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return r.length>=t.length?t.apply(this,r):function(){for(var a=arguments.length,o=new Array(a),l=0;l<a;l++)o[l]=arguments[l];return e.apply(n,[].concat(r,o))}}}function aA(t){return{}.toString.call(t).includes("Object")}function lA(t){return t||G0("configIsRequired"),aA(t)||G0("configType"),t.urls?(cA(),{paths:{vs:t.urls.monacoBase}}):t}function cA(){console.warn(Kw.deprecation)}function uA(t,e){throw new Error(t[e]||t.default)}var Kw={configIsRequired:"the configuration object is required",configType:"the configuration object should be an object",default:"an unknown error accured in `@monaco-editor/loader` package",deprecation:`Deprecation warning!
    You are using deprecated way of configuration.

    Instead of using
      monaco.config({ urls: { monacoBase: '...' } })
    use
      monaco.config({ paths: { vs: '...' } })

    For more please check the link https://github.com/suren-atoyan/monaco-loader#config
  `},G0=oA(uA)(Kw),dA={config:lA},hA=function(){for(var e=arguments.length,n=new Array(e),i=0;i<e;i++)n[i]=arguments[i];return function(r){return n.reduceRight(function(s,a){return a(s)},r)}};function Qw(t,e){return Object.keys(e).forEach(function(n){e[n]instanceof Object&&t[n]&&Object.assign(e[n],Qw(t[n],e[n]))}),j0(j0({},t),e)}var fA={type:"cancelation",msg:"operation is manually canceled"};function xh(t){var e=!1,n=new Promise(function(i,r){t.then(function(s){return e?r(fA):i(s)}),t.catch(r)});return n.cancel=function(){return e=!0},n}var pA=rA.create({config:sA,isInitialized:!1,resolve:null,reject:null,monaco:null}),Xw=UD(pA,2),ql=Xw[0],Td=Xw[1];function mA(t){var e=dA.config(t),n=e.monaco,i=FD(e,["monaco"]);Td(function(r){return{config:Qw(r.config,i),monaco:n}})}function gA(){var t=ql(function(e){var n=e.monaco,i=e.isInitialized,r=e.resolve;return{monaco:n,isInitialized:i,resolve:r}});if(!t.isInitialized){if(Td({isInitialized:!0}),t.monaco)return t.resolve(t.monaco),xh(Ph);if(window.monaco&&window.monaco.editor)return Yw(window.monaco),t.resolve(window.monaco),xh(Ph);hA(vA,yA)(SA)}return xh(Ph)}function vA(t){return document.body.appendChild(t)}function _A(t){var e=document.createElement("script");return t&&(e.src=t),e}function yA(t){var e=ql(function(i){var r=i.config,s=i.reject;return{config:r,reject:s}}),n=_A("".concat(e.config.paths.vs,"/loader.js"));return n.onload=function(){return t()},n.onerror=e.reject,n}function SA(){var t=ql(function(n){var i=n.config,r=n.resolve,s=n.reject;return{config:i,resolve:r,reject:s}}),e=window.require;e.config(t.config),e(["vs/editor/editor.main"],function(n){Yw(n),t.resolve(n)},function(n){t.reject(n)})}function Yw(t){ql().monaco||Td({monaco:t})}function CA(){return ql(function(t){var e=t.monaco;return e})}var Ph=new Promise(function(t,e){return Td({resolve:t,reject:e})}),ju={config:mA,init:gA,__getMonacoInstance:CA},bA={wrapper:{display:"flex",position:"relative",textAlign:"initial"},fullWidth:{width:"100%"},hide:{display:"none"}},Oh=bA,wA={container:{display:"flex",height:"100%",width:"100%",justifyContent:"center",alignItems:"center"}},kA=wA;function EA({children:t}){return te.createElement("div",{style:kA.container},t)}var TA=EA,RA=TA;function xA({width:t,height:e,isEditorReady:n,loading:i,_ref:r,className:s,wrapperProps:a}){return te.createElement("section",{style:{...Oh.wrapper,width:t,height:e},...a},!n&&te.createElement(RA,null,i),te.createElement("div",{ref:r,style:{...Oh.fullWidth,...!n&&Oh.hide},className:s}))}var PA=xA,Zw=T.memo(PA);function OA(t){T.useEffect(t,[])}var Xm=OA;function IA(t,e,n=!0){let i=T.useRef(!0);T.useEffect(i.current||!n?()=>{i.current=!1}:t,e)}var en=IA;function rl(){}function vo(t,e,n,i){return LA(t,i)||MA(t,e,n,i)}function LA(t,e){return t.editor.getModel(e1(t,e))}function MA(t,e,n,i){return t.editor.createModel(e,n,i?e1(t,i):void 0)}function e1(t,e){return t.Uri.parse(e)}function DA({original:t,modified:e,language:n,originalLanguage:i,modifiedLanguage:r,originalModelPath:s,modifiedModelPath:a,keepCurrentOriginalModel:o=!1,keepCurrentModifiedModel:l=!1,theme:c="light",loading:d="Loading...",options:u={},height:m="100%",width:v="100%",className:y,wrapperProps:_={},beforeMount:p=rl,onMount:f=rl}){let[h,g]=T.useState(!1),[S,b]=T.useState(!0),w=T.useRef(null),k=T.useRef(null),C=T.useRef(null),E=T.useRef(f),x=T.useRef(p),I=T.useRef(!1);Xm(()=>{let B=ju.init();return B.then(j=>(k.current=j)&&b(!1)).catch(j=>(j==null?void 0:j.type)!=="cancelation"&&console.error("Monaco initialization: error:",j)),()=>w.current?F():B.cancel()}),en(()=>{if(w.current&&k.current){let B=w.current.getOriginalEditor(),j=vo(k.current,t||"",i||n||"text",s||"");j!==B.getModel()&&B.setModel(j)}},[s],h),en(()=>{if(w.current&&k.current){let B=w.current.getModifiedEditor(),j=vo(k.current,e||"",r||n||"text",a||"");j!==B.getModel()&&B.setModel(j)}},[a],h),en(()=>{let B=w.current.getModifiedEditor();B.getOption(k.current.editor.EditorOption.readOnly)?B.setValue(e||""):e!==B.getValue()&&(B.executeEdits("",[{range:B.getModel().getFullModelRange(),text:e||"",forceMoveMarkers:!0}]),B.pushUndoStop())},[e],h),en(()=>{var B,j;(j=(B=w.current)==null?void 0:B.getModel())==null||j.original.setValue(t||"")},[t],h),en(()=>{let{original:B,modified:j}=w.current.getModel();k.current.editor.setModelLanguage(B,i||n||"text"),k.current.editor.setModelLanguage(j,r||n||"text")},[n,i,r],h),en(()=>{var B;(B=k.current)==null||B.editor.setTheme(c)},[c],h),en(()=>{var B;(B=w.current)==null||B.updateOptions(u)},[u],h);let A=T.useCallback(()=>{var X;if(!k.current)return;x.current(k.current);let B=vo(k.current,t||"",i||n||"text",s||""),j=vo(k.current,e||"",r||n||"text",a||"");(X=w.current)==null||X.setModel({original:B,modified:j})},[n,e,r,t,i,s,a]),P=T.useCallback(()=>{var B;!I.current&&C.current&&(w.current=k.current.editor.createDiffEditor(C.current,{automaticLayout:!0,...u}),A(),(B=k.current)==null||B.editor.setTheme(c),g(!0),I.current=!0)},[u,c,A]);T.useEffect(()=>{h&&E.current(w.current,k.current)},[h]),T.useEffect(()=>{!S&&!h&&P()},[S,h,P]);function F(){var j,X,U,R;let B=(j=w.current)==null?void 0:j.getModel();o||((X=B==null?void 0:B.original)==null||X.dispose()),l||((U=B==null?void 0:B.modified)==null||U.dispose()),(R=w.current)==null||R.dispose()}return te.createElement(Zw,{width:v,height:m,isEditorReady:h,loading:d,_ref:C,className:y,wrapperProps:_})}var AA=DA;T.memo(AA);function NA(){let[t,e]=T.useState(ju.__getMonacoInstance());return Xm(()=>{let n;return t||(n=ju.init(),n.then(i=>{e(i)})),()=>n==null?void 0:n.cancel()}),t}var BA=NA;function FA(t){let e=T.useRef();return T.useEffect(()=>{e.current=t},[t]),e.current}var UA=FA,Cc=new Map;function zA({defaultValue:t,defaultLanguage:e,defaultPath:n,value:i,language:r,path:s,theme:a="light",line:o,loading:l="Loading...",options:c={},overrideServices:d={},saveViewState:u=!0,keepCurrentModel:m=!1,width:v="100%",height:y="100%",className:_,wrapperProps:p={},beforeMount:f=rl,onMount:h=rl,onChange:g,onValidate:S=rl}){let[b,w]=T.useState(!1),[k,C]=T.useState(!0),E=T.useRef(null),x=T.useRef(null),I=T.useRef(null),A=T.useRef(h),P=T.useRef(f),F=T.useRef(),B=T.useRef(i),j=UA(s),X=T.useRef(!1),U=T.useRef(!1);Xm(()=>{let D=ju.init();return D.then(N=>(E.current=N)&&C(!1)).catch(N=>(N==null?void 0:N.type)!=="cancelation"&&console.error("Monaco initialization: error:",N)),()=>x.current?M():D.cancel()}),en(()=>{var N,q,ne,ce;let D=vo(E.current,t||i||"",e||r||"",s||n||"");D!==((N=x.current)==null?void 0:N.getModel())&&(u&&Cc.set(j,(q=x.current)==null?void 0:q.saveViewState()),(ne=x.current)==null||ne.setModel(D),u&&((ce=x.current)==null||ce.restoreViewState(Cc.get(s))))},[s],b),en(()=>{var D;(D=x.current)==null||D.updateOptions(c)},[c],b),en(()=>{!x.current||i===void 0||(x.current.getOption(E.current.editor.EditorOption.readOnly)?x.current.setValue(i):i!==x.current.getValue()&&(U.current=!0,x.current.executeEdits("",[{range:x.current.getModel().getFullModelRange(),text:i,forceMoveMarkers:!0}]),x.current.pushUndoStop(),U.current=!1))},[i],b),en(()=>{var N,q;let D=(N=x.current)==null?void 0:N.getModel();D&&r&&((q=E.current)==null||q.editor.setModelLanguage(D,r))},[r],b),en(()=>{var D;o!==void 0&&((D=x.current)==null||D.revealLine(o))},[o],b),en(()=>{var D;(D=E.current)==null||D.editor.setTheme(a)},[a],b);let R=T.useCallback(()=>{var D;if(!(!I.current||!E.current)&&!X.current){P.current(E.current);let N=s||n,q=vo(E.current,i||t||"",e||r||"",N||"");x.current=(D=E.current)==null?void 0:D.editor.create(I.current,{model:q,automaticLayout:!0,...c},d),u&&x.current.restoreViewState(Cc.get(N)),E.current.editor.setTheme(a),o!==void 0&&x.current.revealLine(o),w(!0),X.current=!0}},[t,e,n,i,r,s,c,d,u,a,o]);T.useEffect(()=>{b&&A.current(x.current,E.current)},[b]),T.useEffect(()=>{!k&&!b&&R()},[k,b,R]),B.current=i,T.useEffect(()=>{var D,N;b&&g&&((D=F.current)==null||D.dispose(),F.current=(N=x.current)==null?void 0:N.onDidChangeModelContent(q=>{U.current||g(x.current.getValue(),q)}))},[b,g]),T.useEffect(()=>{if(b){let D=E.current.editor.onDidChangeMarkers(N=>{var ne;let q=(ne=x.current.getModel())==null?void 0:ne.uri;if(q&&N.find(ce=>ce.path===q.path)){let ce=E.current.editor.getModelMarkers({resource:q});S==null||S(ce)}});return()=>{D==null||D.dispose()}}return()=>{}},[b,S]);function M(){var D,N;(D=F.current)==null||D.dispose(),m?u&&Cc.set(s,x.current.saveViewState()):(N=x.current.getModel())==null||N.dispose(),x.current.dispose()}return te.createElement(Zw,{width:v,height:y,isEditorReady:b,loading:l,_ref:I,className:_,wrapperProps:p})}var HA=zA,jA=T.memo(HA),WA=jA;const $A=t=>{t.editor.defineTheme("customDarkTheme",{base:"vs-dark",inherit:!0,rules:[],colors:{"editor.background":"#1e1e1e","editor.lineHighlightBackground":"#303030","editorCursor.foreground":"#a6a6a6","editor.selectionBackground":"#264f78","editor.inactiveSelectionBackground":"#3a3d41"}});const e={target:t.languages.typescript.ScriptTarget.ES2020,allowNonTsExtensions:!0,moduleResolution:t.languages.typescript.ModuleResolutionKind.NodeJs,module:t.languages.typescript.ModuleKind.ESNext,noEmit:!0,esModuleInterop:!0,jsx:t.languages.typescript.JsxEmit.React,reactNamespace:"React",allowJs:!0,typeRoots:["node_modules/@types"]};t.languages.typescript.javascriptDefaults.setCompilerOptions(e),t.languages.typescript.typescriptDefaults.setCompilerOptions(e);try{t.languages.typescript.javascriptDefaults.addExtraLib(`declare module 'react' {
        export interface Component<P = {}, S = {}> {}
        export function useState<T>(initialState: T | (() => T)): [T, (newState: T) => void];
        export function useEffect(effect: () => void | (() => void), deps?: readonly any[]): void;
        export function useRef<T>(initialValue: T): { current: T };
        export function useCallback<T extends (...args: any[]) => any>(callback: T, deps: readonly any[]): T;
        export function useMemo<T>(factory: () => T, deps: readonly any[]): T;
      }`,"node_modules/@types/react/index.d.ts")}catch(n){console.warn("Failed to load extra libraries for Monaco editor",n)}},VA=({language:t="javascript",value:e="",onChange:n,theme:i="vs-dark",readOnly:r=!1,filename:s="index.js"})=>{const a=T.useRef(null),o=BA(),[l,c]=T.useState(!1);T.useEffect(()=>{o&&($A(o),c(!0))},[o]),T.useEffect(()=>{s&&s.split(".").pop().toLowerCase()},[s]);const d=(u,m)=>{a.current=u,u.addCommand(m.KeyMod.CtrlCmd|m.KeyCode.KeyS,()=>{u.getValue(),console.log("Save triggered")})};return te.createElement("div",{className:"monaco-editor-container",style:{height:"100%",width:"100%"}},te.createElement(WA,{height:"100%",width:"100%",language:t,value:e,theme:i,onChange:n,onMount:d,options:{readOnly:r,minimap:{enabled:!0},scrollBeyondLastLine:!1,automaticLayout:!0,fontSize:14,lineNumbers:"on",folding:!0,formatOnPaste:!0,formatOnType:!0,suggestOnTriggerCharacters:!0,scrollbar:{verticalScrollbarSize:10,horizontalScrollbarSize:10}}}))};var t1={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(globalThis,()=>(()=>{var n={4567:function(a,o,l){var c=this&&this.__decorate||function(h,g,S,b){var w,k=arguments.length,C=k<3?g:b===null?b=Object.getOwnPropertyDescriptor(g,S):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(h,g,S,b);else for(var E=h.length-1;E>=0;E--)(w=h[E])&&(C=(k<3?w(C):k>3?w(g,S,C):w(g,S))||C);return k>3&&C&&Object.defineProperty(g,S,C),C},d=this&&this.__param||function(h,g){return function(S,b){g(S,b,h)}};Object.defineProperty(o,"__esModule",{value:!0}),o.AccessibilityManager=void 0;const u=l(9042),m=l(9924),v=l(844),y=l(4725),_=l(2585),p=l(3656);let f=o.AccessibilityManager=class extends v.Disposable{constructor(h,g,S,b){super(),this._terminal=h,this._coreBrowserService=S,this._renderService=b,this._rowColumns=new WeakMap,this._liveRegionLineCount=0,this._charsToConsume=[],this._charsToAnnounce="",this._accessibilityContainer=this._coreBrowserService.mainDocument.createElement("div"),this._accessibilityContainer.classList.add("xterm-accessibility"),this._rowContainer=this._coreBrowserService.mainDocument.createElement("div"),this._rowContainer.setAttribute("role","list"),this._rowContainer.classList.add("xterm-accessibility-tree"),this._rowElements=[];for(let w=0;w<this._terminal.rows;w++)this._rowElements[w]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[w]);if(this._topBoundaryFocusListener=w=>this._handleBoundaryFocus(w,0),this._bottomBoundaryFocusListener=w=>this._handleBoundaryFocus(w,1),this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions(),this._accessibilityContainer.appendChild(this._rowContainer),this._liveRegion=this._coreBrowserService.mainDocument.createElement("div"),this._liveRegion.classList.add("live-region"),this._liveRegion.setAttribute("aria-live","assertive"),this._accessibilityContainer.appendChild(this._liveRegion),this._liveRegionDebouncer=this.register(new m.TimeBasedDebouncer(this._renderRows.bind(this))),!this._terminal.element)throw new Error("Cannot enable accessibility before Terminal.open");this._terminal.element.insertAdjacentElement("afterbegin",this._accessibilityContainer),this.register(this._terminal.onResize(w=>this._handleResize(w.rows))),this.register(this._terminal.onRender(w=>this._refreshRows(w.start,w.end))),this.register(this._terminal.onScroll(()=>this._refreshRows())),this.register(this._terminal.onA11yChar(w=>this._handleChar(w))),this.register(this._terminal.onLineFeed(()=>this._handleChar(`
`))),this.register(this._terminal.onA11yTab(w=>this._handleTab(w))),this.register(this._terminal.onKey(w=>this._handleKey(w.key))),this.register(this._terminal.onBlur(()=>this._clearLiveRegion())),this.register(this._renderService.onDimensionsChange(()=>this._refreshRowsDimensions())),this.register((0,p.addDisposableDomListener)(document,"selectionchange",()=>this._handleSelectionChange())),this.register(this._coreBrowserService.onDprChange(()=>this._refreshRowsDimensions())),this._refreshRows(),this.register((0,v.toDisposable)(()=>{this._accessibilityContainer.remove(),this._rowElements.length=0}))}_handleTab(h){for(let g=0;g<h;g++)this._handleChar(" ")}_handleChar(h){this._liveRegionLineCount<21&&(this._charsToConsume.length>0?this._charsToConsume.shift()!==h&&(this._charsToAnnounce+=h):this._charsToAnnounce+=h,h===`
`&&(this._liveRegionLineCount++,this._liveRegionLineCount===21&&(this._liveRegion.textContent+=u.tooMuchOutput)))}_clearLiveRegion(){this._liveRegion.textContent="",this._liveRegionLineCount=0}_handleKey(h){this._clearLiveRegion(),/\p{Control}/u.test(h)||this._charsToConsume.push(h)}_refreshRows(h,g){this._liveRegionDebouncer.refresh(h,g,this._terminal.rows)}_renderRows(h,g){const S=this._terminal.buffer,b=S.lines.length.toString();for(let w=h;w<=g;w++){const k=S.lines.get(S.ydisp+w),C=[],E=(k==null?void 0:k.translateToString(!0,void 0,void 0,C))||"",x=(S.ydisp+w+1).toString(),I=this._rowElements[w];I&&(E.length===0?(I.innerText=" ",this._rowColumns.set(I,[0,1])):(I.textContent=E,this._rowColumns.set(I,C)),I.setAttribute("aria-posinset",x),I.setAttribute("aria-setsize",b))}this._announceCharacters()}_announceCharacters(){this._charsToAnnounce.length!==0&&(this._liveRegion.textContent+=this._charsToAnnounce,this._charsToAnnounce="")}_handleBoundaryFocus(h,g){const S=h.target,b=this._rowElements[g===0?1:this._rowElements.length-2];if(S.getAttribute("aria-posinset")===(g===0?"1":`${this._terminal.buffer.lines.length}`)||h.relatedTarget!==b)return;let w,k;if(g===0?(w=S,k=this._rowElements.pop(),this._rowContainer.removeChild(k)):(w=this._rowElements.shift(),k=S,this._rowContainer.removeChild(w)),w.removeEventListener("focus",this._topBoundaryFocusListener),k.removeEventListener("focus",this._bottomBoundaryFocusListener),g===0){const C=this._createAccessibilityTreeNode();this._rowElements.unshift(C),this._rowContainer.insertAdjacentElement("afterbegin",C)}else{const C=this._createAccessibilityTreeNode();this._rowElements.push(C),this._rowContainer.appendChild(C)}this._rowElements[0].addEventListener("focus",this._topBoundaryFocusListener),this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._terminal.scrollLines(g===0?-1:1),this._rowElements[g===0?1:this._rowElements.length-2].focus(),h.preventDefault(),h.stopImmediatePropagation()}_handleSelectionChange(){var E;if(this._rowElements.length===0)return;const h=document.getSelection();if(!h)return;if(h.isCollapsed)return void(this._rowContainer.contains(h.anchorNode)&&this._terminal.clearSelection());if(!h.anchorNode||!h.focusNode)return void console.error("anchorNode and/or focusNode are null");let g={node:h.anchorNode,offset:h.anchorOffset},S={node:h.focusNode,offset:h.focusOffset};if((g.node.compareDocumentPosition(S.node)&Node.DOCUMENT_POSITION_PRECEDING||g.node===S.node&&g.offset>S.offset)&&([g,S]=[S,g]),g.node.compareDocumentPosition(this._rowElements[0])&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_FOLLOWING)&&(g={node:this._rowElements[0].childNodes[0],offset:0}),!this._rowContainer.contains(g.node))return;const b=this._rowElements.slice(-1)[0];if(S.node.compareDocumentPosition(b)&(Node.DOCUMENT_POSITION_CONTAINED_BY|Node.DOCUMENT_POSITION_PRECEDING)&&(S={node:b,offset:((E=b.textContent)==null?void 0:E.length)??0}),!this._rowContainer.contains(S.node))return;const w=({node:x,offset:I})=>{const A=x instanceof Text?x.parentNode:x;let P=parseInt(A==null?void 0:A.getAttribute("aria-posinset"),10)-1;if(isNaN(P))return console.warn("row is invalid. Race condition?"),null;const F=this._rowColumns.get(A);if(!F)return console.warn("columns is null. Race condition?"),null;let B=I<F.length?F[I]:F.slice(-1)[0]+1;return B>=this._terminal.cols&&(++P,B=0),{row:P,column:B}},k=w(g),C=w(S);if(k&&C){if(k.row>C.row||k.row===C.row&&k.column>=C.column)throw new Error("invalid range");this._terminal.select(k.column,k.row,(C.row-k.row)*this._terminal.cols-k.column+C.column)}}_handleResize(h){this._rowElements[this._rowElements.length-1].removeEventListener("focus",this._bottomBoundaryFocusListener);for(let g=this._rowContainer.children.length;g<this._terminal.rows;g++)this._rowElements[g]=this._createAccessibilityTreeNode(),this._rowContainer.appendChild(this._rowElements[g]);for(;this._rowElements.length>h;)this._rowContainer.removeChild(this._rowElements.pop());this._rowElements[this._rowElements.length-1].addEventListener("focus",this._bottomBoundaryFocusListener),this._refreshRowsDimensions()}_createAccessibilityTreeNode(){const h=this._coreBrowserService.mainDocument.createElement("div");return h.setAttribute("role","listitem"),h.tabIndex=-1,this._refreshRowDimensions(h),h}_refreshRowsDimensions(){if(this._renderService.dimensions.css.cell.height){this._accessibilityContainer.style.width=`${this._renderService.dimensions.css.canvas.width}px`,this._rowElements.length!==this._terminal.rows&&this._handleResize(this._terminal.rows);for(let h=0;h<this._terminal.rows;h++)this._refreshRowDimensions(this._rowElements[h])}}_refreshRowDimensions(h){h.style.height=`${this._renderService.dimensions.css.cell.height}px`}};o.AccessibilityManager=f=c([d(1,_.IInstantiationService),d(2,y.ICoreBrowserService),d(3,y.IRenderService)],f)},3614:(a,o)=>{function l(m){return m.replace(/\r?\n/g,"\r")}function c(m,v){return v?"\x1B[200~"+m+"\x1B[201~":m}function d(m,v,y,_){m=c(m=l(m),y.decPrivateModes.bracketedPasteMode&&_.rawOptions.ignoreBracketedPasteMode!==!0),y.triggerDataEvent(m,!0),v.value=""}function u(m,v,y){const _=y.getBoundingClientRect(),p=m.clientX-_.left-10,f=m.clientY-_.top-10;v.style.width="20px",v.style.height="20px",v.style.left=`${p}px`,v.style.top=`${f}px`,v.style.zIndex="1000",v.focus()}Object.defineProperty(o,"__esModule",{value:!0}),o.rightClickHandler=o.moveTextAreaUnderMouseCursor=o.paste=o.handlePasteEvent=o.copyHandler=o.bracketTextForPaste=o.prepareTextForTerminal=void 0,o.prepareTextForTerminal=l,o.bracketTextForPaste=c,o.copyHandler=function(m,v){m.clipboardData&&m.clipboardData.setData("text/plain",v.selectionText),m.preventDefault()},o.handlePasteEvent=function(m,v,y,_){m.stopPropagation(),m.clipboardData&&d(m.clipboardData.getData("text/plain"),v,y,_)},o.paste=d,o.moveTextAreaUnderMouseCursor=u,o.rightClickHandler=function(m,v,y,_,p){u(m,v,y),p&&_.rightClickSelect(m),v.value=_.selectionText,v.select()}},7239:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorContrastCache=void 0;const c=l(1505);o.ColorContrastCache=class{constructor(){this._color=new c.TwoKeyMap,this._css=new c.TwoKeyMap}setCss(d,u,m){this._css.set(d,u,m)}getCss(d,u){return this._css.get(d,u)}setColor(d,u,m){this._color.set(d,u,m)}getColor(d,u){return this._color.get(d,u)}clear(){this._color.clear(),this._css.clear()}}},3656:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.addDisposableDomListener=void 0,o.addDisposableDomListener=function(l,c,d,u){l.addEventListener(c,d,u);let m=!1;return{dispose:()=>{m||(m=!0,l.removeEventListener(c,d,u))}}}},3551:function(a,o,l){var c=this&&this.__decorate||function(f,h,g,S){var b,w=arguments.length,k=w<3?h:S===null?S=Object.getOwnPropertyDescriptor(h,g):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(f,h,g,S);else for(var C=f.length-1;C>=0;C--)(b=f[C])&&(k=(w<3?b(k):w>3?b(h,g,k):b(h,g))||k);return w>3&&k&&Object.defineProperty(h,g,k),k},d=this&&this.__param||function(f,h){return function(g,S){h(g,S,f)}};Object.defineProperty(o,"__esModule",{value:!0}),o.Linkifier=void 0;const u=l(3656),m=l(8460),v=l(844),y=l(2585),_=l(4725);let p=o.Linkifier=class extends v.Disposable{get currentLink(){return this._currentLink}constructor(f,h,g,S,b){super(),this._element=f,this._mouseService=h,this._renderService=g,this._bufferService=S,this._linkProviderService=b,this._linkCacheDisposables=[],this._isMouseOut=!0,this._wasResized=!1,this._activeLine=-1,this._onShowLinkUnderline=this.register(new m.EventEmitter),this.onShowLinkUnderline=this._onShowLinkUnderline.event,this._onHideLinkUnderline=this.register(new m.EventEmitter),this.onHideLinkUnderline=this._onHideLinkUnderline.event,this.register((0,v.getDisposeArrayDisposable)(this._linkCacheDisposables)),this.register((0,v.toDisposable)(()=>{var w;this._lastMouseEvent=void 0,(w=this._activeProviderReplies)==null||w.clear()})),this.register(this._bufferService.onResize(()=>{this._clearCurrentLink(),this._wasResized=!0})),this.register((0,u.addDisposableDomListener)(this._element,"mouseleave",()=>{this._isMouseOut=!0,this._clearCurrentLink()})),this.register((0,u.addDisposableDomListener)(this._element,"mousemove",this._handleMouseMove.bind(this))),this.register((0,u.addDisposableDomListener)(this._element,"mousedown",this._handleMouseDown.bind(this))),this.register((0,u.addDisposableDomListener)(this._element,"mouseup",this._handleMouseUp.bind(this)))}_handleMouseMove(f){this._lastMouseEvent=f;const h=this._positionFromMouseEvent(f,this._element,this._mouseService);if(!h)return;this._isMouseOut=!1;const g=f.composedPath();for(let S=0;S<g.length;S++){const b=g[S];if(b.classList.contains("xterm"))break;if(b.classList.contains("xterm-hover"))return}this._lastBufferCell&&h.x===this._lastBufferCell.x&&h.y===this._lastBufferCell.y||(this._handleHover(h),this._lastBufferCell=h)}_handleHover(f){if(this._activeLine!==f.y||this._wasResized)return this._clearCurrentLink(),this._askForLink(f,!1),void(this._wasResized=!1);this._currentLink&&this._linkAtPosition(this._currentLink.link,f)||(this._clearCurrentLink(),this._askForLink(f,!0))}_askForLink(f,h){var S,b;this._activeProviderReplies&&h||((S=this._activeProviderReplies)==null||S.forEach(w=>{w==null||w.forEach(k=>{k.link.dispose&&k.link.dispose()})}),this._activeProviderReplies=new Map,this._activeLine=f.y);let g=!1;for(const[w,k]of this._linkProviderService.linkProviders.entries())h?(b=this._activeProviderReplies)!=null&&b.get(w)&&(g=this._checkLinkProviderResult(w,f,g)):k.provideLinks(f.y,C=>{var x,I;if(this._isMouseOut)return;const E=C==null?void 0:C.map(A=>({link:A}));(x=this._activeProviderReplies)==null||x.set(w,E),g=this._checkLinkProviderResult(w,f,g),((I=this._activeProviderReplies)==null?void 0:I.size)===this._linkProviderService.linkProviders.length&&this._removeIntersectingLinks(f.y,this._activeProviderReplies)})}_removeIntersectingLinks(f,h){const g=new Set;for(let S=0;S<h.size;S++){const b=h.get(S);if(b)for(let w=0;w<b.length;w++){const k=b[w],C=k.link.range.start.y<f?0:k.link.range.start.x,E=k.link.range.end.y>f?this._bufferService.cols:k.link.range.end.x;for(let x=C;x<=E;x++){if(g.has(x)){b.splice(w--,1);break}g.add(x)}}}}_checkLinkProviderResult(f,h,g){var w;if(!this._activeProviderReplies)return g;const S=this._activeProviderReplies.get(f);let b=!1;for(let k=0;k<f;k++)this._activeProviderReplies.has(k)&&!this._activeProviderReplies.get(k)||(b=!0);if(!b&&S){const k=S.find(C=>this._linkAtPosition(C.link,h));k&&(g=!0,this._handleNewLink(k))}if(this._activeProviderReplies.size===this._linkProviderService.linkProviders.length&&!g)for(let k=0;k<this._activeProviderReplies.size;k++){const C=(w=this._activeProviderReplies.get(k))==null?void 0:w.find(E=>this._linkAtPosition(E.link,h));if(C){g=!0,this._handleNewLink(C);break}}return g}_handleMouseDown(){this._mouseDownLink=this._currentLink}_handleMouseUp(f){if(!this._currentLink)return;const h=this._positionFromMouseEvent(f,this._element,this._mouseService);h&&this._mouseDownLink===this._currentLink&&this._linkAtPosition(this._currentLink.link,h)&&this._currentLink.link.activate(f,this._currentLink.link.text)}_clearCurrentLink(f,h){this._currentLink&&this._lastMouseEvent&&(!f||!h||this._currentLink.link.range.start.y>=f&&this._currentLink.link.range.end.y<=h)&&(this._linkLeave(this._element,this._currentLink.link,this._lastMouseEvent),this._currentLink=void 0,(0,v.disposeArray)(this._linkCacheDisposables))}_handleNewLink(f){if(!this._lastMouseEvent)return;const h=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);h&&this._linkAtPosition(f.link,h)&&(this._currentLink=f,this._currentLink.state={decorations:{underline:f.link.decorations===void 0||f.link.decorations.underline,pointerCursor:f.link.decorations===void 0||f.link.decorations.pointerCursor},isHovered:!0},this._linkHover(this._element,f.link,this._lastMouseEvent),f.link.decorations={},Object.defineProperties(f.link.decorations,{pointerCursor:{get:()=>{var g,S;return(S=(g=this._currentLink)==null?void 0:g.state)==null?void 0:S.decorations.pointerCursor},set:g=>{var S;(S=this._currentLink)!=null&&S.state&&this._currentLink.state.decorations.pointerCursor!==g&&(this._currentLink.state.decorations.pointerCursor=g,this._currentLink.state.isHovered&&this._element.classList.toggle("xterm-cursor-pointer",g))}},underline:{get:()=>{var g,S;return(S=(g=this._currentLink)==null?void 0:g.state)==null?void 0:S.decorations.underline},set:g=>{var S,b,w;(S=this._currentLink)!=null&&S.state&&((w=(b=this._currentLink)==null?void 0:b.state)==null?void 0:w.decorations.underline)!==g&&(this._currentLink.state.decorations.underline=g,this._currentLink.state.isHovered&&this._fireUnderlineEvent(f.link,g))}}}),this._linkCacheDisposables.push(this._renderService.onRenderedViewportChange(g=>{if(!this._currentLink)return;const S=g.start===0?0:g.start+1+this._bufferService.buffer.ydisp,b=this._bufferService.buffer.ydisp+1+g.end;if(this._currentLink.link.range.start.y>=S&&this._currentLink.link.range.end.y<=b&&(this._clearCurrentLink(S,b),this._lastMouseEvent)){const w=this._positionFromMouseEvent(this._lastMouseEvent,this._element,this._mouseService);w&&this._askForLink(w,!1)}})))}_linkHover(f,h,g){var S;(S=this._currentLink)!=null&&S.state&&(this._currentLink.state.isHovered=!0,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(h,!0),this._currentLink.state.decorations.pointerCursor&&f.classList.add("xterm-cursor-pointer")),h.hover&&h.hover(g,h.text)}_fireUnderlineEvent(f,h){const g=f.range,S=this._bufferService.buffer.ydisp,b=this._createLinkUnderlineEvent(g.start.x-1,g.start.y-S-1,g.end.x,g.end.y-S-1,void 0);(h?this._onShowLinkUnderline:this._onHideLinkUnderline).fire(b)}_linkLeave(f,h,g){var S;(S=this._currentLink)!=null&&S.state&&(this._currentLink.state.isHovered=!1,this._currentLink.state.decorations.underline&&this._fireUnderlineEvent(h,!1),this._currentLink.state.decorations.pointerCursor&&f.classList.remove("xterm-cursor-pointer")),h.leave&&h.leave(g,h.text)}_linkAtPosition(f,h){const g=f.range.start.y*this._bufferService.cols+f.range.start.x,S=f.range.end.y*this._bufferService.cols+f.range.end.x,b=h.y*this._bufferService.cols+h.x;return g<=b&&b<=S}_positionFromMouseEvent(f,h,g){const S=g.getCoords(f,h,this._bufferService.cols,this._bufferService.rows);if(S)return{x:S[0],y:S[1]+this._bufferService.buffer.ydisp}}_createLinkUnderlineEvent(f,h,g,S,b){return{x1:f,y1:h,x2:g,y2:S,cols:this._bufferService.cols,fg:b}}};o.Linkifier=p=c([d(1,_.IMouseService),d(2,_.IRenderService),d(3,y.IBufferService),d(4,_.ILinkProviderService)],p)},9042:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.tooMuchOutput=o.promptLabel=void 0,o.promptLabel="Terminal input",o.tooMuchOutput="Too much output to announce, navigate to rows manually to read"},3730:function(a,o,l){var c=this&&this.__decorate||function(_,p,f,h){var g,S=arguments.length,b=S<3?p:h===null?h=Object.getOwnPropertyDescriptor(p,f):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(_,p,f,h);else for(var w=_.length-1;w>=0;w--)(g=_[w])&&(b=(S<3?g(b):S>3?g(p,f,b):g(p,f))||b);return S>3&&b&&Object.defineProperty(p,f,b),b},d=this&&this.__param||function(_,p){return function(f,h){p(f,h,_)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OscLinkProvider=void 0;const u=l(511),m=l(2585);let v=o.OscLinkProvider=class{constructor(_,p,f){this._bufferService=_,this._optionsService=p,this._oscLinkService=f}provideLinks(_,p){var E;const f=this._bufferService.buffer.lines.get(_-1);if(!f)return void p(void 0);const h=[],g=this._optionsService.rawOptions.linkHandler,S=new u.CellData,b=f.getTrimmedLength();let w=-1,k=-1,C=!1;for(let x=0;x<b;x++)if(k!==-1||f.hasContent(x)){if(f.loadCell(x,S),S.hasExtendedAttrs()&&S.extended.urlId){if(k===-1){k=x,w=S.extended.urlId;continue}C=S.extended.urlId!==w}else k!==-1&&(C=!0);if(C||k!==-1&&x===b-1){const I=(E=this._oscLinkService.getLinkData(w))==null?void 0:E.uri;if(I){const A={start:{x:k+1,y:_},end:{x:x+(C||x!==b-1?0:1),y:_}};let P=!1;if(!(g!=null&&g.allowNonHttpProtocols))try{const F=new URL(I);["http:","https:"].includes(F.protocol)||(P=!0)}catch{P=!0}P||h.push({text:I,range:A,activate:(F,B)=>g?g.activate(F,B,A):y(0,B),hover:(F,B)=>{var j;return(j=g==null?void 0:g.hover)==null?void 0:j.call(g,F,B,A)},leave:(F,B)=>{var j;return(j=g==null?void 0:g.leave)==null?void 0:j.call(g,F,B,A)}})}C=!1,S.hasExtendedAttrs()&&S.extended.urlId?(k=x,w=S.extended.urlId):(k=-1,w=-1)}}p(h)}};function y(_,p){if(confirm(`Do you want to navigate to ${p}?

WARNING: This link could potentially be dangerous`)){const f=window.open();if(f){try{f.opener=null}catch{}f.location.href=p}else console.warn("Opening link blocked as opener could not be cleared")}}o.OscLinkProvider=v=c([d(0,m.IBufferService),d(1,m.IOptionsService),d(2,m.IOscLinkService)],v)},6193:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.RenderDebouncer=void 0,o.RenderDebouncer=class{constructor(l,c){this._renderCallback=l,this._coreBrowserService=c,this._refreshCallbacks=[]}dispose(){this._animationFrame&&(this._coreBrowserService.window.cancelAnimationFrame(this._animationFrame),this._animationFrame=void 0)}addRefreshCallback(l){return this._refreshCallbacks.push(l),this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh())),this._animationFrame}refresh(l,c,d){this._rowCount=d,l=l!==void 0?l:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c,this._animationFrame||(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._animationFrame=void 0,this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return void this._runRefreshCallbacks();const l=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,c),this._runRefreshCallbacks()}_runRefreshCallbacks(){for(const l of this._refreshCallbacks)l(0);this._refreshCallbacks=[]}}},3236:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Terminal=void 0;const c=l(3614),d=l(3656),u=l(3551),m=l(9042),v=l(3730),y=l(1680),_=l(3107),p=l(5744),f=l(2950),h=l(1296),g=l(428),S=l(4269),b=l(5114),w=l(8934),k=l(3230),C=l(9312),E=l(4725),x=l(6731),I=l(8055),A=l(8969),P=l(8460),F=l(844),B=l(6114),j=l(8437),X=l(2584),U=l(7399),R=l(5941),M=l(9074),D=l(2585),N=l(5435),q=l(4567),ne=l(779);class ce extends A.CoreTerminal{get onFocus(){return this._onFocus.event}get onBlur(){return this._onBlur.event}get onA11yChar(){return this._onA11yCharEmitter.event}get onA11yTab(){return this._onA11yTabEmitter.event}get onWillOpen(){return this._onWillOpen.event}constructor(z={}){super(z),this.browser=B,this._keyDownHandled=!1,this._keyDownSeen=!1,this._keyPressHandled=!1,this._unprocessedDeadKey=!1,this._accessibilityManager=this.register(new F.MutableDisposable),this._onCursorMove=this.register(new P.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onKey=this.register(new P.EventEmitter),this.onKey=this._onKey.event,this._onRender=this.register(new P.EventEmitter),this.onRender=this._onRender.event,this._onSelectionChange=this.register(new P.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onTitleChange=this.register(new P.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onBell=this.register(new P.EventEmitter),this.onBell=this._onBell.event,this._onFocus=this.register(new P.EventEmitter),this._onBlur=this.register(new P.EventEmitter),this._onA11yCharEmitter=this.register(new P.EventEmitter),this._onA11yTabEmitter=this.register(new P.EventEmitter),this._onWillOpen=this.register(new P.EventEmitter),this._setup(),this._decorationService=this._instantiationService.createInstance(M.DecorationService),this._instantiationService.setService(D.IDecorationService,this._decorationService),this._linkProviderService=this._instantiationService.createInstance(ne.LinkProviderService),this._instantiationService.setService(E.ILinkProviderService,this._linkProviderService),this._linkProviderService.registerLinkProvider(this._instantiationService.createInstance(v.OscLinkProvider)),this.register(this._inputHandler.onRequestBell(()=>this._onBell.fire())),this.register(this._inputHandler.onRequestRefreshRows((O,Y)=>this.refresh(O,Y))),this.register(this._inputHandler.onRequestSendFocus(()=>this._reportFocus())),this.register(this._inputHandler.onRequestReset(()=>this.reset())),this.register(this._inputHandler.onRequestWindowsOptionsReport(O=>this._reportWindowsOptions(O))),this.register(this._inputHandler.onColor(O=>this._handleColorEvent(O))),this.register((0,P.forwardEvent)(this._inputHandler.onCursorMove,this._onCursorMove)),this.register((0,P.forwardEvent)(this._inputHandler.onTitleChange,this._onTitleChange)),this.register((0,P.forwardEvent)(this._inputHandler.onA11yChar,this._onA11yCharEmitter)),this.register((0,P.forwardEvent)(this._inputHandler.onA11yTab,this._onA11yTabEmitter)),this.register(this._bufferService.onResize(O=>this._afterResize(O.cols,O.rows))),this.register((0,F.toDisposable)(()=>{var O,Y;this._customKeyEventHandler=void 0,(Y=(O=this.element)==null?void 0:O.parentNode)==null||Y.removeChild(this.element)}))}_handleColorEvent(z){if(this._themeService)for(const O of z){let Y,G="";switch(O.index){case 256:Y="foreground",G="10";break;case 257:Y="background",G="11";break;case 258:Y="cursor",G="12";break;default:Y="ansi",G="4;"+O.index}switch(O.type){case 0:const se=I.color.toColorRGB(Y==="ansi"?this._themeService.colors.ansi[O.index]:this._themeService.colors[Y]);this.coreService.triggerDataEvent(`${X.C0.ESC}]${G};${(0,R.toRgbString)(se)}${X.C1_ESCAPED.ST}`);break;case 1:if(Y==="ansi")this._themeService.modifyColors(ie=>ie.ansi[O.index]=I.channels.toColor(...O.color));else{const ie=Y;this._themeService.modifyColors(Se=>Se[ie]=I.channels.toColor(...O.color))}break;case 2:this._themeService.restoreColor(O.index)}}}_setup(){super._setup(),this._customKeyEventHandler=void 0}get buffer(){return this.buffers.active}focus(){this.textarea&&this.textarea.focus({preventScroll:!0})}_handleScreenReaderModeOptionChange(z){z?!this._accessibilityManager.value&&this._renderService&&(this._accessibilityManager.value=this._instantiationService.createInstance(q.AccessibilityManager,this)):this._accessibilityManager.clear()}_handleTextAreaFocus(z){this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(X.C0.ESC+"[I"),this.element.classList.add("focus"),this._showCursor(),this._onFocus.fire()}blur(){var z;return(z=this.textarea)==null?void 0:z.blur()}_handleTextAreaBlur(){this.textarea.value="",this.refresh(this.buffer.y,this.buffer.y),this.coreService.decPrivateModes.sendFocus&&this.coreService.triggerDataEvent(X.C0.ESC+"[O"),this.element.classList.remove("focus"),this._onBlur.fire()}_syncTextArea(){if(!this.textarea||!this.buffer.isCursorInViewport||this._compositionHelper.isComposing||!this._renderService)return;const z=this.buffer.ybase+this.buffer.y,O=this.buffer.lines.get(z);if(!O)return;const Y=Math.min(this.buffer.x,this.cols-1),G=this._renderService.dimensions.css.cell.height,se=O.getWidth(Y),ie=this._renderService.dimensions.css.cell.width*se,Se=this.buffer.y*this._renderService.dimensions.css.cell.height,Ue=Y*this._renderService.dimensions.css.cell.width;this.textarea.style.left=Ue+"px",this.textarea.style.top=Se+"px",this.textarea.style.width=ie+"px",this.textarea.style.height=G+"px",this.textarea.style.lineHeight=G+"px",this.textarea.style.zIndex="-5"}_initGlobal(){this._bindKeys(),this.register((0,d.addDisposableDomListener)(this.element,"copy",O=>{this.hasSelection()&&(0,c.copyHandler)(O,this._selectionService)}));const z=O=>(0,c.handlePasteEvent)(O,this.textarea,this.coreService,this.optionsService);this.register((0,d.addDisposableDomListener)(this.textarea,"paste",z)),this.register((0,d.addDisposableDomListener)(this.element,"paste",z)),B.isFirefox?this.register((0,d.addDisposableDomListener)(this.element,"mousedown",O=>{O.button===2&&(0,c.rightClickHandler)(O,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})):this.register((0,d.addDisposableDomListener)(this.element,"contextmenu",O=>{(0,c.rightClickHandler)(O,this.textarea,this.screenElement,this._selectionService,this.options.rightClickSelectsWord)})),B.isLinux&&this.register((0,d.addDisposableDomListener)(this.element,"auxclick",O=>{O.button===1&&(0,c.moveTextAreaUnderMouseCursor)(O,this.textarea,this.screenElement)}))}_bindKeys(){this.register((0,d.addDisposableDomListener)(this.textarea,"keyup",z=>this._keyUp(z),!0)),this.register((0,d.addDisposableDomListener)(this.textarea,"keydown",z=>this._keyDown(z),!0)),this.register((0,d.addDisposableDomListener)(this.textarea,"keypress",z=>this._keyPress(z),!0)),this.register((0,d.addDisposableDomListener)(this.textarea,"compositionstart",()=>this._compositionHelper.compositionstart())),this.register((0,d.addDisposableDomListener)(this.textarea,"compositionupdate",z=>this._compositionHelper.compositionupdate(z))),this.register((0,d.addDisposableDomListener)(this.textarea,"compositionend",()=>this._compositionHelper.compositionend())),this.register((0,d.addDisposableDomListener)(this.textarea,"input",z=>this._inputEvent(z),!0)),this.register(this.onRender(()=>this._compositionHelper.updateCompositionElements()))}open(z){var Y;if(!z)throw new Error("Terminal requires a parent element.");if(z.isConnected||this._logService.debug("Terminal.open was called on an element that was not attached to the DOM"),((Y=this.element)==null?void 0:Y.ownerDocument.defaultView)&&this._coreBrowserService)return void(this.element.ownerDocument.defaultView!==this._coreBrowserService.window&&(this._coreBrowserService.window=this.element.ownerDocument.defaultView));this._document=z.ownerDocument,this.options.documentOverride&&this.options.documentOverride instanceof Document&&(this._document=this.optionsService.rawOptions.documentOverride),this.element=this._document.createElement("div"),this.element.dir="ltr",this.element.classList.add("terminal"),this.element.classList.add("xterm"),z.appendChild(this.element);const O=this._document.createDocumentFragment();this._viewportElement=this._document.createElement("div"),this._viewportElement.classList.add("xterm-viewport"),O.appendChild(this._viewportElement),this._viewportScrollArea=this._document.createElement("div"),this._viewportScrollArea.classList.add("xterm-scroll-area"),this._viewportElement.appendChild(this._viewportScrollArea),this.screenElement=this._document.createElement("div"),this.screenElement.classList.add("xterm-screen"),this.register((0,d.addDisposableDomListener)(this.screenElement,"mousemove",G=>this.updateCursorStyle(G))),this._helperContainer=this._document.createElement("div"),this._helperContainer.classList.add("xterm-helpers"),this.screenElement.appendChild(this._helperContainer),O.appendChild(this.screenElement),this.textarea=this._document.createElement("textarea"),this.textarea.classList.add("xterm-helper-textarea"),this.textarea.setAttribute("aria-label",m.promptLabel),B.isChromeOS||this.textarea.setAttribute("aria-multiline","false"),this.textarea.setAttribute("autocorrect","off"),this.textarea.setAttribute("autocapitalize","off"),this.textarea.setAttribute("spellcheck","false"),this.textarea.tabIndex=0,this._coreBrowserService=this.register(this._instantiationService.createInstance(b.CoreBrowserService,this.textarea,z.ownerDocument.defaultView??window,this._document??typeof window<"u"?window.document:null)),this._instantiationService.setService(E.ICoreBrowserService,this._coreBrowserService),this.register((0,d.addDisposableDomListener)(this.textarea,"focus",G=>this._handleTextAreaFocus(G))),this.register((0,d.addDisposableDomListener)(this.textarea,"blur",()=>this._handleTextAreaBlur())),this._helperContainer.appendChild(this.textarea),this._charSizeService=this._instantiationService.createInstance(g.CharSizeService,this._document,this._helperContainer),this._instantiationService.setService(E.ICharSizeService,this._charSizeService),this._themeService=this._instantiationService.createInstance(x.ThemeService),this._instantiationService.setService(E.IThemeService,this._themeService),this._characterJoinerService=this._instantiationService.createInstance(S.CharacterJoinerService),this._instantiationService.setService(E.ICharacterJoinerService,this._characterJoinerService),this._renderService=this.register(this._instantiationService.createInstance(k.RenderService,this.rows,this.screenElement)),this._instantiationService.setService(E.IRenderService,this._renderService),this.register(this._renderService.onRenderedViewportChange(G=>this._onRender.fire(G))),this.onResize(G=>this._renderService.resize(G.cols,G.rows)),this._compositionView=this._document.createElement("div"),this._compositionView.classList.add("composition-view"),this._compositionHelper=this._instantiationService.createInstance(f.CompositionHelper,this.textarea,this._compositionView),this._helperContainer.appendChild(this._compositionView),this._mouseService=this._instantiationService.createInstance(w.MouseService),this._instantiationService.setService(E.IMouseService,this._mouseService),this.linkifier=this.register(this._instantiationService.createInstance(u.Linkifier,this.screenElement)),this.element.appendChild(O);try{this._onWillOpen.fire(this.element)}catch{}this._renderService.hasRenderer()||this._renderService.setRenderer(this._createRenderer()),this.viewport=this._instantiationService.createInstance(y.Viewport,this._viewportElement,this._viewportScrollArea),this.viewport.onRequestScrollLines(G=>this.scrollLines(G.amount,G.suppressScrollEvent,1)),this.register(this._inputHandler.onRequestSyncScrollBar(()=>this.viewport.syncScrollArea())),this.register(this.viewport),this.register(this.onCursorMove(()=>{this._renderService.handleCursorMove(),this._syncTextArea()})),this.register(this.onResize(()=>this._renderService.handleResize(this.cols,this.rows))),this.register(this.onBlur(()=>this._renderService.handleBlur())),this.register(this.onFocus(()=>this._renderService.handleFocus())),this.register(this._renderService.onDimensionsChange(()=>this.viewport.syncScrollArea())),this._selectionService=this.register(this._instantiationService.createInstance(C.SelectionService,this.element,this.screenElement,this.linkifier)),this._instantiationService.setService(E.ISelectionService,this._selectionService),this.register(this._selectionService.onRequestScrollLines(G=>this.scrollLines(G.amount,G.suppressScrollEvent))),this.register(this._selectionService.onSelectionChange(()=>this._onSelectionChange.fire())),this.register(this._selectionService.onRequestRedraw(G=>this._renderService.handleSelectionChanged(G.start,G.end,G.columnSelectMode))),this.register(this._selectionService.onLinuxMouseSelection(G=>{this.textarea.value=G,this.textarea.focus(),this.textarea.select()})),this.register(this._onScroll.event(G=>{this.viewport.syncScrollArea(),this._selectionService.refresh()})),this.register((0,d.addDisposableDomListener)(this._viewportElement,"scroll",()=>this._selectionService.refresh())),this.register(this._instantiationService.createInstance(_.BufferDecorationRenderer,this.screenElement)),this.register((0,d.addDisposableDomListener)(this.element,"mousedown",G=>this._selectionService.handleMouseDown(G))),this.coreMouseService.areMouseEventsActive?(this._selectionService.disable(),this.element.classList.add("enable-mouse-events")):this._selectionService.enable(),this.options.screenReaderMode&&(this._accessibilityManager.value=this._instantiationService.createInstance(q.AccessibilityManager,this)),this.register(this.optionsService.onSpecificOptionChange("screenReaderMode",G=>this._handleScreenReaderModeOptionChange(G))),this.options.overviewRulerWidth&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(p.OverviewRulerRenderer,this._viewportElement,this.screenElement))),this.optionsService.onSpecificOptionChange("overviewRulerWidth",G=>{!this._overviewRulerRenderer&&G&&this._viewportElement&&this.screenElement&&(this._overviewRulerRenderer=this.register(this._instantiationService.createInstance(p.OverviewRulerRenderer,this._viewportElement,this.screenElement)))}),this._charSizeService.measure(),this.refresh(0,this.rows-1),this._initGlobal(),this.bindMouse()}_createRenderer(){return this._instantiationService.createInstance(h.DomRenderer,this,this._document,this.element,this.screenElement,this._viewportElement,this._helperContainer,this.linkifier)}bindMouse(){const z=this,O=this.element;function Y(ie){const Se=z._mouseService.getMouseReportCoords(ie,z.screenElement);if(!Se)return!1;let Ue,ze;switch(ie.overrideType||ie.type){case"mousemove":ze=32,ie.buttons===void 0?(Ue=3,ie.button!==void 0&&(Ue=ie.button<3?ie.button:3)):Ue=1&ie.buttons?0:4&ie.buttons?1:2&ie.buttons?2:3;break;case"mouseup":ze=0,Ue=ie.button<3?ie.button:3;break;case"mousedown":ze=1,Ue=ie.button<3?ie.button:3;break;case"wheel":if(z._customWheelEventHandler&&z._customWheelEventHandler(ie)===!1||z.viewport.getLinesScrolled(ie)===0)return!1;ze=ie.deltaY<0?0:1,Ue=4;break;default:return!1}return!(ze===void 0||Ue===void 0||Ue>4)&&z.coreMouseService.triggerMouseEvent({col:Se.col,row:Se.row,x:Se.x,y:Se.y,button:Ue,action:ze,ctrl:ie.ctrlKey,alt:ie.altKey,shift:ie.shiftKey})}const G={mouseup:null,wheel:null,mousedrag:null,mousemove:null},se={mouseup:ie=>(Y(ie),ie.buttons||(this._document.removeEventListener("mouseup",G.mouseup),G.mousedrag&&this._document.removeEventListener("mousemove",G.mousedrag)),this.cancel(ie)),wheel:ie=>(Y(ie),this.cancel(ie,!0)),mousedrag:ie=>{ie.buttons&&Y(ie)},mousemove:ie=>{ie.buttons||Y(ie)}};this.register(this.coreMouseService.onProtocolChange(ie=>{ie?(this.optionsService.rawOptions.logLevel==="debug"&&this._logService.debug("Binding to mouse events:",this.coreMouseService.explainEvents(ie)),this.element.classList.add("enable-mouse-events"),this._selectionService.disable()):(this._logService.debug("Unbinding from mouse events."),this.element.classList.remove("enable-mouse-events"),this._selectionService.enable()),8&ie?G.mousemove||(O.addEventListener("mousemove",se.mousemove),G.mousemove=se.mousemove):(O.removeEventListener("mousemove",G.mousemove),G.mousemove=null),16&ie?G.wheel||(O.addEventListener("wheel",se.wheel,{passive:!1}),G.wheel=se.wheel):(O.removeEventListener("wheel",G.wheel),G.wheel=null),2&ie?G.mouseup||(G.mouseup=se.mouseup):(this._document.removeEventListener("mouseup",G.mouseup),G.mouseup=null),4&ie?G.mousedrag||(G.mousedrag=se.mousedrag):(this._document.removeEventListener("mousemove",G.mousedrag),G.mousedrag=null)})),this.coreMouseService.activeProtocol=this.coreMouseService.activeProtocol,this.register((0,d.addDisposableDomListener)(O,"mousedown",ie=>{if(ie.preventDefault(),this.focus(),this.coreMouseService.areMouseEventsActive&&!this._selectionService.shouldForceSelection(ie))return Y(ie),G.mouseup&&this._document.addEventListener("mouseup",G.mouseup),G.mousedrag&&this._document.addEventListener("mousemove",G.mousedrag),this.cancel(ie)})),this.register((0,d.addDisposableDomListener)(O,"wheel",ie=>{if(!G.wheel){if(this._customWheelEventHandler&&this._customWheelEventHandler(ie)===!1)return!1;if(!this.buffer.hasScrollback){const Se=this.viewport.getLinesScrolled(ie);if(Se===0)return;const Ue=X.C0.ESC+(this.coreService.decPrivateModes.applicationCursorKeys?"O":"[")+(ie.deltaY<0?"A":"B");let ze="";for(let Ut=0;Ut<Math.abs(Se);Ut++)ze+=Ue;return this.coreService.triggerDataEvent(ze,!0),this.cancel(ie,!0)}return this.viewport.handleWheel(ie)?this.cancel(ie):void 0}},{passive:!1})),this.register((0,d.addDisposableDomListener)(O,"touchstart",ie=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchStart(ie),this.cancel(ie)},{passive:!0})),this.register((0,d.addDisposableDomListener)(O,"touchmove",ie=>{if(!this.coreMouseService.areMouseEventsActive)return this.viewport.handleTouchMove(ie)?void 0:this.cancel(ie)},{passive:!1}))}refresh(z,O){var Y;(Y=this._renderService)==null||Y.refreshRows(z,O)}updateCursorStyle(z){var O;(O=this._selectionService)!=null&&O.shouldColumnSelect(z)?this.element.classList.add("column-select"):this.element.classList.remove("column-select")}_showCursor(){this.coreService.isCursorInitialized||(this.coreService.isCursorInitialized=!0,this.refresh(this.buffer.y,this.buffer.y))}scrollLines(z,O,Y=0){var G;Y===1?(super.scrollLines(z,O,Y),this.refresh(0,this.rows-1)):(G=this.viewport)==null||G.scrollLines(z)}paste(z){(0,c.paste)(z,this.textarea,this.coreService,this.optionsService)}attachCustomKeyEventHandler(z){this._customKeyEventHandler=z}attachCustomWheelEventHandler(z){this._customWheelEventHandler=z}registerLinkProvider(z){return this._linkProviderService.registerLinkProvider(z)}registerCharacterJoiner(z){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");const O=this._characterJoinerService.register(z);return this.refresh(0,this.rows-1),O}deregisterCharacterJoiner(z){if(!this._characterJoinerService)throw new Error("Terminal must be opened first");this._characterJoinerService.deregister(z)&&this.refresh(0,this.rows-1)}get markers(){return this.buffer.markers}registerMarker(z){return this.buffer.addMarker(this.buffer.ybase+this.buffer.y+z)}registerDecoration(z){return this._decorationService.registerDecoration(z)}hasSelection(){return!!this._selectionService&&this._selectionService.hasSelection}select(z,O,Y){this._selectionService.setSelection(z,O,Y)}getSelection(){return this._selectionService?this._selectionService.selectionText:""}getSelectionPosition(){if(this._selectionService&&this._selectionService.hasSelection)return{start:{x:this._selectionService.selectionStart[0],y:this._selectionService.selectionStart[1]},end:{x:this._selectionService.selectionEnd[0],y:this._selectionService.selectionEnd[1]}}}clearSelection(){var z;(z=this._selectionService)==null||z.clearSelection()}selectAll(){var z;(z=this._selectionService)==null||z.selectAll()}selectLines(z,O){var Y;(Y=this._selectionService)==null||Y.selectLines(z,O)}_keyDown(z){if(this._keyDownHandled=!1,this._keyDownSeen=!0,this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1)return!1;const O=this.browser.isMac&&this.options.macOptionIsMeta&&z.altKey;if(!O&&!this._compositionHelper.keydown(z))return this.options.scrollOnUserInput&&this.buffer.ybase!==this.buffer.ydisp&&this.scrollToBottom(),!1;O||z.key!=="Dead"&&z.key!=="AltGraph"||(this._unprocessedDeadKey=!0);const Y=(0,U.evaluateKeyboardEvent)(z,this.coreService.decPrivateModes.applicationCursorKeys,this.browser.isMac,this.options.macOptionIsMeta);if(this.updateCursorStyle(z),Y.type===3||Y.type===2){const G=this.rows-1;return this.scrollLines(Y.type===2?-G:G),this.cancel(z,!0)}return Y.type===1&&this.selectAll(),!!this._isThirdLevelShift(this.browser,z)||(Y.cancel&&this.cancel(z,!0),!Y.key||!!(z.key&&!z.ctrlKey&&!z.altKey&&!z.metaKey&&z.key.length===1&&z.key.charCodeAt(0)>=65&&z.key.charCodeAt(0)<=90)||(this._unprocessedDeadKey?(this._unprocessedDeadKey=!1,!0):(Y.key!==X.C0.ETX&&Y.key!==X.C0.CR||(this.textarea.value=""),this._onKey.fire({key:Y.key,domEvent:z}),this._showCursor(),this.coreService.triggerDataEvent(Y.key,!0),!this.optionsService.rawOptions.screenReaderMode||z.altKey||z.ctrlKey?this.cancel(z,!0):void(this._keyDownHandled=!0))))}_isThirdLevelShift(z,O){const Y=z.isMac&&!this.options.macOptionIsMeta&&O.altKey&&!O.ctrlKey&&!O.metaKey||z.isWindows&&O.altKey&&O.ctrlKey&&!O.metaKey||z.isWindows&&O.getModifierState("AltGraph");return O.type==="keypress"?Y:Y&&(!O.keyCode||O.keyCode>47)}_keyUp(z){this._keyDownSeen=!1,this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1||(function(O){return O.keyCode===16||O.keyCode===17||O.keyCode===18}(z)||this.focus(),this.updateCursorStyle(z),this._keyPressHandled=!1)}_keyPress(z){let O;if(this._keyPressHandled=!1,this._keyDownHandled||this._customKeyEventHandler&&this._customKeyEventHandler(z)===!1)return!1;if(this.cancel(z),z.charCode)O=z.charCode;else if(z.which===null||z.which===void 0)O=z.keyCode;else{if(z.which===0||z.charCode===0)return!1;O=z.which}return!(!O||(z.altKey||z.ctrlKey||z.metaKey)&&!this._isThirdLevelShift(this.browser,z)||(O=String.fromCharCode(O),this._onKey.fire({key:O,domEvent:z}),this._showCursor(),this.coreService.triggerDataEvent(O,!0),this._keyPressHandled=!0,this._unprocessedDeadKey=!1,0))}_inputEvent(z){if(z.data&&z.inputType==="insertText"&&(!z.composed||!this._keyDownSeen)&&!this.optionsService.rawOptions.screenReaderMode){if(this._keyPressHandled)return!1;this._unprocessedDeadKey=!1;const O=z.data;return this.coreService.triggerDataEvent(O,!0),this.cancel(z),!0}return!1}resize(z,O){z!==this.cols||O!==this.rows?super.resize(z,O):this._charSizeService&&!this._charSizeService.hasValidSize&&this._charSizeService.measure()}_afterResize(z,O){var Y,G;(Y=this._charSizeService)==null||Y.measure(),(G=this.viewport)==null||G.syncScrollArea(!0)}clear(){var z;if(this.buffer.ybase!==0||this.buffer.y!==0){this.buffer.clearAllMarkers(),this.buffer.lines.set(0,this.buffer.lines.get(this.buffer.ybase+this.buffer.y)),this.buffer.lines.length=1,this.buffer.ydisp=0,this.buffer.ybase=0,this.buffer.y=0;for(let O=1;O<this.rows;O++)this.buffer.lines.push(this.buffer.getBlankLine(j.DEFAULT_ATTR_DATA));this._onScroll.fire({position:this.buffer.ydisp,source:0}),(z=this.viewport)==null||z.reset(),this.refresh(0,this.rows-1)}}reset(){var O,Y;this.options.rows=this.rows,this.options.cols=this.cols;const z=this._customKeyEventHandler;this._setup(),super.reset(),(O=this._selectionService)==null||O.reset(),this._decorationService.reset(),(Y=this.viewport)==null||Y.reset(),this._customKeyEventHandler=z,this.refresh(0,this.rows-1)}clearTextureAtlas(){var z;(z=this._renderService)==null||z.clearTextureAtlas()}_reportFocus(){var z;(z=this.element)!=null&&z.classList.contains("focus")?this.coreService.triggerDataEvent(X.C0.ESC+"[I"):this.coreService.triggerDataEvent(X.C0.ESC+"[O")}_reportWindowsOptions(z){if(this._renderService)switch(z){case N.WindowsOptionsReportType.GET_WIN_SIZE_PIXELS:const O=this._renderService.dimensions.css.canvas.width.toFixed(0),Y=this._renderService.dimensions.css.canvas.height.toFixed(0);this.coreService.triggerDataEvent(`${X.C0.ESC}[4;${Y};${O}t`);break;case N.WindowsOptionsReportType.GET_CELL_SIZE_PIXELS:const G=this._renderService.dimensions.css.cell.width.toFixed(0),se=this._renderService.dimensions.css.cell.height.toFixed(0);this.coreService.triggerDataEvent(`${X.C0.ESC}[6;${se};${G}t`)}}cancel(z,O){if(this.options.cancelEvents||O)return z.preventDefault(),z.stopPropagation(),!1}}o.Terminal=ce},9924:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TimeBasedDebouncer=void 0,o.TimeBasedDebouncer=class{constructor(l,c=1e3){this._renderCallback=l,this._debounceThresholdMS=c,this._lastRefreshMs=0,this._additionalRefreshRequested=!1}dispose(){this._refreshTimeoutID&&clearTimeout(this._refreshTimeoutID)}refresh(l,c,d){this._rowCount=d,l=l!==void 0?l:0,c=c!==void 0?c:this._rowCount-1,this._rowStart=this._rowStart!==void 0?Math.min(this._rowStart,l):l,this._rowEnd=this._rowEnd!==void 0?Math.max(this._rowEnd,c):c;const u=Date.now();if(u-this._lastRefreshMs>=this._debounceThresholdMS)this._lastRefreshMs=u,this._innerRefresh();else if(!this._additionalRefreshRequested){const m=u-this._lastRefreshMs,v=this._debounceThresholdMS-m;this._additionalRefreshRequested=!0,this._refreshTimeoutID=window.setTimeout(()=>{this._lastRefreshMs=Date.now(),this._innerRefresh(),this._additionalRefreshRequested=!1,this._refreshTimeoutID=void 0},v)}}_innerRefresh(){if(this._rowStart===void 0||this._rowEnd===void 0||this._rowCount===void 0)return;const l=Math.max(this._rowStart,0),c=Math.min(this._rowEnd,this._rowCount-1);this._rowStart=void 0,this._rowEnd=void 0,this._renderCallback(l,c)}}},1680:function(a,o,l){var c=this&&this.__decorate||function(f,h,g,S){var b,w=arguments.length,k=w<3?h:S===null?S=Object.getOwnPropertyDescriptor(h,g):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(f,h,g,S);else for(var C=f.length-1;C>=0;C--)(b=f[C])&&(k=(w<3?b(k):w>3?b(h,g,k):b(h,g))||k);return w>3&&k&&Object.defineProperty(h,g,k),k},d=this&&this.__param||function(f,h){return function(g,S){h(g,S,f)}};Object.defineProperty(o,"__esModule",{value:!0}),o.Viewport=void 0;const u=l(3656),m=l(4725),v=l(8460),y=l(844),_=l(2585);let p=o.Viewport=class extends y.Disposable{constructor(f,h,g,S,b,w,k,C){super(),this._viewportElement=f,this._scrollArea=h,this._bufferService=g,this._optionsService=S,this._charSizeService=b,this._renderService=w,this._coreBrowserService=k,this.scrollBarWidth=0,this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._wheelPartialScroll=0,this._refreshAnimationFrame=null,this._ignoreNextScrollEvent=!1,this._smoothScrollState={startTime:0,origin:-1,target:-1},this._onRequestScrollLines=this.register(new v.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this.scrollBarWidth=this._viewportElement.offsetWidth-this._scrollArea.offsetWidth||15,this.register((0,u.addDisposableDomListener)(this._viewportElement,"scroll",this._handleScroll.bind(this))),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(E=>this._activeBuffer=E.activeBuffer)),this._renderDimensions=this._renderService.dimensions,this.register(this._renderService.onDimensionsChange(E=>this._renderDimensions=E)),this._handleThemeChange(C.colors),this.register(C.onChangeColors(E=>this._handleThemeChange(E))),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.syncScrollArea())),setTimeout(()=>this.syncScrollArea())}_handleThemeChange(f){this._viewportElement.style.backgroundColor=f.background.css}reset(){this._currentRowHeight=0,this._currentDeviceCellHeight=0,this._lastRecordedBufferLength=0,this._lastRecordedViewportHeight=0,this._lastRecordedBufferHeight=0,this._lastTouchY=0,this._lastScrollTop=0,this._coreBrowserService.window.requestAnimationFrame(()=>this.syncScrollArea())}_refresh(f){if(f)return this._innerRefresh(),void(this._refreshAnimationFrame!==null&&this._coreBrowserService.window.cancelAnimationFrame(this._refreshAnimationFrame));this._refreshAnimationFrame===null&&(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._innerRefresh()))}_innerRefresh(){if(this._charSizeService.height>0){this._currentRowHeight=this._renderDimensions.device.cell.height/this._coreBrowserService.dpr,this._currentDeviceCellHeight=this._renderDimensions.device.cell.height,this._lastRecordedViewportHeight=this._viewportElement.offsetHeight;const h=Math.round(this._currentRowHeight*this._lastRecordedBufferLength)+(this._lastRecordedViewportHeight-this._renderDimensions.css.canvas.height);this._lastRecordedBufferHeight!==h&&(this._lastRecordedBufferHeight=h,this._scrollArea.style.height=this._lastRecordedBufferHeight+"px")}const f=this._bufferService.buffer.ydisp*this._currentRowHeight;this._viewportElement.scrollTop!==f&&(this._ignoreNextScrollEvent=!0,this._viewportElement.scrollTop=f),this._refreshAnimationFrame=null}syncScrollArea(f=!1){if(this._lastRecordedBufferLength!==this._bufferService.buffer.lines.length)return this._lastRecordedBufferLength=this._bufferService.buffer.lines.length,void this._refresh(f);this._lastRecordedViewportHeight===this._renderService.dimensions.css.canvas.height&&this._lastScrollTop===this._activeBuffer.ydisp*this._currentRowHeight&&this._renderDimensions.device.cell.height===this._currentDeviceCellHeight||this._refresh(f)}_handleScroll(f){if(this._lastScrollTop=this._viewportElement.scrollTop,!this._viewportElement.offsetParent)return;if(this._ignoreNextScrollEvent)return this._ignoreNextScrollEvent=!1,void this._onRequestScrollLines.fire({amount:0,suppressScrollEvent:!0});const h=Math.round(this._lastScrollTop/this._currentRowHeight)-this._bufferService.buffer.ydisp;this._onRequestScrollLines.fire({amount:h,suppressScrollEvent:!0})}_smoothScroll(){if(this._isDisposed||this._smoothScrollState.origin===-1||this._smoothScrollState.target===-1)return;const f=this._smoothScrollPercent();this._viewportElement.scrollTop=this._smoothScrollState.origin+Math.round(f*(this._smoothScrollState.target-this._smoothScrollState.origin)),f<1?this._coreBrowserService.window.requestAnimationFrame(()=>this._smoothScroll()):this._clearSmoothScrollState()}_smoothScrollPercent(){return this._optionsService.rawOptions.smoothScrollDuration&&this._smoothScrollState.startTime?Math.max(Math.min((Date.now()-this._smoothScrollState.startTime)/this._optionsService.rawOptions.smoothScrollDuration,1),0):1}_clearSmoothScrollState(){this._smoothScrollState.startTime=0,this._smoothScrollState.origin=-1,this._smoothScrollState.target=-1}_bubbleScroll(f,h){const g=this._viewportElement.scrollTop+this._lastRecordedViewportHeight;return!(h<0&&this._viewportElement.scrollTop!==0||h>0&&g<this._lastRecordedBufferHeight)||(f.cancelable&&f.preventDefault(),!1)}handleWheel(f){const h=this._getPixelsScrolled(f);return h!==0&&(this._optionsService.rawOptions.smoothScrollDuration?(this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target===-1?this._smoothScrollState.target=this._viewportElement.scrollTop+h:this._smoothScrollState.target+=h,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()):this._viewportElement.scrollTop+=h,this._bubbleScroll(f,h))}scrollLines(f){if(f!==0)if(this._optionsService.rawOptions.smoothScrollDuration){const h=f*this._currentRowHeight;this._smoothScrollState.startTime=Date.now(),this._smoothScrollPercent()<1?(this._smoothScrollState.origin=this._viewportElement.scrollTop,this._smoothScrollState.target=this._smoothScrollState.origin+h,this._smoothScrollState.target=Math.max(Math.min(this._smoothScrollState.target,this._viewportElement.scrollHeight),0),this._smoothScroll()):this._clearSmoothScrollState()}else this._onRequestScrollLines.fire({amount:f,suppressScrollEvent:!1})}_getPixelsScrolled(f){if(f.deltaY===0||f.shiftKey)return 0;let h=this._applyScrollModifier(f.deltaY,f);return f.deltaMode===WheelEvent.DOM_DELTA_LINE?h*=this._currentRowHeight:f.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(h*=this._currentRowHeight*this._bufferService.rows),h}getBufferElements(f,h){var C;let g,S="";const b=[],w=h??this._bufferService.buffer.lines.length,k=this._bufferService.buffer.lines;for(let E=f;E<w;E++){const x=k.get(E);if(!x)continue;const I=(C=k.get(E+1))==null?void 0:C.isWrapped;if(S+=x.translateToString(!I),!I||E===k.length-1){const A=document.createElement("div");A.textContent=S,b.push(A),S.length>0&&(g=A),S=""}}return{bufferElements:b,cursorElement:g}}getLinesScrolled(f){if(f.deltaY===0||f.shiftKey)return 0;let h=this._applyScrollModifier(f.deltaY,f);return f.deltaMode===WheelEvent.DOM_DELTA_PIXEL?(h/=this._currentRowHeight+0,this._wheelPartialScroll+=h,h=Math.floor(Math.abs(this._wheelPartialScroll))*(this._wheelPartialScroll>0?1:-1),this._wheelPartialScroll%=1):f.deltaMode===WheelEvent.DOM_DELTA_PAGE&&(h*=this._bufferService.rows),h}_applyScrollModifier(f,h){const g=this._optionsService.rawOptions.fastScrollModifier;return g==="alt"&&h.altKey||g==="ctrl"&&h.ctrlKey||g==="shift"&&h.shiftKey?f*this._optionsService.rawOptions.fastScrollSensitivity*this._optionsService.rawOptions.scrollSensitivity:f*this._optionsService.rawOptions.scrollSensitivity}handleTouchStart(f){this._lastTouchY=f.touches[0].pageY}handleTouchMove(f){const h=this._lastTouchY-f.touches[0].pageY;return this._lastTouchY=f.touches[0].pageY,h!==0&&(this._viewportElement.scrollTop+=h,this._bubbleScroll(f,h))}};o.Viewport=p=c([d(2,_.IBufferService),d(3,_.IOptionsService),d(4,m.ICharSizeService),d(5,m.IRenderService),d(6,m.ICoreBrowserService),d(7,m.IThemeService)],p)},3107:function(a,o,l){var c=this&&this.__decorate||function(_,p,f,h){var g,S=arguments.length,b=S<3?p:h===null?h=Object.getOwnPropertyDescriptor(p,f):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(_,p,f,h);else for(var w=_.length-1;w>=0;w--)(g=_[w])&&(b=(S<3?g(b):S>3?g(p,f,b):g(p,f))||b);return S>3&&b&&Object.defineProperty(p,f,b),b},d=this&&this.__param||function(_,p){return function(f,h){p(f,h,_)}};Object.defineProperty(o,"__esModule",{value:!0}),o.BufferDecorationRenderer=void 0;const u=l(4725),m=l(844),v=l(2585);let y=o.BufferDecorationRenderer=class extends m.Disposable{constructor(_,p,f,h,g){super(),this._screenElement=_,this._bufferService=p,this._coreBrowserService=f,this._decorationService=h,this._renderService=g,this._decorationElements=new Map,this._altBufferIsActive=!1,this._dimensionsChanged=!1,this._container=document.createElement("div"),this._container.classList.add("xterm-decoration-container"),this._screenElement.appendChild(this._container),this.register(this._renderService.onRenderedViewportChange(()=>this._doRefreshDecorations())),this.register(this._renderService.onDimensionsChange(()=>{this._dimensionsChanged=!0,this._queueRefresh()})),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._altBufferIsActive=this._bufferService.buffer===this._bufferService.buffers.alt})),this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh())),this.register(this._decorationService.onDecorationRemoved(S=>this._removeDecoration(S))),this.register((0,m.toDisposable)(()=>{this._container.remove(),this._decorationElements.clear()}))}_queueRefresh(){this._animationFrame===void 0&&(this._animationFrame=this._renderService.addRefreshCallback(()=>{this._doRefreshDecorations(),this._animationFrame=void 0}))}_doRefreshDecorations(){for(const _ of this._decorationService.decorations)this._renderDecoration(_);this._dimensionsChanged=!1}_renderDecoration(_){this._refreshStyle(_),this._dimensionsChanged&&this._refreshXPosition(_)}_createElement(_){var h;const p=this._coreBrowserService.mainDocument.createElement("div");p.classList.add("xterm-decoration"),p.classList.toggle("xterm-decoration-top-layer",((h=_==null?void 0:_.options)==null?void 0:h.layer)==="top"),p.style.width=`${Math.round((_.options.width||1)*this._renderService.dimensions.css.cell.width)}px`,p.style.height=(_.options.height||1)*this._renderService.dimensions.css.cell.height+"px",p.style.top=(_.marker.line-this._bufferService.buffers.active.ydisp)*this._renderService.dimensions.css.cell.height+"px",p.style.lineHeight=`${this._renderService.dimensions.css.cell.height}px`;const f=_.options.x??0;return f&&f>this._bufferService.cols&&(p.style.display="none"),this._refreshXPosition(_,p),p}_refreshStyle(_){const p=_.marker.line-this._bufferService.buffers.active.ydisp;if(p<0||p>=this._bufferService.rows)_.element&&(_.element.style.display="none",_.onRenderEmitter.fire(_.element));else{let f=this._decorationElements.get(_);f||(f=this._createElement(_),_.element=f,this._decorationElements.set(_,f),this._container.appendChild(f),_.onDispose(()=>{this._decorationElements.delete(_),f.remove()})),f.style.top=p*this._renderService.dimensions.css.cell.height+"px",f.style.display=this._altBufferIsActive?"none":"block",_.onRenderEmitter.fire(f)}}_refreshXPosition(_,p=_.element){if(!p)return;const f=_.options.x??0;(_.options.anchor||"left")==="right"?p.style.right=f?f*this._renderService.dimensions.css.cell.width+"px":"":p.style.left=f?f*this._renderService.dimensions.css.cell.width+"px":""}_removeDecoration(_){var p;(p=this._decorationElements.get(_))==null||p.remove(),this._decorationElements.delete(_),_.dispose()}};o.BufferDecorationRenderer=y=c([d(1,v.IBufferService),d(2,u.ICoreBrowserService),d(3,v.IDecorationService),d(4,u.IRenderService)],y)},5871:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ColorZoneStore=void 0,o.ColorZoneStore=class{constructor(){this._zones=[],this._zonePool=[],this._zonePoolIndex=0,this._linePadding={full:0,left:0,center:0,right:0}}get zones(){return this._zonePool.length=Math.min(this._zonePool.length,this._zones.length),this._zones}clear(){this._zones.length=0,this._zonePoolIndex=0}addDecoration(l){if(l.options.overviewRulerOptions){for(const c of this._zones)if(c.color===l.options.overviewRulerOptions.color&&c.position===l.options.overviewRulerOptions.position){if(this._lineIntersectsZone(c,l.marker.line))return;if(this._lineAdjacentToZone(c,l.marker.line,l.options.overviewRulerOptions.position))return void this._addLineToZone(c,l.marker.line)}if(this._zonePoolIndex<this._zonePool.length)return this._zonePool[this._zonePoolIndex].color=l.options.overviewRulerOptions.color,this._zonePool[this._zonePoolIndex].position=l.options.overviewRulerOptions.position,this._zonePool[this._zonePoolIndex].startBufferLine=l.marker.line,this._zonePool[this._zonePoolIndex].endBufferLine=l.marker.line,void this._zones.push(this._zonePool[this._zonePoolIndex++]);this._zones.push({color:l.options.overviewRulerOptions.color,position:l.options.overviewRulerOptions.position,startBufferLine:l.marker.line,endBufferLine:l.marker.line}),this._zonePool.push(this._zones[this._zones.length-1]),this._zonePoolIndex++}}setPadding(l){this._linePadding=l}_lineIntersectsZone(l,c){return c>=l.startBufferLine&&c<=l.endBufferLine}_lineAdjacentToZone(l,c,d){return c>=l.startBufferLine-this._linePadding[d||"full"]&&c<=l.endBufferLine+this._linePadding[d||"full"]}_addLineToZone(l,c){l.startBufferLine=Math.min(l.startBufferLine,c),l.endBufferLine=Math.max(l.endBufferLine,c)}}},5744:function(a,o,l){var c=this&&this.__decorate||function(g,S,b,w){var k,C=arguments.length,E=C<3?S:w===null?w=Object.getOwnPropertyDescriptor(S,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(g,S,b,w);else for(var x=g.length-1;x>=0;x--)(k=g[x])&&(E=(C<3?k(E):C>3?k(S,b,E):k(S,b))||E);return C>3&&E&&Object.defineProperty(S,b,E),E},d=this&&this.__param||function(g,S){return function(b,w){S(b,w,g)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OverviewRulerRenderer=void 0;const u=l(5871),m=l(4725),v=l(844),y=l(2585),_={full:0,left:0,center:0,right:0},p={full:0,left:0,center:0,right:0},f={full:0,left:0,center:0,right:0};let h=o.OverviewRulerRenderer=class extends v.Disposable{get _width(){return this._optionsService.options.overviewRulerWidth||0}constructor(g,S,b,w,k,C,E){var I;super(),this._viewportElement=g,this._screenElement=S,this._bufferService=b,this._decorationService=w,this._renderService=k,this._optionsService=C,this._coreBrowserService=E,this._colorZoneStore=new u.ColorZoneStore,this._shouldUpdateDimensions=!0,this._shouldUpdateAnchor=!0,this._lastKnownBufferLength=0,this._canvas=this._coreBrowserService.mainDocument.createElement("canvas"),this._canvas.classList.add("xterm-decoration-overview-ruler"),this._refreshCanvasDimensions(),(I=this._viewportElement.parentElement)==null||I.insertBefore(this._canvas,this._viewportElement);const x=this._canvas.getContext("2d");if(!x)throw new Error("Ctx cannot be null");this._ctx=x,this._registerDecorationListeners(),this._registerBufferChangeListeners(),this._registerDimensionChangeListeners(),this.register((0,v.toDisposable)(()=>{var A;(A=this._canvas)==null||A.remove()}))}_registerDecorationListeners(){this.register(this._decorationService.onDecorationRegistered(()=>this._queueRefresh(void 0,!0))),this.register(this._decorationService.onDecorationRemoved(()=>this._queueRefresh(void 0,!0)))}_registerBufferChangeListeners(){this.register(this._renderService.onRenderedViewportChange(()=>this._queueRefresh())),this.register(this._bufferService.buffers.onBufferActivate(()=>{this._canvas.style.display=this._bufferService.buffer===this._bufferService.buffers.alt?"none":"block"})),this.register(this._bufferService.onScroll(()=>{this._lastKnownBufferLength!==this._bufferService.buffers.normal.lines.length&&(this._refreshDrawHeightConstants(),this._refreshColorZonePadding())}))}_registerDimensionChangeListeners(){this.register(this._renderService.onRender(()=>{this._containerHeight&&this._containerHeight===this._screenElement.clientHeight||(this._queueRefresh(!0),this._containerHeight=this._screenElement.clientHeight)})),this.register(this._optionsService.onSpecificOptionChange("overviewRulerWidth",()=>this._queueRefresh(!0))),this.register(this._coreBrowserService.onDprChange(()=>this._queueRefresh(!0))),this._queueRefresh(!0)}_refreshDrawConstants(){const g=Math.floor(this._canvas.width/3),S=Math.ceil(this._canvas.width/3);p.full=this._canvas.width,p.left=g,p.center=S,p.right=g,this._refreshDrawHeightConstants(),f.full=0,f.left=0,f.center=p.left,f.right=p.left+p.center}_refreshDrawHeightConstants(){_.full=Math.round(2*this._coreBrowserService.dpr);const g=this._canvas.height/this._bufferService.buffer.lines.length,S=Math.round(Math.max(Math.min(g,12),6)*this._coreBrowserService.dpr);_.left=S,_.center=S,_.right=S}_refreshColorZonePadding(){this._colorZoneStore.setPadding({full:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.full),left:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.left),center:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.center),right:Math.floor(this._bufferService.buffers.active.lines.length/(this._canvas.height-1)*_.right)}),this._lastKnownBufferLength=this._bufferService.buffers.normal.lines.length}_refreshCanvasDimensions(){this._canvas.style.width=`${this._width}px`,this._canvas.width=Math.round(this._width*this._coreBrowserService.dpr),this._canvas.style.height=`${this._screenElement.clientHeight}px`,this._canvas.height=Math.round(this._screenElement.clientHeight*this._coreBrowserService.dpr),this._refreshDrawConstants(),this._refreshColorZonePadding()}_refreshDecorations(){this._shouldUpdateDimensions&&this._refreshCanvasDimensions(),this._ctx.clearRect(0,0,this._canvas.width,this._canvas.height),this._colorZoneStore.clear();for(const S of this._decorationService.decorations)this._colorZoneStore.addDecoration(S);this._ctx.lineWidth=1;const g=this._colorZoneStore.zones;for(const S of g)S.position!=="full"&&this._renderColorZone(S);for(const S of g)S.position==="full"&&this._renderColorZone(S);this._shouldUpdateDimensions=!1,this._shouldUpdateAnchor=!1}_renderColorZone(g){this._ctx.fillStyle=g.color,this._ctx.fillRect(f[g.position||"full"],Math.round((this._canvas.height-1)*(g.startBufferLine/this._bufferService.buffers.active.lines.length)-_[g.position||"full"]/2),p[g.position||"full"],Math.round((this._canvas.height-1)*((g.endBufferLine-g.startBufferLine)/this._bufferService.buffers.active.lines.length)+_[g.position||"full"]))}_queueRefresh(g,S){this._shouldUpdateDimensions=g||this._shouldUpdateDimensions,this._shouldUpdateAnchor=S||this._shouldUpdateAnchor,this._animationFrame===void 0&&(this._animationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>{this._refreshDecorations(),this._animationFrame=void 0}))}};o.OverviewRulerRenderer=h=c([d(2,y.IBufferService),d(3,y.IDecorationService),d(4,m.IRenderService),d(5,y.IOptionsService),d(6,m.ICoreBrowserService)],h)},2950:function(a,o,l){var c=this&&this.__decorate||function(_,p,f,h){var g,S=arguments.length,b=S<3?p:h===null?h=Object.getOwnPropertyDescriptor(p,f):h;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")b=Reflect.decorate(_,p,f,h);else for(var w=_.length-1;w>=0;w--)(g=_[w])&&(b=(S<3?g(b):S>3?g(p,f,b):g(p,f))||b);return S>3&&b&&Object.defineProperty(p,f,b),b},d=this&&this.__param||function(_,p){return function(f,h){p(f,h,_)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CompositionHelper=void 0;const u=l(4725),m=l(2585),v=l(2584);let y=o.CompositionHelper=class{get isComposing(){return this._isComposing}constructor(_,p,f,h,g,S){this._textarea=_,this._compositionView=p,this._bufferService=f,this._optionsService=h,this._coreService=g,this._renderService=S,this._isComposing=!1,this._isSendingComposition=!1,this._compositionPosition={start:0,end:0},this._dataAlreadySent=""}compositionstart(){this._isComposing=!0,this._compositionPosition.start=this._textarea.value.length,this._compositionView.textContent="",this._dataAlreadySent="",this._compositionView.classList.add("active")}compositionupdate(_){this._compositionView.textContent=_.data,this.updateCompositionElements(),setTimeout(()=>{this._compositionPosition.end=this._textarea.value.length},0)}compositionend(){this._finalizeComposition(!0)}keydown(_){if(this._isComposing||this._isSendingComposition){if(_.keyCode===229||_.keyCode===16||_.keyCode===17||_.keyCode===18)return!1;this._finalizeComposition(!1)}return _.keyCode!==229||(this._handleAnyTextareaChanges(),!1)}_finalizeComposition(_){if(this._compositionView.classList.remove("active"),this._isComposing=!1,_){const p={start:this._compositionPosition.start,end:this._compositionPosition.end};this._isSendingComposition=!0,setTimeout(()=>{if(this._isSendingComposition){let f;this._isSendingComposition=!1,p.start+=this._dataAlreadySent.length,f=this._isComposing?this._textarea.value.substring(p.start,p.end):this._textarea.value.substring(p.start),f.length>0&&this._coreService.triggerDataEvent(f,!0)}},0)}else{this._isSendingComposition=!1;const p=this._textarea.value.substring(this._compositionPosition.start,this._compositionPosition.end);this._coreService.triggerDataEvent(p,!0)}}_handleAnyTextareaChanges(){const _=this._textarea.value;setTimeout(()=>{if(!this._isComposing){const p=this._textarea.value,f=p.replace(_,"");this._dataAlreadySent=f,p.length>_.length?this._coreService.triggerDataEvent(f,!0):p.length<_.length?this._coreService.triggerDataEvent(`${v.C0.DEL}`,!0):p.length===_.length&&p!==_&&this._coreService.triggerDataEvent(p,!0)}},0)}updateCompositionElements(_){if(this._isComposing){if(this._bufferService.buffer.isCursorInViewport){const p=Math.min(this._bufferService.buffer.x,this._bufferService.cols-1),f=this._renderService.dimensions.css.cell.height,h=this._bufferService.buffer.y*this._renderService.dimensions.css.cell.height,g=p*this._renderService.dimensions.css.cell.width;this._compositionView.style.left=g+"px",this._compositionView.style.top=h+"px",this._compositionView.style.height=f+"px",this._compositionView.style.lineHeight=f+"px",this._compositionView.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._compositionView.style.fontSize=this._optionsService.rawOptions.fontSize+"px";const S=this._compositionView.getBoundingClientRect();this._textarea.style.left=g+"px",this._textarea.style.top=h+"px",this._textarea.style.width=Math.max(S.width,1)+"px",this._textarea.style.height=Math.max(S.height,1)+"px",this._textarea.style.lineHeight=S.height+"px"}_||setTimeout(()=>this.updateCompositionElements(!0),0)}}};o.CompositionHelper=y=c([d(2,m.IBufferService),d(3,m.IOptionsService),d(4,m.ICoreService),d(5,u.IRenderService)],y)},9806:(a,o)=>{function l(c,d,u){const m=u.getBoundingClientRect(),v=c.getComputedStyle(u),y=parseInt(v.getPropertyValue("padding-left")),_=parseInt(v.getPropertyValue("padding-top"));return[d.clientX-m.left-y,d.clientY-m.top-_]}Object.defineProperty(o,"__esModule",{value:!0}),o.getCoords=o.getCoordsRelativeToElement=void 0,o.getCoordsRelativeToElement=l,o.getCoords=function(c,d,u,m,v,y,_,p,f){if(!y)return;const h=l(c,d,u);return h?(h[0]=Math.ceil((h[0]+(f?_/2:0))/_),h[1]=Math.ceil(h[1]/p),h[0]=Math.min(Math.max(h[0],1),m+(f?1:0)),h[1]=Math.min(Math.max(h[1],1),v),h):void 0}},9504:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.moveToCellSequence=void 0;const c=l(2584);function d(p,f,h,g){const S=p-u(p,h),b=f-u(f,h),w=Math.abs(S-b)-function(k,C,E){let x=0;const I=k-u(k,E),A=C-u(C,E);for(let P=0;P<Math.abs(I-A);P++){const F=m(k,C)==="A"?-1:1,B=E.buffer.lines.get(I+F*P);B!=null&&B.isWrapped&&x++}return x}(p,f,h);return _(w,y(m(p,f),g))}function u(p,f){let h=0,g=f.buffer.lines.get(p),S=g==null?void 0:g.isWrapped;for(;S&&p>=0&&p<f.rows;)h++,g=f.buffer.lines.get(--p),S=g==null?void 0:g.isWrapped;return h}function m(p,f){return p>f?"A":"B"}function v(p,f,h,g,S,b){let w=p,k=f,C="";for(;w!==h||k!==g;)w+=S?1:-1,S&&w>b.cols-1?(C+=b.buffer.translateBufferLineToString(k,!1,p,w),w=0,p=0,k++):!S&&w<0&&(C+=b.buffer.translateBufferLineToString(k,!1,0,p+1),w=b.cols-1,p=w,k--);return C+b.buffer.translateBufferLineToString(k,!1,p,w)}function y(p,f){const h=f?"O":"[";return c.C0.ESC+h+p}function _(p,f){p=Math.floor(p);let h="";for(let g=0;g<p;g++)h+=f;return h}o.moveToCellSequence=function(p,f,h,g){const S=h.buffer.x,b=h.buffer.y;if(!h.buffer.hasScrollback)return function(C,E,x,I,A,P){return d(E,I,A,P).length===0?"":_(v(C,E,C,E-u(E,A),!1,A).length,y("D",P))}(S,b,0,f,h,g)+d(b,f,h,g)+function(C,E,x,I,A,P){let F;F=d(E,I,A,P).length>0?I-u(I,A):E;const B=I,j=function(X,U,R,M,D,N){let q;return q=d(R,M,D,N).length>0?M-u(M,D):U,X<R&&q<=M||X>=R&&q<M?"C":"D"}(C,E,x,I,A,P);return _(v(C,F,x,B,j==="C",A).length,y(j,P))}(S,b,p,f,h,g);let w;if(b===f)return w=S>p?"D":"C",_(Math.abs(S-p),y(w,g));w=b>f?"D":"C";const k=Math.abs(b-f);return _(function(C,E){return E.cols-C}(b>f?p:S,h)+(k-1)*h.cols+1+((b>f?S:p)-1),y(w,g))}},1296:function(a,o,l){var c=this&&this.__decorate||function(P,F,B,j){var X,U=arguments.length,R=U<3?F:j===null?j=Object.getOwnPropertyDescriptor(F,B):j;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")R=Reflect.decorate(P,F,B,j);else for(var M=P.length-1;M>=0;M--)(X=P[M])&&(R=(U<3?X(R):U>3?X(F,B,R):X(F,B))||R);return U>3&&R&&Object.defineProperty(F,B,R),R},d=this&&this.__param||function(P,F){return function(B,j){F(B,j,P)}};Object.defineProperty(o,"__esModule",{value:!0}),o.DomRenderer=void 0;const u=l(3787),m=l(2550),v=l(2223),y=l(6171),_=l(6052),p=l(4725),f=l(8055),h=l(8460),g=l(844),S=l(2585),b="xterm-dom-renderer-owner-",w="xterm-rows",k="xterm-fg-",C="xterm-bg-",E="xterm-focus",x="xterm-selection";let I=1,A=o.DomRenderer=class extends g.Disposable{constructor(P,F,B,j,X,U,R,M,D,N,q,ne,ce){super(),this._terminal=P,this._document=F,this._element=B,this._screenElement=j,this._viewportElement=X,this._helperContainer=U,this._linkifier2=R,this._charSizeService=D,this._optionsService=N,this._bufferService=q,this._coreBrowserService=ne,this._themeService=ce,this._terminalClass=I++,this._rowElements=[],this._selectionRenderModel=(0,_.createSelectionRenderModel)(),this.onRequestRedraw=this.register(new h.EventEmitter).event,this._rowContainer=this._document.createElement("div"),this._rowContainer.classList.add(w),this._rowContainer.style.lineHeight="normal",this._rowContainer.setAttribute("aria-hidden","true"),this._refreshRowElements(this._bufferService.cols,this._bufferService.rows),this._selectionContainer=this._document.createElement("div"),this._selectionContainer.classList.add(x),this._selectionContainer.setAttribute("aria-hidden","true"),this.dimensions=(0,y.createRenderDimensions)(),this._updateDimensions(),this.register(this._optionsService.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._themeService.onChangeColors(de=>this._injectCss(de))),this._injectCss(this._themeService.colors),this._rowFactory=M.createInstance(u.DomRendererRowFactory,document),this._element.classList.add(b+this._terminalClass),this._screenElement.appendChild(this._rowContainer),this._screenElement.appendChild(this._selectionContainer),this.register(this._linkifier2.onShowLinkUnderline(de=>this._handleLinkHover(de))),this.register(this._linkifier2.onHideLinkUnderline(de=>this._handleLinkLeave(de))),this.register((0,g.toDisposable)(()=>{this._element.classList.remove(b+this._terminalClass),this._rowContainer.remove(),this._selectionContainer.remove(),this._widthCache.dispose(),this._themeStyleElement.remove(),this._dimensionsStyleElement.remove()})),this._widthCache=new m.WidthCache(this._document,this._helperContainer),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}_updateDimensions(){const P=this._coreBrowserService.dpr;this.dimensions.device.char.width=this._charSizeService.width*P,this.dimensions.device.char.height=Math.ceil(this._charSizeService.height*P),this.dimensions.device.cell.width=this.dimensions.device.char.width+Math.round(this._optionsService.rawOptions.letterSpacing),this.dimensions.device.cell.height=Math.floor(this.dimensions.device.char.height*this._optionsService.rawOptions.lineHeight),this.dimensions.device.char.left=0,this.dimensions.device.char.top=0,this.dimensions.device.canvas.width=this.dimensions.device.cell.width*this._bufferService.cols,this.dimensions.device.canvas.height=this.dimensions.device.cell.height*this._bufferService.rows,this.dimensions.css.canvas.width=Math.round(this.dimensions.device.canvas.width/P),this.dimensions.css.canvas.height=Math.round(this.dimensions.device.canvas.height/P),this.dimensions.css.cell.width=this.dimensions.css.canvas.width/this._bufferService.cols,this.dimensions.css.cell.height=this.dimensions.css.canvas.height/this._bufferService.rows;for(const B of this._rowElements)B.style.width=`${this.dimensions.css.canvas.width}px`,B.style.height=`${this.dimensions.css.cell.height}px`,B.style.lineHeight=`${this.dimensions.css.cell.height}px`,B.style.overflow="hidden";this._dimensionsStyleElement||(this._dimensionsStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._dimensionsStyleElement));const F=`${this._terminalSelector} .${w} span { display: inline-block; height: 100%; vertical-align: top;}`;this._dimensionsStyleElement.textContent=F,this._selectionContainer.style.height=this._viewportElement.style.height,this._screenElement.style.width=`${this.dimensions.css.canvas.width}px`,this._screenElement.style.height=`${this.dimensions.css.canvas.height}px`}_injectCss(P){this._themeStyleElement||(this._themeStyleElement=this._document.createElement("style"),this._screenElement.appendChild(this._themeStyleElement));let F=`${this._terminalSelector} .${w} { color: ${P.foreground.css}; font-family: ${this._optionsService.rawOptions.fontFamily}; font-size: ${this._optionsService.rawOptions.fontSize}px; font-kerning: none; white-space: pre}`;F+=`${this._terminalSelector} .${w} .xterm-dim { color: ${f.color.multiplyOpacity(P.foreground,.5).css};}`,F+=`${this._terminalSelector} span:not(.xterm-bold) { font-weight: ${this._optionsService.rawOptions.fontWeight};}${this._terminalSelector} span.xterm-bold { font-weight: ${this._optionsService.rawOptions.fontWeightBold};}${this._terminalSelector} span.xterm-italic { font-style: italic;}`;const B=`blink_underline_${this._terminalClass}`,j=`blink_bar_${this._terminalClass}`,X=`blink_block_${this._terminalClass}`;F+=`@keyframes ${B} { 50% {  border-bottom-style: hidden; }}`,F+=`@keyframes ${j} { 50% {  box-shadow: none; }}`,F+=`@keyframes ${X} { 0% {  background-color: ${P.cursor.css};  color: ${P.cursorAccent.css}; } 50% {  background-color: inherit;  color: ${P.cursor.css}; }}`,F+=`${this._terminalSelector} .${w}.${E} .xterm-cursor.xterm-cursor-blink.xterm-cursor-underline { animation: ${B} 1s step-end infinite;}${this._terminalSelector} .${w}.${E} .xterm-cursor.xterm-cursor-blink.xterm-cursor-bar { animation: ${j} 1s step-end infinite;}${this._terminalSelector} .${w}.${E} .xterm-cursor.xterm-cursor-blink.xterm-cursor-block { animation: ${X} 1s step-end infinite;}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-block { background-color: ${P.cursor.css}; color: ${P.cursorAccent.css};}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-block:not(.xterm-cursor-blink) { background-color: ${P.cursor.css} !important; color: ${P.cursorAccent.css} !important;}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-outline { outline: 1px solid ${P.cursor.css}; outline-offset: -1px;}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-bar { box-shadow: ${this._optionsService.rawOptions.cursorWidth}px 0 0 ${P.cursor.css} inset;}${this._terminalSelector} .${w} .xterm-cursor.xterm-cursor-underline { border-bottom: 1px ${P.cursor.css}; border-bottom-style: solid; height: calc(100% - 1px);}`,F+=`${this._terminalSelector} .${x} { position: absolute; top: 0; left: 0; z-index: 1; pointer-events: none;}${this._terminalSelector}.focus .${x} div { position: absolute; background-color: ${P.selectionBackgroundOpaque.css};}${this._terminalSelector} .${x} div { position: absolute; background-color: ${P.selectionInactiveBackgroundOpaque.css};}`;for(const[U,R]of P.ansi.entries())F+=`${this._terminalSelector} .${k}${U} { color: ${R.css}; }${this._terminalSelector} .${k}${U}.xterm-dim { color: ${f.color.multiplyOpacity(R,.5).css}; }${this._terminalSelector} .${C}${U} { background-color: ${R.css}; }`;F+=`${this._terminalSelector} .${k}${v.INVERTED_DEFAULT_COLOR} { color: ${f.color.opaque(P.background).css}; }${this._terminalSelector} .${k}${v.INVERTED_DEFAULT_COLOR}.xterm-dim { color: ${f.color.multiplyOpacity(f.color.opaque(P.background),.5).css}; }${this._terminalSelector} .${C}${v.INVERTED_DEFAULT_COLOR} { background-color: ${P.foreground.css}; }`,this._themeStyleElement.textContent=F}_setDefaultSpacing(){const P=this.dimensions.css.cell.width-this._widthCache.get("W",!1,!1);this._rowContainer.style.letterSpacing=`${P}px`,this._rowFactory.defaultSpacing=P}handleDevicePixelRatioChange(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}_refreshRowElements(P,F){for(let B=this._rowElements.length;B<=F;B++){const j=this._document.createElement("div");this._rowContainer.appendChild(j),this._rowElements.push(j)}for(;this._rowElements.length>F;)this._rowContainer.removeChild(this._rowElements.pop())}handleResize(P,F){this._refreshRowElements(P,F),this._updateDimensions(),this.handleSelectionChanged(this._selectionRenderModel.selectionStart,this._selectionRenderModel.selectionEnd,this._selectionRenderModel.columnSelectMode)}handleCharSizeChanged(){this._updateDimensions(),this._widthCache.clear(),this._setDefaultSpacing()}handleBlur(){this._rowContainer.classList.remove(E),this.renderRows(0,this._bufferService.rows-1)}handleFocus(){this._rowContainer.classList.add(E),this.renderRows(this._bufferService.buffer.y,this._bufferService.buffer.y)}handleSelectionChanged(P,F,B){if(this._selectionContainer.replaceChildren(),this._rowFactory.handleSelectionChanged(P,F,B),this.renderRows(0,this._bufferService.rows-1),!P||!F)return;this._selectionRenderModel.update(this._terminal,P,F,B);const j=this._selectionRenderModel.viewportStartRow,X=this._selectionRenderModel.viewportEndRow,U=this._selectionRenderModel.viewportCappedStartRow,R=this._selectionRenderModel.viewportCappedEndRow;if(U>=this._bufferService.rows||R<0)return;const M=this._document.createDocumentFragment();if(B){const D=P[0]>F[0];M.appendChild(this._createSelectionElement(U,D?F[0]:P[0],D?P[0]:F[0],R-U+1))}else{const D=j===U?P[0]:0,N=U===X?F[0]:this._bufferService.cols;M.appendChild(this._createSelectionElement(U,D,N));const q=R-U-1;if(M.appendChild(this._createSelectionElement(U+1,0,this._bufferService.cols,q)),U!==R){const ne=X===R?F[0]:this._bufferService.cols;M.appendChild(this._createSelectionElement(R,0,ne))}}this._selectionContainer.appendChild(M)}_createSelectionElement(P,F,B,j=1){const X=this._document.createElement("div"),U=F*this.dimensions.css.cell.width;let R=this.dimensions.css.cell.width*(B-F);return U+R>this.dimensions.css.canvas.width&&(R=this.dimensions.css.canvas.width-U),X.style.height=j*this.dimensions.css.cell.height+"px",X.style.top=P*this.dimensions.css.cell.height+"px",X.style.left=`${U}px`,X.style.width=`${R}px`,X}handleCursorMove(){}_handleOptionsChanged(){this._updateDimensions(),this._injectCss(this._themeService.colors),this._widthCache.setFont(this._optionsService.rawOptions.fontFamily,this._optionsService.rawOptions.fontSize,this._optionsService.rawOptions.fontWeight,this._optionsService.rawOptions.fontWeightBold),this._setDefaultSpacing()}clear(){for(const P of this._rowElements)P.replaceChildren()}renderRows(P,F){const B=this._bufferService.buffer,j=B.ybase+B.y,X=Math.min(B.x,this._bufferService.cols-1),U=this._optionsService.rawOptions.cursorBlink,R=this._optionsService.rawOptions.cursorStyle,M=this._optionsService.rawOptions.cursorInactiveStyle;for(let D=P;D<=F;D++){const N=D+B.ydisp,q=this._rowElements[D],ne=B.lines.get(N);if(!q||!ne)break;q.replaceChildren(...this._rowFactory.createRow(ne,N,N===j,R,M,X,U,this.dimensions.css.cell.width,this._widthCache,-1,-1))}}get _terminalSelector(){return`.${b}${this._terminalClass}`}_handleLinkHover(P){this._setCellUnderline(P.x1,P.x2,P.y1,P.y2,P.cols,!0)}_handleLinkLeave(P){this._setCellUnderline(P.x1,P.x2,P.y1,P.y2,P.cols,!1)}_setCellUnderline(P,F,B,j,X,U){B<0&&(P=0),j<0&&(F=0);const R=this._bufferService.rows-1;B=Math.max(Math.min(B,R),0),j=Math.max(Math.min(j,R),0),X=Math.min(X,this._bufferService.cols);const M=this._bufferService.buffer,D=M.ybase+M.y,N=Math.min(M.x,X-1),q=this._optionsService.rawOptions.cursorBlink,ne=this._optionsService.rawOptions.cursorStyle,ce=this._optionsService.rawOptions.cursorInactiveStyle;for(let de=B;de<=j;++de){const z=de+M.ydisp,O=this._rowElements[de],Y=M.lines.get(z);if(!O||!Y)break;O.replaceChildren(...this._rowFactory.createRow(Y,z,z===D,ne,ce,N,q,this.dimensions.css.cell.width,this._widthCache,U?de===B?P:0:-1,U?(de===j?F:X)-1:-1))}}};o.DomRenderer=A=c([d(7,S.IInstantiationService),d(8,p.ICharSizeService),d(9,S.IOptionsService),d(10,S.IBufferService),d(11,p.ICoreBrowserService),d(12,p.IThemeService)],A)},3787:function(a,o,l){var c=this&&this.__decorate||function(w,k,C,E){var x,I=arguments.length,A=I<3?k:E===null?E=Object.getOwnPropertyDescriptor(k,C):E;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")A=Reflect.decorate(w,k,C,E);else for(var P=w.length-1;P>=0;P--)(x=w[P])&&(A=(I<3?x(A):I>3?x(k,C,A):x(k,C))||A);return I>3&&A&&Object.defineProperty(k,C,A),A},d=this&&this.__param||function(w,k){return function(C,E){k(C,E,w)}};Object.defineProperty(o,"__esModule",{value:!0}),o.DomRendererRowFactory=void 0;const u=l(2223),m=l(643),v=l(511),y=l(2585),_=l(8055),p=l(4725),f=l(4269),h=l(6171),g=l(3734);let S=o.DomRendererRowFactory=class{constructor(w,k,C,E,x,I,A){this._document=w,this._characterJoinerService=k,this._optionsService=C,this._coreBrowserService=E,this._coreService=x,this._decorationService=I,this._themeService=A,this._workCell=new v.CellData,this._columnSelectMode=!1,this.defaultSpacing=0}handleSelectionChanged(w,k,C){this._selectionStart=w,this._selectionEnd=k,this._columnSelectMode=C}createRow(w,k,C,E,x,I,A,P,F,B,j){const X=[],U=this._characterJoinerService.getJoinedCharacters(k),R=this._themeService.colors;let M,D=w.getNoBgTrimmedLength();C&&D<I+1&&(D=I+1);let N=0,q="",ne=0,ce=0,de=0,z=!1,O=0,Y=!1,G=0;const se=[],ie=B!==-1&&j!==-1;for(let Se=0;Se<D;Se++){w.loadCell(Se,this._workCell);let Ue=this._workCell.getWidth();if(Ue===0)continue;let ze=!1,Ut=Se,he=this._workCell;if(U.length>0&&Se===U[0][0]){ze=!0;const Ae=U.shift();he=new f.JoinedCellData(this._workCell,w.translateToString(!0,Ae[0],Ae[1]),Ae[1]-Ae[0]),Ut=Ae[1]-1,Ue=he.getWidth()}const va=this._isCellInSelection(Se,k),Id=C&&Se===I,Ld=ie&&Se>=B&&Se<=j;let Md=!1;this._decorationService.forEachDecorationAtCell(Se,k,void 0,Ae=>{Md=!0});let Ql=he.getChars()||m.WHITESPACE_CELL_CHAR;if(Ql===" "&&(he.isUnderline()||he.isOverline())&&(Ql=" "),G=Ue*P-F.get(Ql,he.isBold(),he.isItalic()),M){if(N&&(va&&Y||!va&&!Y&&he.bg===ne)&&(va&&Y&&R.selectionForeground||he.fg===ce)&&he.extended.ext===de&&Ld===z&&G===O&&!Id&&!ze&&!Md){he.isInvisible()?q+=m.WHITESPACE_CELL_CHAR:q+=Ql,N++;continue}N&&(M.textContent=q),M=this._document.createElement("span"),N=0,q=""}else M=this._document.createElement("span");if(ne=he.bg,ce=he.fg,de=he.extended.ext,z=Ld,O=G,Y=va,ze&&I>=Se&&I<=Ut&&(I=Se),!this._coreService.isCursorHidden&&Id&&this._coreService.isCursorInitialized){if(se.push("xterm-cursor"),this._coreBrowserService.isFocused)A&&se.push("xterm-cursor-blink"),se.push(E==="bar"?"xterm-cursor-bar":E==="underline"?"xterm-cursor-underline":"xterm-cursor-block");else if(x)switch(x){case"outline":se.push("xterm-cursor-outline");break;case"block":se.push("xterm-cursor-block");break;case"bar":se.push("xterm-cursor-bar");break;case"underline":se.push("xterm-cursor-underline")}}if(he.isBold()&&se.push("xterm-bold"),he.isItalic()&&se.push("xterm-italic"),he.isDim()&&se.push("xterm-dim"),q=he.isInvisible()?m.WHITESPACE_CELL_CHAR:he.getChars()||m.WHITESPACE_CELL_CHAR,he.isUnderline()&&(se.push(`xterm-underline-${he.extended.underlineStyle}`),q===" "&&(q=" "),!he.isUnderlineColorDefault()))if(he.isUnderlineColorRGB())M.style.textDecorationColor=`rgb(${g.AttributeData.toColorRGB(he.getUnderlineColor()).join(",")})`;else{let Ae=he.getUnderlineColor();this._optionsService.rawOptions.drawBoldTextInBrightColors&&he.isBold()&&Ae<8&&(Ae+=8),M.style.textDecorationColor=R.ansi[Ae].css}he.isOverline()&&(se.push("xterm-overline"),q===" "&&(q=" ")),he.isStrikethrough()&&se.push("xterm-strikethrough"),Ld&&(M.style.textDecoration="underline");let un=he.getFgColor(),_a=he.getFgColorMode(),Qn=he.getBgColor(),ya=he.getBgColorMode();const Dd=!!he.isInverse();if(Dd){const Ae=un;un=Qn,Qn=Ae;const ek=_a;_a=ya,ya=ek}let Er,Xl,Tr,Sa=!1;switch(this._decorationService.forEachDecorationAtCell(Se,k,void 0,Ae=>{Ae.options.layer!=="top"&&Sa||(Ae.backgroundColorRGB&&(ya=50331648,Qn=Ae.backgroundColorRGB.rgba>>8&16777215,Er=Ae.backgroundColorRGB),Ae.foregroundColorRGB&&(_a=50331648,un=Ae.foregroundColorRGB.rgba>>8&16777215,Xl=Ae.foregroundColorRGB),Sa=Ae.options.layer==="top")}),!Sa&&va&&(Er=this._coreBrowserService.isFocused?R.selectionBackgroundOpaque:R.selectionInactiveBackgroundOpaque,Qn=Er.rgba>>8&16777215,ya=50331648,Sa=!0,R.selectionForeground&&(_a=50331648,un=R.selectionForeground.rgba>>8&16777215,Xl=R.selectionForeground)),Sa&&se.push("xterm-decoration-top"),ya){case 16777216:case 33554432:Tr=R.ansi[Qn],se.push(`xterm-bg-${Qn}`);break;case 50331648:Tr=_.channels.toColor(Qn>>16,Qn>>8&255,255&Qn),this._addStyle(M,`background-color:#${b((Qn>>>0).toString(16),"0",6)}`);break;default:Dd?(Tr=R.foreground,se.push(`xterm-bg-${u.INVERTED_DEFAULT_COLOR}`)):Tr=R.background}switch(Er||he.isDim()&&(Er=_.color.multiplyOpacity(Tr,.5)),_a){case 16777216:case 33554432:he.isBold()&&un<8&&this._optionsService.rawOptions.drawBoldTextInBrightColors&&(un+=8),this._applyMinimumContrast(M,Tr,R.ansi[un],he,Er,void 0)||se.push(`xterm-fg-${un}`);break;case 50331648:const Ae=_.channels.toColor(un>>16&255,un>>8&255,255&un);this._applyMinimumContrast(M,Tr,Ae,he,Er,Xl)||this._addStyle(M,`color:#${b(un.toString(16),"0",6)}`);break;default:this._applyMinimumContrast(M,Tr,R.foreground,he,Er,Xl)||Dd&&se.push(`xterm-fg-${u.INVERTED_DEFAULT_COLOR}`)}se.length&&(M.className=se.join(" "),se.length=0),Id||ze||Md?M.textContent=q:N++,G!==this.defaultSpacing&&(M.style.letterSpacing=`${G}px`),X.push(M),Se=Ut}return M&&N&&(M.textContent=q),X}_applyMinimumContrast(w,k,C,E,x,I){if(this._optionsService.rawOptions.minimumContrastRatio===1||(0,h.treatGlyphAsBackgroundColor)(E.getCode()))return!1;const A=this._getContrastCache(E);let P;if(x||I||(P=A.getColor(k.rgba,C.rgba)),P===void 0){const F=this._optionsService.rawOptions.minimumContrastRatio/(E.isDim()?2:1);P=_.color.ensureContrastRatio(x||k,I||C,F),A.setColor((x||k).rgba,(I||C).rgba,P??null)}return!!P&&(this._addStyle(w,`color:${P.css}`),!0)}_getContrastCache(w){return w.isDim()?this._themeService.colors.halfContrastCache:this._themeService.colors.contrastCache}_addStyle(w,k){w.setAttribute("style",`${w.getAttribute("style")||""}${k};`)}_isCellInSelection(w,k){const C=this._selectionStart,E=this._selectionEnd;return!(!C||!E)&&(this._columnSelectMode?C[0]<=E[0]?w>=C[0]&&k>=C[1]&&w<E[0]&&k<=E[1]:w<C[0]&&k>=C[1]&&w>=E[0]&&k<=E[1]:k>C[1]&&k<E[1]||C[1]===E[1]&&k===C[1]&&w>=C[0]&&w<E[0]||C[1]<E[1]&&k===E[1]&&w<E[0]||C[1]<E[1]&&k===C[1]&&w>=C[0])}};function b(w,k,C){for(;w.length<C;)w=k+w;return w}o.DomRendererRowFactory=S=c([d(1,p.ICharacterJoinerService),d(2,y.IOptionsService),d(3,p.ICoreBrowserService),d(4,y.ICoreService),d(5,y.IDecorationService),d(6,p.IThemeService)],S)},2550:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WidthCache=void 0,o.WidthCache=class{constructor(l,c){this._flat=new Float32Array(256),this._font="",this._fontSize=0,this._weight="normal",this._weightBold="bold",this._measureElements=[],this._container=l.createElement("div"),this._container.classList.add("xterm-width-cache-measure-container"),this._container.setAttribute("aria-hidden","true"),this._container.style.whiteSpace="pre",this._container.style.fontKerning="none";const d=l.createElement("span");d.classList.add("xterm-char-measure-element");const u=l.createElement("span");u.classList.add("xterm-char-measure-element"),u.style.fontWeight="bold";const m=l.createElement("span");m.classList.add("xterm-char-measure-element"),m.style.fontStyle="italic";const v=l.createElement("span");v.classList.add("xterm-char-measure-element"),v.style.fontWeight="bold",v.style.fontStyle="italic",this._measureElements=[d,u,m,v],this._container.appendChild(d),this._container.appendChild(u),this._container.appendChild(m),this._container.appendChild(v),c.appendChild(this._container),this.clear()}dispose(){this._container.remove(),this._measureElements.length=0,this._holey=void 0}clear(){this._flat.fill(-9999),this._holey=new Map}setFont(l,c,d,u){l===this._font&&c===this._fontSize&&d===this._weight&&u===this._weightBold||(this._font=l,this._fontSize=c,this._weight=d,this._weightBold=u,this._container.style.fontFamily=this._font,this._container.style.fontSize=`${this._fontSize}px`,this._measureElements[0].style.fontWeight=`${d}`,this._measureElements[1].style.fontWeight=`${u}`,this._measureElements[2].style.fontWeight=`${d}`,this._measureElements[3].style.fontWeight=`${u}`,this.clear())}get(l,c,d){let u=0;if(!c&&!d&&l.length===1&&(u=l.charCodeAt(0))<256){if(this._flat[u]!==-9999)return this._flat[u];const y=this._measure(l,0);return y>0&&(this._flat[u]=y),y}let m=l;c&&(m+="B"),d&&(m+="I");let v=this._holey.get(m);if(v===void 0){let y=0;c&&(y|=1),d&&(y|=2),v=this._measure(l,y),v>0&&this._holey.set(m,v)}return v}_measure(l,c){const d=this._measureElements[c];return d.textContent=l.repeat(32),d.offsetWidth/32}}},2223:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.TEXT_BASELINE=o.DIM_OPACITY=o.INVERTED_DEFAULT_COLOR=void 0;const c=l(6114);o.INVERTED_DEFAULT_COLOR=257,o.DIM_OPACITY=.5,o.TEXT_BASELINE=c.isFirefox||c.isLegacyEdge?"bottom":"ideographic"},6171:(a,o)=>{function l(d){return 57508<=d&&d<=57558}function c(d){return d>=128512&&d<=128591||d>=127744&&d<=128511||d>=128640&&d<=128767||d>=9728&&d<=9983||d>=9984&&d<=10175||d>=65024&&d<=65039||d>=129280&&d<=129535||d>=127462&&d<=127487}Object.defineProperty(o,"__esModule",{value:!0}),o.computeNextVariantOffset=o.createRenderDimensions=o.treatGlyphAsBackgroundColor=o.allowRescaling=o.isEmoji=o.isRestrictedPowerlineGlyph=o.isPowerlineGlyph=o.throwIfFalsy=void 0,o.throwIfFalsy=function(d){if(!d)throw new Error("value must not be falsy");return d},o.isPowerlineGlyph=l,o.isRestrictedPowerlineGlyph=function(d){return 57520<=d&&d<=57527},o.isEmoji=c,o.allowRescaling=function(d,u,m,v){return u===1&&m>Math.ceil(1.5*v)&&d!==void 0&&d>255&&!c(d)&&!l(d)&&!function(y){return 57344<=y&&y<=63743}(d)},o.treatGlyphAsBackgroundColor=function(d){return l(d)||function(u){return 9472<=u&&u<=9631}(d)},o.createRenderDimensions=function(){return{css:{canvas:{width:0,height:0},cell:{width:0,height:0}},device:{canvas:{width:0,height:0},cell:{width:0,height:0},char:{width:0,height:0,left:0,top:0}}}},o.computeNextVariantOffset=function(d,u,m=0){return(d-(2*Math.round(u)-m))%(2*Math.round(u))}},6052:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createSelectionRenderModel=void 0;class l{constructor(){this.clear()}clear(){this.hasSelection=!1,this.columnSelectMode=!1,this.viewportStartRow=0,this.viewportEndRow=0,this.viewportCappedStartRow=0,this.viewportCappedEndRow=0,this.startCol=0,this.endCol=0,this.selectionStart=void 0,this.selectionEnd=void 0}update(d,u,m,v=!1){if(this.selectionStart=u,this.selectionEnd=m,!u||!m||u[0]===m[0]&&u[1]===m[1])return void this.clear();const y=d.buffers.active.ydisp,_=u[1]-y,p=m[1]-y,f=Math.max(_,0),h=Math.min(p,d.rows-1);f>=d.rows||h<0?this.clear():(this.hasSelection=!0,this.columnSelectMode=v,this.viewportStartRow=_,this.viewportEndRow=p,this.viewportCappedStartRow=f,this.viewportCappedEndRow=h,this.startCol=u[0],this.endCol=m[0])}isCellSelected(d,u,m){return!!this.hasSelection&&(m-=d.buffer.active.viewportY,this.columnSelectMode?this.startCol<=this.endCol?u>=this.startCol&&m>=this.viewportCappedStartRow&&u<this.endCol&&m<=this.viewportCappedEndRow:u<this.startCol&&m>=this.viewportCappedStartRow&&u>=this.endCol&&m<=this.viewportCappedEndRow:m>this.viewportStartRow&&m<this.viewportEndRow||this.viewportStartRow===this.viewportEndRow&&m===this.viewportStartRow&&u>=this.startCol&&u<this.endCol||this.viewportStartRow<this.viewportEndRow&&m===this.viewportEndRow&&u<this.endCol||this.viewportStartRow<this.viewportEndRow&&m===this.viewportStartRow&&u>=this.startCol)}}o.createSelectionRenderModel=function(){return new l}},456:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SelectionModel=void 0,o.SelectionModel=class{constructor(l){this._bufferService=l,this.isSelectAllActive=!1,this.selectionStartLength=0}clearSelection(){this.selectionStart=void 0,this.selectionEnd=void 0,this.isSelectAllActive=!1,this.selectionStartLength=0}get finalSelectionStart(){return this.isSelectAllActive?[0,0]:this.selectionEnd&&this.selectionStart&&this.areSelectionValuesReversed()?this.selectionEnd:this.selectionStart}get finalSelectionEnd(){if(this.isSelectAllActive)return[this._bufferService.cols,this._bufferService.buffer.ybase+this._bufferService.rows-1];if(this.selectionStart){if(!this.selectionEnd||this.areSelectionValuesReversed()){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?l%this._bufferService.cols==0?[this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)-1]:[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[l,this.selectionStart[1]]}if(this.selectionStartLength&&this.selectionEnd[1]===this.selectionStart[1]){const l=this.selectionStart[0]+this.selectionStartLength;return l>this._bufferService.cols?[l%this._bufferService.cols,this.selectionStart[1]+Math.floor(l/this._bufferService.cols)]:[Math.max(l,this.selectionEnd[0]),this.selectionEnd[1]]}return this.selectionEnd}}areSelectionValuesReversed(){const l=this.selectionStart,c=this.selectionEnd;return!(!l||!c)&&(l[1]>c[1]||l[1]===c[1]&&l[0]>c[0])}handleTrim(l){return this.selectionStart&&(this.selectionStart[1]-=l),this.selectionEnd&&(this.selectionEnd[1]-=l),this.selectionEnd&&this.selectionEnd[1]<0?(this.clearSelection(),!0):(this.selectionStart&&this.selectionStart[1]<0&&(this.selectionStart[1]=0),!1)}}},428:function(a,o,l){var c=this&&this.__decorate||function(h,g,S,b){var w,k=arguments.length,C=k<3?g:b===null?b=Object.getOwnPropertyDescriptor(g,S):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(h,g,S,b);else for(var E=h.length-1;E>=0;E--)(w=h[E])&&(C=(k<3?w(C):k>3?w(g,S,C):w(g,S))||C);return k>3&&C&&Object.defineProperty(g,S,C),C},d=this&&this.__param||function(h,g){return function(S,b){g(S,b,h)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CharSizeService=void 0;const u=l(2585),m=l(8460),v=l(844);let y=o.CharSizeService=class extends v.Disposable{get hasValidSize(){return this.width>0&&this.height>0}constructor(h,g,S){super(),this._optionsService=S,this.width=0,this.height=0,this._onCharSizeChange=this.register(new m.EventEmitter),this.onCharSizeChange=this._onCharSizeChange.event;try{this._measureStrategy=this.register(new f(this._optionsService))}catch{this._measureStrategy=this.register(new p(h,g,this._optionsService))}this.register(this._optionsService.onMultipleOptionChange(["fontFamily","fontSize"],()=>this.measure()))}measure(){const h=this._measureStrategy.measure();h.width===this.width&&h.height===this.height||(this.width=h.width,this.height=h.height,this._onCharSizeChange.fire())}};o.CharSizeService=y=c([d(2,u.IOptionsService)],y);class _ extends v.Disposable{constructor(){super(...arguments),this._result={width:0,height:0}}_validateAndSet(g,S){g!==void 0&&g>0&&S!==void 0&&S>0&&(this._result.width=g,this._result.height=S)}}class p extends _{constructor(g,S,b){super(),this._document=g,this._parentElement=S,this._optionsService=b,this._measureElement=this._document.createElement("span"),this._measureElement.classList.add("xterm-char-measure-element"),this._measureElement.textContent="W".repeat(32),this._measureElement.setAttribute("aria-hidden","true"),this._measureElement.style.whiteSpace="pre",this._measureElement.style.fontKerning="none",this._parentElement.appendChild(this._measureElement)}measure(){return this._measureElement.style.fontFamily=this._optionsService.rawOptions.fontFamily,this._measureElement.style.fontSize=`${this._optionsService.rawOptions.fontSize}px`,this._validateAndSet(Number(this._measureElement.offsetWidth)/32,Number(this._measureElement.offsetHeight)),this._result}}class f extends _{constructor(g){super(),this._optionsService=g,this._canvas=new OffscreenCanvas(100,100),this._ctx=this._canvas.getContext("2d");const S=this._ctx.measureText("W");if(!("width"in S&&"fontBoundingBoxAscent"in S&&"fontBoundingBoxDescent"in S))throw new Error("Required font metrics not supported")}measure(){this._ctx.font=`${this._optionsService.rawOptions.fontSize}px ${this._optionsService.rawOptions.fontFamily}`;const g=this._ctx.measureText("W");return this._validateAndSet(g.width,g.fontBoundingBoxAscent+g.fontBoundingBoxDescent),this._result}}},4269:function(a,o,l){var c=this&&this.__decorate||function(f,h,g,S){var b,w=arguments.length,k=w<3?h:S===null?S=Object.getOwnPropertyDescriptor(h,g):S;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")k=Reflect.decorate(f,h,g,S);else for(var C=f.length-1;C>=0;C--)(b=f[C])&&(k=(w<3?b(k):w>3?b(h,g,k):b(h,g))||k);return w>3&&k&&Object.defineProperty(h,g,k),k},d=this&&this.__param||function(f,h){return function(g,S){h(g,S,f)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CharacterJoinerService=o.JoinedCellData=void 0;const u=l(3734),m=l(643),v=l(511),y=l(2585);class _ extends u.AttributeData{constructor(h,g,S){super(),this.content=0,this.combinedData="",this.fg=h.fg,this.bg=h.bg,this.combinedData=g,this._width=S}isCombined(){return 2097152}getWidth(){return this._width}getChars(){return this.combinedData}getCode(){return 2097151}setFromCharData(h){throw new Error("not implemented")}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}o.JoinedCellData=_;let p=o.CharacterJoinerService=class n1{constructor(h){this._bufferService=h,this._characterJoiners=[],this._nextCharacterJoinerId=0,this._workCell=new v.CellData}register(h){const g={id:this._nextCharacterJoinerId++,handler:h};return this._characterJoiners.push(g),g.id}deregister(h){for(let g=0;g<this._characterJoiners.length;g++)if(this._characterJoiners[g].id===h)return this._characterJoiners.splice(g,1),!0;return!1}getJoinedCharacters(h){if(this._characterJoiners.length===0)return[];const g=this._bufferService.buffer.lines.get(h);if(!g||g.length===0)return[];const S=[],b=g.translateToString(!0);let w=0,k=0,C=0,E=g.getFg(0),x=g.getBg(0);for(let I=0;I<g.getTrimmedLength();I++)if(g.loadCell(I,this._workCell),this._workCell.getWidth()!==0){if(this._workCell.fg!==E||this._workCell.bg!==x){if(I-w>1){const A=this._getJoinedRanges(b,C,k,g,w);for(let P=0;P<A.length;P++)S.push(A[P])}w=I,C=k,E=this._workCell.fg,x=this._workCell.bg}k+=this._workCell.getChars().length||m.WHITESPACE_CELL_CHAR.length}if(this._bufferService.cols-w>1){const I=this._getJoinedRanges(b,C,k,g,w);for(let A=0;A<I.length;A++)S.push(I[A])}return S}_getJoinedRanges(h,g,S,b,w){const k=h.substring(g,S);let C=[];try{C=this._characterJoiners[0].handler(k)}catch(E){console.error(E)}for(let E=1;E<this._characterJoiners.length;E++)try{const x=this._characterJoiners[E].handler(k);for(let I=0;I<x.length;I++)n1._mergeRanges(C,x[I])}catch(x){console.error(x)}return this._stringRangesToCellRanges(C,b,w),C}_stringRangesToCellRanges(h,g,S){let b=0,w=!1,k=0,C=h[b];if(C){for(let E=S;E<this._bufferService.cols;E++){const x=g.getWidth(E),I=g.getString(E).length||m.WHITESPACE_CELL_CHAR.length;if(x!==0){if(!w&&C[0]<=k&&(C[0]=E,w=!0),C[1]<=k){if(C[1]=E,C=h[++b],!C)break;C[0]<=k?(C[0]=E,w=!0):w=!1}k+=I}}C&&(C[1]=this._bufferService.cols)}}static _mergeRanges(h,g){let S=!1;for(let b=0;b<h.length;b++){const w=h[b];if(S){if(g[1]<=w[0])return h[b-1][1]=g[1],h;if(g[1]<=w[1])return h[b-1][1]=Math.max(g[1],w[1]),h.splice(b,1),h;h.splice(b,1),b--}else{if(g[1]<=w[0])return h.splice(b,0,g),h;if(g[1]<=w[1])return w[0]=Math.min(g[0],w[0]),h;g[0]<w[1]&&(w[0]=Math.min(g[0],w[0]),S=!0)}}return S?h[h.length-1][1]=g[1]:h.push(g),h}};o.CharacterJoinerService=p=c([d(0,y.IBufferService)],p)},5114:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CoreBrowserService=void 0;const c=l(844),d=l(8460),u=l(3656);class m extends c.Disposable{constructor(_,p,f){super(),this._textarea=_,this._window=p,this.mainDocument=f,this._isFocused=!1,this._cachedIsFocused=void 0,this._screenDprMonitor=new v(this._window),this._onDprChange=this.register(new d.EventEmitter),this.onDprChange=this._onDprChange.event,this._onWindowChange=this.register(new d.EventEmitter),this.onWindowChange=this._onWindowChange.event,this.register(this.onWindowChange(h=>this._screenDprMonitor.setWindow(h))),this.register((0,d.forwardEvent)(this._screenDprMonitor.onDprChange,this._onDprChange)),this._textarea.addEventListener("focus",()=>this._isFocused=!0),this._textarea.addEventListener("blur",()=>this._isFocused=!1)}get window(){return this._window}set window(_){this._window!==_&&(this._window=_,this._onWindowChange.fire(this._window))}get dpr(){return this.window.devicePixelRatio}get isFocused(){return this._cachedIsFocused===void 0&&(this._cachedIsFocused=this._isFocused&&this._textarea.ownerDocument.hasFocus(),queueMicrotask(()=>this._cachedIsFocused=void 0)),this._cachedIsFocused}}o.CoreBrowserService=m;class v extends c.Disposable{constructor(_){super(),this._parentWindow=_,this._windowResizeListener=this.register(new c.MutableDisposable),this._onDprChange=this.register(new d.EventEmitter),this.onDprChange=this._onDprChange.event,this._outerListener=()=>this._setDprAndFireIfDiffers(),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._updateDpr(),this._setWindowResizeListener(),this.register((0,c.toDisposable)(()=>this.clearListener()))}setWindow(_){this._parentWindow=_,this._setWindowResizeListener(),this._setDprAndFireIfDiffers()}_setWindowResizeListener(){this._windowResizeListener.value=(0,u.addDisposableDomListener)(this._parentWindow,"resize",()=>this._setDprAndFireIfDiffers())}_setDprAndFireIfDiffers(){this._parentWindow.devicePixelRatio!==this._currentDevicePixelRatio&&this._onDprChange.fire(this._parentWindow.devicePixelRatio),this._updateDpr()}_updateDpr(){var _;this._outerListener&&((_=this._resolutionMediaMatchList)==null||_.removeListener(this._outerListener),this._currentDevicePixelRatio=this._parentWindow.devicePixelRatio,this._resolutionMediaMatchList=this._parentWindow.matchMedia(`screen and (resolution: ${this._parentWindow.devicePixelRatio}dppx)`),this._resolutionMediaMatchList.addListener(this._outerListener))}clearListener(){this._resolutionMediaMatchList&&this._outerListener&&(this._resolutionMediaMatchList.removeListener(this._outerListener),this._resolutionMediaMatchList=void 0,this._outerListener=void 0)}}},779:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.LinkProviderService=void 0;const c=l(844);class d extends c.Disposable{constructor(){super(),this.linkProviders=[],this.register((0,c.toDisposable)(()=>this.linkProviders.length=0))}registerLinkProvider(m){return this.linkProviders.push(m),{dispose:()=>{const v=this.linkProviders.indexOf(m);v!==-1&&this.linkProviders.splice(v,1)}}}}o.LinkProviderService=d},8934:function(a,o,l){var c=this&&this.__decorate||function(y,_,p,f){var h,g=arguments.length,S=g<3?_:f===null?f=Object.getOwnPropertyDescriptor(_,p):f;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")S=Reflect.decorate(y,_,p,f);else for(var b=y.length-1;b>=0;b--)(h=y[b])&&(S=(g<3?h(S):g>3?h(_,p,S):h(_,p))||S);return g>3&&S&&Object.defineProperty(_,p,S),S},d=this&&this.__param||function(y,_){return function(p,f){_(p,f,y)}};Object.defineProperty(o,"__esModule",{value:!0}),o.MouseService=void 0;const u=l(4725),m=l(9806);let v=o.MouseService=class{constructor(y,_){this._renderService=y,this._charSizeService=_}getCoords(y,_,p,f,h){return(0,m.getCoords)(window,y,_,p,f,this._charSizeService.hasValidSize,this._renderService.dimensions.css.cell.width,this._renderService.dimensions.css.cell.height,h)}getMouseReportCoords(y,_){const p=(0,m.getCoordsRelativeToElement)(window,y,_);if(this._charSizeService.hasValidSize)return p[0]=Math.min(Math.max(p[0],0),this._renderService.dimensions.css.canvas.width-1),p[1]=Math.min(Math.max(p[1],0),this._renderService.dimensions.css.canvas.height-1),{col:Math.floor(p[0]/this._renderService.dimensions.css.cell.width),row:Math.floor(p[1]/this._renderService.dimensions.css.cell.height),x:Math.floor(p[0]),y:Math.floor(p[1])}}};o.MouseService=v=c([d(0,u.IRenderService),d(1,u.ICharSizeService)],v)},3230:function(a,o,l){var c=this&&this.__decorate||function(h,g,S,b){var w,k=arguments.length,C=k<3?g:b===null?b=Object.getOwnPropertyDescriptor(g,S):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(h,g,S,b);else for(var E=h.length-1;E>=0;E--)(w=h[E])&&(C=(k<3?w(C):k>3?w(g,S,C):w(g,S))||C);return k>3&&C&&Object.defineProperty(g,S,C),C},d=this&&this.__param||function(h,g){return function(S,b){g(S,b,h)}};Object.defineProperty(o,"__esModule",{value:!0}),o.RenderService=void 0;const u=l(6193),m=l(4725),v=l(8460),y=l(844),_=l(7226),p=l(2585);let f=o.RenderService=class extends y.Disposable{get dimensions(){return this._renderer.value.dimensions}constructor(h,g,S,b,w,k,C,E){super(),this._rowCount=h,this._charSizeService=b,this._renderer=this.register(new y.MutableDisposable),this._pausedResizeTask=new _.DebouncedIdleTask,this._observerDisposable=this.register(new y.MutableDisposable),this._isPaused=!1,this._needsFullRefresh=!1,this._isNextRenderRedrawOnly=!0,this._needsSelectionRefresh=!1,this._canvasWidth=0,this._canvasHeight=0,this._selectionState={start:void 0,end:void 0,columnSelectMode:!1},this._onDimensionsChange=this.register(new v.EventEmitter),this.onDimensionsChange=this._onDimensionsChange.event,this._onRenderedViewportChange=this.register(new v.EventEmitter),this.onRenderedViewportChange=this._onRenderedViewportChange.event,this._onRender=this.register(new v.EventEmitter),this.onRender=this._onRender.event,this._onRefreshRequest=this.register(new v.EventEmitter),this.onRefreshRequest=this._onRefreshRequest.event,this._renderDebouncer=new u.RenderDebouncer((x,I)=>this._renderRows(x,I),C),this.register(this._renderDebouncer),this.register(C.onDprChange(()=>this.handleDevicePixelRatioChange())),this.register(k.onResize(()=>this._fullRefresh())),this.register(k.buffers.onBufferActivate(()=>{var x;return(x=this._renderer.value)==null?void 0:x.clear()})),this.register(S.onOptionChange(()=>this._handleOptionsChanged())),this.register(this._charSizeService.onCharSizeChange(()=>this.handleCharSizeChanged())),this.register(w.onDecorationRegistered(()=>this._fullRefresh())),this.register(w.onDecorationRemoved(()=>this._fullRefresh())),this.register(S.onMultipleOptionChange(["customGlyphs","drawBoldTextInBrightColors","letterSpacing","lineHeight","fontFamily","fontSize","fontWeight","fontWeightBold","minimumContrastRatio","rescaleOverlappingGlyphs"],()=>{this.clear(),this.handleResize(k.cols,k.rows),this._fullRefresh()})),this.register(S.onMultipleOptionChange(["cursorBlink","cursorStyle"],()=>this.refreshRows(k.buffer.y,k.buffer.y,!0))),this.register(E.onChangeColors(()=>this._fullRefresh())),this._registerIntersectionObserver(C.window,g),this.register(C.onWindowChange(x=>this._registerIntersectionObserver(x,g)))}_registerIntersectionObserver(h,g){if("IntersectionObserver"in h){const S=new h.IntersectionObserver(b=>this._handleIntersectionChange(b[b.length-1]),{threshold:0});S.observe(g),this._observerDisposable.value=(0,y.toDisposable)(()=>S.disconnect())}}_handleIntersectionChange(h){this._isPaused=h.isIntersecting===void 0?h.intersectionRatio===0:!h.isIntersecting,this._isPaused||this._charSizeService.hasValidSize||this._charSizeService.measure(),!this._isPaused&&this._needsFullRefresh&&(this._pausedResizeTask.flush(),this.refreshRows(0,this._rowCount-1),this._needsFullRefresh=!1)}refreshRows(h,g,S=!1){this._isPaused?this._needsFullRefresh=!0:(S||(this._isNextRenderRedrawOnly=!1),this._renderDebouncer.refresh(h,g,this._rowCount))}_renderRows(h,g){this._renderer.value&&(h=Math.min(h,this._rowCount-1),g=Math.min(g,this._rowCount-1),this._renderer.value.renderRows(h,g),this._needsSelectionRefresh&&(this._renderer.value.handleSelectionChanged(this._selectionState.start,this._selectionState.end,this._selectionState.columnSelectMode),this._needsSelectionRefresh=!1),this._isNextRenderRedrawOnly||this._onRenderedViewportChange.fire({start:h,end:g}),this._onRender.fire({start:h,end:g}),this._isNextRenderRedrawOnly=!0)}resize(h,g){this._rowCount=g,this._fireOnCanvasResize()}_handleOptionsChanged(){this._renderer.value&&(this.refreshRows(0,this._rowCount-1),this._fireOnCanvasResize())}_fireOnCanvasResize(){this._renderer.value&&(this._renderer.value.dimensions.css.canvas.width===this._canvasWidth&&this._renderer.value.dimensions.css.canvas.height===this._canvasHeight||this._onDimensionsChange.fire(this._renderer.value.dimensions))}hasRenderer(){return!!this._renderer.value}setRenderer(h){this._renderer.value=h,this._renderer.value&&(this._renderer.value.onRequestRedraw(g=>this.refreshRows(g.start,g.end,!0)),this._needsSelectionRefresh=!0,this._fullRefresh())}addRefreshCallback(h){return this._renderDebouncer.addRefreshCallback(h)}_fullRefresh(){this._isPaused?this._needsFullRefresh=!0:this.refreshRows(0,this._rowCount-1)}clearTextureAtlas(){var h,g;this._renderer.value&&((g=(h=this._renderer.value).clearTextureAtlas)==null||g.call(h),this._fullRefresh())}handleDevicePixelRatioChange(){this._charSizeService.measure(),this._renderer.value&&(this._renderer.value.handleDevicePixelRatioChange(),this.refreshRows(0,this._rowCount-1))}handleResize(h,g){this._renderer.value&&(this._isPaused?this._pausedResizeTask.set(()=>{var S;return(S=this._renderer.value)==null?void 0:S.handleResize(h,g)}):this._renderer.value.handleResize(h,g),this._fullRefresh())}handleCharSizeChanged(){var h;(h=this._renderer.value)==null||h.handleCharSizeChanged()}handleBlur(){var h;(h=this._renderer.value)==null||h.handleBlur()}handleFocus(){var h;(h=this._renderer.value)==null||h.handleFocus()}handleSelectionChanged(h,g,S){var b;this._selectionState.start=h,this._selectionState.end=g,this._selectionState.columnSelectMode=S,(b=this._renderer.value)==null||b.handleSelectionChanged(h,g,S)}handleCursorMove(){var h;(h=this._renderer.value)==null||h.handleCursorMove()}clear(){var h;(h=this._renderer.value)==null||h.clear()}};o.RenderService=f=c([d(2,p.IOptionsService),d(3,m.ICharSizeService),d(4,p.IDecorationService),d(5,p.IBufferService),d(6,m.ICoreBrowserService),d(7,m.IThemeService)],f)},9312:function(a,o,l){var c=this&&this.__decorate||function(C,E,x,I){var A,P=arguments.length,F=P<3?E:I===null?I=Object.getOwnPropertyDescriptor(E,x):I;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")F=Reflect.decorate(C,E,x,I);else for(var B=C.length-1;B>=0;B--)(A=C[B])&&(F=(P<3?A(F):P>3?A(E,x,F):A(E,x))||F);return P>3&&F&&Object.defineProperty(E,x,F),F},d=this&&this.__param||function(C,E){return function(x,I){E(x,I,C)}};Object.defineProperty(o,"__esModule",{value:!0}),o.SelectionService=void 0;const u=l(9806),m=l(9504),v=l(456),y=l(4725),_=l(8460),p=l(844),f=l(6114),h=l(4841),g=l(511),S=l(2585),b=String.fromCharCode(160),w=new RegExp(b,"g");let k=o.SelectionService=class extends p.Disposable{constructor(C,E,x,I,A,P,F,B,j){super(),this._element=C,this._screenElement=E,this._linkifier=x,this._bufferService=I,this._coreService=A,this._mouseService=P,this._optionsService=F,this._renderService=B,this._coreBrowserService=j,this._dragScrollAmount=0,this._enabled=!0,this._workCell=new g.CellData,this._mouseDownTimeStamp=0,this._oldHasSelection=!1,this._oldSelectionStart=void 0,this._oldSelectionEnd=void 0,this._onLinuxMouseSelection=this.register(new _.EventEmitter),this.onLinuxMouseSelection=this._onLinuxMouseSelection.event,this._onRedrawRequest=this.register(new _.EventEmitter),this.onRequestRedraw=this._onRedrawRequest.event,this._onSelectionChange=this.register(new _.EventEmitter),this.onSelectionChange=this._onSelectionChange.event,this._onRequestScrollLines=this.register(new _.EventEmitter),this.onRequestScrollLines=this._onRequestScrollLines.event,this._mouseMoveListener=X=>this._handleMouseMove(X),this._mouseUpListener=X=>this._handleMouseUp(X),this._coreService.onUserInput(()=>{this.hasSelection&&this.clearSelection()}),this._trimListener=this._bufferService.buffer.lines.onTrim(X=>this._handleTrim(X)),this.register(this._bufferService.buffers.onBufferActivate(X=>this._handleBufferActivate(X))),this.enable(),this._model=new v.SelectionModel(this._bufferService),this._activeSelectionMode=0,this.register((0,p.toDisposable)(()=>{this._removeMouseDownListeners()}))}reset(){this.clearSelection()}disable(){this.clearSelection(),this._enabled=!1}enable(){this._enabled=!0}get selectionStart(){return this._model.finalSelectionStart}get selectionEnd(){return this._model.finalSelectionEnd}get hasSelection(){const C=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;return!(!C||!E||C[0]===E[0]&&C[1]===E[1])}get selectionText(){const C=this._model.finalSelectionStart,E=this._model.finalSelectionEnd;if(!C||!E)return"";const x=this._bufferService.buffer,I=[];if(this._activeSelectionMode===3){if(C[0]===E[0])return"";const A=C[0]<E[0]?C[0]:E[0],P=C[0]<E[0]?E[0]:C[0];for(let F=C[1];F<=E[1];F++){const B=x.translateBufferLineToString(F,!0,A,P);I.push(B)}}else{const A=C[1]===E[1]?E[0]:void 0;I.push(x.translateBufferLineToString(C[1],!0,C[0],A));for(let P=C[1]+1;P<=E[1]-1;P++){const F=x.lines.get(P),B=x.translateBufferLineToString(P,!0);F!=null&&F.isWrapped?I[I.length-1]+=B:I.push(B)}if(C[1]!==E[1]){const P=x.lines.get(E[1]),F=x.translateBufferLineToString(E[1],!0,0,E[0]);P&&P.isWrapped?I[I.length-1]+=F:I.push(F)}}return I.map(A=>A.replace(w," ")).join(f.isWindows?`\r
`:`
`)}clearSelection(){this._model.clearSelection(),this._removeMouseDownListeners(),this.refresh(),this._onSelectionChange.fire()}refresh(C){this._refreshAnimationFrame||(this._refreshAnimationFrame=this._coreBrowserService.window.requestAnimationFrame(()=>this._refresh())),f.isLinux&&C&&this.selectionText.length&&this._onLinuxMouseSelection.fire(this.selectionText)}_refresh(){this._refreshAnimationFrame=void 0,this._onRedrawRequest.fire({start:this._model.finalSelectionStart,end:this._model.finalSelectionEnd,columnSelectMode:this._activeSelectionMode===3})}_isClickInSelection(C){const E=this._getMouseBufferCoords(C),x=this._model.finalSelectionStart,I=this._model.finalSelectionEnd;return!!(x&&I&&E)&&this._areCoordsInSelection(E,x,I)}isCellInSelection(C,E){const x=this._model.finalSelectionStart,I=this._model.finalSelectionEnd;return!(!x||!I)&&this._areCoordsInSelection([C,E],x,I)}_areCoordsInSelection(C,E,x){return C[1]>E[1]&&C[1]<x[1]||E[1]===x[1]&&C[1]===E[1]&&C[0]>=E[0]&&C[0]<x[0]||E[1]<x[1]&&C[1]===x[1]&&C[0]<x[0]||E[1]<x[1]&&C[1]===E[1]&&C[0]>=E[0]}_selectWordAtCursor(C,E){var A,P;const x=(P=(A=this._linkifier.currentLink)==null?void 0:A.link)==null?void 0:P.range;if(x)return this._model.selectionStart=[x.start.x-1,x.start.y-1],this._model.selectionStartLength=(0,h.getRangeLength)(x,this._bufferService.cols),this._model.selectionEnd=void 0,!0;const I=this._getMouseBufferCoords(C);return!!I&&(this._selectWordAt(I,E),this._model.selectionEnd=void 0,!0)}selectAll(){this._model.isSelectAllActive=!0,this.refresh(),this._onSelectionChange.fire()}selectLines(C,E){this._model.clearSelection(),C=Math.max(C,0),E=Math.min(E,this._bufferService.buffer.lines.length-1),this._model.selectionStart=[0,C],this._model.selectionEnd=[this._bufferService.cols,E],this.refresh(),this._onSelectionChange.fire()}_handleTrim(C){this._model.handleTrim(C)&&this.refresh()}_getMouseBufferCoords(C){const E=this._mouseService.getCoords(C,this._screenElement,this._bufferService.cols,this._bufferService.rows,!0);if(E)return E[0]--,E[1]--,E[1]+=this._bufferService.buffer.ydisp,E}_getMouseEventScrollAmount(C){let E=(0,u.getCoordsRelativeToElement)(this._coreBrowserService.window,C,this._screenElement)[1];const x=this._renderService.dimensions.css.canvas.height;return E>=0&&E<=x?0:(E>x&&(E-=x),E=Math.min(Math.max(E,-50),50),E/=50,E/Math.abs(E)+Math.round(14*E))}shouldForceSelection(C){return f.isMac?C.altKey&&this._optionsService.rawOptions.macOptionClickForcesSelection:C.shiftKey}handleMouseDown(C){if(this._mouseDownTimeStamp=C.timeStamp,(C.button!==2||!this.hasSelection)&&C.button===0){if(!this._enabled){if(!this.shouldForceSelection(C))return;C.stopPropagation()}C.preventDefault(),this._dragScrollAmount=0,this._enabled&&C.shiftKey?this._handleIncrementalClick(C):C.detail===1?this._handleSingleClick(C):C.detail===2?this._handleDoubleClick(C):C.detail===3&&this._handleTripleClick(C),this._addMouseDownListeners(),this.refresh(!0)}}_addMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.addEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.addEventListener("mouseup",this._mouseUpListener)),this._dragScrollIntervalTimer=this._coreBrowserService.window.setInterval(()=>this._dragScroll(),50)}_removeMouseDownListeners(){this._screenElement.ownerDocument&&(this._screenElement.ownerDocument.removeEventListener("mousemove",this._mouseMoveListener),this._screenElement.ownerDocument.removeEventListener("mouseup",this._mouseUpListener)),this._coreBrowserService.window.clearInterval(this._dragScrollIntervalTimer),this._dragScrollIntervalTimer=void 0}_handleIncrementalClick(C){this._model.selectionStart&&(this._model.selectionEnd=this._getMouseBufferCoords(C))}_handleSingleClick(C){if(this._model.selectionStartLength=0,this._model.isSelectAllActive=!1,this._activeSelectionMode=this.shouldColumnSelect(C)?3:0,this._model.selectionStart=this._getMouseBufferCoords(C),!this._model.selectionStart)return;this._model.selectionEnd=void 0;const E=this._bufferService.buffer.lines.get(this._model.selectionStart[1]);E&&E.length!==this._model.selectionStart[0]&&E.hasWidth(this._model.selectionStart[0])===0&&this._model.selectionStart[0]++}_handleDoubleClick(C){this._selectWordAtCursor(C,!0)&&(this._activeSelectionMode=1)}_handleTripleClick(C){const E=this._getMouseBufferCoords(C);E&&(this._activeSelectionMode=2,this._selectLineAt(E[1]))}shouldColumnSelect(C){return C.altKey&&!(f.isMac&&this._optionsService.rawOptions.macOptionClickForcesSelection)}_handleMouseMove(C){if(C.stopImmediatePropagation(),!this._model.selectionStart)return;const E=this._model.selectionEnd?[this._model.selectionEnd[0],this._model.selectionEnd[1]]:null;if(this._model.selectionEnd=this._getMouseBufferCoords(C),!this._model.selectionEnd)return void this.refresh(!0);this._activeSelectionMode===2?this._model.selectionEnd[1]<this._model.selectionStart[1]?this._model.selectionEnd[0]=0:this._model.selectionEnd[0]=this._bufferService.cols:this._activeSelectionMode===1&&this._selectToWordAt(this._model.selectionEnd),this._dragScrollAmount=this._getMouseEventScrollAmount(C),this._activeSelectionMode!==3&&(this._dragScrollAmount>0?this._model.selectionEnd[0]=this._bufferService.cols:this._dragScrollAmount<0&&(this._model.selectionEnd[0]=0));const x=this._bufferService.buffer;if(this._model.selectionEnd[1]<x.lines.length){const I=x.lines.get(this._model.selectionEnd[1]);I&&I.hasWidth(this._model.selectionEnd[0])===0&&this._model.selectionEnd[0]<this._bufferService.cols&&this._model.selectionEnd[0]++}E&&E[0]===this._model.selectionEnd[0]&&E[1]===this._model.selectionEnd[1]||this.refresh(!0)}_dragScroll(){if(this._model.selectionEnd&&this._model.selectionStart&&this._dragScrollAmount){this._onRequestScrollLines.fire({amount:this._dragScrollAmount,suppressScrollEvent:!1});const C=this._bufferService.buffer;this._dragScrollAmount>0?(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=this._bufferService.cols),this._model.selectionEnd[1]=Math.min(C.ydisp+this._bufferService.rows,C.lines.length-1)):(this._activeSelectionMode!==3&&(this._model.selectionEnd[0]=0),this._model.selectionEnd[1]=C.ydisp),this.refresh()}}_handleMouseUp(C){const E=C.timeStamp-this._mouseDownTimeStamp;if(this._removeMouseDownListeners(),this.selectionText.length<=1&&E<500&&C.altKey&&this._optionsService.rawOptions.altClickMovesCursor){if(this._bufferService.buffer.ybase===this._bufferService.buffer.ydisp){const x=this._mouseService.getCoords(C,this._element,this._bufferService.cols,this._bufferService.rows,!1);if(x&&x[0]!==void 0&&x[1]!==void 0){const I=(0,m.moveToCellSequence)(x[0]-1,x[1]-1,this._bufferService,this._coreService.decPrivateModes.applicationCursorKeys);this._coreService.triggerDataEvent(I,!0)}}}else this._fireEventIfSelectionChanged()}_fireEventIfSelectionChanged(){const C=this._model.finalSelectionStart,E=this._model.finalSelectionEnd,x=!(!C||!E||C[0]===E[0]&&C[1]===E[1]);x?C&&E&&(this._oldSelectionStart&&this._oldSelectionEnd&&C[0]===this._oldSelectionStart[0]&&C[1]===this._oldSelectionStart[1]&&E[0]===this._oldSelectionEnd[0]&&E[1]===this._oldSelectionEnd[1]||this._fireOnSelectionChange(C,E,x)):this._oldHasSelection&&this._fireOnSelectionChange(C,E,x)}_fireOnSelectionChange(C,E,x){this._oldSelectionStart=C,this._oldSelectionEnd=E,this._oldHasSelection=x,this._onSelectionChange.fire()}_handleBufferActivate(C){this.clearSelection(),this._trimListener.dispose(),this._trimListener=C.activeBuffer.lines.onTrim(E=>this._handleTrim(E))}_convertViewportColToCharacterIndex(C,E){let x=E;for(let I=0;E>=I;I++){const A=C.loadCell(I,this._workCell).getChars().length;this._workCell.getWidth()===0?x--:A>1&&E!==I&&(x+=A-1)}return x}setSelection(C,E,x){this._model.clearSelection(),this._removeMouseDownListeners(),this._model.selectionStart=[C,E],this._model.selectionStartLength=x,this.refresh(),this._fireEventIfSelectionChanged()}rightClickSelect(C){this._isClickInSelection(C)||(this._selectWordAtCursor(C,!1)&&this.refresh(!0),this._fireEventIfSelectionChanged())}_getWordAt(C,E,x=!0,I=!0){if(C[0]>=this._bufferService.cols)return;const A=this._bufferService.buffer,P=A.lines.get(C[1]);if(!P)return;const F=A.translateBufferLineToString(C[1],!1);let B=this._convertViewportColToCharacterIndex(P,C[0]),j=B;const X=C[0]-B;let U=0,R=0,M=0,D=0;if(F.charAt(B)===" "){for(;B>0&&F.charAt(B-1)===" ";)B--;for(;j<F.length&&F.charAt(j+1)===" ";)j++}else{let ne=C[0],ce=C[0];P.getWidth(ne)===0&&(U++,ne--),P.getWidth(ce)===2&&(R++,ce++);const de=P.getString(ce).length;for(de>1&&(D+=de-1,j+=de-1);ne>0&&B>0&&!this._isCharWordSeparator(P.loadCell(ne-1,this._workCell));){P.loadCell(ne-1,this._workCell);const z=this._workCell.getChars().length;this._workCell.getWidth()===0?(U++,ne--):z>1&&(M+=z-1,B-=z-1),B--,ne--}for(;ce<P.length&&j+1<F.length&&!this._isCharWordSeparator(P.loadCell(ce+1,this._workCell));){P.loadCell(ce+1,this._workCell);const z=this._workCell.getChars().length;this._workCell.getWidth()===2?(R++,ce++):z>1&&(D+=z-1,j+=z-1),j++,ce++}}j++;let N=B+X-U+M,q=Math.min(this._bufferService.cols,j-B+U+R-M-D);if(E||F.slice(B,j).trim()!==""){if(x&&N===0&&P.getCodePoint(0)!==32){const ne=A.lines.get(C[1]-1);if(ne&&P.isWrapped&&ne.getCodePoint(this._bufferService.cols-1)!==32){const ce=this._getWordAt([this._bufferService.cols-1,C[1]-1],!1,!0,!1);if(ce){const de=this._bufferService.cols-ce.start;N-=de,q+=de}}}if(I&&N+q===this._bufferService.cols&&P.getCodePoint(this._bufferService.cols-1)!==32){const ne=A.lines.get(C[1]+1);if(ne!=null&&ne.isWrapped&&ne.getCodePoint(0)!==32){const ce=this._getWordAt([0,C[1]+1],!1,!1,!0);ce&&(q+=ce.length)}}return{start:N,length:q}}}_selectWordAt(C,E){const x=this._getWordAt(C,E);if(x){for(;x.start<0;)x.start+=this._bufferService.cols,C[1]--;this._model.selectionStart=[x.start,C[1]],this._model.selectionStartLength=x.length}}_selectToWordAt(C){const E=this._getWordAt(C,!0);if(E){let x=C[1];for(;E.start<0;)E.start+=this._bufferService.cols,x--;if(!this._model.areSelectionValuesReversed())for(;E.start+E.length>this._bufferService.cols;)E.length-=this._bufferService.cols,x++;this._model.selectionEnd=[this._model.areSelectionValuesReversed()?E.start:E.start+E.length,x]}}_isCharWordSeparator(C){return C.getWidth()!==0&&this._optionsService.rawOptions.wordSeparator.indexOf(C.getChars())>=0}_selectLineAt(C){const E=this._bufferService.buffer.getWrappedRangeForLine(C),x={start:{x:0,y:E.first},end:{x:this._bufferService.cols-1,y:E.last}};this._model.selectionStart=[0,E.first],this._model.selectionEnd=void 0,this._model.selectionStartLength=(0,h.getRangeLength)(x,this._bufferService.cols)}};o.SelectionService=k=c([d(3,S.IBufferService),d(4,S.ICoreService),d(5,y.IMouseService),d(6,S.IOptionsService),d(7,y.IRenderService),d(8,y.ICoreBrowserService)],k)},4725:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ILinkProviderService=o.IThemeService=o.ICharacterJoinerService=o.ISelectionService=o.IRenderService=o.IMouseService=o.ICoreBrowserService=o.ICharSizeService=void 0;const c=l(8343);o.ICharSizeService=(0,c.createDecorator)("CharSizeService"),o.ICoreBrowserService=(0,c.createDecorator)("CoreBrowserService"),o.IMouseService=(0,c.createDecorator)("MouseService"),o.IRenderService=(0,c.createDecorator)("RenderService"),o.ISelectionService=(0,c.createDecorator)("SelectionService"),o.ICharacterJoinerService=(0,c.createDecorator)("CharacterJoinerService"),o.IThemeService=(0,c.createDecorator)("ThemeService"),o.ILinkProviderService=(0,c.createDecorator)("LinkProviderService")},6731:function(a,o,l){var c=this&&this.__decorate||function(k,C,E,x){var I,A=arguments.length,P=A<3?C:x===null?x=Object.getOwnPropertyDescriptor(C,E):x;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")P=Reflect.decorate(k,C,E,x);else for(var F=k.length-1;F>=0;F--)(I=k[F])&&(P=(A<3?I(P):A>3?I(C,E,P):I(C,E))||P);return A>3&&P&&Object.defineProperty(C,E,P),P},d=this&&this.__param||function(k,C){return function(E,x){C(E,x,k)}};Object.defineProperty(o,"__esModule",{value:!0}),o.ThemeService=o.DEFAULT_ANSI_COLORS=void 0;const u=l(7239),m=l(8055),v=l(8460),y=l(844),_=l(2585),p=m.css.toColor("#ffffff"),f=m.css.toColor("#000000"),h=m.css.toColor("#ffffff"),g=m.css.toColor("#000000"),S={css:"rgba(255, 255, 255, 0.3)",rgba:4294967117};o.DEFAULT_ANSI_COLORS=Object.freeze((()=>{const k=[m.css.toColor("#2e3436"),m.css.toColor("#cc0000"),m.css.toColor("#4e9a06"),m.css.toColor("#c4a000"),m.css.toColor("#3465a4"),m.css.toColor("#75507b"),m.css.toColor("#06989a"),m.css.toColor("#d3d7cf"),m.css.toColor("#555753"),m.css.toColor("#ef2929"),m.css.toColor("#8ae234"),m.css.toColor("#fce94f"),m.css.toColor("#729fcf"),m.css.toColor("#ad7fa8"),m.css.toColor("#34e2e2"),m.css.toColor("#eeeeec")],C=[0,95,135,175,215,255];for(let E=0;E<216;E++){const x=C[E/36%6|0],I=C[E/6%6|0],A=C[E%6];k.push({css:m.channels.toCss(x,I,A),rgba:m.channels.toRgba(x,I,A)})}for(let E=0;E<24;E++){const x=8+10*E;k.push({css:m.channels.toCss(x,x,x),rgba:m.channels.toRgba(x,x,x)})}return k})());let b=o.ThemeService=class extends y.Disposable{get colors(){return this._colors}constructor(k){super(),this._optionsService=k,this._contrastCache=new u.ColorContrastCache,this._halfContrastCache=new u.ColorContrastCache,this._onChangeColors=this.register(new v.EventEmitter),this.onChangeColors=this._onChangeColors.event,this._colors={foreground:p,background:f,cursor:h,cursorAccent:g,selectionForeground:void 0,selectionBackgroundTransparent:S,selectionBackgroundOpaque:m.color.blend(f,S),selectionInactiveBackgroundTransparent:S,selectionInactiveBackgroundOpaque:m.color.blend(f,S),ansi:o.DEFAULT_ANSI_COLORS.slice(),contrastCache:this._contrastCache,halfContrastCache:this._halfContrastCache},this._updateRestoreColors(),this._setTheme(this._optionsService.rawOptions.theme),this.register(this._optionsService.onSpecificOptionChange("minimumContrastRatio",()=>this._contrastCache.clear())),this.register(this._optionsService.onSpecificOptionChange("theme",()=>this._setTheme(this._optionsService.rawOptions.theme)))}_setTheme(k={}){const C=this._colors;if(C.foreground=w(k.foreground,p),C.background=w(k.background,f),C.cursor=w(k.cursor,h),C.cursorAccent=w(k.cursorAccent,g),C.selectionBackgroundTransparent=w(k.selectionBackground,S),C.selectionBackgroundOpaque=m.color.blend(C.background,C.selectionBackgroundTransparent),C.selectionInactiveBackgroundTransparent=w(k.selectionInactiveBackground,C.selectionBackgroundTransparent),C.selectionInactiveBackgroundOpaque=m.color.blend(C.background,C.selectionInactiveBackgroundTransparent),C.selectionForeground=k.selectionForeground?w(k.selectionForeground,m.NULL_COLOR):void 0,C.selectionForeground===m.NULL_COLOR&&(C.selectionForeground=void 0),m.color.isOpaque(C.selectionBackgroundTransparent)&&(C.selectionBackgroundTransparent=m.color.opacity(C.selectionBackgroundTransparent,.3)),m.color.isOpaque(C.selectionInactiveBackgroundTransparent)&&(C.selectionInactiveBackgroundTransparent=m.color.opacity(C.selectionInactiveBackgroundTransparent,.3)),C.ansi=o.DEFAULT_ANSI_COLORS.slice(),C.ansi[0]=w(k.black,o.DEFAULT_ANSI_COLORS[0]),C.ansi[1]=w(k.red,o.DEFAULT_ANSI_COLORS[1]),C.ansi[2]=w(k.green,o.DEFAULT_ANSI_COLORS[2]),C.ansi[3]=w(k.yellow,o.DEFAULT_ANSI_COLORS[3]),C.ansi[4]=w(k.blue,o.DEFAULT_ANSI_COLORS[4]),C.ansi[5]=w(k.magenta,o.DEFAULT_ANSI_COLORS[5]),C.ansi[6]=w(k.cyan,o.DEFAULT_ANSI_COLORS[6]),C.ansi[7]=w(k.white,o.DEFAULT_ANSI_COLORS[7]),C.ansi[8]=w(k.brightBlack,o.DEFAULT_ANSI_COLORS[8]),C.ansi[9]=w(k.brightRed,o.DEFAULT_ANSI_COLORS[9]),C.ansi[10]=w(k.brightGreen,o.DEFAULT_ANSI_COLORS[10]),C.ansi[11]=w(k.brightYellow,o.DEFAULT_ANSI_COLORS[11]),C.ansi[12]=w(k.brightBlue,o.DEFAULT_ANSI_COLORS[12]),C.ansi[13]=w(k.brightMagenta,o.DEFAULT_ANSI_COLORS[13]),C.ansi[14]=w(k.brightCyan,o.DEFAULT_ANSI_COLORS[14]),C.ansi[15]=w(k.brightWhite,o.DEFAULT_ANSI_COLORS[15]),k.extendedAnsi){const E=Math.min(C.ansi.length-16,k.extendedAnsi.length);for(let x=0;x<E;x++)C.ansi[x+16]=w(k.extendedAnsi[x],o.DEFAULT_ANSI_COLORS[x+16])}this._contrastCache.clear(),this._halfContrastCache.clear(),this._updateRestoreColors(),this._onChangeColors.fire(this.colors)}restoreColor(k){this._restoreColor(k),this._onChangeColors.fire(this.colors)}_restoreColor(k){if(k!==void 0)switch(k){case 256:this._colors.foreground=this._restoreColors.foreground;break;case 257:this._colors.background=this._restoreColors.background;break;case 258:this._colors.cursor=this._restoreColors.cursor;break;default:this._colors.ansi[k]=this._restoreColors.ansi[k]}else for(let C=0;C<this._restoreColors.ansi.length;++C)this._colors.ansi[C]=this._restoreColors.ansi[C]}modifyColors(k){k(this._colors),this._onChangeColors.fire(this.colors)}_updateRestoreColors(){this._restoreColors={foreground:this._colors.foreground,background:this._colors.background,cursor:this._colors.cursor,ansi:this._colors.ansi.slice()}}};function w(k,C){if(k!==void 0)try{return m.css.toColor(k)}catch{}return C}o.ThemeService=b=c([d(0,_.IOptionsService)],b)},6349:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CircularList=void 0;const c=l(8460),d=l(844);class u extends d.Disposable{constructor(v){super(),this._maxLength=v,this.onDeleteEmitter=this.register(new c.EventEmitter),this.onDelete=this.onDeleteEmitter.event,this.onInsertEmitter=this.register(new c.EventEmitter),this.onInsert=this.onInsertEmitter.event,this.onTrimEmitter=this.register(new c.EventEmitter),this.onTrim=this.onTrimEmitter.event,this._array=new Array(this._maxLength),this._startIndex=0,this._length=0}get maxLength(){return this._maxLength}set maxLength(v){if(this._maxLength===v)return;const y=new Array(v);for(let _=0;_<Math.min(v,this.length);_++)y[_]=this._array[this._getCyclicIndex(_)];this._array=y,this._maxLength=v,this._startIndex=0}get length(){return this._length}set length(v){if(v>this._length)for(let y=this._length;y<v;y++)this._array[y]=void 0;this._length=v}get(v){return this._array[this._getCyclicIndex(v)]}set(v,y){this._array[this._getCyclicIndex(v)]=y}push(v){this._array[this._getCyclicIndex(this._length)]=v,this._length===this._maxLength?(this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1)):this._length++}recycle(){if(this._length!==this._maxLength)throw new Error("Can only recycle when the buffer is full");return this._startIndex=++this._startIndex%this._maxLength,this.onTrimEmitter.fire(1),this._array[this._getCyclicIndex(this._length-1)]}get isFull(){return this._length===this._maxLength}pop(){return this._array[this._getCyclicIndex(this._length---1)]}splice(v,y,..._){if(y){for(let p=v;p<this._length-y;p++)this._array[this._getCyclicIndex(p)]=this._array[this._getCyclicIndex(p+y)];this._length-=y,this.onDeleteEmitter.fire({index:v,amount:y})}for(let p=this._length-1;p>=v;p--)this._array[this._getCyclicIndex(p+_.length)]=this._array[this._getCyclicIndex(p)];for(let p=0;p<_.length;p++)this._array[this._getCyclicIndex(v+p)]=_[p];if(_.length&&this.onInsertEmitter.fire({index:v,amount:_.length}),this._length+_.length>this._maxLength){const p=this._length+_.length-this._maxLength;this._startIndex+=p,this._length=this._maxLength,this.onTrimEmitter.fire(p)}else this._length+=_.length}trimStart(v){v>this._length&&(v=this._length),this._startIndex+=v,this._length-=v,this.onTrimEmitter.fire(v)}shiftElements(v,y,_){if(!(y<=0)){if(v<0||v>=this._length)throw new Error("start argument out of range");if(v+_<0)throw new Error("Cannot shift elements in list beyond index 0");if(_>0){for(let f=y-1;f>=0;f--)this.set(v+f+_,this.get(v+f));const p=v+y+_-this._length;if(p>0)for(this._length+=p;this._length>this._maxLength;)this._length--,this._startIndex++,this.onTrimEmitter.fire(1)}else for(let p=0;p<y;p++)this.set(v+p+_,this.get(v+p))}}_getCyclicIndex(v){return(this._startIndex+v)%this._maxLength}}o.CircularList=u},1439:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.clone=void 0,o.clone=function l(c,d=5){if(typeof c!="object")return c;const u=Array.isArray(c)?[]:{};for(const m in c)u[m]=d<=1?c[m]:c[m]&&l(c[m],d-1);return u}},8055:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.contrastRatio=o.toPaddedHex=o.rgba=o.rgb=o.css=o.color=o.channels=o.NULL_COLOR=void 0;let l=0,c=0,d=0,u=0;var m,v,y,_,p;function f(g){const S=g.toString(16);return S.length<2?"0"+S:S}function h(g,S){return g<S?(S+.05)/(g+.05):(g+.05)/(S+.05)}o.NULL_COLOR={css:"#00000000",rgba:0},function(g){g.toCss=function(S,b,w,k){return k!==void 0?`#${f(S)}${f(b)}${f(w)}${f(k)}`:`#${f(S)}${f(b)}${f(w)}`},g.toRgba=function(S,b,w,k=255){return(S<<24|b<<16|w<<8|k)>>>0},g.toColor=function(S,b,w,k){return{css:g.toCss(S,b,w,k),rgba:g.toRgba(S,b,w,k)}}}(m||(o.channels=m={})),function(g){function S(b,w){return u=Math.round(255*w),[l,c,d]=p.toChannels(b.rgba),{css:m.toCss(l,c,d,u),rgba:m.toRgba(l,c,d,u)}}g.blend=function(b,w){if(u=(255&w.rgba)/255,u===1)return{css:w.css,rgba:w.rgba};const k=w.rgba>>24&255,C=w.rgba>>16&255,E=w.rgba>>8&255,x=b.rgba>>24&255,I=b.rgba>>16&255,A=b.rgba>>8&255;return l=x+Math.round((k-x)*u),c=I+Math.round((C-I)*u),d=A+Math.round((E-A)*u),{css:m.toCss(l,c,d),rgba:m.toRgba(l,c,d)}},g.isOpaque=function(b){return(255&b.rgba)==255},g.ensureContrastRatio=function(b,w,k){const C=p.ensureContrastRatio(b.rgba,w.rgba,k);if(C)return m.toColor(C>>24&255,C>>16&255,C>>8&255)},g.opaque=function(b){const w=(255|b.rgba)>>>0;return[l,c,d]=p.toChannels(w),{css:m.toCss(l,c,d),rgba:w}},g.opacity=S,g.multiplyOpacity=function(b,w){return u=255&b.rgba,S(b,u*w/255)},g.toColorRGB=function(b){return[b.rgba>>24&255,b.rgba>>16&255,b.rgba>>8&255]}}(v||(o.color=v={})),function(g){let S,b;try{const w=document.createElement("canvas");w.width=1,w.height=1;const k=w.getContext("2d",{willReadFrequently:!0});k&&(S=k,S.globalCompositeOperation="copy",b=S.createLinearGradient(0,0,1,1))}catch{}g.toColor=function(w){if(w.match(/#[\da-f]{3,8}/i))switch(w.length){case 4:return l=parseInt(w.slice(1,2).repeat(2),16),c=parseInt(w.slice(2,3).repeat(2),16),d=parseInt(w.slice(3,4).repeat(2),16),m.toColor(l,c,d);case 5:return l=parseInt(w.slice(1,2).repeat(2),16),c=parseInt(w.slice(2,3).repeat(2),16),d=parseInt(w.slice(3,4).repeat(2),16),u=parseInt(w.slice(4,5).repeat(2),16),m.toColor(l,c,d,u);case 7:return{css:w,rgba:(parseInt(w.slice(1),16)<<8|255)>>>0};case 9:return{css:w,rgba:parseInt(w.slice(1),16)>>>0}}const k=w.match(/rgba?\(\s*(\d{1,3})\s*,\s*(\d{1,3})\s*,\s*(\d{1,3})\s*(,\s*(0|1|\d?\.(\d+))\s*)?\)/);if(k)return l=parseInt(k[1]),c=parseInt(k[2]),d=parseInt(k[3]),u=Math.round(255*(k[5]===void 0?1:parseFloat(k[5]))),m.toColor(l,c,d,u);if(!S||!b)throw new Error("css.toColor: Unsupported css format");if(S.fillStyle=b,S.fillStyle=w,typeof S.fillStyle!="string")throw new Error("css.toColor: Unsupported css format");if(S.fillRect(0,0,1,1),[l,c,d,u]=S.getImageData(0,0,1,1).data,u!==255)throw new Error("css.toColor: Unsupported css format");return{rgba:m.toRgba(l,c,d,u),css:w}}}(y||(o.css=y={})),function(g){function S(b,w,k){const C=b/255,E=w/255,x=k/255;return .2126*(C<=.03928?C/12.92:Math.pow((C+.055)/1.055,2.4))+.7152*(E<=.03928?E/12.92:Math.pow((E+.055)/1.055,2.4))+.0722*(x<=.03928?x/12.92:Math.pow((x+.055)/1.055,2.4))}g.relativeLuminance=function(b){return S(b>>16&255,b>>8&255,255&b)},g.relativeLuminance2=S}(_||(o.rgb=_={})),function(g){function S(w,k,C){const E=w>>24&255,x=w>>16&255,I=w>>8&255;let A=k>>24&255,P=k>>16&255,F=k>>8&255,B=h(_.relativeLuminance2(A,P,F),_.relativeLuminance2(E,x,I));for(;B<C&&(A>0||P>0||F>0);)A-=Math.max(0,Math.ceil(.1*A)),P-=Math.max(0,Math.ceil(.1*P)),F-=Math.max(0,Math.ceil(.1*F)),B=h(_.relativeLuminance2(A,P,F),_.relativeLuminance2(E,x,I));return(A<<24|P<<16|F<<8|255)>>>0}function b(w,k,C){const E=w>>24&255,x=w>>16&255,I=w>>8&255;let A=k>>24&255,P=k>>16&255,F=k>>8&255,B=h(_.relativeLuminance2(A,P,F),_.relativeLuminance2(E,x,I));for(;B<C&&(A<255||P<255||F<255);)A=Math.min(255,A+Math.ceil(.1*(255-A))),P=Math.min(255,P+Math.ceil(.1*(255-P))),F=Math.min(255,F+Math.ceil(.1*(255-F))),B=h(_.relativeLuminance2(A,P,F),_.relativeLuminance2(E,x,I));return(A<<24|P<<16|F<<8|255)>>>0}g.blend=function(w,k){if(u=(255&k)/255,u===1)return k;const C=k>>24&255,E=k>>16&255,x=k>>8&255,I=w>>24&255,A=w>>16&255,P=w>>8&255;return l=I+Math.round((C-I)*u),c=A+Math.round((E-A)*u),d=P+Math.round((x-P)*u),m.toRgba(l,c,d)},g.ensureContrastRatio=function(w,k,C){const E=_.relativeLuminance(w>>8),x=_.relativeLuminance(k>>8);if(h(E,x)<C){if(x<E){const P=S(w,k,C),F=h(E,_.relativeLuminance(P>>8));if(F<C){const B=b(w,k,C);return F>h(E,_.relativeLuminance(B>>8))?P:B}return P}const I=b(w,k,C),A=h(E,_.relativeLuminance(I>>8));if(A<C){const P=S(w,k,C);return A>h(E,_.relativeLuminance(P>>8))?I:P}return I}},g.reduceLuminance=S,g.increaseLuminance=b,g.toChannels=function(w){return[w>>24&255,w>>16&255,w>>8&255,255&w]}}(p||(o.rgba=p={})),o.toPaddedHex=f,o.contrastRatio=h},8969:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CoreTerminal=void 0;const c=l(844),d=l(2585),u=l(4348),m=l(7866),v=l(744),y=l(7302),_=l(6975),p=l(8460),f=l(1753),h=l(1480),g=l(7994),S=l(9282),b=l(5435),w=l(5981),k=l(2660);let C=!1;class E extends c.Disposable{get onScroll(){return this._onScrollApi||(this._onScrollApi=this.register(new p.EventEmitter),this._onScroll.event(I=>{var A;(A=this._onScrollApi)==null||A.fire(I.position)})),this._onScrollApi.event}get cols(){return this._bufferService.cols}get rows(){return this._bufferService.rows}get buffers(){return this._bufferService.buffers}get options(){return this.optionsService.options}set options(I){for(const A in I)this.optionsService.options[A]=I[A]}constructor(I){super(),this._windowsWrappingHeuristics=this.register(new c.MutableDisposable),this._onBinary=this.register(new p.EventEmitter),this.onBinary=this._onBinary.event,this._onData=this.register(new p.EventEmitter),this.onData=this._onData.event,this._onLineFeed=this.register(new p.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onResize=this.register(new p.EventEmitter),this.onResize=this._onResize.event,this._onWriteParsed=this.register(new p.EventEmitter),this.onWriteParsed=this._onWriteParsed.event,this._onScroll=this.register(new p.EventEmitter),this._instantiationService=new u.InstantiationService,this.optionsService=this.register(new y.OptionsService(I)),this._instantiationService.setService(d.IOptionsService,this.optionsService),this._bufferService=this.register(this._instantiationService.createInstance(v.BufferService)),this._instantiationService.setService(d.IBufferService,this._bufferService),this._logService=this.register(this._instantiationService.createInstance(m.LogService)),this._instantiationService.setService(d.ILogService,this._logService),this.coreService=this.register(this._instantiationService.createInstance(_.CoreService)),this._instantiationService.setService(d.ICoreService,this.coreService),this.coreMouseService=this.register(this._instantiationService.createInstance(f.CoreMouseService)),this._instantiationService.setService(d.ICoreMouseService,this.coreMouseService),this.unicodeService=this.register(this._instantiationService.createInstance(h.UnicodeService)),this._instantiationService.setService(d.IUnicodeService,this.unicodeService),this._charsetService=this._instantiationService.createInstance(g.CharsetService),this._instantiationService.setService(d.ICharsetService,this._charsetService),this._oscLinkService=this._instantiationService.createInstance(k.OscLinkService),this._instantiationService.setService(d.IOscLinkService,this._oscLinkService),this._inputHandler=this.register(new b.InputHandler(this._bufferService,this._charsetService,this.coreService,this._logService,this.optionsService,this._oscLinkService,this.coreMouseService,this.unicodeService)),this.register((0,p.forwardEvent)(this._inputHandler.onLineFeed,this._onLineFeed)),this.register(this._inputHandler),this.register((0,p.forwardEvent)(this._bufferService.onResize,this._onResize)),this.register((0,p.forwardEvent)(this.coreService.onData,this._onData)),this.register((0,p.forwardEvent)(this.coreService.onBinary,this._onBinary)),this.register(this.coreService.onRequestScrollToBottom(()=>this.scrollToBottom())),this.register(this.coreService.onUserInput(()=>this._writeBuffer.handleUserInput())),this.register(this.optionsService.onMultipleOptionChange(["windowsMode","windowsPty"],()=>this._handleWindowsPtyOptionChange())),this.register(this._bufferService.onScroll(A=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this.register(this._inputHandler.onScroll(A=>{this._onScroll.fire({position:this._bufferService.buffer.ydisp,source:0}),this._inputHandler.markRangeDirty(this._bufferService.buffer.scrollTop,this._bufferService.buffer.scrollBottom)})),this._writeBuffer=this.register(new w.WriteBuffer((A,P)=>this._inputHandler.parse(A,P))),this.register((0,p.forwardEvent)(this._writeBuffer.onWriteParsed,this._onWriteParsed))}write(I,A){this._writeBuffer.write(I,A)}writeSync(I,A){this._logService.logLevel<=d.LogLevelEnum.WARN&&!C&&(this._logService.warn("writeSync is unreliable and will be removed soon."),C=!0),this._writeBuffer.writeSync(I,A)}input(I,A=!0){this.coreService.triggerDataEvent(I,A)}resize(I,A){isNaN(I)||isNaN(A)||(I=Math.max(I,v.MINIMUM_COLS),A=Math.max(A,v.MINIMUM_ROWS),this._bufferService.resize(I,A))}scroll(I,A=!1){this._bufferService.scroll(I,A)}scrollLines(I,A,P){this._bufferService.scrollLines(I,A,P)}scrollPages(I){this.scrollLines(I*(this.rows-1))}scrollToTop(){this.scrollLines(-this._bufferService.buffer.ydisp)}scrollToBottom(){this.scrollLines(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp)}scrollToLine(I){const A=I-this._bufferService.buffer.ydisp;A!==0&&this.scrollLines(A)}registerEscHandler(I,A){return this._inputHandler.registerEscHandler(I,A)}registerDcsHandler(I,A){return this._inputHandler.registerDcsHandler(I,A)}registerCsiHandler(I,A){return this._inputHandler.registerCsiHandler(I,A)}registerOscHandler(I,A){return this._inputHandler.registerOscHandler(I,A)}_setup(){this._handleWindowsPtyOptionChange()}reset(){this._inputHandler.reset(),this._bufferService.reset(),this._charsetService.reset(),this.coreService.reset(),this.coreMouseService.reset()}_handleWindowsPtyOptionChange(){let I=!1;const A=this.optionsService.rawOptions.windowsPty;A&&A.buildNumber!==void 0&&A.buildNumber!==void 0?I=A.backend==="conpty"&&A.buildNumber<21376:this.optionsService.rawOptions.windowsMode&&(I=!0),I?this._enableWindowsWrappingHeuristics():this._windowsWrappingHeuristics.clear()}_enableWindowsWrappingHeuristics(){if(!this._windowsWrappingHeuristics.value){const I=[];I.push(this.onLineFeed(S.updateWindowsModeWrappedState.bind(null,this._bufferService))),I.push(this.registerCsiHandler({final:"H"},()=>((0,S.updateWindowsModeWrappedState)(this._bufferService),!1))),this._windowsWrappingHeuristics.value=(0,c.toDisposable)(()=>{for(const A of I)A.dispose()})}}}o.CoreTerminal=E},8460:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.runAndSubscribe=o.forwardEvent=o.EventEmitter=void 0,o.EventEmitter=class{constructor(){this._listeners=[],this._disposed=!1}get event(){return this._event||(this._event=l=>(this._listeners.push(l),{dispose:()=>{if(!this._disposed){for(let c=0;c<this._listeners.length;c++)if(this._listeners[c]===l)return void this._listeners.splice(c,1)}}})),this._event}fire(l,c){const d=[];for(let u=0;u<this._listeners.length;u++)d.push(this._listeners[u]);for(let u=0;u<d.length;u++)d[u].call(void 0,l,c)}dispose(){this.clearListeners(),this._disposed=!0}clearListeners(){this._listeners&&(this._listeners.length=0)}},o.forwardEvent=function(l,c){return l(d=>c.fire(d))},o.runAndSubscribe=function(l,c){return c(void 0),l(d=>c(d))}},5435:function(a,o,l){var c=this&&this.__decorate||function(U,R,M,D){var N,q=arguments.length,ne=q<3?R:D===null?D=Object.getOwnPropertyDescriptor(R,M):D;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")ne=Reflect.decorate(U,R,M,D);else for(var ce=U.length-1;ce>=0;ce--)(N=U[ce])&&(ne=(q<3?N(ne):q>3?N(R,M,ne):N(R,M))||ne);return q>3&&ne&&Object.defineProperty(R,M,ne),ne},d=this&&this.__param||function(U,R){return function(M,D){R(M,D,U)}};Object.defineProperty(o,"__esModule",{value:!0}),o.InputHandler=o.WindowsOptionsReportType=void 0;const u=l(2584),m=l(7116),v=l(2015),y=l(844),_=l(482),p=l(8437),f=l(8460),h=l(643),g=l(511),S=l(3734),b=l(2585),w=l(1480),k=l(6242),C=l(6351),E=l(5941),x={"(":0,")":1,"*":2,"+":3,"-":1,".":2},I=131072;function A(U,R){if(U>24)return R.setWinLines||!1;switch(U){case 1:return!!R.restoreWin;case 2:return!!R.minimizeWin;case 3:return!!R.setWinPosition;case 4:return!!R.setWinSizePixels;case 5:return!!R.raiseWin;case 6:return!!R.lowerWin;case 7:return!!R.refreshWin;case 8:return!!R.setWinSizeChars;case 9:return!!R.maximizeWin;case 10:return!!R.fullscreenWin;case 11:return!!R.getWinState;case 13:return!!R.getWinPosition;case 14:return!!R.getWinSizePixels;case 15:return!!R.getScreenSizePixels;case 16:return!!R.getCellSizePixels;case 18:return!!R.getWinSizeChars;case 19:return!!R.getScreenSizeChars;case 20:return!!R.getIconTitle;case 21:return!!R.getWinTitle;case 22:return!!R.pushTitle;case 23:return!!R.popTitle;case 24:return!!R.setWinLines}return!1}var P;(function(U){U[U.GET_WIN_SIZE_PIXELS=0]="GET_WIN_SIZE_PIXELS",U[U.GET_CELL_SIZE_PIXELS=1]="GET_CELL_SIZE_PIXELS"})(P||(o.WindowsOptionsReportType=P={}));let F=0;class B extends y.Disposable{getAttrData(){return this._curAttrData}constructor(R,M,D,N,q,ne,ce,de,z=new v.EscapeSequenceParser){super(),this._bufferService=R,this._charsetService=M,this._coreService=D,this._logService=N,this._optionsService=q,this._oscLinkService=ne,this._coreMouseService=ce,this._unicodeService=de,this._parser=z,this._parseBuffer=new Uint32Array(4096),this._stringDecoder=new _.StringToUtf32,this._utf8Decoder=new _.Utf8ToUtf32,this._workCell=new g.CellData,this._windowTitle="",this._iconName="",this._windowTitleStack=[],this._iconNameStack=[],this._curAttrData=p.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=p.DEFAULT_ATTR_DATA.clone(),this._onRequestBell=this.register(new f.EventEmitter),this.onRequestBell=this._onRequestBell.event,this._onRequestRefreshRows=this.register(new f.EventEmitter),this.onRequestRefreshRows=this._onRequestRefreshRows.event,this._onRequestReset=this.register(new f.EventEmitter),this.onRequestReset=this._onRequestReset.event,this._onRequestSendFocus=this.register(new f.EventEmitter),this.onRequestSendFocus=this._onRequestSendFocus.event,this._onRequestSyncScrollBar=this.register(new f.EventEmitter),this.onRequestSyncScrollBar=this._onRequestSyncScrollBar.event,this._onRequestWindowsOptionsReport=this.register(new f.EventEmitter),this.onRequestWindowsOptionsReport=this._onRequestWindowsOptionsReport.event,this._onA11yChar=this.register(new f.EventEmitter),this.onA11yChar=this._onA11yChar.event,this._onA11yTab=this.register(new f.EventEmitter),this.onA11yTab=this._onA11yTab.event,this._onCursorMove=this.register(new f.EventEmitter),this.onCursorMove=this._onCursorMove.event,this._onLineFeed=this.register(new f.EventEmitter),this.onLineFeed=this._onLineFeed.event,this._onScroll=this.register(new f.EventEmitter),this.onScroll=this._onScroll.event,this._onTitleChange=this.register(new f.EventEmitter),this.onTitleChange=this._onTitleChange.event,this._onColor=this.register(new f.EventEmitter),this.onColor=this._onColor.event,this._parseStack={paused:!1,cursorStartX:0,cursorStartY:0,decodedLength:0,position:0},this._specialColors=[256,257,258],this.register(this._parser),this._dirtyRowTracker=new j(this._bufferService),this._activeBuffer=this._bufferService.buffer,this.register(this._bufferService.buffers.onBufferActivate(O=>this._activeBuffer=O.activeBuffer)),this._parser.setCsiHandlerFallback((O,Y)=>{this._logService.debug("Unknown CSI code: ",{identifier:this._parser.identToString(O),params:Y.toArray()})}),this._parser.setEscHandlerFallback(O=>{this._logService.debug("Unknown ESC code: ",{identifier:this._parser.identToString(O)})}),this._parser.setExecuteHandlerFallback(O=>{this._logService.debug("Unknown EXECUTE code: ",{code:O})}),this._parser.setOscHandlerFallback((O,Y,G)=>{this._logService.debug("Unknown OSC code: ",{identifier:O,action:Y,data:G})}),this._parser.setDcsHandlerFallback((O,Y,G)=>{Y==="HOOK"&&(G=G.toArray()),this._logService.debug("Unknown DCS code: ",{identifier:this._parser.identToString(O),action:Y,payload:G})}),this._parser.setPrintHandler((O,Y,G)=>this.print(O,Y,G)),this._parser.registerCsiHandler({final:"@"},O=>this.insertChars(O)),this._parser.registerCsiHandler({intermediates:" ",final:"@"},O=>this.scrollLeft(O)),this._parser.registerCsiHandler({final:"A"},O=>this.cursorUp(O)),this._parser.registerCsiHandler({intermediates:" ",final:"A"},O=>this.scrollRight(O)),this._parser.registerCsiHandler({final:"B"},O=>this.cursorDown(O)),this._parser.registerCsiHandler({final:"C"},O=>this.cursorForward(O)),this._parser.registerCsiHandler({final:"D"},O=>this.cursorBackward(O)),this._parser.registerCsiHandler({final:"E"},O=>this.cursorNextLine(O)),this._parser.registerCsiHandler({final:"F"},O=>this.cursorPrecedingLine(O)),this._parser.registerCsiHandler({final:"G"},O=>this.cursorCharAbsolute(O)),this._parser.registerCsiHandler({final:"H"},O=>this.cursorPosition(O)),this._parser.registerCsiHandler({final:"I"},O=>this.cursorForwardTab(O)),this._parser.registerCsiHandler({final:"J"},O=>this.eraseInDisplay(O,!1)),this._parser.registerCsiHandler({prefix:"?",final:"J"},O=>this.eraseInDisplay(O,!0)),this._parser.registerCsiHandler({final:"K"},O=>this.eraseInLine(O,!1)),this._parser.registerCsiHandler({prefix:"?",final:"K"},O=>this.eraseInLine(O,!0)),this._parser.registerCsiHandler({final:"L"},O=>this.insertLines(O)),this._parser.registerCsiHandler({final:"M"},O=>this.deleteLines(O)),this._parser.registerCsiHandler({final:"P"},O=>this.deleteChars(O)),this._parser.registerCsiHandler({final:"S"},O=>this.scrollUp(O)),this._parser.registerCsiHandler({final:"T"},O=>this.scrollDown(O)),this._parser.registerCsiHandler({final:"X"},O=>this.eraseChars(O)),this._parser.registerCsiHandler({final:"Z"},O=>this.cursorBackwardTab(O)),this._parser.registerCsiHandler({final:"`"},O=>this.charPosAbsolute(O)),this._parser.registerCsiHandler({final:"a"},O=>this.hPositionRelative(O)),this._parser.registerCsiHandler({final:"b"},O=>this.repeatPrecedingCharacter(O)),this._parser.registerCsiHandler({final:"c"},O=>this.sendDeviceAttributesPrimary(O)),this._parser.registerCsiHandler({prefix:">",final:"c"},O=>this.sendDeviceAttributesSecondary(O)),this._parser.registerCsiHandler({final:"d"},O=>this.linePosAbsolute(O)),this._parser.registerCsiHandler({final:"e"},O=>this.vPositionRelative(O)),this._parser.registerCsiHandler({final:"f"},O=>this.hVPosition(O)),this._parser.registerCsiHandler({final:"g"},O=>this.tabClear(O)),this._parser.registerCsiHandler({final:"h"},O=>this.setMode(O)),this._parser.registerCsiHandler({prefix:"?",final:"h"},O=>this.setModePrivate(O)),this._parser.registerCsiHandler({final:"l"},O=>this.resetMode(O)),this._parser.registerCsiHandler({prefix:"?",final:"l"},O=>this.resetModePrivate(O)),this._parser.registerCsiHandler({final:"m"},O=>this.charAttributes(O)),this._parser.registerCsiHandler({final:"n"},O=>this.deviceStatus(O)),this._parser.registerCsiHandler({prefix:"?",final:"n"},O=>this.deviceStatusPrivate(O)),this._parser.registerCsiHandler({intermediates:"!",final:"p"},O=>this.softReset(O)),this._parser.registerCsiHandler({intermediates:" ",final:"q"},O=>this.setCursorStyle(O)),this._parser.registerCsiHandler({final:"r"},O=>this.setScrollRegion(O)),this._parser.registerCsiHandler({final:"s"},O=>this.saveCursor(O)),this._parser.registerCsiHandler({final:"t"},O=>this.windowOptions(O)),this._parser.registerCsiHandler({final:"u"},O=>this.restoreCursor(O)),this._parser.registerCsiHandler({intermediates:"'",final:"}"},O=>this.insertColumns(O)),this._parser.registerCsiHandler({intermediates:"'",final:"~"},O=>this.deleteColumns(O)),this._parser.registerCsiHandler({intermediates:'"',final:"q"},O=>this.selectProtected(O)),this._parser.registerCsiHandler({intermediates:"$",final:"p"},O=>this.requestMode(O,!0)),this._parser.registerCsiHandler({prefix:"?",intermediates:"$",final:"p"},O=>this.requestMode(O,!1)),this._parser.setExecuteHandler(u.C0.BEL,()=>this.bell()),this._parser.setExecuteHandler(u.C0.LF,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.VT,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.FF,()=>this.lineFeed()),this._parser.setExecuteHandler(u.C0.CR,()=>this.carriageReturn()),this._parser.setExecuteHandler(u.C0.BS,()=>this.backspace()),this._parser.setExecuteHandler(u.C0.HT,()=>this.tab()),this._parser.setExecuteHandler(u.C0.SO,()=>this.shiftOut()),this._parser.setExecuteHandler(u.C0.SI,()=>this.shiftIn()),this._parser.setExecuteHandler(u.C1.IND,()=>this.index()),this._parser.setExecuteHandler(u.C1.NEL,()=>this.nextLine()),this._parser.setExecuteHandler(u.C1.HTS,()=>this.tabSet()),this._parser.registerOscHandler(0,new k.OscHandler(O=>(this.setTitle(O),this.setIconName(O),!0))),this._parser.registerOscHandler(1,new k.OscHandler(O=>this.setIconName(O))),this._parser.registerOscHandler(2,new k.OscHandler(O=>this.setTitle(O))),this._parser.registerOscHandler(4,new k.OscHandler(O=>this.setOrReportIndexedColor(O))),this._parser.registerOscHandler(8,new k.OscHandler(O=>this.setHyperlink(O))),this._parser.registerOscHandler(10,new k.OscHandler(O=>this.setOrReportFgColor(O))),this._parser.registerOscHandler(11,new k.OscHandler(O=>this.setOrReportBgColor(O))),this._parser.registerOscHandler(12,new k.OscHandler(O=>this.setOrReportCursorColor(O))),this._parser.registerOscHandler(104,new k.OscHandler(O=>this.restoreIndexedColor(O))),this._parser.registerOscHandler(110,new k.OscHandler(O=>this.restoreFgColor(O))),this._parser.registerOscHandler(111,new k.OscHandler(O=>this.restoreBgColor(O))),this._parser.registerOscHandler(112,new k.OscHandler(O=>this.restoreCursorColor(O))),this._parser.registerEscHandler({final:"7"},()=>this.saveCursor()),this._parser.registerEscHandler({final:"8"},()=>this.restoreCursor()),this._parser.registerEscHandler({final:"D"},()=>this.index()),this._parser.registerEscHandler({final:"E"},()=>this.nextLine()),this._parser.registerEscHandler({final:"H"},()=>this.tabSet()),this._parser.registerEscHandler({final:"M"},()=>this.reverseIndex()),this._parser.registerEscHandler({final:"="},()=>this.keypadApplicationMode()),this._parser.registerEscHandler({final:">"},()=>this.keypadNumericMode()),this._parser.registerEscHandler({final:"c"},()=>this.fullReset()),this._parser.registerEscHandler({final:"n"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"o"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"|"},()=>this.setgLevel(3)),this._parser.registerEscHandler({final:"}"},()=>this.setgLevel(2)),this._parser.registerEscHandler({final:"~"},()=>this.setgLevel(1)),this._parser.registerEscHandler({intermediates:"%",final:"@"},()=>this.selectDefaultCharset()),this._parser.registerEscHandler({intermediates:"%",final:"G"},()=>this.selectDefaultCharset());for(const O in m.CHARSETS)this._parser.registerEscHandler({intermediates:"(",final:O},()=>this.selectCharset("("+O)),this._parser.registerEscHandler({intermediates:")",final:O},()=>this.selectCharset(")"+O)),this._parser.registerEscHandler({intermediates:"*",final:O},()=>this.selectCharset("*"+O)),this._parser.registerEscHandler({intermediates:"+",final:O},()=>this.selectCharset("+"+O)),this._parser.registerEscHandler({intermediates:"-",final:O},()=>this.selectCharset("-"+O)),this._parser.registerEscHandler({intermediates:".",final:O},()=>this.selectCharset("."+O)),this._parser.registerEscHandler({intermediates:"/",final:O},()=>this.selectCharset("/"+O));this._parser.registerEscHandler({intermediates:"#",final:"8"},()=>this.screenAlignmentPattern()),this._parser.setErrorHandler(O=>(this._logService.error("Parsing error: ",O),O)),this._parser.registerDcsHandler({intermediates:"$",final:"q"},new C.DcsHandler((O,Y)=>this.requestStatusString(O,Y)))}_preserveStack(R,M,D,N){this._parseStack.paused=!0,this._parseStack.cursorStartX=R,this._parseStack.cursorStartY=M,this._parseStack.decodedLength=D,this._parseStack.position=N}_logSlowResolvingAsync(R){this._logService.logLevel<=b.LogLevelEnum.WARN&&Promise.race([R,new Promise((M,D)=>setTimeout(()=>D("#SLOW_TIMEOUT"),5e3))]).catch(M=>{if(M!=="#SLOW_TIMEOUT")throw M;console.warn("async parser handler taking longer than 5000 ms")})}_getCurrentLinkId(){return this._curAttrData.extended.urlId}parse(R,M){let D,N=this._activeBuffer.x,q=this._activeBuffer.y,ne=0;const ce=this._parseStack.paused;if(ce){if(D=this._parser.parse(this._parseBuffer,this._parseStack.decodedLength,M))return this._logSlowResolvingAsync(D),D;N=this._parseStack.cursorStartX,q=this._parseStack.cursorStartY,this._parseStack.paused=!1,R.length>I&&(ne=this._parseStack.position+I)}if(this._logService.logLevel<=b.LogLevelEnum.DEBUG&&this._logService.debug("parsing data"+(typeof R=="string"?` "${R}"`:` "${Array.prototype.map.call(R,O=>String.fromCharCode(O)).join("")}"`),typeof R=="string"?R.split("").map(O=>O.charCodeAt(0)):R),this._parseBuffer.length<R.length&&this._parseBuffer.length<I&&(this._parseBuffer=new Uint32Array(Math.min(R.length,I))),ce||this._dirtyRowTracker.clearRange(),R.length>I)for(let O=ne;O<R.length;O+=I){const Y=O+I<R.length?O+I:R.length,G=typeof R=="string"?this._stringDecoder.decode(R.substring(O,Y),this._parseBuffer):this._utf8Decoder.decode(R.subarray(O,Y),this._parseBuffer);if(D=this._parser.parse(this._parseBuffer,G))return this._preserveStack(N,q,G,O),this._logSlowResolvingAsync(D),D}else if(!ce){const O=typeof R=="string"?this._stringDecoder.decode(R,this._parseBuffer):this._utf8Decoder.decode(R,this._parseBuffer);if(D=this._parser.parse(this._parseBuffer,O))return this._preserveStack(N,q,O,0),this._logSlowResolvingAsync(D),D}this._activeBuffer.x===N&&this._activeBuffer.y===q||this._onCursorMove.fire();const de=this._dirtyRowTracker.end+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp),z=this._dirtyRowTracker.start+(this._bufferService.buffer.ybase-this._bufferService.buffer.ydisp);z<this._bufferService.rows&&this._onRequestRefreshRows.fire(Math.min(z,this._bufferService.rows-1),Math.min(de,this._bufferService.rows-1))}print(R,M,D){let N,q;const ne=this._charsetService.charset,ce=this._optionsService.rawOptions.screenReaderMode,de=this._bufferService.cols,z=this._coreService.decPrivateModes.wraparound,O=this._coreService.modes.insertMode,Y=this._curAttrData;let G=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._activeBuffer.x&&D-M>0&&G.getWidth(this._activeBuffer.x-1)===2&&G.setCellFromCodepoint(this._activeBuffer.x-1,0,1,Y);let se=this._parser.precedingJoinState;for(let ie=M;ie<D;++ie){if(N=R[ie],N<127&&ne){const Ut=ne[String.fromCharCode(N)];Ut&&(N=Ut.charCodeAt(0))}const Se=this._unicodeService.charProperties(N,se);q=w.UnicodeService.extractWidth(Se);const Ue=w.UnicodeService.extractShouldJoin(Se),ze=Ue?w.UnicodeService.extractWidth(se):0;if(se=Se,ce&&this._onA11yChar.fire((0,_.stringFromCodePoint)(N)),this._getCurrentLinkId()&&this._oscLinkService.addLineToLink(this._getCurrentLinkId(),this._activeBuffer.ybase+this._activeBuffer.y),this._activeBuffer.x+q-ze>de){if(z){const Ut=G;let he=this._activeBuffer.x-ze;for(this._activeBuffer.x=ze,this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData(),!0)):(this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!0),G=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y),ze>0&&G instanceof p.BufferLine&&G.copyCellsFrom(Ut,he,0,ze,!1);he<de;)Ut.setCellFromCodepoint(he++,0,1,Y)}else if(this._activeBuffer.x=de-1,q===2)continue}if(Ue&&this._activeBuffer.x){const Ut=G.getWidth(this._activeBuffer.x-1)?1:2;G.addCodepointToCell(this._activeBuffer.x-Ut,N,q);for(let he=q-ze;--he>=0;)G.setCellFromCodepoint(this._activeBuffer.x++,0,0,Y)}else if(O&&(G.insertCells(this._activeBuffer.x,q-ze,this._activeBuffer.getNullCell(Y)),G.getWidth(de-1)===2&&G.setCellFromCodepoint(de-1,h.NULL_CELL_CODE,h.NULL_CELL_WIDTH,Y)),G.setCellFromCodepoint(this._activeBuffer.x++,N,q,Y),q>0)for(;--q;)G.setCellFromCodepoint(this._activeBuffer.x++,0,0,Y)}this._parser.precedingJoinState=se,this._activeBuffer.x<de&&D-M>0&&G.getWidth(this._activeBuffer.x)===0&&!G.hasContent(this._activeBuffer.x)&&G.setCellFromCodepoint(this._activeBuffer.x,0,1,Y),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}registerCsiHandler(R,M){return R.final!=="t"||R.prefix||R.intermediates?this._parser.registerCsiHandler(R,M):this._parser.registerCsiHandler(R,D=>!A(D.params[0],this._optionsService.rawOptions.windowOptions)||M(D))}registerDcsHandler(R,M){return this._parser.registerDcsHandler(R,new C.DcsHandler(M))}registerEscHandler(R,M){return this._parser.registerEscHandler(R,M)}registerOscHandler(R,M){return this._parser.registerOscHandler(R,new k.OscHandler(M))}bell(){return this._onRequestBell.fire(),!0}lineFeed(){return this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._optionsService.rawOptions.convertEol&&(this._activeBuffer.x=0),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows?this._activeBuffer.y=this._bufferService.rows-1:this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.x>=this._bufferService.cols&&this._activeBuffer.x--,this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._onLineFeed.fire(),!0}carriageReturn(){return this._activeBuffer.x=0,!0}backspace(){var R;if(!this._coreService.decPrivateModes.reverseWraparound)return this._restrictCursor(),this._activeBuffer.x>0&&this._activeBuffer.x--,!0;if(this._restrictCursor(this._bufferService.cols),this._activeBuffer.x>0)this._activeBuffer.x--;else if(this._activeBuffer.x===0&&this._activeBuffer.y>this._activeBuffer.scrollTop&&this._activeBuffer.y<=this._activeBuffer.scrollBottom&&((R=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y))!=null&&R.isWrapped)){this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).isWrapped=!1,this._activeBuffer.y--,this._activeBuffer.x=this._bufferService.cols-1;const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);M.hasWidth(this._activeBuffer.x)&&!M.hasContent(this._activeBuffer.x)&&this._activeBuffer.x--}return this._restrictCursor(),!0}tab(){if(this._activeBuffer.x>=this._bufferService.cols)return!0;const R=this._activeBuffer.x;return this._activeBuffer.x=this._activeBuffer.nextStop(),this._optionsService.rawOptions.screenReaderMode&&this._onA11yTab.fire(this._activeBuffer.x-R),!0}shiftOut(){return this._charsetService.setgLevel(1),!0}shiftIn(){return this._charsetService.setgLevel(0),!0}_restrictCursor(R=this._bufferService.cols-1){this._activeBuffer.x=Math.min(R,Math.max(0,this._activeBuffer.x)),this._activeBuffer.y=this._coreService.decPrivateModes.origin?Math.min(this._activeBuffer.scrollBottom,Math.max(this._activeBuffer.scrollTop,this._activeBuffer.y)):Math.min(this._bufferService.rows-1,Math.max(0,this._activeBuffer.y)),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_setCursor(R,M){this._dirtyRowTracker.markDirty(this._activeBuffer.y),this._coreService.decPrivateModes.origin?(this._activeBuffer.x=R,this._activeBuffer.y=this._activeBuffer.scrollTop+M):(this._activeBuffer.x=R,this._activeBuffer.y=M),this._restrictCursor(),this._dirtyRowTracker.markDirty(this._activeBuffer.y)}_moveCursor(R,M){this._restrictCursor(),this._setCursor(this._activeBuffer.x+R,this._activeBuffer.y+M)}cursorUp(R){const M=this._activeBuffer.y-this._activeBuffer.scrollTop;return M>=0?this._moveCursor(0,-Math.min(M,R.params[0]||1)):this._moveCursor(0,-(R.params[0]||1)),!0}cursorDown(R){const M=this._activeBuffer.scrollBottom-this._activeBuffer.y;return M>=0?this._moveCursor(0,Math.min(M,R.params[0]||1)):this._moveCursor(0,R.params[0]||1),!0}cursorForward(R){return this._moveCursor(R.params[0]||1,0),!0}cursorBackward(R){return this._moveCursor(-(R.params[0]||1),0),!0}cursorNextLine(R){return this.cursorDown(R),this._activeBuffer.x=0,!0}cursorPrecedingLine(R){return this.cursorUp(R),this._activeBuffer.x=0,!0}cursorCharAbsolute(R){return this._setCursor((R.params[0]||1)-1,this._activeBuffer.y),!0}cursorPosition(R){return this._setCursor(R.length>=2?(R.params[1]||1)-1:0,(R.params[0]||1)-1),!0}charPosAbsolute(R){return this._setCursor((R.params[0]||1)-1,this._activeBuffer.y),!0}hPositionRelative(R){return this._moveCursor(R.params[0]||1,0),!0}linePosAbsolute(R){return this._setCursor(this._activeBuffer.x,(R.params[0]||1)-1),!0}vPositionRelative(R){return this._moveCursor(0,R.params[0]||1),!0}hVPosition(R){return this.cursorPosition(R),!0}tabClear(R){const M=R.params[0];return M===0?delete this._activeBuffer.tabs[this._activeBuffer.x]:M===3&&(this._activeBuffer.tabs={}),!0}cursorForwardTab(R){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let M=R.params[0]||1;for(;M--;)this._activeBuffer.x=this._activeBuffer.nextStop();return!0}cursorBackwardTab(R){if(this._activeBuffer.x>=this._bufferService.cols)return!0;let M=R.params[0]||1;for(;M--;)this._activeBuffer.x=this._activeBuffer.prevStop();return!0}selectProtected(R){const M=R.params[0];return M===1&&(this._curAttrData.bg|=536870912),M!==2&&M!==0||(this._curAttrData.bg&=-536870913),!0}_eraseInBufferLine(R,M,D,N=!1,q=!1){const ne=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);ne.replaceCells(M,D,this._activeBuffer.getNullCell(this._eraseAttrData()),q),N&&(ne.isWrapped=!1)}_resetBufferLine(R,M=!1){const D=this._activeBuffer.lines.get(this._activeBuffer.ybase+R);D&&(D.fill(this._activeBuffer.getNullCell(this._eraseAttrData()),M),this._bufferService.buffer.clearMarkers(this._activeBuffer.ybase+R),D.isWrapped=!1)}eraseInDisplay(R,M=!1){let D;switch(this._restrictCursor(this._bufferService.cols),R.params[0]){case 0:for(D=this._activeBuffer.y,this._dirtyRowTracker.markDirty(D),this._eraseInBufferLine(D++,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,M);D<this._bufferService.rows;D++)this._resetBufferLine(D,M);this._dirtyRowTracker.markDirty(D);break;case 1:for(D=this._activeBuffer.y,this._dirtyRowTracker.markDirty(D),this._eraseInBufferLine(D,0,this._activeBuffer.x+1,!0,M),this._activeBuffer.x+1>=this._bufferService.cols&&(this._activeBuffer.lines.get(D+1).isWrapped=!1);D--;)this._resetBufferLine(D,M);this._dirtyRowTracker.markDirty(0);break;case 2:for(D=this._bufferService.rows,this._dirtyRowTracker.markDirty(D-1);D--;)this._resetBufferLine(D,M);this._dirtyRowTracker.markDirty(0);break;case 3:const N=this._activeBuffer.lines.length-this._bufferService.rows;N>0&&(this._activeBuffer.lines.trimStart(N),this._activeBuffer.ybase=Math.max(this._activeBuffer.ybase-N,0),this._activeBuffer.ydisp=Math.max(this._activeBuffer.ydisp-N,0),this._onScroll.fire(0))}return!0}eraseInLine(R,M=!1){switch(this._restrictCursor(this._bufferService.cols),R.params[0]){case 0:this._eraseInBufferLine(this._activeBuffer.y,this._activeBuffer.x,this._bufferService.cols,this._activeBuffer.x===0,M);break;case 1:this._eraseInBufferLine(this._activeBuffer.y,0,this._activeBuffer.x+1,!1,M);break;case 2:this._eraseInBufferLine(this._activeBuffer.y,0,this._bufferService.cols,!0,M)}return this._dirtyRowTracker.markDirty(this._activeBuffer.y),!0}insertLines(R){this._restrictCursor();let M=R.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const D=this._activeBuffer.ybase+this._activeBuffer.y,N=this._bufferService.rows-1-this._activeBuffer.scrollBottom,q=this._bufferService.rows-1+this._activeBuffer.ybase-N+1;for(;M--;)this._activeBuffer.lines.splice(q-1,1),this._activeBuffer.lines.splice(D,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}deleteLines(R){this._restrictCursor();let M=R.params[0]||1;if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const D=this._activeBuffer.ybase+this._activeBuffer.y;let N;for(N=this._bufferService.rows-1-this._activeBuffer.scrollBottom,N=this._bufferService.rows-1+this._activeBuffer.ybase-N;M--;)this._activeBuffer.lines.splice(D,1),this._activeBuffer.lines.splice(N,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.y,this._activeBuffer.scrollBottom),this._activeBuffer.x=0,!0}insertChars(R){this._restrictCursor();const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return M&&(M.insertCells(this._activeBuffer.x,R.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}deleteChars(R){this._restrictCursor();const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return M&&(M.deleteCells(this._activeBuffer.x,R.params[0]||1,this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}scrollUp(R){let M=R.params[0]||1;for(;M--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,0,this._activeBuffer.getBlankLine(this._eraseAttrData()));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollDown(R){let M=R.params[0]||1;for(;M--;)this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollBottom,1),this._activeBuffer.lines.splice(this._activeBuffer.ybase+this._activeBuffer.scrollTop,0,this._activeBuffer.getBlankLine(p.DEFAULT_ATTR_DATA));return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollLeft(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);N.deleteCells(0,M,this._activeBuffer.getNullCell(this._eraseAttrData())),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}scrollRight(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);N.insertCells(0,M,this._activeBuffer.getNullCell(this._eraseAttrData())),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}insertColumns(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);N.insertCells(this._activeBuffer.x,M,this._activeBuffer.getNullCell(this._eraseAttrData())),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}deleteColumns(R){if(this._activeBuffer.y>this._activeBuffer.scrollBottom||this._activeBuffer.y<this._activeBuffer.scrollTop)return!0;const M=R.params[0]||1;for(let D=this._activeBuffer.scrollTop;D<=this._activeBuffer.scrollBottom;++D){const N=this._activeBuffer.lines.get(this._activeBuffer.ybase+D);N.deleteCells(this._activeBuffer.x,M,this._activeBuffer.getNullCell(this._eraseAttrData())),N.isWrapped=!1}return this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom),!0}eraseChars(R){this._restrictCursor();const M=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y);return M&&(M.replaceCells(this._activeBuffer.x,this._activeBuffer.x+(R.params[0]||1),this._activeBuffer.getNullCell(this._eraseAttrData())),this._dirtyRowTracker.markDirty(this._activeBuffer.y)),!0}repeatPrecedingCharacter(R){const M=this._parser.precedingJoinState;if(!M)return!0;const D=R.params[0]||1,N=w.UnicodeService.extractWidth(M),q=this._activeBuffer.x-N,ne=this._activeBuffer.lines.get(this._activeBuffer.ybase+this._activeBuffer.y).getString(q),ce=new Uint32Array(ne.length*D);let de=0;for(let O=0;O<ne.length;){const Y=ne.codePointAt(O)||0;ce[de++]=Y,O+=Y>65535?2:1}let z=de;for(let O=1;O<D;++O)ce.copyWithin(z,0,de),z+=de;return this.print(ce,0,z),!0}sendDeviceAttributesPrimary(R){return R.params[0]>0||(this._is("xterm")||this._is("rxvt-unicode")||this._is("screen")?this._coreService.triggerDataEvent(u.C0.ESC+"[?1;2c"):this._is("linux")&&this._coreService.triggerDataEvent(u.C0.ESC+"[?6c")),!0}sendDeviceAttributesSecondary(R){return R.params[0]>0||(this._is("xterm")?this._coreService.triggerDataEvent(u.C0.ESC+"[>0;276;0c"):this._is("rxvt-unicode")?this._coreService.triggerDataEvent(u.C0.ESC+"[>85;95;0c"):this._is("linux")?this._coreService.triggerDataEvent(R.params[0]+"c"):this._is("screen")&&this._coreService.triggerDataEvent(u.C0.ESC+"[>83;40003;0c")),!0}_is(R){return(this._optionsService.rawOptions.termName+"").indexOf(R)===0}setMode(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 4:this._coreService.modes.insertMode=!0;break;case 20:this._optionsService.options.convertEol=!0}return!0}setModePrivate(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!0;break;case 2:this._charsetService.setgCharset(0,m.DEFAULT_CHARSET),this._charsetService.setgCharset(1,m.DEFAULT_CHARSET),this._charsetService.setgCharset(2,m.DEFAULT_CHARSET),this._charsetService.setgCharset(3,m.DEFAULT_CHARSET);break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(132,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!0,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!0;break;case 12:this._optionsService.options.cursorBlink=!0;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!0;break;case 66:this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire();break;case 9:this._coreMouseService.activeProtocol="X10";break;case 1e3:this._coreMouseService.activeProtocol="VT200";break;case 1002:this._coreMouseService.activeProtocol="DRAG";break;case 1003:this._coreMouseService.activeProtocol="ANY";break;case 1004:this._coreService.decPrivateModes.sendFocus=!0,this._onRequestSendFocus.fire();break;case 1005:this._logService.debug("DECSET 1005 not supported (see #2507)");break;case 1006:this._coreMouseService.activeEncoding="SGR";break;case 1015:this._logService.debug("DECSET 1015 not supported (see #2507)");break;case 1016:this._coreMouseService.activeEncoding="SGR_PIXELS";break;case 25:this._coreService.isCursorHidden=!1;break;case 1048:this.saveCursor();break;case 1049:this.saveCursor();case 47:case 1047:this._bufferService.buffers.activateAltBuffer(this._eraseAttrData()),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!0}return!0}resetMode(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 4:this._coreService.modes.insertMode=!1;break;case 20:this._optionsService.options.convertEol=!1}return!0}resetModePrivate(R){for(let M=0;M<R.length;M++)switch(R.params[M]){case 1:this._coreService.decPrivateModes.applicationCursorKeys=!1;break;case 3:this._optionsService.rawOptions.windowOptions.setWinLines&&(this._bufferService.resize(80,this._bufferService.rows),this._onRequestReset.fire());break;case 6:this._coreService.decPrivateModes.origin=!1,this._setCursor(0,0);break;case 7:this._coreService.decPrivateModes.wraparound=!1;break;case 12:this._optionsService.options.cursorBlink=!1;break;case 45:this._coreService.decPrivateModes.reverseWraparound=!1;break;case 66:this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire();break;case 9:case 1e3:case 1002:case 1003:this._coreMouseService.activeProtocol="NONE";break;case 1004:this._coreService.decPrivateModes.sendFocus=!1;break;case 1005:this._logService.debug("DECRST 1005 not supported (see #2507)");break;case 1006:case 1016:this._coreMouseService.activeEncoding="DEFAULT";break;case 1015:this._logService.debug("DECRST 1015 not supported (see #2507)");break;case 25:this._coreService.isCursorHidden=!0;break;case 1048:this.restoreCursor();break;case 1049:case 47:case 1047:this._bufferService.buffers.activateNormalBuffer(),R.params[M]===1049&&this.restoreCursor(),this._coreService.isCursorInitialized=!0,this._onRequestRefreshRows.fire(0,this._bufferService.rows-1),this._onRequestSyncScrollBar.fire();break;case 2004:this._coreService.decPrivateModes.bracketedPasteMode=!1}return!0}requestMode(R,M){const D=this._coreService.decPrivateModes,{activeProtocol:N,activeEncoding:q}=this._coreMouseService,ne=this._coreService,{buffers:ce,cols:de}=this._bufferService,{active:z,alt:O}=ce,Y=this._optionsService.rawOptions,G=Ue=>Ue?1:2,se=R.params[0];return ie=se,Se=M?se===2?4:se===4?G(ne.modes.insertMode):se===12?3:se===20?G(Y.convertEol):0:se===1?G(D.applicationCursorKeys):se===3?Y.windowOptions.setWinLines?de===80?2:de===132?1:0:0:se===6?G(D.origin):se===7?G(D.wraparound):se===8?3:se===9?G(N==="X10"):se===12?G(Y.cursorBlink):se===25?G(!ne.isCursorHidden):se===45?G(D.reverseWraparound):se===66?G(D.applicationKeypad):se===67?4:se===1e3?G(N==="VT200"):se===1002?G(N==="DRAG"):se===1003?G(N==="ANY"):se===1004?G(D.sendFocus):se===1005?4:se===1006?G(q==="SGR"):se===1015?4:se===1016?G(q==="SGR_PIXELS"):se===1048?1:se===47||se===1047||se===1049?G(z===O):se===2004?G(D.bracketedPasteMode):0,ne.triggerDataEvent(`${u.C0.ESC}[${M?"":"?"}${ie};${Se}$y`),!0;var ie,Se}_updateAttrColor(R,M,D,N,q){return M===2?(R|=50331648,R&=-16777216,R|=S.AttributeData.fromColorRGB([D,N,q])):M===5&&(R&=-50331904,R|=33554432|255&D),R}_extractColor(R,M,D){const N=[0,0,-1,0,0,0];let q=0,ne=0;do{if(N[ne+q]=R.params[M+ne],R.hasSubParams(M+ne)){const ce=R.getSubParams(M+ne);let de=0;do N[1]===5&&(q=1),N[ne+de+1+q]=ce[de];while(++de<ce.length&&de+ne+1+q<N.length);break}if(N[1]===5&&ne+q>=2||N[1]===2&&ne+q>=5)break;N[1]&&(q=1)}while(++ne+M<R.length&&ne+q<N.length);for(let ce=2;ce<N.length;++ce)N[ce]===-1&&(N[ce]=0);switch(N[0]){case 38:D.fg=this._updateAttrColor(D.fg,N[1],N[3],N[4],N[5]);break;case 48:D.bg=this._updateAttrColor(D.bg,N[1],N[3],N[4],N[5]);break;case 58:D.extended=D.extended.clone(),D.extended.underlineColor=this._updateAttrColor(D.extended.underlineColor,N[1],N[3],N[4],N[5])}return ne}_processUnderline(R,M){M.extended=M.extended.clone(),(!~R||R>5)&&(R=1),M.extended.underlineStyle=R,M.fg|=268435456,R===0&&(M.fg&=-268435457),M.updateExtended()}_processSGR0(R){R.fg=p.DEFAULT_ATTR_DATA.fg,R.bg=p.DEFAULT_ATTR_DATA.bg,R.extended=R.extended.clone(),R.extended.underlineStyle=0,R.extended.underlineColor&=-67108864,R.updateExtended()}charAttributes(R){if(R.length===1&&R.params[0]===0)return this._processSGR0(this._curAttrData),!0;const M=R.length;let D;const N=this._curAttrData;for(let q=0;q<M;q++)D=R.params[q],D>=30&&D<=37?(N.fg&=-50331904,N.fg|=16777216|D-30):D>=40&&D<=47?(N.bg&=-50331904,N.bg|=16777216|D-40):D>=90&&D<=97?(N.fg&=-50331904,N.fg|=16777224|D-90):D>=100&&D<=107?(N.bg&=-50331904,N.bg|=16777224|D-100):D===0?this._processSGR0(N):D===1?N.fg|=134217728:D===3?N.bg|=67108864:D===4?(N.fg|=268435456,this._processUnderline(R.hasSubParams(q)?R.getSubParams(q)[0]:1,N)):D===5?N.fg|=536870912:D===7?N.fg|=67108864:D===8?N.fg|=1073741824:D===9?N.fg|=2147483648:D===2?N.bg|=134217728:D===21?this._processUnderline(2,N):D===22?(N.fg&=-134217729,N.bg&=-134217729):D===23?N.bg&=-67108865:D===24?(N.fg&=-268435457,this._processUnderline(0,N)):D===25?N.fg&=-536870913:D===27?N.fg&=-67108865:D===28?N.fg&=-1073741825:D===29?N.fg&=2147483647:D===39?(N.fg&=-67108864,N.fg|=16777215&p.DEFAULT_ATTR_DATA.fg):D===49?(N.bg&=-67108864,N.bg|=16777215&p.DEFAULT_ATTR_DATA.bg):D===38||D===48||D===58?q+=this._extractColor(R,q,N):D===53?N.bg|=1073741824:D===55?N.bg&=-1073741825:D===59?(N.extended=N.extended.clone(),N.extended.underlineColor=-1,N.updateExtended()):D===100?(N.fg&=-67108864,N.fg|=16777215&p.DEFAULT_ATTR_DATA.fg,N.bg&=-67108864,N.bg|=16777215&p.DEFAULT_ATTR_DATA.bg):this._logService.debug("Unknown SGR attribute: %d.",D);return!0}deviceStatus(R){switch(R.params[0]){case 5:this._coreService.triggerDataEvent(`${u.C0.ESC}[0n`);break;case 6:const M=this._activeBuffer.y+1,D=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${u.C0.ESC}[${M};${D}R`)}return!0}deviceStatusPrivate(R){if(R.params[0]===6){const M=this._activeBuffer.y+1,D=this._activeBuffer.x+1;this._coreService.triggerDataEvent(`${u.C0.ESC}[?${M};${D}R`)}return!0}softReset(R){return this._coreService.isCursorHidden=!1,this._onRequestSyncScrollBar.fire(),this._activeBuffer.scrollTop=0,this._activeBuffer.scrollBottom=this._bufferService.rows-1,this._curAttrData=p.DEFAULT_ATTR_DATA.clone(),this._coreService.reset(),this._charsetService.reset(),this._activeBuffer.savedX=0,this._activeBuffer.savedY=this._activeBuffer.ybase,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,this._coreService.decPrivateModes.origin=!1,!0}setCursorStyle(R){const M=R.params[0]||1;switch(M){case 1:case 2:this._optionsService.options.cursorStyle="block";break;case 3:case 4:this._optionsService.options.cursorStyle="underline";break;case 5:case 6:this._optionsService.options.cursorStyle="bar"}const D=M%2==1;return this._optionsService.options.cursorBlink=D,!0}setScrollRegion(R){const M=R.params[0]||1;let D;return(R.length<2||(D=R.params[1])>this._bufferService.rows||D===0)&&(D=this._bufferService.rows),D>M&&(this._activeBuffer.scrollTop=M-1,this._activeBuffer.scrollBottom=D-1,this._setCursor(0,0)),!0}windowOptions(R){if(!A(R.params[0],this._optionsService.rawOptions.windowOptions))return!0;const M=R.length>1?R.params[1]:0;switch(R.params[0]){case 14:M!==2&&this._onRequestWindowsOptionsReport.fire(P.GET_WIN_SIZE_PIXELS);break;case 16:this._onRequestWindowsOptionsReport.fire(P.GET_CELL_SIZE_PIXELS);break;case 18:this._bufferService&&this._coreService.triggerDataEvent(`${u.C0.ESC}[8;${this._bufferService.rows};${this._bufferService.cols}t`);break;case 22:M!==0&&M!==2||(this._windowTitleStack.push(this._windowTitle),this._windowTitleStack.length>10&&this._windowTitleStack.shift()),M!==0&&M!==1||(this._iconNameStack.push(this._iconName),this._iconNameStack.length>10&&this._iconNameStack.shift());break;case 23:M!==0&&M!==2||this._windowTitleStack.length&&this.setTitle(this._windowTitleStack.pop()),M!==0&&M!==1||this._iconNameStack.length&&this.setIconName(this._iconNameStack.pop())}return!0}saveCursor(R){return this._activeBuffer.savedX=this._activeBuffer.x,this._activeBuffer.savedY=this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.savedCurAttrData.fg=this._curAttrData.fg,this._activeBuffer.savedCurAttrData.bg=this._curAttrData.bg,this._activeBuffer.savedCharset=this._charsetService.charset,!0}restoreCursor(R){return this._activeBuffer.x=this._activeBuffer.savedX||0,this._activeBuffer.y=Math.max(this._activeBuffer.savedY-this._activeBuffer.ybase,0),this._curAttrData.fg=this._activeBuffer.savedCurAttrData.fg,this._curAttrData.bg=this._activeBuffer.savedCurAttrData.bg,this._charsetService.charset=this._savedCharset,this._activeBuffer.savedCharset&&(this._charsetService.charset=this._activeBuffer.savedCharset),this._restrictCursor(),!0}setTitle(R){return this._windowTitle=R,this._onTitleChange.fire(R),!0}setIconName(R){return this._iconName=R,!0}setOrReportIndexedColor(R){const M=[],D=R.split(";");for(;D.length>1;){const N=D.shift(),q=D.shift();if(/^\d+$/.exec(N)){const ne=parseInt(N);if(X(ne))if(q==="?")M.push({type:0,index:ne});else{const ce=(0,E.parseColor)(q);ce&&M.push({type:1,index:ne,color:ce})}}}return M.length&&this._onColor.fire(M),!0}setHyperlink(R){const M=R.split(";");return!(M.length<2)&&(M[1]?this._createHyperlink(M[0],M[1]):!M[0]&&this._finishHyperlink())}_createHyperlink(R,M){this._getCurrentLinkId()&&this._finishHyperlink();const D=R.split(":");let N;const q=D.findIndex(ne=>ne.startsWith("id="));return q!==-1&&(N=D[q].slice(3)||void 0),this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=this._oscLinkService.registerLink({id:N,uri:M}),this._curAttrData.updateExtended(),!0}_finishHyperlink(){return this._curAttrData.extended=this._curAttrData.extended.clone(),this._curAttrData.extended.urlId=0,this._curAttrData.updateExtended(),!0}_setOrReportSpecialColor(R,M){const D=R.split(";");for(let N=0;N<D.length&&!(M>=this._specialColors.length);++N,++M)if(D[N]==="?")this._onColor.fire([{type:0,index:this._specialColors[M]}]);else{const q=(0,E.parseColor)(D[N]);q&&this._onColor.fire([{type:1,index:this._specialColors[M],color:q}])}return!0}setOrReportFgColor(R){return this._setOrReportSpecialColor(R,0)}setOrReportBgColor(R){return this._setOrReportSpecialColor(R,1)}setOrReportCursorColor(R){return this._setOrReportSpecialColor(R,2)}restoreIndexedColor(R){if(!R)return this._onColor.fire([{type:2}]),!0;const M=[],D=R.split(";");for(let N=0;N<D.length;++N)if(/^\d+$/.exec(D[N])){const q=parseInt(D[N]);X(q)&&M.push({type:2,index:q})}return M.length&&this._onColor.fire(M),!0}restoreFgColor(R){return this._onColor.fire([{type:2,index:256}]),!0}restoreBgColor(R){return this._onColor.fire([{type:2,index:257}]),!0}restoreCursorColor(R){return this._onColor.fire([{type:2,index:258}]),!0}nextLine(){return this._activeBuffer.x=0,this.index(),!0}keypadApplicationMode(){return this._logService.debug("Serial port requested application keypad."),this._coreService.decPrivateModes.applicationKeypad=!0,this._onRequestSyncScrollBar.fire(),!0}keypadNumericMode(){return this._logService.debug("Switching back to normal keypad."),this._coreService.decPrivateModes.applicationKeypad=!1,this._onRequestSyncScrollBar.fire(),!0}selectDefaultCharset(){return this._charsetService.setgLevel(0),this._charsetService.setgCharset(0,m.DEFAULT_CHARSET),!0}selectCharset(R){return R.length!==2?(this.selectDefaultCharset(),!0):(R[0]==="/"||this._charsetService.setgCharset(x[R[0]],m.CHARSETS[R[1]]||m.DEFAULT_CHARSET),!0)}index(){return this._restrictCursor(),this._activeBuffer.y++,this._activeBuffer.y===this._activeBuffer.scrollBottom+1?(this._activeBuffer.y--,this._bufferService.scroll(this._eraseAttrData())):this._activeBuffer.y>=this._bufferService.rows&&(this._activeBuffer.y=this._bufferService.rows-1),this._restrictCursor(),!0}tabSet(){return this._activeBuffer.tabs[this._activeBuffer.x]=!0,!0}reverseIndex(){if(this._restrictCursor(),this._activeBuffer.y===this._activeBuffer.scrollTop){const R=this._activeBuffer.scrollBottom-this._activeBuffer.scrollTop;this._activeBuffer.lines.shiftElements(this._activeBuffer.ybase+this._activeBuffer.y,R,1),this._activeBuffer.lines.set(this._activeBuffer.ybase+this._activeBuffer.y,this._activeBuffer.getBlankLine(this._eraseAttrData())),this._dirtyRowTracker.markRangeDirty(this._activeBuffer.scrollTop,this._activeBuffer.scrollBottom)}else this._activeBuffer.y--,this._restrictCursor();return!0}fullReset(){return this._parser.reset(),this._onRequestReset.fire(),!0}reset(){this._curAttrData=p.DEFAULT_ATTR_DATA.clone(),this._eraseAttrDataInternal=p.DEFAULT_ATTR_DATA.clone()}_eraseAttrData(){return this._eraseAttrDataInternal.bg&=-67108864,this._eraseAttrDataInternal.bg|=67108863&this._curAttrData.bg,this._eraseAttrDataInternal}setgLevel(R){return this._charsetService.setgLevel(R),!0}screenAlignmentPattern(){const R=new g.CellData;R.content=4194304|"E".charCodeAt(0),R.fg=this._curAttrData.fg,R.bg=this._curAttrData.bg,this._setCursor(0,0);for(let M=0;M<this._bufferService.rows;++M){const D=this._activeBuffer.ybase+this._activeBuffer.y+M,N=this._activeBuffer.lines.get(D);N&&(N.fill(R),N.isWrapped=!1)}return this._dirtyRowTracker.markAllDirty(),this._setCursor(0,0),!0}requestStatusString(R,M){const D=this._bufferService.buffer,N=this._optionsService.rawOptions;return(q=>(this._coreService.triggerDataEvent(`${u.C0.ESC}${q}${u.C0.ESC}\\`),!0))(R==='"q'?`P1$r${this._curAttrData.isProtected()?1:0}"q`:R==='"p'?'P1$r61;1"p':R==="r"?`P1$r${D.scrollTop+1};${D.scrollBottom+1}r`:R==="m"?"P1$r0m":R===" q"?`P1$r${{block:2,underline:4,bar:6}[N.cursorStyle]-(N.cursorBlink?1:0)} q`:"P0$r")}markRangeDirty(R,M){this._dirtyRowTracker.markRangeDirty(R,M)}}o.InputHandler=B;let j=class{constructor(U){this._bufferService=U,this.clearRange()}clearRange(){this.start=this._bufferService.buffer.y,this.end=this._bufferService.buffer.y}markDirty(U){U<this.start?this.start=U:U>this.end&&(this.end=U)}markRangeDirty(U,R){U>R&&(F=U,U=R,R=F),U<this.start&&(this.start=U),R>this.end&&(this.end=R)}markAllDirty(){this.markRangeDirty(0,this._bufferService.rows-1)}};function X(U){return 0<=U&&U<256}j=c([d(0,b.IBufferService)],j)},844:(a,o)=>{function l(c){for(const d of c)d.dispose();c.length=0}Object.defineProperty(o,"__esModule",{value:!0}),o.getDisposeArrayDisposable=o.disposeArray=o.toDisposable=o.MutableDisposable=o.Disposable=void 0,o.Disposable=class{constructor(){this._disposables=[],this._isDisposed=!1}dispose(){this._isDisposed=!0;for(const c of this._disposables)c.dispose();this._disposables.length=0}register(c){return this._disposables.push(c),c}unregister(c){const d=this._disposables.indexOf(c);d!==-1&&this._disposables.splice(d,1)}},o.MutableDisposable=class{constructor(){this._isDisposed=!1}get value(){return this._isDisposed?void 0:this._value}set value(c){var d;this._isDisposed||c===this._value||((d=this._value)==null||d.dispose(),this._value=c)}clear(){this.value=void 0}dispose(){var c;this._isDisposed=!0,(c=this._value)==null||c.dispose(),this._value=void 0}},o.toDisposable=function(c){return{dispose:c}},o.disposeArray=l,o.getDisposeArrayDisposable=function(c){return{dispose:()=>l(c)}}},1505:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.FourKeyMap=o.TwoKeyMap=void 0;class l{constructor(){this._data={}}set(d,u,m){this._data[d]||(this._data[d]={}),this._data[d][u]=m}get(d,u){return this._data[d]?this._data[d][u]:void 0}clear(){this._data={}}}o.TwoKeyMap=l,o.FourKeyMap=class{constructor(){this._data=new l}set(c,d,u,m,v){this._data.get(c,d)||this._data.set(c,d,new l),this._data.get(c,d).set(u,m,v)}get(c,d,u,m){var v;return(v=this._data.get(c,d))==null?void 0:v.get(u,m)}clear(){this._data.clear()}}},6114:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.isChromeOS=o.isLinux=o.isWindows=o.isIphone=o.isIpad=o.isMac=o.getSafariVersion=o.isSafari=o.isLegacyEdge=o.isFirefox=o.isNode=void 0,o.isNode=typeof process<"u"&&"title"in process;const l=o.isNode?"node":navigator.userAgent,c=o.isNode?"node":navigator.platform;o.isFirefox=l.includes("Firefox"),o.isLegacyEdge=l.includes("Edge"),o.isSafari=/^((?!chrome|android).)*safari/i.test(l),o.getSafariVersion=function(){if(!o.isSafari)return 0;const d=l.match(/Version\/(\d+)/);return d===null||d.length<2?0:parseInt(d[1])},o.isMac=["Macintosh","MacIntel","MacPPC","Mac68K"].includes(c),o.isIpad=c==="iPad",o.isIphone=c==="iPhone",o.isWindows=["Windows","Win16","Win32","WinCE"].includes(c),o.isLinux=c.indexOf("Linux")>=0,o.isChromeOS=/\bCrOS\b/.test(l)},6106:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.SortedList=void 0;let l=0;o.SortedList=class{constructor(c){this._getKey=c,this._array=[]}clear(){this._array.length=0}insert(c){this._array.length!==0?(l=this._search(this._getKey(c)),this._array.splice(l,0,c)):this._array.push(c)}delete(c){if(this._array.length===0)return!1;const d=this._getKey(c);if(d===void 0||(l=this._search(d),l===-1)||this._getKey(this._array[l])!==d)return!1;do if(this._array[l]===c)return this._array.splice(l,1),!0;while(++l<this._array.length&&this._getKey(this._array[l])===d);return!1}*getKeyIterator(c){if(this._array.length!==0&&(l=this._search(c),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===c))do yield this._array[l];while(++l<this._array.length&&this._getKey(this._array[l])===c)}forEachByKey(c,d){if(this._array.length!==0&&(l=this._search(c),!(l<0||l>=this._array.length)&&this._getKey(this._array[l])===c))do d(this._array[l]);while(++l<this._array.length&&this._getKey(this._array[l])===c)}values(){return[...this._array].values()}_search(c){let d=0,u=this._array.length-1;for(;u>=d;){let m=d+u>>1;const v=this._getKey(this._array[m]);if(v>c)u=m-1;else{if(!(v<c)){for(;m>0&&this._getKey(this._array[m-1])===c;)m--;return m}d=m+1}}return d}}},7226:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DebouncedIdleTask=o.IdleTaskQueue=o.PriorityTaskQueue=void 0;const c=l(6114);class d{constructor(){this._tasks=[],this._i=0}enqueue(v){this._tasks.push(v),this._start()}flush(){for(;this._i<this._tasks.length;)this._tasks[this._i]()||this._i++;this.clear()}clear(){this._idleCallback&&(this._cancelCallback(this._idleCallback),this._idleCallback=void 0),this._i=0,this._tasks.length=0}_start(){this._idleCallback||(this._idleCallback=this._requestCallback(this._process.bind(this)))}_process(v){this._idleCallback=void 0;let y=0,_=0,p=v.timeRemaining(),f=0;for(;this._i<this._tasks.length;){if(y=Date.now(),this._tasks[this._i]()||this._i++,y=Math.max(1,Date.now()-y),_=Math.max(y,_),f=v.timeRemaining(),1.5*_>f)return p-y<-20&&console.warn(`task queue exceeded allotted deadline by ${Math.abs(Math.round(p-y))}ms`),void this._start();p=f}this.clear()}}class u extends d{_requestCallback(v){return setTimeout(()=>v(this._createDeadline(16)))}_cancelCallback(v){clearTimeout(v)}_createDeadline(v){const y=Date.now()+v;return{timeRemaining:()=>Math.max(0,y-Date.now())}}}o.PriorityTaskQueue=u,o.IdleTaskQueue=!c.isNode&&"requestIdleCallback"in window?class extends d{_requestCallback(m){return requestIdleCallback(m)}_cancelCallback(m){cancelIdleCallback(m)}}:u,o.DebouncedIdleTask=class{constructor(){this._queue=new o.IdleTaskQueue}set(m){this._queue.clear(),this._queue.enqueue(m)}flush(){this._queue.flush()}}},9282:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.updateWindowsModeWrappedState=void 0;const c=l(643);o.updateWindowsModeWrappedState=function(d){const u=d.buffer.lines.get(d.buffer.ybase+d.buffer.y-1),m=u==null?void 0:u.get(d.cols-1),v=d.buffer.lines.get(d.buffer.ybase+d.buffer.y);v&&m&&(v.isWrapped=m[c.CHAR_DATA_CODE_INDEX]!==c.NULL_CELL_CODE&&m[c.CHAR_DATA_CODE_INDEX]!==c.WHITESPACE_CELL_CODE)}},3734:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ExtendedAttrs=o.AttributeData=void 0;class l{constructor(){this.fg=0,this.bg=0,this.extended=new c}static toColorRGB(u){return[u>>>16&255,u>>>8&255,255&u]}static fromColorRGB(u){return(255&u[0])<<16|(255&u[1])<<8|255&u[2]}clone(){const u=new l;return u.fg=this.fg,u.bg=this.bg,u.extended=this.extended.clone(),u}isInverse(){return 67108864&this.fg}isBold(){return 134217728&this.fg}isUnderline(){return this.hasExtendedAttrs()&&this.extended.underlineStyle!==0?1:268435456&this.fg}isBlink(){return 536870912&this.fg}isInvisible(){return 1073741824&this.fg}isItalic(){return 67108864&this.bg}isDim(){return 134217728&this.bg}isStrikethrough(){return 2147483648&this.fg}isProtected(){return 536870912&this.bg}isOverline(){return 1073741824&this.bg}getFgColorMode(){return 50331648&this.fg}getBgColorMode(){return 50331648&this.bg}isFgRGB(){return(50331648&this.fg)==50331648}isBgRGB(){return(50331648&this.bg)==50331648}isFgPalette(){return(50331648&this.fg)==16777216||(50331648&this.fg)==33554432}isBgPalette(){return(50331648&this.bg)==16777216||(50331648&this.bg)==33554432}isFgDefault(){return(50331648&this.fg)==0}isBgDefault(){return(50331648&this.bg)==0}isAttributeDefault(){return this.fg===0&&this.bg===0}getFgColor(){switch(50331648&this.fg){case 16777216:case 33554432:return 255&this.fg;case 50331648:return 16777215&this.fg;default:return-1}}getBgColor(){switch(50331648&this.bg){case 16777216:case 33554432:return 255&this.bg;case 50331648:return 16777215&this.bg;default:return-1}}hasExtendedAttrs(){return 268435456&this.bg}updateExtended(){this.extended.isEmpty()?this.bg&=-268435457:this.bg|=268435456}getUnderlineColor(){if(268435456&this.bg&&~this.extended.underlineColor)switch(50331648&this.extended.underlineColor){case 16777216:case 33554432:return 255&this.extended.underlineColor;case 50331648:return 16777215&this.extended.underlineColor;default:return this.getFgColor()}return this.getFgColor()}getUnderlineColorMode(){return 268435456&this.bg&&~this.extended.underlineColor?50331648&this.extended.underlineColor:this.getFgColorMode()}isUnderlineColorRGB(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==50331648:this.isFgRGB()}isUnderlineColorPalette(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==16777216||(50331648&this.extended.underlineColor)==33554432:this.isFgPalette()}isUnderlineColorDefault(){return 268435456&this.bg&&~this.extended.underlineColor?(50331648&this.extended.underlineColor)==0:this.isFgDefault()}getUnderlineStyle(){return 268435456&this.fg?268435456&this.bg?this.extended.underlineStyle:1:0}getUnderlineVariantOffset(){return this.extended.underlineVariantOffset}}o.AttributeData=l;class c{get ext(){return this._urlId?-469762049&this._ext|this.underlineStyle<<26:this._ext}set ext(u){this._ext=u}get underlineStyle(){return this._urlId?5:(469762048&this._ext)>>26}set underlineStyle(u){this._ext&=-469762049,this._ext|=u<<26&469762048}get underlineColor(){return 67108863&this._ext}set underlineColor(u){this._ext&=-67108864,this._ext|=67108863&u}get urlId(){return this._urlId}set urlId(u){this._urlId=u}get underlineVariantOffset(){const u=(3758096384&this._ext)>>29;return u<0?4294967288^u:u}set underlineVariantOffset(u){this._ext&=536870911,this._ext|=u<<29&3758096384}constructor(u=0,m=0){this._ext=0,this._urlId=0,this._ext=u,this._urlId=m}clone(){return new c(this._ext,this._urlId)}isEmpty(){return this.underlineStyle===0&&this._urlId===0}}o.ExtendedAttrs=c},9092:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Buffer=o.MAX_BUFFER_SIZE=void 0;const c=l(6349),d=l(7226),u=l(3734),m=l(8437),v=l(4634),y=l(511),_=l(643),p=l(4863),f=l(7116);o.MAX_BUFFER_SIZE=4294967295,o.Buffer=class{constructor(h,g,S){this._hasScrollback=h,this._optionsService=g,this._bufferService=S,this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.tabs={},this.savedY=0,this.savedX=0,this.savedCurAttrData=m.DEFAULT_ATTR_DATA.clone(),this.savedCharset=f.DEFAULT_CHARSET,this.markers=[],this._nullCell=y.CellData.fromCharData([0,_.NULL_CELL_CHAR,_.NULL_CELL_WIDTH,_.NULL_CELL_CODE]),this._whitespaceCell=y.CellData.fromCharData([0,_.WHITESPACE_CELL_CHAR,_.WHITESPACE_CELL_WIDTH,_.WHITESPACE_CELL_CODE]),this._isClearing=!1,this._memoryCleanupQueue=new d.IdleTaskQueue,this._memoryCleanupPosition=0,this._cols=this._bufferService.cols,this._rows=this._bufferService.rows,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}getNullCell(h){return h?(this._nullCell.fg=h.fg,this._nullCell.bg=h.bg,this._nullCell.extended=h.extended):(this._nullCell.fg=0,this._nullCell.bg=0,this._nullCell.extended=new u.ExtendedAttrs),this._nullCell}getWhitespaceCell(h){return h?(this._whitespaceCell.fg=h.fg,this._whitespaceCell.bg=h.bg,this._whitespaceCell.extended=h.extended):(this._whitespaceCell.fg=0,this._whitespaceCell.bg=0,this._whitespaceCell.extended=new u.ExtendedAttrs),this._whitespaceCell}getBlankLine(h,g){return new m.BufferLine(this._bufferService.cols,this.getNullCell(h),g)}get hasScrollback(){return this._hasScrollback&&this.lines.maxLength>this._rows}get isCursorInViewport(){const h=this.ybase+this.y-this.ydisp;return h>=0&&h<this._rows}_getCorrectBufferLength(h){if(!this._hasScrollback)return h;const g=h+this._optionsService.rawOptions.scrollback;return g>o.MAX_BUFFER_SIZE?o.MAX_BUFFER_SIZE:g}fillViewportRows(h){if(this.lines.length===0){h===void 0&&(h=m.DEFAULT_ATTR_DATA);let g=this._rows;for(;g--;)this.lines.push(this.getBlankLine(h))}}clear(){this.ydisp=0,this.ybase=0,this.y=0,this.x=0,this.lines=new c.CircularList(this._getCorrectBufferLength(this._rows)),this.scrollTop=0,this.scrollBottom=this._rows-1,this.setupTabStops()}resize(h,g){const S=this.getNullCell(m.DEFAULT_ATTR_DATA);let b=0;const w=this._getCorrectBufferLength(g);if(w>this.lines.maxLength&&(this.lines.maxLength=w),this.lines.length>0){if(this._cols<h)for(let C=0;C<this.lines.length;C++)b+=+this.lines.get(C).resize(h,S);let k=0;if(this._rows<g)for(let C=this._rows;C<g;C++)this.lines.length<g+this.ybase&&(this._optionsService.rawOptions.windowsMode||this._optionsService.rawOptions.windowsPty.backend!==void 0||this._optionsService.rawOptions.windowsPty.buildNumber!==void 0?this.lines.push(new m.BufferLine(h,S)):this.ybase>0&&this.lines.length<=this.ybase+this.y+k+1?(this.ybase--,k++,this.ydisp>0&&this.ydisp--):this.lines.push(new m.BufferLine(h,S)));else for(let C=this._rows;C>g;C--)this.lines.length>g+this.ybase&&(this.lines.length>this.ybase+this.y+1?this.lines.pop():(this.ybase++,this.ydisp++));if(w<this.lines.maxLength){const C=this.lines.length-w;C>0&&(this.lines.trimStart(C),this.ybase=Math.max(this.ybase-C,0),this.ydisp=Math.max(this.ydisp-C,0),this.savedY=Math.max(this.savedY-C,0)),this.lines.maxLength=w}this.x=Math.min(this.x,h-1),this.y=Math.min(this.y,g-1),k&&(this.y+=k),this.savedX=Math.min(this.savedX,h-1),this.scrollTop=0}if(this.scrollBottom=g-1,this._isReflowEnabled&&(this._reflow(h,g),this._cols>h))for(let k=0;k<this.lines.length;k++)b+=+this.lines.get(k).resize(h,S);this._cols=h,this._rows=g,this._memoryCleanupQueue.clear(),b>.1*this.lines.length&&(this._memoryCleanupPosition=0,this._memoryCleanupQueue.enqueue(()=>this._batchedMemoryCleanup()))}_batchedMemoryCleanup(){let h=!0;this._memoryCleanupPosition>=this.lines.length&&(this._memoryCleanupPosition=0,h=!1);let g=0;for(;this._memoryCleanupPosition<this.lines.length;)if(g+=this.lines.get(this._memoryCleanupPosition++).cleanupMemory(),g>100)return!0;return h}get _isReflowEnabled(){const h=this._optionsService.rawOptions.windowsPty;return h&&h.buildNumber?this._hasScrollback&&h.backend==="conpty"&&h.buildNumber>=21376:this._hasScrollback&&!this._optionsService.rawOptions.windowsMode}_reflow(h,g){this._cols!==h&&(h>this._cols?this._reflowLarger(h,g):this._reflowSmaller(h,g))}_reflowLarger(h,g){const S=(0,v.reflowLargerGetLinesToRemove)(this.lines,this._cols,h,this.ybase+this.y,this.getNullCell(m.DEFAULT_ATTR_DATA));if(S.length>0){const b=(0,v.reflowLargerCreateNewLayout)(this.lines,S);(0,v.reflowLargerApplyNewLayout)(this.lines,b.layout),this._reflowLargerAdjustViewport(h,g,b.countRemoved)}}_reflowLargerAdjustViewport(h,g,S){const b=this.getNullCell(m.DEFAULT_ATTR_DATA);let w=S;for(;w-- >0;)this.ybase===0?(this.y>0&&this.y--,this.lines.length<g&&this.lines.push(new m.BufferLine(h,b))):(this.ydisp===this.ybase&&this.ydisp--,this.ybase--);this.savedY=Math.max(this.savedY-S,0)}_reflowSmaller(h,g){const S=this.getNullCell(m.DEFAULT_ATTR_DATA),b=[];let w=0;for(let k=this.lines.length-1;k>=0;k--){let C=this.lines.get(k);if(!C||!C.isWrapped&&C.getTrimmedLength()<=h)continue;const E=[C];for(;C.isWrapped&&k>0;)C=this.lines.get(--k),E.unshift(C);const x=this.ybase+this.y;if(x>=k&&x<k+E.length)continue;const I=E[E.length-1].getTrimmedLength(),A=(0,v.reflowSmallerGetNewLineLengths)(E,this._cols,h),P=A.length-E.length;let F;F=this.ybase===0&&this.y!==this.lines.length-1?Math.max(0,this.y-this.lines.maxLength+P):Math.max(0,this.lines.length-this.lines.maxLength+P);const B=[];for(let D=0;D<P;D++){const N=this.getBlankLine(m.DEFAULT_ATTR_DATA,!0);B.push(N)}B.length>0&&(b.push({start:k+E.length+w,newLines:B}),w+=B.length),E.push(...B);let j=A.length-1,X=A[j];X===0&&(j--,X=A[j]);let U=E.length-P-1,R=I;for(;U>=0;){const D=Math.min(R,X);if(E[j]===void 0)break;if(E[j].copyCellsFrom(E[U],R-D,X-D,D,!0),X-=D,X===0&&(j--,X=A[j]),R-=D,R===0){U--;const N=Math.max(U,0);R=(0,v.getWrappedLineTrimmedLength)(E,N,this._cols)}}for(let D=0;D<E.length;D++)A[D]<h&&E[D].setCell(A[D],S);let M=P-F;for(;M-- >0;)this.ybase===0?this.y<g-1?(this.y++,this.lines.pop()):(this.ybase++,this.ydisp++):this.ybase<Math.min(this.lines.maxLength,this.lines.length+w)-g&&(this.ybase===this.ydisp&&this.ydisp++,this.ybase++);this.savedY=Math.min(this.savedY+P,this.ybase+g-1)}if(b.length>0){const k=[],C=[];for(let j=0;j<this.lines.length;j++)C.push(this.lines.get(j));const E=this.lines.length;let x=E-1,I=0,A=b[I];this.lines.length=Math.min(this.lines.maxLength,this.lines.length+w);let P=0;for(let j=Math.min(this.lines.maxLength-1,E+w-1);j>=0;j--)if(A&&A.start>x+P){for(let X=A.newLines.length-1;X>=0;X--)this.lines.set(j--,A.newLines[X]);j++,k.push({index:x+1,amount:A.newLines.length}),P+=A.newLines.length,A=b[++I]}else this.lines.set(j,C[x--]);let F=0;for(let j=k.length-1;j>=0;j--)k[j].index+=F,this.lines.onInsertEmitter.fire(k[j]),F+=k[j].amount;const B=Math.max(0,E+w-this.lines.maxLength);B>0&&this.lines.onTrimEmitter.fire(B)}}translateBufferLineToString(h,g,S=0,b){const w=this.lines.get(h);return w?w.translateToString(g,S,b):""}getWrappedRangeForLine(h){let g=h,S=h;for(;g>0&&this.lines.get(g).isWrapped;)g--;for(;S+1<this.lines.length&&this.lines.get(S+1).isWrapped;)S++;return{first:g,last:S}}setupTabStops(h){for(h!=null?this.tabs[h]||(h=this.prevStop(h)):(this.tabs={},h=0);h<this._cols;h+=this._optionsService.rawOptions.tabStopWidth)this.tabs[h]=!0}prevStop(h){for(h==null&&(h=this.x);!this.tabs[--h]&&h>0;);return h>=this._cols?this._cols-1:h<0?0:h}nextStop(h){for(h==null&&(h=this.x);!this.tabs[++h]&&h<this._cols;);return h>=this._cols?this._cols-1:h<0?0:h}clearMarkers(h){this._isClearing=!0;for(let g=0;g<this.markers.length;g++)this.markers[g].line===h&&(this.markers[g].dispose(),this.markers.splice(g--,1));this._isClearing=!1}clearAllMarkers(){this._isClearing=!0;for(let h=0;h<this.markers.length;h++)this.markers[h].dispose(),this.markers.splice(h--,1);this._isClearing=!1}addMarker(h){const g=new p.Marker(h);return this.markers.push(g),g.register(this.lines.onTrim(S=>{g.line-=S,g.line<0&&g.dispose()})),g.register(this.lines.onInsert(S=>{g.line>=S.index&&(g.line+=S.amount)})),g.register(this.lines.onDelete(S=>{g.line>=S.index&&g.line<S.index+S.amount&&g.dispose(),g.line>S.index&&(g.line-=S.amount)})),g.register(g.onDispose(()=>this._removeMarker(g))),g}_removeMarker(h){this._isClearing||this.markers.splice(this.markers.indexOf(h),1)}}},8437:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferLine=o.DEFAULT_ATTR_DATA=void 0;const c=l(3734),d=l(511),u=l(643),m=l(482);o.DEFAULT_ATTR_DATA=Object.freeze(new c.AttributeData);let v=0;class y{constructor(p,f,h=!1){this.isWrapped=h,this._combined={},this._extendedAttrs={},this._data=new Uint32Array(3*p);const g=f||d.CellData.fromCharData([0,u.NULL_CELL_CHAR,u.NULL_CELL_WIDTH,u.NULL_CELL_CODE]);for(let S=0;S<p;++S)this.setCell(S,g);this.length=p}get(p){const f=this._data[3*p+0],h=2097151&f;return[this._data[3*p+1],2097152&f?this._combined[p]:h?(0,m.stringFromCodePoint)(h):"",f>>22,2097152&f?this._combined[p].charCodeAt(this._combined[p].length-1):h]}set(p,f){this._data[3*p+1]=f[u.CHAR_DATA_ATTR_INDEX],f[u.CHAR_DATA_CHAR_INDEX].length>1?(this._combined[p]=f[1],this._data[3*p+0]=2097152|p|f[u.CHAR_DATA_WIDTH_INDEX]<<22):this._data[3*p+0]=f[u.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|f[u.CHAR_DATA_WIDTH_INDEX]<<22}getWidth(p){return this._data[3*p+0]>>22}hasWidth(p){return 12582912&this._data[3*p+0]}getFg(p){return this._data[3*p+1]}getBg(p){return this._data[3*p+2]}hasContent(p){return 4194303&this._data[3*p+0]}getCodePoint(p){const f=this._data[3*p+0];return 2097152&f?this._combined[p].charCodeAt(this._combined[p].length-1):2097151&f}isCombined(p){return 2097152&this._data[3*p+0]}getString(p){const f=this._data[3*p+0];return 2097152&f?this._combined[p]:2097151&f?(0,m.stringFromCodePoint)(2097151&f):""}isProtected(p){return 536870912&this._data[3*p+2]}loadCell(p,f){return v=3*p,f.content=this._data[v+0],f.fg=this._data[v+1],f.bg=this._data[v+2],2097152&f.content&&(f.combinedData=this._combined[p]),268435456&f.bg&&(f.extended=this._extendedAttrs[p]),f}setCell(p,f){2097152&f.content&&(this._combined[p]=f.combinedData),268435456&f.bg&&(this._extendedAttrs[p]=f.extended),this._data[3*p+0]=f.content,this._data[3*p+1]=f.fg,this._data[3*p+2]=f.bg}setCellFromCodepoint(p,f,h,g){268435456&g.bg&&(this._extendedAttrs[p]=g.extended),this._data[3*p+0]=f|h<<22,this._data[3*p+1]=g.fg,this._data[3*p+2]=g.bg}addCodepointToCell(p,f,h){let g=this._data[3*p+0];2097152&g?this._combined[p]+=(0,m.stringFromCodePoint)(f):2097151&g?(this._combined[p]=(0,m.stringFromCodePoint)(2097151&g)+(0,m.stringFromCodePoint)(f),g&=-2097152,g|=2097152):g=f|4194304,h&&(g&=-12582913,g|=h<<22),this._data[3*p+0]=g}insertCells(p,f,h){if((p%=this.length)&&this.getWidth(p-1)===2&&this.setCellFromCodepoint(p-1,0,1,h),f<this.length-p){const g=new d.CellData;for(let S=this.length-p-f-1;S>=0;--S)this.setCell(p+f+S,this.loadCell(p+S,g));for(let S=0;S<f;++S)this.setCell(p+S,h)}else for(let g=p;g<this.length;++g)this.setCell(g,h);this.getWidth(this.length-1)===2&&this.setCellFromCodepoint(this.length-1,0,1,h)}deleteCells(p,f,h){if(p%=this.length,f<this.length-p){const g=new d.CellData;for(let S=0;S<this.length-p-f;++S)this.setCell(p+S,this.loadCell(p+f+S,g));for(let S=this.length-f;S<this.length;++S)this.setCell(S,h)}else for(let g=p;g<this.length;++g)this.setCell(g,h);p&&this.getWidth(p-1)===2&&this.setCellFromCodepoint(p-1,0,1,h),this.getWidth(p)!==0||this.hasContent(p)||this.setCellFromCodepoint(p,0,1,h)}replaceCells(p,f,h,g=!1){if(g)for(p&&this.getWidth(p-1)===2&&!this.isProtected(p-1)&&this.setCellFromCodepoint(p-1,0,1,h),f<this.length&&this.getWidth(f-1)===2&&!this.isProtected(f)&&this.setCellFromCodepoint(f,0,1,h);p<f&&p<this.length;)this.isProtected(p)||this.setCell(p,h),p++;else for(p&&this.getWidth(p-1)===2&&this.setCellFromCodepoint(p-1,0,1,h),f<this.length&&this.getWidth(f-1)===2&&this.setCellFromCodepoint(f,0,1,h);p<f&&p<this.length;)this.setCell(p++,h)}resize(p,f){if(p===this.length)return 4*this._data.length*2<this._data.buffer.byteLength;const h=3*p;if(p>this.length){if(this._data.buffer.byteLength>=4*h)this._data=new Uint32Array(this._data.buffer,0,h);else{const g=new Uint32Array(h);g.set(this._data),this._data=g}for(let g=this.length;g<p;++g)this.setCell(g,f)}else{this._data=this._data.subarray(0,h);const g=Object.keys(this._combined);for(let b=0;b<g.length;b++){const w=parseInt(g[b],10);w>=p&&delete this._combined[w]}const S=Object.keys(this._extendedAttrs);for(let b=0;b<S.length;b++){const w=parseInt(S[b],10);w>=p&&delete this._extendedAttrs[w]}}return this.length=p,4*h*2<this._data.buffer.byteLength}cleanupMemory(){if(4*this._data.length*2<this._data.buffer.byteLength){const p=new Uint32Array(this._data.length);return p.set(this._data),this._data=p,1}return 0}fill(p,f=!1){if(f)for(let h=0;h<this.length;++h)this.isProtected(h)||this.setCell(h,p);else{this._combined={},this._extendedAttrs={};for(let h=0;h<this.length;++h)this.setCell(h,p)}}copyFrom(p){this.length!==p.length?this._data=new Uint32Array(p._data):this._data.set(p._data),this.length=p.length,this._combined={};for(const f in p._combined)this._combined[f]=p._combined[f];this._extendedAttrs={};for(const f in p._extendedAttrs)this._extendedAttrs[f]=p._extendedAttrs[f];this.isWrapped=p.isWrapped}clone(){const p=new y(0);p._data=new Uint32Array(this._data),p.length=this.length;for(const f in this._combined)p._combined[f]=this._combined[f];for(const f in this._extendedAttrs)p._extendedAttrs[f]=this._extendedAttrs[f];return p.isWrapped=this.isWrapped,p}getTrimmedLength(){for(let p=this.length-1;p>=0;--p)if(4194303&this._data[3*p+0])return p+(this._data[3*p+0]>>22);return 0}getNoBgTrimmedLength(){for(let p=this.length-1;p>=0;--p)if(4194303&this._data[3*p+0]||50331648&this._data[3*p+2])return p+(this._data[3*p+0]>>22);return 0}copyCellsFrom(p,f,h,g,S){const b=p._data;if(S)for(let k=g-1;k>=0;k--){for(let C=0;C<3;C++)this._data[3*(h+k)+C]=b[3*(f+k)+C];268435456&b[3*(f+k)+2]&&(this._extendedAttrs[h+k]=p._extendedAttrs[f+k])}else for(let k=0;k<g;k++){for(let C=0;C<3;C++)this._data[3*(h+k)+C]=b[3*(f+k)+C];268435456&b[3*(f+k)+2]&&(this._extendedAttrs[h+k]=p._extendedAttrs[f+k])}const w=Object.keys(p._combined);for(let k=0;k<w.length;k++){const C=parseInt(w[k],10);C>=f&&(this._combined[C-f+h]=p._combined[C])}}translateToString(p,f,h,g){f=f??0,h=h??this.length,p&&(h=Math.min(h,this.getTrimmedLength())),g&&(g.length=0);let S="";for(;f<h;){const b=this._data[3*f+0],w=2097151&b,k=2097152&b?this._combined[f]:w?(0,m.stringFromCodePoint)(w):u.WHITESPACE_CELL_CHAR;if(S+=k,g)for(let C=0;C<k.length;++C)g.push(f);f+=b>>22||1}return g&&g.push(f),S}}o.BufferLine=y},4841:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.getRangeLength=void 0,o.getRangeLength=function(l,c){if(l.start.y>l.end.y)throw new Error(`Buffer range end (${l.end.x}, ${l.end.y}) cannot be before start (${l.start.x}, ${l.start.y})`);return c*(l.end.y-l.start.y)+(l.end.x-l.start.x+1)}},4634:(a,o)=>{function l(c,d,u){if(d===c.length-1)return c[d].getTrimmedLength();const m=!c[d].hasContent(u-1)&&c[d].getWidth(u-1)===1,v=c[d+1].getWidth(0)===2;return m&&v?u-1:u}Object.defineProperty(o,"__esModule",{value:!0}),o.getWrappedLineTrimmedLength=o.reflowSmallerGetNewLineLengths=o.reflowLargerApplyNewLayout=o.reflowLargerCreateNewLayout=o.reflowLargerGetLinesToRemove=void 0,o.reflowLargerGetLinesToRemove=function(c,d,u,m,v){const y=[];for(let _=0;_<c.length-1;_++){let p=_,f=c.get(++p);if(!f.isWrapped)continue;const h=[c.get(_)];for(;p<c.length&&f.isWrapped;)h.push(f),f=c.get(++p);if(m>=_&&m<p){_+=h.length-1;continue}let g=0,S=l(h,g,d),b=1,w=0;for(;b<h.length;){const C=l(h,b,d),E=C-w,x=u-S,I=Math.min(E,x);h[g].copyCellsFrom(h[b],w,S,I,!1),S+=I,S===u&&(g++,S=0),w+=I,w===C&&(b++,w=0),S===0&&g!==0&&h[g-1].getWidth(u-1)===2&&(h[g].copyCellsFrom(h[g-1],u-1,S++,1,!1),h[g-1].setCell(u-1,v))}h[g].replaceCells(S,u,v);let k=0;for(let C=h.length-1;C>0&&(C>g||h[C].getTrimmedLength()===0);C--)k++;k>0&&(y.push(_+h.length-k),y.push(k)),_+=h.length-1}return y},o.reflowLargerCreateNewLayout=function(c,d){const u=[];let m=0,v=d[m],y=0;for(let _=0;_<c.length;_++)if(v===_){const p=d[++m];c.onDeleteEmitter.fire({index:_-y,amount:p}),_+=p-1,y+=p,v=d[++m]}else u.push(_);return{layout:u,countRemoved:y}},o.reflowLargerApplyNewLayout=function(c,d){const u=[];for(let m=0;m<d.length;m++)u.push(c.get(d[m]));for(let m=0;m<u.length;m++)c.set(m,u[m]);c.length=d.length},o.reflowSmallerGetNewLineLengths=function(c,d,u){const m=[],v=c.map((f,h)=>l(c,h,d)).reduce((f,h)=>f+h);let y=0,_=0,p=0;for(;p<v;){if(v-p<u){m.push(v-p);break}y+=u;const f=l(c,_,d);y>f&&(y-=f,_++);const h=c[_].getWidth(y-1)===2;h&&y--;const g=h?u-1:u;m.push(g),p+=g}return m},o.getWrappedLineTrimmedLength=l},5295:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferSet=void 0;const c=l(8460),d=l(844),u=l(9092);class m extends d.Disposable{constructor(y,_){super(),this._optionsService=y,this._bufferService=_,this._onBufferActivate=this.register(new c.EventEmitter),this.onBufferActivate=this._onBufferActivate.event,this.reset(),this.register(this._optionsService.onSpecificOptionChange("scrollback",()=>this.resize(this._bufferService.cols,this._bufferService.rows))),this.register(this._optionsService.onSpecificOptionChange("tabStopWidth",()=>this.setupTabStops()))}reset(){this._normal=new u.Buffer(!0,this._optionsService,this._bufferService),this._normal.fillViewportRows(),this._alt=new u.Buffer(!1,this._optionsService,this._bufferService),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}),this.setupTabStops()}get alt(){return this._alt}get active(){return this._activeBuffer}get normal(){return this._normal}activateNormalBuffer(){this._activeBuffer!==this._normal&&(this._normal.x=this._alt.x,this._normal.y=this._alt.y,this._alt.clearAllMarkers(),this._alt.clear(),this._activeBuffer=this._normal,this._onBufferActivate.fire({activeBuffer:this._normal,inactiveBuffer:this._alt}))}activateAltBuffer(y){this._activeBuffer!==this._alt&&(this._alt.fillViewportRows(y),this._alt.x=this._normal.x,this._alt.y=this._normal.y,this._activeBuffer=this._alt,this._onBufferActivate.fire({activeBuffer:this._alt,inactiveBuffer:this._normal}))}resize(y,_){this._normal.resize(y,_),this._alt.resize(y,_),this.setupTabStops(y)}setupTabStops(y){this._normal.setupTabStops(y),this._alt.setupTabStops(y)}}o.BufferSet=m},511:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CellData=void 0;const c=l(482),d=l(643),u=l(3734);class m extends u.AttributeData{constructor(){super(...arguments),this.content=0,this.fg=0,this.bg=0,this.extended=new u.ExtendedAttrs,this.combinedData=""}static fromCharData(y){const _=new m;return _.setFromCharData(y),_}isCombined(){return 2097152&this.content}getWidth(){return this.content>>22}getChars(){return 2097152&this.content?this.combinedData:2097151&this.content?(0,c.stringFromCodePoint)(2097151&this.content):""}getCode(){return this.isCombined()?this.combinedData.charCodeAt(this.combinedData.length-1):2097151&this.content}setFromCharData(y){this.fg=y[d.CHAR_DATA_ATTR_INDEX],this.bg=0;let _=!1;if(y[d.CHAR_DATA_CHAR_INDEX].length>2)_=!0;else if(y[d.CHAR_DATA_CHAR_INDEX].length===2){const p=y[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0);if(55296<=p&&p<=56319){const f=y[d.CHAR_DATA_CHAR_INDEX].charCodeAt(1);56320<=f&&f<=57343?this.content=1024*(p-55296)+f-56320+65536|y[d.CHAR_DATA_WIDTH_INDEX]<<22:_=!0}else _=!0}else this.content=y[d.CHAR_DATA_CHAR_INDEX].charCodeAt(0)|y[d.CHAR_DATA_WIDTH_INDEX]<<22;_&&(this.combinedData=y[d.CHAR_DATA_CHAR_INDEX],this.content=2097152|y[d.CHAR_DATA_WIDTH_INDEX]<<22)}getAsCharData(){return[this.fg,this.getChars(),this.getWidth(),this.getCode()]}}o.CellData=m},643:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WHITESPACE_CELL_CODE=o.WHITESPACE_CELL_WIDTH=o.WHITESPACE_CELL_CHAR=o.NULL_CELL_CODE=o.NULL_CELL_WIDTH=o.NULL_CELL_CHAR=o.CHAR_DATA_CODE_INDEX=o.CHAR_DATA_WIDTH_INDEX=o.CHAR_DATA_CHAR_INDEX=o.CHAR_DATA_ATTR_INDEX=o.DEFAULT_EXT=o.DEFAULT_ATTR=o.DEFAULT_COLOR=void 0,o.DEFAULT_COLOR=0,o.DEFAULT_ATTR=256|o.DEFAULT_COLOR<<9,o.DEFAULT_EXT=0,o.CHAR_DATA_ATTR_INDEX=0,o.CHAR_DATA_CHAR_INDEX=1,o.CHAR_DATA_WIDTH_INDEX=2,o.CHAR_DATA_CODE_INDEX=3,o.NULL_CELL_CHAR="",o.NULL_CELL_WIDTH=1,o.NULL_CELL_CODE=0,o.WHITESPACE_CELL_CHAR=" ",o.WHITESPACE_CELL_WIDTH=1,o.WHITESPACE_CELL_CODE=32},4863:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Marker=void 0;const c=l(8460),d=l(844);class u{get id(){return this._id}constructor(v){this.line=v,this.isDisposed=!1,this._disposables=[],this._id=u._nextId++,this._onDispose=this.register(new c.EventEmitter),this.onDispose=this._onDispose.event}dispose(){this.isDisposed||(this.isDisposed=!0,this.line=-1,this._onDispose.fire(),(0,d.disposeArray)(this._disposables),this._disposables.length=0)}register(v){return this._disposables.push(v),v}}o.Marker=u,u._nextId=1},7116:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DEFAULT_CHARSET=o.CHARSETS=void 0,o.CHARSETS={},o.DEFAULT_CHARSET=o.CHARSETS.B,o.CHARSETS[0]={"`":"◆",a:"▒",b:"␉",c:"␌",d:"␍",e:"␊",f:"°",g:"±",h:"␤",i:"␋",j:"┘",k:"┐",l:"┌",m:"└",n:"┼",o:"⎺",p:"⎻",q:"─",r:"⎼",s:"⎽",t:"├",u:"┤",v:"┴",w:"┬",x:"│",y:"≤",z:"≥","{":"π","|":"≠","}":"£","~":"·"},o.CHARSETS.A={"#":"£"},o.CHARSETS.B=void 0,o.CHARSETS[4]={"#":"£","@":"¾","[":"ij","\\":"½","]":"|","{":"¨","|":"f","}":"¼","~":"´"},o.CHARSETS.C=o.CHARSETS[5]={"[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},o.CHARSETS.R={"#":"£","@":"à","[":"°","\\":"ç","]":"§","{":"é","|":"ù","}":"è","~":"¨"},o.CHARSETS.Q={"@":"à","[":"â","\\":"ç","]":"ê","^":"î","`":"ô","{":"é","|":"ù","}":"è","~":"û"},o.CHARSETS.K={"@":"§","[":"Ä","\\":"Ö","]":"Ü","{":"ä","|":"ö","}":"ü","~":"ß"},o.CHARSETS.Y={"#":"£","@":"§","[":"°","\\":"ç","]":"é","`":"ù","{":"à","|":"ò","}":"è","~":"ì"},o.CHARSETS.E=o.CHARSETS[6]={"@":"Ä","[":"Æ","\\":"Ø","]":"Å","^":"Ü","`":"ä","{":"æ","|":"ø","}":"å","~":"ü"},o.CHARSETS.Z={"#":"£","@":"§","[":"¡","\\":"Ñ","]":"¿","{":"°","|":"ñ","}":"ç"},o.CHARSETS.H=o.CHARSETS[7]={"@":"É","[":"Ä","\\":"Ö","]":"Å","^":"Ü","`":"é","{":"ä","|":"ö","}":"å","~":"ü"},o.CHARSETS["="]={"#":"ù","@":"à","[":"é","\\":"ç","]":"ê","^":"î",_:"è","`":"ô","{":"ä","|":"ö","}":"ü","~":"û"}},2584:(a,o)=>{var l,c,d;Object.defineProperty(o,"__esModule",{value:!0}),o.C1_ESCAPED=o.C1=o.C0=void 0,function(u){u.NUL="\0",u.SOH="",u.STX="",u.ETX="",u.EOT="",u.ENQ="",u.ACK="",u.BEL="\x07",u.BS="\b",u.HT="	",u.LF=`
`,u.VT="\v",u.FF="\f",u.CR="\r",u.SO="",u.SI="",u.DLE="",u.DC1="",u.DC2="",u.DC3="",u.DC4="",u.NAK="",u.SYN="",u.ETB="",u.CAN="",u.EM="",u.SUB="",u.ESC="\x1B",u.FS="",u.GS="",u.RS="",u.US="",u.SP=" ",u.DEL=""}(l||(o.C0=l={})),function(u){u.PAD="",u.HOP="",u.BPH="",u.NBH="",u.IND="",u.NEL="",u.SSA="",u.ESA="",u.HTS="",u.HTJ="",u.VTS="",u.PLD="",u.PLU="",u.RI="",u.SS2="",u.SS3="",u.DCS="",u.PU1="",u.PU2="",u.STS="",u.CCH="",u.MW="",u.SPA="",u.EPA="",u.SOS="",u.SGCI="",u.SCI="",u.CSI="",u.ST="",u.OSC="",u.PM="",u.APC=""}(c||(o.C1=c={})),function(u){u.ST=`${l.ESC}\\`}(d||(o.C1_ESCAPED=d={}))},7399:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.evaluateKeyboardEvent=void 0;const c=l(2584),d={48:["0",")"],49:["1","!"],50:["2","@"],51:["3","#"],52:["4","$"],53:["5","%"],54:["6","^"],55:["7","&"],56:["8","*"],57:["9","("],186:[";",":"],187:["=","+"],188:[",","<"],189:["-","_"],190:[".",">"],191:["/","?"],192:["`","~"],219:["[","{"],220:["\\","|"],221:["]","}"],222:["'",'"']};o.evaluateKeyboardEvent=function(u,m,v,y){const _={type:0,cancel:!1,key:void 0},p=(u.shiftKey?1:0)|(u.altKey?2:0)|(u.ctrlKey?4:0)|(u.metaKey?8:0);switch(u.keyCode){case 0:u.key==="UIKeyInputUpArrow"?_.key=m?c.C0.ESC+"OA":c.C0.ESC+"[A":u.key==="UIKeyInputLeftArrow"?_.key=m?c.C0.ESC+"OD":c.C0.ESC+"[D":u.key==="UIKeyInputRightArrow"?_.key=m?c.C0.ESC+"OC":c.C0.ESC+"[C":u.key==="UIKeyInputDownArrow"&&(_.key=m?c.C0.ESC+"OB":c.C0.ESC+"[B");break;case 8:_.key=u.ctrlKey?"\b":c.C0.DEL,u.altKey&&(_.key=c.C0.ESC+_.key);break;case 9:if(u.shiftKey){_.key=c.C0.ESC+"[Z";break}_.key=c.C0.HT,_.cancel=!0;break;case 13:_.key=u.altKey?c.C0.ESC+c.C0.CR:c.C0.CR,_.cancel=!0;break;case 27:_.key=c.C0.ESC,u.altKey&&(_.key=c.C0.ESC+c.C0.ESC),_.cancel=!0;break;case 37:if(u.metaKey)break;p?(_.key=c.C0.ESC+"[1;"+(p+1)+"D",_.key===c.C0.ESC+"[1;3D"&&(_.key=c.C0.ESC+(v?"b":"[1;5D"))):_.key=m?c.C0.ESC+"OD":c.C0.ESC+"[D";break;case 39:if(u.metaKey)break;p?(_.key=c.C0.ESC+"[1;"+(p+1)+"C",_.key===c.C0.ESC+"[1;3C"&&(_.key=c.C0.ESC+(v?"f":"[1;5C"))):_.key=m?c.C0.ESC+"OC":c.C0.ESC+"[C";break;case 38:if(u.metaKey)break;p?(_.key=c.C0.ESC+"[1;"+(p+1)+"A",v||_.key!==c.C0.ESC+"[1;3A"||(_.key=c.C0.ESC+"[1;5A")):_.key=m?c.C0.ESC+"OA":c.C0.ESC+"[A";break;case 40:if(u.metaKey)break;p?(_.key=c.C0.ESC+"[1;"+(p+1)+"B",v||_.key!==c.C0.ESC+"[1;3B"||(_.key=c.C0.ESC+"[1;5B")):_.key=m?c.C0.ESC+"OB":c.C0.ESC+"[B";break;case 45:u.shiftKey||u.ctrlKey||(_.key=c.C0.ESC+"[2~");break;case 46:_.key=p?c.C0.ESC+"[3;"+(p+1)+"~":c.C0.ESC+"[3~";break;case 36:_.key=p?c.C0.ESC+"[1;"+(p+1)+"H":m?c.C0.ESC+"OH":c.C0.ESC+"[H";break;case 35:_.key=p?c.C0.ESC+"[1;"+(p+1)+"F":m?c.C0.ESC+"OF":c.C0.ESC+"[F";break;case 33:u.shiftKey?_.type=2:u.ctrlKey?_.key=c.C0.ESC+"[5;"+(p+1)+"~":_.key=c.C0.ESC+"[5~";break;case 34:u.shiftKey?_.type=3:u.ctrlKey?_.key=c.C0.ESC+"[6;"+(p+1)+"~":_.key=c.C0.ESC+"[6~";break;case 112:_.key=p?c.C0.ESC+"[1;"+(p+1)+"P":c.C0.ESC+"OP";break;case 113:_.key=p?c.C0.ESC+"[1;"+(p+1)+"Q":c.C0.ESC+"OQ";break;case 114:_.key=p?c.C0.ESC+"[1;"+(p+1)+"R":c.C0.ESC+"OR";break;case 115:_.key=p?c.C0.ESC+"[1;"+(p+1)+"S":c.C0.ESC+"OS";break;case 116:_.key=p?c.C0.ESC+"[15;"+(p+1)+"~":c.C0.ESC+"[15~";break;case 117:_.key=p?c.C0.ESC+"[17;"+(p+1)+"~":c.C0.ESC+"[17~";break;case 118:_.key=p?c.C0.ESC+"[18;"+(p+1)+"~":c.C0.ESC+"[18~";break;case 119:_.key=p?c.C0.ESC+"[19;"+(p+1)+"~":c.C0.ESC+"[19~";break;case 120:_.key=p?c.C0.ESC+"[20;"+(p+1)+"~":c.C0.ESC+"[20~";break;case 121:_.key=p?c.C0.ESC+"[21;"+(p+1)+"~":c.C0.ESC+"[21~";break;case 122:_.key=p?c.C0.ESC+"[23;"+(p+1)+"~":c.C0.ESC+"[23~";break;case 123:_.key=p?c.C0.ESC+"[24;"+(p+1)+"~":c.C0.ESC+"[24~";break;default:if(!u.ctrlKey||u.shiftKey||u.altKey||u.metaKey)if(v&&!y||!u.altKey||u.metaKey)!v||u.altKey||u.ctrlKey||u.shiftKey||!u.metaKey?u.key&&!u.ctrlKey&&!u.altKey&&!u.metaKey&&u.keyCode>=48&&u.key.length===1?_.key=u.key:u.key&&u.ctrlKey&&(u.key==="_"&&(_.key=c.C0.US),u.key==="@"&&(_.key=c.C0.NUL)):u.keyCode===65&&(_.type=1);else{const f=d[u.keyCode],h=f==null?void 0:f[u.shiftKey?1:0];if(h)_.key=c.C0.ESC+h;else if(u.keyCode>=65&&u.keyCode<=90){const g=u.ctrlKey?u.keyCode-64:u.keyCode+32;let S=String.fromCharCode(g);u.shiftKey&&(S=S.toUpperCase()),_.key=c.C0.ESC+S}else if(u.keyCode===32)_.key=c.C0.ESC+(u.ctrlKey?c.C0.NUL:" ");else if(u.key==="Dead"&&u.code.startsWith("Key")){let g=u.code.slice(3,4);u.shiftKey||(g=g.toLowerCase()),_.key=c.C0.ESC+g,_.cancel=!0}}else u.keyCode>=65&&u.keyCode<=90?_.key=String.fromCharCode(u.keyCode-64):u.keyCode===32?_.key=c.C0.NUL:u.keyCode>=51&&u.keyCode<=55?_.key=String.fromCharCode(u.keyCode-51+27):u.keyCode===56?_.key=c.C0.DEL:u.keyCode===219?_.key=c.C0.ESC:u.keyCode===220?_.key=c.C0.FS:u.keyCode===221&&(_.key=c.C0.GS)}return _}},482:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Utf8ToUtf32=o.StringToUtf32=o.utf32ToString=o.stringFromCodePoint=void 0,o.stringFromCodePoint=function(l){return l>65535?(l-=65536,String.fromCharCode(55296+(l>>10))+String.fromCharCode(l%1024+56320)):String.fromCharCode(l)},o.utf32ToString=function(l,c=0,d=l.length){let u="";for(let m=c;m<d;++m){let v=l[m];v>65535?(v-=65536,u+=String.fromCharCode(55296+(v>>10))+String.fromCharCode(v%1024+56320)):u+=String.fromCharCode(v)}return u},o.StringToUtf32=class{constructor(){this._interim=0}clear(){this._interim=0}decode(l,c){const d=l.length;if(!d)return 0;let u=0,m=0;if(this._interim){const v=l.charCodeAt(m++);56320<=v&&v<=57343?c[u++]=1024*(this._interim-55296)+v-56320+65536:(c[u++]=this._interim,c[u++]=v),this._interim=0}for(let v=m;v<d;++v){const y=l.charCodeAt(v);if(55296<=y&&y<=56319){if(++v>=d)return this._interim=y,u;const _=l.charCodeAt(v);56320<=_&&_<=57343?c[u++]=1024*(y-55296)+_-56320+65536:(c[u++]=y,c[u++]=_)}else y!==65279&&(c[u++]=y)}return u}},o.Utf8ToUtf32=class{constructor(){this.interim=new Uint8Array(3)}clear(){this.interim.fill(0)}decode(l,c){const d=l.length;if(!d)return 0;let u,m,v,y,_=0,p=0,f=0;if(this.interim[0]){let S=!1,b=this.interim[0];b&=(224&b)==192?31:(240&b)==224?15:7;let w,k=0;for(;(w=63&this.interim[++k])&&k<4;)b<<=6,b|=w;const C=(224&this.interim[0])==192?2:(240&this.interim[0])==224?3:4,E=C-k;for(;f<E;){if(f>=d)return 0;if(w=l[f++],(192&w)!=128){f--,S=!0;break}this.interim[k++]=w,b<<=6,b|=63&w}S||(C===2?b<128?f--:c[_++]=b:C===3?b<2048||b>=55296&&b<=57343||b===65279||(c[_++]=b):b<65536||b>1114111||(c[_++]=b)),this.interim.fill(0)}const h=d-4;let g=f;for(;g<d;){for(;!(!(g<h)||128&(u=l[g])||128&(m=l[g+1])||128&(v=l[g+2])||128&(y=l[g+3]));)c[_++]=u,c[_++]=m,c[_++]=v,c[_++]=y,g+=4;if(u=l[g++],u<128)c[_++]=u;else if((224&u)==192){if(g>=d)return this.interim[0]=u,_;if(m=l[g++],(192&m)!=128){g--;continue}if(p=(31&u)<<6|63&m,p<128){g--;continue}c[_++]=p}else if((240&u)==224){if(g>=d)return this.interim[0]=u,_;if(m=l[g++],(192&m)!=128){g--;continue}if(g>=d)return this.interim[0]=u,this.interim[1]=m,_;if(v=l[g++],(192&v)!=128){g--;continue}if(p=(15&u)<<12|(63&m)<<6|63&v,p<2048||p>=55296&&p<=57343||p===65279)continue;c[_++]=p}else if((248&u)==240){if(g>=d)return this.interim[0]=u,_;if(m=l[g++],(192&m)!=128){g--;continue}if(g>=d)return this.interim[0]=u,this.interim[1]=m,_;if(v=l[g++],(192&v)!=128){g--;continue}if(g>=d)return this.interim[0]=u,this.interim[1]=m,this.interim[2]=v,_;if(y=l[g++],(192&y)!=128){g--;continue}if(p=(7&u)<<18|(63&m)<<12|(63&v)<<6|63&y,p<65536||p>1114111)continue;c[_++]=p}}return _}}},225:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeV6=void 0;const c=l(1480),d=[[768,879],[1155,1158],[1160,1161],[1425,1469],[1471,1471],[1473,1474],[1476,1477],[1479,1479],[1536,1539],[1552,1557],[1611,1630],[1648,1648],[1750,1764],[1767,1768],[1770,1773],[1807,1807],[1809,1809],[1840,1866],[1958,1968],[2027,2035],[2305,2306],[2364,2364],[2369,2376],[2381,2381],[2385,2388],[2402,2403],[2433,2433],[2492,2492],[2497,2500],[2509,2509],[2530,2531],[2561,2562],[2620,2620],[2625,2626],[2631,2632],[2635,2637],[2672,2673],[2689,2690],[2748,2748],[2753,2757],[2759,2760],[2765,2765],[2786,2787],[2817,2817],[2876,2876],[2879,2879],[2881,2883],[2893,2893],[2902,2902],[2946,2946],[3008,3008],[3021,3021],[3134,3136],[3142,3144],[3146,3149],[3157,3158],[3260,3260],[3263,3263],[3270,3270],[3276,3277],[3298,3299],[3393,3395],[3405,3405],[3530,3530],[3538,3540],[3542,3542],[3633,3633],[3636,3642],[3655,3662],[3761,3761],[3764,3769],[3771,3772],[3784,3789],[3864,3865],[3893,3893],[3895,3895],[3897,3897],[3953,3966],[3968,3972],[3974,3975],[3984,3991],[3993,4028],[4038,4038],[4141,4144],[4146,4146],[4150,4151],[4153,4153],[4184,4185],[4448,4607],[4959,4959],[5906,5908],[5938,5940],[5970,5971],[6002,6003],[6068,6069],[6071,6077],[6086,6086],[6089,6099],[6109,6109],[6155,6157],[6313,6313],[6432,6434],[6439,6440],[6450,6450],[6457,6459],[6679,6680],[6912,6915],[6964,6964],[6966,6970],[6972,6972],[6978,6978],[7019,7027],[7616,7626],[7678,7679],[8203,8207],[8234,8238],[8288,8291],[8298,8303],[8400,8431],[12330,12335],[12441,12442],[43014,43014],[43019,43019],[43045,43046],[64286,64286],[65024,65039],[65056,65059],[65279,65279],[65529,65531]],u=[[68097,68099],[68101,68102],[68108,68111],[68152,68154],[68159,68159],[119143,119145],[119155,119170],[119173,119179],[119210,119213],[119362,119364],[917505,917505],[917536,917631],[917760,917999]];let m;o.UnicodeV6=class{constructor(){if(this.version="6",!m){m=new Uint8Array(65536),m.fill(1),m[0]=0,m.fill(0,1,32),m.fill(0,127,160),m.fill(2,4352,4448),m[9001]=2,m[9002]=2,m.fill(2,11904,42192),m[12351]=1,m.fill(2,44032,55204),m.fill(2,63744,64256),m.fill(2,65040,65050),m.fill(2,65072,65136),m.fill(2,65280,65377),m.fill(2,65504,65511);for(let v=0;v<d.length;++v)m.fill(0,d[v][0],d[v][1]+1)}}wcwidth(v){return v<32?0:v<127?1:v<65536?m[v]:function(y,_){let p,f=0,h=_.length-1;if(y<_[0][0]||y>_[h][1])return!1;for(;h>=f;)if(p=f+h>>1,y>_[p][1])f=p+1;else{if(!(y<_[p][0]))return!0;h=p-1}return!1}(v,u)?0:v>=131072&&v<=196605||v>=196608&&v<=262141?2:1}charProperties(v,y){let _=this.wcwidth(v),p=_===0&&y!==0;if(p){const f=c.UnicodeService.extractWidth(y);f===0?p=!1:f>_&&(_=f)}return c.UnicodeService.createPropertyValue(0,_,p)}}},5981:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.WriteBuffer=void 0;const c=l(8460),d=l(844);class u extends d.Disposable{constructor(v){super(),this._action=v,this._writeBuffer=[],this._callbacks=[],this._pendingData=0,this._bufferOffset=0,this._isSyncWriting=!1,this._syncCalls=0,this._didUserInput=!1,this._onWriteParsed=this.register(new c.EventEmitter),this.onWriteParsed=this._onWriteParsed.event}handleUserInput(){this._didUserInput=!0}writeSync(v,y){if(y!==void 0&&this._syncCalls>y)return void(this._syncCalls=0);if(this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(void 0),this._syncCalls++,this._isSyncWriting)return;let _;for(this._isSyncWriting=!0;_=this._writeBuffer.shift();){this._action(_);const p=this._callbacks.shift();p&&p()}this._pendingData=0,this._bufferOffset=2147483647,this._isSyncWriting=!1,this._syncCalls=0}write(v,y){if(this._pendingData>5e7)throw new Error("write data discarded, use flow control to avoid losing data");if(!this._writeBuffer.length){if(this._bufferOffset=0,this._didUserInput)return this._didUserInput=!1,this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(y),void this._innerWrite();setTimeout(()=>this._innerWrite())}this._pendingData+=v.length,this._writeBuffer.push(v),this._callbacks.push(y)}_innerWrite(v=0,y=!0){const _=v||Date.now();for(;this._writeBuffer.length>this._bufferOffset;){const p=this._writeBuffer[this._bufferOffset],f=this._action(p,y);if(f){const g=S=>Date.now()-_>=12?setTimeout(()=>this._innerWrite(0,S)):this._innerWrite(_,S);return void f.catch(S=>(queueMicrotask(()=>{throw S}),Promise.resolve(!1))).then(g)}const h=this._callbacks[this._bufferOffset];if(h&&h(),this._bufferOffset++,this._pendingData-=p.length,Date.now()-_>=12)break}this._writeBuffer.length>this._bufferOffset?(this._bufferOffset>50&&(this._writeBuffer=this._writeBuffer.slice(this._bufferOffset),this._callbacks=this._callbacks.slice(this._bufferOffset),this._bufferOffset=0),setTimeout(()=>this._innerWrite())):(this._writeBuffer.length=0,this._callbacks.length=0,this._pendingData=0,this._bufferOffset=0),this._onWriteParsed.fire()}}o.WriteBuffer=u},5941:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.toRgbString=o.parseColor=void 0;const l=/^([\da-f])\/([\da-f])\/([\da-f])$|^([\da-f]{2})\/([\da-f]{2})\/([\da-f]{2})$|^([\da-f]{3})\/([\da-f]{3})\/([\da-f]{3})$|^([\da-f]{4})\/([\da-f]{4})\/([\da-f]{4})$/,c=/^[\da-f]+$/;function d(u,m){const v=u.toString(16),y=v.length<2?"0"+v:v;switch(m){case 4:return v[0];case 8:return y;case 12:return(y+y).slice(0,3);default:return y+y}}o.parseColor=function(u){if(!u)return;let m=u.toLowerCase();if(m.indexOf("rgb:")===0){m=m.slice(4);const v=l.exec(m);if(v){const y=v[1]?15:v[4]?255:v[7]?4095:65535;return[Math.round(parseInt(v[1]||v[4]||v[7]||v[10],16)/y*255),Math.round(parseInt(v[2]||v[5]||v[8]||v[11],16)/y*255),Math.round(parseInt(v[3]||v[6]||v[9]||v[12],16)/y*255)]}}else if(m.indexOf("#")===0&&(m=m.slice(1),c.exec(m)&&[3,6,9,12].includes(m.length))){const v=m.length/3,y=[0,0,0];for(let _=0;_<3;++_){const p=parseInt(m.slice(v*_,v*_+v),16);y[_]=v===1?p<<4:v===2?p:v===3?p>>4:p>>8}return y}},o.toRgbString=function(u,m=16){const[v,y,_]=u;return`rgb:${d(v,m)}/${d(y,m)}/${d(_,m)}`}},5770:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.PAYLOAD_LIMIT=void 0,o.PAYLOAD_LIMIT=1e7},6351:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DcsHandler=o.DcsParser=void 0;const c=l(482),d=l(8742),u=l(5770),m=[];o.DcsParser=class{constructor(){this._handlers=Object.create(null),this._active=m,this._ident=0,this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=m}registerHandler(y,_){this._handlers[y]===void 0&&(this._handlers[y]=[]);const p=this._handlers[y];return p.push(_),{dispose:()=>{const f=p.indexOf(_);f!==-1&&p.splice(f,1)}}}clearHandler(y){this._handlers[y]&&delete this._handlers[y]}setHandlerFallback(y){this._handlerFb=y}reset(){if(this._active.length)for(let y=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;y>=0;--y)this._active[y].unhook(!1);this._stack.paused=!1,this._active=m,this._ident=0}hook(y,_){if(this.reset(),this._ident=y,this._active=this._handlers[y]||m,this._active.length)for(let p=this._active.length-1;p>=0;p--)this._active[p].hook(_);else this._handlerFb(this._ident,"HOOK",_)}put(y,_,p){if(this._active.length)for(let f=this._active.length-1;f>=0;f--)this._active[f].put(y,_,p);else this._handlerFb(this._ident,"PUT",(0,c.utf32ToString)(y,_,p))}unhook(y,_=!0){if(this._active.length){let p=!1,f=this._active.length-1,h=!1;if(this._stack.paused&&(f=this._stack.loopPosition-1,p=_,h=this._stack.fallThrough,this._stack.paused=!1),!h&&p===!1){for(;f>=0&&(p=this._active[f].unhook(y),p!==!0);f--)if(p instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!1,p;f--}for(;f>=0;f--)if(p=this._active[f].unhook(!1),p instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=f,this._stack.fallThrough=!0,p}else this._handlerFb(this._ident,"UNHOOK",y);this._active=m,this._ident=0}};const v=new d.Params;v.addParam(0),o.DcsHandler=class{constructor(y){this._handler=y,this._data="",this._params=v,this._hitLimit=!1}hook(y){this._params=y.length>1||y.params[0]?y.clone():v,this._data="",this._hitLimit=!1}put(y,_,p){this._hitLimit||(this._data+=(0,c.utf32ToString)(y,_,p),this._data.length>u.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}unhook(y){let _=!1;if(this._hitLimit)_=!1;else if(y&&(_=this._handler(this._data,this._params),_ instanceof Promise))return _.then(p=>(this._params=v,this._data="",this._hitLimit=!1,p));return this._params=v,this._data="",this._hitLimit=!1,_}}},2015:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.EscapeSequenceParser=o.VT500_TRANSITION_TABLE=o.TransitionTable=void 0;const c=l(844),d=l(8742),u=l(6242),m=l(6351);class v{constructor(f){this.table=new Uint8Array(f)}setDefault(f,h){this.table.fill(f<<4|h)}add(f,h,g,S){this.table[h<<8|f]=g<<4|S}addMany(f,h,g,S){for(let b=0;b<f.length;b++)this.table[h<<8|f[b]]=g<<4|S}}o.TransitionTable=v;const y=160;o.VT500_TRANSITION_TABLE=function(){const p=new v(4095),f=Array.apply(null,Array(256)).map((k,C)=>C),h=(k,C)=>f.slice(k,C),g=h(32,127),S=h(0,24);S.push(25),S.push.apply(S,h(28,32));const b=h(0,14);let w;for(w in p.setDefault(1,0),p.addMany(g,0,2,0),b)p.addMany([24,26,153,154],w,3,0),p.addMany(h(128,144),w,3,0),p.addMany(h(144,152),w,3,0),p.add(156,w,0,0),p.add(27,w,11,1),p.add(157,w,4,8),p.addMany([152,158,159],w,0,7),p.add(155,w,11,3),p.add(144,w,11,9);return p.addMany(S,0,3,0),p.addMany(S,1,3,1),p.add(127,1,0,1),p.addMany(S,8,0,8),p.addMany(S,3,3,3),p.add(127,3,0,3),p.addMany(S,4,3,4),p.add(127,4,0,4),p.addMany(S,6,3,6),p.addMany(S,5,3,5),p.add(127,5,0,5),p.addMany(S,2,3,2),p.add(127,2,0,2),p.add(93,1,4,8),p.addMany(g,8,5,8),p.add(127,8,5,8),p.addMany([156,27,24,26,7],8,6,0),p.addMany(h(28,32),8,0,8),p.addMany([88,94,95],1,0,7),p.addMany(g,7,0,7),p.addMany(S,7,0,7),p.add(156,7,0,0),p.add(127,7,0,7),p.add(91,1,11,3),p.addMany(h(64,127),3,7,0),p.addMany(h(48,60),3,8,4),p.addMany([60,61,62,63],3,9,4),p.addMany(h(48,60),4,8,4),p.addMany(h(64,127),4,7,0),p.addMany([60,61,62,63],4,0,6),p.addMany(h(32,64),6,0,6),p.add(127,6,0,6),p.addMany(h(64,127),6,0,0),p.addMany(h(32,48),3,9,5),p.addMany(h(32,48),5,9,5),p.addMany(h(48,64),5,0,6),p.addMany(h(64,127),5,7,0),p.addMany(h(32,48),4,9,5),p.addMany(h(32,48),1,9,2),p.addMany(h(32,48),2,9,2),p.addMany(h(48,127),2,10,0),p.addMany(h(48,80),1,10,0),p.addMany(h(81,88),1,10,0),p.addMany([89,90,92],1,10,0),p.addMany(h(96,127),1,10,0),p.add(80,1,11,9),p.addMany(S,9,0,9),p.add(127,9,0,9),p.addMany(h(28,32),9,0,9),p.addMany(h(32,48),9,9,12),p.addMany(h(48,60),9,8,10),p.addMany([60,61,62,63],9,9,10),p.addMany(S,11,0,11),p.addMany(h(32,128),11,0,11),p.addMany(h(28,32),11,0,11),p.addMany(S,10,0,10),p.add(127,10,0,10),p.addMany(h(28,32),10,0,10),p.addMany(h(48,60),10,8,10),p.addMany([60,61,62,63],10,0,11),p.addMany(h(32,48),10,9,12),p.addMany(S,12,0,12),p.add(127,12,0,12),p.addMany(h(28,32),12,0,12),p.addMany(h(32,48),12,9,12),p.addMany(h(48,64),12,0,11),p.addMany(h(64,127),12,12,13),p.addMany(h(64,127),10,12,13),p.addMany(h(64,127),9,12,13),p.addMany(S,13,13,13),p.addMany(g,13,13,13),p.add(127,13,0,13),p.addMany([27,156,24,26],13,14,0),p.add(y,0,2,0),p.add(y,8,5,8),p.add(y,6,0,6),p.add(y,11,0,11),p.add(y,13,13,13),p}();class _ extends c.Disposable{constructor(f=o.VT500_TRANSITION_TABLE){super(),this._transitions=f,this._parseStack={state:0,handlers:[],handlerPos:0,transition:0,chunkPos:0},this.initialState=0,this.currentState=this.initialState,this._params=new d.Params,this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._printHandlerFb=(h,g,S)=>{},this._executeHandlerFb=h=>{},this._csiHandlerFb=(h,g)=>{},this._escHandlerFb=h=>{},this._errorHandlerFb=h=>h,this._printHandler=this._printHandlerFb,this._executeHandlers=Object.create(null),this._csiHandlers=Object.create(null),this._escHandlers=Object.create(null),this.register((0,c.toDisposable)(()=>{this._csiHandlers=Object.create(null),this._executeHandlers=Object.create(null),this._escHandlers=Object.create(null)})),this._oscParser=this.register(new u.OscParser),this._dcsParser=this.register(new m.DcsParser),this._errorHandler=this._errorHandlerFb,this.registerEscHandler({final:"\\"},()=>!0)}_identifier(f,h=[64,126]){let g=0;if(f.prefix){if(f.prefix.length>1)throw new Error("only one byte as prefix supported");if(g=f.prefix.charCodeAt(0),g&&60>g||g>63)throw new Error("prefix must be in range 0x3c .. 0x3f")}if(f.intermediates){if(f.intermediates.length>2)throw new Error("only two bytes as intermediates are supported");for(let b=0;b<f.intermediates.length;++b){const w=f.intermediates.charCodeAt(b);if(32>w||w>47)throw new Error("intermediate must be in range 0x20 .. 0x2f");g<<=8,g|=w}}if(f.final.length!==1)throw new Error("final must be a single byte");const S=f.final.charCodeAt(0);if(h[0]>S||S>h[1])throw new Error(`final must be in range ${h[0]} .. ${h[1]}`);return g<<=8,g|=S,g}identToString(f){const h=[];for(;f;)h.push(String.fromCharCode(255&f)),f>>=8;return h.reverse().join("")}setPrintHandler(f){this._printHandler=f}clearPrintHandler(){this._printHandler=this._printHandlerFb}registerEscHandler(f,h){const g=this._identifier(f,[48,126]);this._escHandlers[g]===void 0&&(this._escHandlers[g]=[]);const S=this._escHandlers[g];return S.push(h),{dispose:()=>{const b=S.indexOf(h);b!==-1&&S.splice(b,1)}}}clearEscHandler(f){this._escHandlers[this._identifier(f,[48,126])]&&delete this._escHandlers[this._identifier(f,[48,126])]}setEscHandlerFallback(f){this._escHandlerFb=f}setExecuteHandler(f,h){this._executeHandlers[f.charCodeAt(0)]=h}clearExecuteHandler(f){this._executeHandlers[f.charCodeAt(0)]&&delete this._executeHandlers[f.charCodeAt(0)]}setExecuteHandlerFallback(f){this._executeHandlerFb=f}registerCsiHandler(f,h){const g=this._identifier(f);this._csiHandlers[g]===void 0&&(this._csiHandlers[g]=[]);const S=this._csiHandlers[g];return S.push(h),{dispose:()=>{const b=S.indexOf(h);b!==-1&&S.splice(b,1)}}}clearCsiHandler(f){this._csiHandlers[this._identifier(f)]&&delete this._csiHandlers[this._identifier(f)]}setCsiHandlerFallback(f){this._csiHandlerFb=f}registerDcsHandler(f,h){return this._dcsParser.registerHandler(this._identifier(f),h)}clearDcsHandler(f){this._dcsParser.clearHandler(this._identifier(f))}setDcsHandlerFallback(f){this._dcsParser.setHandlerFallback(f)}registerOscHandler(f,h){return this._oscParser.registerHandler(f,h)}clearOscHandler(f){this._oscParser.clearHandler(f)}setOscHandlerFallback(f){this._oscParser.setHandlerFallback(f)}setErrorHandler(f){this._errorHandler=f}clearErrorHandler(){this._errorHandler=this._errorHandlerFb}reset(){this.currentState=this.initialState,this._oscParser.reset(),this._dcsParser.reset(),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0,this._parseStack.state!==0&&(this._parseStack.state=2,this._parseStack.handlers=[])}_preserveStack(f,h,g,S,b){this._parseStack.state=f,this._parseStack.handlers=h,this._parseStack.handlerPos=g,this._parseStack.transition=S,this._parseStack.chunkPos=b}parse(f,h,g){let S,b=0,w=0,k=0;if(this._parseStack.state)if(this._parseStack.state===2)this._parseStack.state=0,k=this._parseStack.chunkPos+1;else{if(g===void 0||this._parseStack.state===1)throw this._parseStack.state=1,new Error("improper continuation due to previous async handler, giving up parsing");const C=this._parseStack.handlers;let E=this._parseStack.handlerPos-1;switch(this._parseStack.state){case 3:if(g===!1&&E>-1){for(;E>=0&&(S=C[E](this._params),S!==!0);E--)if(S instanceof Promise)return this._parseStack.handlerPos=E,S}this._parseStack.handlers=[];break;case 4:if(g===!1&&E>-1){for(;E>=0&&(S=C[E](),S!==!0);E--)if(S instanceof Promise)return this._parseStack.handlerPos=E,S}this._parseStack.handlers=[];break;case 6:if(b=f[this._parseStack.chunkPos],S=this._dcsParser.unhook(b!==24&&b!==26,g),S)return S;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0;break;case 5:if(b=f[this._parseStack.chunkPos],S=this._oscParser.end(b!==24&&b!==26,g),S)return S;b===27&&(this._parseStack.transition|=1),this._params.reset(),this._params.addParam(0),this._collect=0}this._parseStack.state=0,k=this._parseStack.chunkPos+1,this.precedingJoinState=0,this.currentState=15&this._parseStack.transition}for(let C=k;C<h;++C){switch(b=f[C],w=this._transitions.table[this.currentState<<8|(b<160?b:y)],w>>4){case 2:for(let P=C+1;;++P){if(P>=h||(b=f[P])<32||b>126&&b<y){this._printHandler(f,C,P),C=P-1;break}if(++P>=h||(b=f[P])<32||b>126&&b<y){this._printHandler(f,C,P),C=P-1;break}if(++P>=h||(b=f[P])<32||b>126&&b<y){this._printHandler(f,C,P),C=P-1;break}if(++P>=h||(b=f[P])<32||b>126&&b<y){this._printHandler(f,C,P),C=P-1;break}}break;case 3:this._executeHandlers[b]?this._executeHandlers[b]():this._executeHandlerFb(b),this.precedingJoinState=0;break;case 0:break;case 1:if(this._errorHandler({position:C,code:b,currentState:this.currentState,collect:this._collect,params:this._params,abort:!1}).abort)return;break;case 7:const E=this._csiHandlers[this._collect<<8|b];let x=E?E.length-1:-1;for(;x>=0&&(S=E[x](this._params),S!==!0);x--)if(S instanceof Promise)return this._preserveStack(3,E,x,w,C),S;x<0&&this._csiHandlerFb(this._collect<<8|b,this._params),this.precedingJoinState=0;break;case 8:do switch(b){case 59:this._params.addParam(0);break;case 58:this._params.addSubParam(-1);break;default:this._params.addDigit(b-48)}while(++C<h&&(b=f[C])>47&&b<60);C--;break;case 9:this._collect<<=8,this._collect|=b;break;case 10:const I=this._escHandlers[this._collect<<8|b];let A=I?I.length-1:-1;for(;A>=0&&(S=I[A](),S!==!0);A--)if(S instanceof Promise)return this._preserveStack(4,I,A,w,C),S;A<0&&this._escHandlerFb(this._collect<<8|b),this.precedingJoinState=0;break;case 11:this._params.reset(),this._params.addParam(0),this._collect=0;break;case 12:this._dcsParser.hook(this._collect<<8|b,this._params);break;case 13:for(let P=C+1;;++P)if(P>=h||(b=f[P])===24||b===26||b===27||b>127&&b<y){this._dcsParser.put(f,C,P),C=P-1;break}break;case 14:if(S=this._dcsParser.unhook(b!==24&&b!==26),S)return this._preserveStack(6,[],0,w,C),S;b===27&&(w|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0;break;case 4:this._oscParser.start();break;case 5:for(let P=C+1;;P++)if(P>=h||(b=f[P])<32||b>127&&b<y){this._oscParser.put(f,C,P),C=P-1;break}break;case 6:if(S=this._oscParser.end(b!==24&&b!==26),S)return this._preserveStack(5,[],0,w,C),S;b===27&&(w|=1),this._params.reset(),this._params.addParam(0),this._collect=0,this.precedingJoinState=0}this.currentState=15&w}}}o.EscapeSequenceParser=_},6242:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OscHandler=o.OscParser=void 0;const c=l(5770),d=l(482),u=[];o.OscParser=class{constructor(){this._state=0,this._active=u,this._id=-1,this._handlers=Object.create(null),this._handlerFb=()=>{},this._stack={paused:!1,loopPosition:0,fallThrough:!1}}registerHandler(m,v){this._handlers[m]===void 0&&(this._handlers[m]=[]);const y=this._handlers[m];return y.push(v),{dispose:()=>{const _=y.indexOf(v);_!==-1&&y.splice(_,1)}}}clearHandler(m){this._handlers[m]&&delete this._handlers[m]}setHandlerFallback(m){this._handlerFb=m}dispose(){this._handlers=Object.create(null),this._handlerFb=()=>{},this._active=u}reset(){if(this._state===2)for(let m=this._stack.paused?this._stack.loopPosition-1:this._active.length-1;m>=0;--m)this._active[m].end(!1);this._stack.paused=!1,this._active=u,this._id=-1,this._state=0}_start(){if(this._active=this._handlers[this._id]||u,this._active.length)for(let m=this._active.length-1;m>=0;m--)this._active[m].start();else this._handlerFb(this._id,"START")}_put(m,v,y){if(this._active.length)for(let _=this._active.length-1;_>=0;_--)this._active[_].put(m,v,y);else this._handlerFb(this._id,"PUT",(0,d.utf32ToString)(m,v,y))}start(){this.reset(),this._state=1}put(m,v,y){if(this._state!==3){if(this._state===1)for(;v<y;){const _=m[v++];if(_===59){this._state=2,this._start();break}if(_<48||57<_)return void(this._state=3);this._id===-1&&(this._id=0),this._id=10*this._id+_-48}this._state===2&&y-v>0&&this._put(m,v,y)}}end(m,v=!0){if(this._state!==0){if(this._state!==3)if(this._state===1&&this._start(),this._active.length){let y=!1,_=this._active.length-1,p=!1;if(this._stack.paused&&(_=this._stack.loopPosition-1,y=v,p=this._stack.fallThrough,this._stack.paused=!1),!p&&y===!1){for(;_>=0&&(y=this._active[_].end(m),y!==!0);_--)if(y instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!1,y;_--}for(;_>=0;_--)if(y=this._active[_].end(!1),y instanceof Promise)return this._stack.paused=!0,this._stack.loopPosition=_,this._stack.fallThrough=!0,y}else this._handlerFb(this._id,"END",m);this._active=u,this._id=-1,this._state=0}}},o.OscHandler=class{constructor(m){this._handler=m,this._data="",this._hitLimit=!1}start(){this._data="",this._hitLimit=!1}put(m,v,y){this._hitLimit||(this._data+=(0,d.utf32ToString)(m,v,y),this._data.length>c.PAYLOAD_LIMIT&&(this._data="",this._hitLimit=!0))}end(m){let v=!1;if(this._hitLimit)v=!1;else if(m&&(v=this._handler(this._data),v instanceof Promise))return v.then(y=>(this._data="",this._hitLimit=!1,y));return this._data="",this._hitLimit=!1,v}}},8742:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.Params=void 0;const l=2147483647;class c{static fromArray(u){const m=new c;if(!u.length)return m;for(let v=Array.isArray(u[0])?1:0;v<u.length;++v){const y=u[v];if(Array.isArray(y))for(let _=0;_<y.length;++_)m.addSubParam(y[_]);else m.addParam(y)}return m}constructor(u=32,m=32){if(this.maxLength=u,this.maxSubParamsLength=m,m>256)throw new Error("maxSubParamsLength must not be greater than 256");this.params=new Int32Array(u),this.length=0,this._subParams=new Int32Array(m),this._subParamsLength=0,this._subParamsIdx=new Uint16Array(u),this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}clone(){const u=new c(this.maxLength,this.maxSubParamsLength);return u.params.set(this.params),u.length=this.length,u._subParams.set(this._subParams),u._subParamsLength=this._subParamsLength,u._subParamsIdx.set(this._subParamsIdx),u._rejectDigits=this._rejectDigits,u._rejectSubDigits=this._rejectSubDigits,u._digitIsSub=this._digitIsSub,u}toArray(){const u=[];for(let m=0;m<this.length;++m){u.push(this.params[m]);const v=this._subParamsIdx[m]>>8,y=255&this._subParamsIdx[m];y-v>0&&u.push(Array.prototype.slice.call(this._subParams,v,y))}return u}reset(){this.length=0,this._subParamsLength=0,this._rejectDigits=!1,this._rejectSubDigits=!1,this._digitIsSub=!1}addParam(u){if(this._digitIsSub=!1,this.length>=this.maxLength)this._rejectDigits=!0;else{if(u<-1)throw new Error("values lesser than -1 are not allowed");this._subParamsIdx[this.length]=this._subParamsLength<<8|this._subParamsLength,this.params[this.length++]=u>l?l:u}}addSubParam(u){if(this._digitIsSub=!0,this.length)if(this._rejectDigits||this._subParamsLength>=this.maxSubParamsLength)this._rejectSubDigits=!0;else{if(u<-1)throw new Error("values lesser than -1 are not allowed");this._subParams[this._subParamsLength++]=u>l?l:u,this._subParamsIdx[this.length-1]++}}hasSubParams(u){return(255&this._subParamsIdx[u])-(this._subParamsIdx[u]>>8)>0}getSubParams(u){const m=this._subParamsIdx[u]>>8,v=255&this._subParamsIdx[u];return v-m>0?this._subParams.subarray(m,v):null}getSubParamsAll(){const u={};for(let m=0;m<this.length;++m){const v=this._subParamsIdx[m]>>8,y=255&this._subParamsIdx[m];y-v>0&&(u[m]=this._subParams.slice(v,y))}return u}addDigit(u){let m;if(this._rejectDigits||!(m=this._digitIsSub?this._subParamsLength:this.length)||this._digitIsSub&&this._rejectSubDigits)return;const v=this._digitIsSub?this._subParams:this.params,y=v[m-1];v[m-1]=~y?Math.min(10*y+u,l):u}}o.Params=c},5741:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.AddonManager=void 0,o.AddonManager=class{constructor(){this._addons=[]}dispose(){for(let l=this._addons.length-1;l>=0;l--)this._addons[l].instance.dispose()}loadAddon(l,c){const d={instance:c,dispose:c.dispose,isDisposed:!1};this._addons.push(d),c.dispose=()=>this._wrappedAddonDispose(d),c.activate(l)}_wrappedAddonDispose(l){if(l.isDisposed)return;let c=-1;for(let d=0;d<this._addons.length;d++)if(this._addons[d]===l){c=d;break}if(c===-1)throw new Error("Could not dispose an addon that has not been loaded");l.isDisposed=!0,l.dispose.apply(l.instance),this._addons.splice(c,1)}}},8771:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferApiView=void 0;const c=l(3785),d=l(511);o.BufferApiView=class{constructor(u,m){this._buffer=u,this.type=m}init(u){return this._buffer=u,this}get cursorY(){return this._buffer.y}get cursorX(){return this._buffer.x}get viewportY(){return this._buffer.ydisp}get baseY(){return this._buffer.ybase}get length(){return this._buffer.lines.length}getLine(u){const m=this._buffer.lines.get(u);if(m)return new c.BufferLineApiView(m)}getNullCell(){return new d.CellData}}},3785:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferLineApiView=void 0;const c=l(511);o.BufferLineApiView=class{constructor(d){this._line=d}get isWrapped(){return this._line.isWrapped}get length(){return this._line.length}getCell(d,u){if(!(d<0||d>=this._line.length))return u?(this._line.loadCell(d,u),u):this._line.loadCell(d,new c.CellData)}translateToString(d,u,m){return this._line.translateToString(d,u,m)}}},8285:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.BufferNamespaceApi=void 0;const c=l(8771),d=l(8460),u=l(844);class m extends u.Disposable{constructor(y){super(),this._core=y,this._onBufferChange=this.register(new d.EventEmitter),this.onBufferChange=this._onBufferChange.event,this._normal=new c.BufferApiView(this._core.buffers.normal,"normal"),this._alternate=new c.BufferApiView(this._core.buffers.alt,"alternate"),this._core.buffers.onBufferActivate(()=>this._onBufferChange.fire(this.active))}get active(){if(this._core.buffers.active===this._core.buffers.normal)return this.normal;if(this._core.buffers.active===this._core.buffers.alt)return this.alternate;throw new Error("Active buffer is neither normal nor alternate")}get normal(){return this._normal.init(this._core.buffers.normal)}get alternate(){return this._alternate.init(this._core.buffers.alt)}}o.BufferNamespaceApi=m},7975:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.ParserApi=void 0,o.ParserApi=class{constructor(l){this._core=l}registerCsiHandler(l,c){return this._core.registerCsiHandler(l,d=>c(d.toArray()))}addCsiHandler(l,c){return this.registerCsiHandler(l,c)}registerDcsHandler(l,c){return this._core.registerDcsHandler(l,(d,u)=>c(d,u.toArray()))}addDcsHandler(l,c){return this.registerDcsHandler(l,c)}registerEscHandler(l,c){return this._core.registerEscHandler(l,c)}addEscHandler(l,c){return this.registerEscHandler(l,c)}registerOscHandler(l,c){return this._core.registerOscHandler(l,c)}addOscHandler(l,c){return this.registerOscHandler(l,c)}}},7090:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeApi=void 0,o.UnicodeApi=class{constructor(l){this._core=l}register(l){this._core.unicodeService.register(l)}get versions(){return this._core.unicodeService.versions}get activeVersion(){return this._core.unicodeService.activeVersion}set activeVersion(l){this._core.unicodeService.activeVersion=l}}},744:function(a,o,l){var c=this&&this.__decorate||function(p,f,h,g){var S,b=arguments.length,w=b<3?f:g===null?g=Object.getOwnPropertyDescriptor(f,h):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(p,f,h,g);else for(var k=p.length-1;k>=0;k--)(S=p[k])&&(w=(b<3?S(w):b>3?S(f,h,w):S(f,h))||w);return b>3&&w&&Object.defineProperty(f,h,w),w},d=this&&this.__param||function(p,f){return function(h,g){f(h,g,p)}};Object.defineProperty(o,"__esModule",{value:!0}),o.BufferService=o.MINIMUM_ROWS=o.MINIMUM_COLS=void 0;const u=l(8460),m=l(844),v=l(5295),y=l(2585);o.MINIMUM_COLS=2,o.MINIMUM_ROWS=1;let _=o.BufferService=class extends m.Disposable{get buffer(){return this.buffers.active}constructor(p){super(),this.isUserScrolling=!1,this._onResize=this.register(new u.EventEmitter),this.onResize=this._onResize.event,this._onScroll=this.register(new u.EventEmitter),this.onScroll=this._onScroll.event,this.cols=Math.max(p.rawOptions.cols||0,o.MINIMUM_COLS),this.rows=Math.max(p.rawOptions.rows||0,o.MINIMUM_ROWS),this.buffers=this.register(new v.BufferSet(p,this))}resize(p,f){this.cols=p,this.rows=f,this.buffers.resize(p,f),this._onResize.fire({cols:p,rows:f})}reset(){this.buffers.reset(),this.isUserScrolling=!1}scroll(p,f=!1){const h=this.buffer;let g;g=this._cachedBlankLine,g&&g.length===this.cols&&g.getFg(0)===p.fg&&g.getBg(0)===p.bg||(g=h.getBlankLine(p,f),this._cachedBlankLine=g),g.isWrapped=f;const S=h.ybase+h.scrollTop,b=h.ybase+h.scrollBottom;if(h.scrollTop===0){const w=h.lines.isFull;b===h.lines.length-1?w?h.lines.recycle().copyFrom(g):h.lines.push(g.clone()):h.lines.splice(b+1,0,g.clone()),w?this.isUserScrolling&&(h.ydisp=Math.max(h.ydisp-1,0)):(h.ybase++,this.isUserScrolling||h.ydisp++)}else{const w=b-S+1;h.lines.shiftElements(S+1,w-1,-1),h.lines.set(b,g.clone())}this.isUserScrolling||(h.ydisp=h.ybase),this._onScroll.fire(h.ydisp)}scrollLines(p,f,h){const g=this.buffer;if(p<0){if(g.ydisp===0)return;this.isUserScrolling=!0}else p+g.ydisp>=g.ybase&&(this.isUserScrolling=!1);const S=g.ydisp;g.ydisp=Math.max(Math.min(g.ydisp+p,g.ybase),0),S!==g.ydisp&&(f||this._onScroll.fire(g.ydisp))}};o.BufferService=_=c([d(0,y.IOptionsService)],_)},7994:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.CharsetService=void 0,o.CharsetService=class{constructor(){this.glevel=0,this._charsets=[]}reset(){this.charset=void 0,this._charsets=[],this.glevel=0}setgLevel(l){this.glevel=l,this.charset=this._charsets[l]}setgCharset(l,c){this._charsets[l]=c,this.glevel===l&&(this.charset=c)}}},1753:function(a,o,l){var c=this&&this.__decorate||function(g,S,b,w){var k,C=arguments.length,E=C<3?S:w===null?w=Object.getOwnPropertyDescriptor(S,b):w;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")E=Reflect.decorate(g,S,b,w);else for(var x=g.length-1;x>=0;x--)(k=g[x])&&(E=(C<3?k(E):C>3?k(S,b,E):k(S,b))||E);return C>3&&E&&Object.defineProperty(S,b,E),E},d=this&&this.__param||function(g,S){return function(b,w){S(b,w,g)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CoreMouseService=void 0;const u=l(2585),m=l(8460),v=l(844),y={NONE:{events:0,restrict:()=>!1},X10:{events:1,restrict:g=>g.button!==4&&g.action===1&&(g.ctrl=!1,g.alt=!1,g.shift=!1,!0)},VT200:{events:19,restrict:g=>g.action!==32},DRAG:{events:23,restrict:g=>g.action!==32||g.button!==3},ANY:{events:31,restrict:g=>!0}};function _(g,S){let b=(g.ctrl?16:0)|(g.shift?4:0)|(g.alt?8:0);return g.button===4?(b|=64,b|=g.action):(b|=3&g.button,4&g.button&&(b|=64),8&g.button&&(b|=128),g.action===32?b|=32:g.action!==0||S||(b|=3)),b}const p=String.fromCharCode,f={DEFAULT:g=>{const S=[_(g,!1)+32,g.col+32,g.row+32];return S[0]>255||S[1]>255||S[2]>255?"":`\x1B[M${p(S[0])}${p(S[1])}${p(S[2])}`},SGR:g=>{const S=g.action===0&&g.button!==4?"m":"M";return`\x1B[<${_(g,!0)};${g.col};${g.row}${S}`},SGR_PIXELS:g=>{const S=g.action===0&&g.button!==4?"m":"M";return`\x1B[<${_(g,!0)};${g.x};${g.y}${S}`}};let h=o.CoreMouseService=class extends v.Disposable{constructor(g,S){super(),this._bufferService=g,this._coreService=S,this._protocols={},this._encodings={},this._activeProtocol="",this._activeEncoding="",this._lastEvent=null,this._onProtocolChange=this.register(new m.EventEmitter),this.onProtocolChange=this._onProtocolChange.event;for(const b of Object.keys(y))this.addProtocol(b,y[b]);for(const b of Object.keys(f))this.addEncoding(b,f[b]);this.reset()}addProtocol(g,S){this._protocols[g]=S}addEncoding(g,S){this._encodings[g]=S}get activeProtocol(){return this._activeProtocol}get areMouseEventsActive(){return this._protocols[this._activeProtocol].events!==0}set activeProtocol(g){if(!this._protocols[g])throw new Error(`unknown protocol "${g}"`);this._activeProtocol=g,this._onProtocolChange.fire(this._protocols[g].events)}get activeEncoding(){return this._activeEncoding}set activeEncoding(g){if(!this._encodings[g])throw new Error(`unknown encoding "${g}"`);this._activeEncoding=g}reset(){this.activeProtocol="NONE",this.activeEncoding="DEFAULT",this._lastEvent=null}triggerMouseEvent(g){if(g.col<0||g.col>=this._bufferService.cols||g.row<0||g.row>=this._bufferService.rows||g.button===4&&g.action===32||g.button===3&&g.action!==32||g.button!==4&&(g.action===2||g.action===3)||(g.col++,g.row++,g.action===32&&this._lastEvent&&this._equalEvents(this._lastEvent,g,this._activeEncoding==="SGR_PIXELS"))||!this._protocols[this._activeProtocol].restrict(g))return!1;const S=this._encodings[this._activeEncoding](g);return S&&(this._activeEncoding==="DEFAULT"?this._coreService.triggerBinaryEvent(S):this._coreService.triggerDataEvent(S,!0)),this._lastEvent=g,!0}explainEvents(g){return{down:!!(1&g),up:!!(2&g),drag:!!(4&g),move:!!(8&g),wheel:!!(16&g)}}_equalEvents(g,S,b){if(b){if(g.x!==S.x||g.y!==S.y)return!1}else if(g.col!==S.col||g.row!==S.row)return!1;return g.button===S.button&&g.action===S.action&&g.ctrl===S.ctrl&&g.alt===S.alt&&g.shift===S.shift}};o.CoreMouseService=h=c([d(0,u.IBufferService),d(1,u.ICoreService)],h)},6975:function(a,o,l){var c=this&&this.__decorate||function(h,g,S,b){var w,k=arguments.length,C=k<3?g:b===null?b=Object.getOwnPropertyDescriptor(g,S):b;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")C=Reflect.decorate(h,g,S,b);else for(var E=h.length-1;E>=0;E--)(w=h[E])&&(C=(k<3?w(C):k>3?w(g,S,C):w(g,S))||C);return k>3&&C&&Object.defineProperty(g,S,C),C},d=this&&this.__param||function(h,g){return function(S,b){g(S,b,h)}};Object.defineProperty(o,"__esModule",{value:!0}),o.CoreService=void 0;const u=l(1439),m=l(8460),v=l(844),y=l(2585),_=Object.freeze({insertMode:!1}),p=Object.freeze({applicationCursorKeys:!1,applicationKeypad:!1,bracketedPasteMode:!1,origin:!1,reverseWraparound:!1,sendFocus:!1,wraparound:!0});let f=o.CoreService=class extends v.Disposable{constructor(h,g,S){super(),this._bufferService=h,this._logService=g,this._optionsService=S,this.isCursorInitialized=!1,this.isCursorHidden=!1,this._onData=this.register(new m.EventEmitter),this.onData=this._onData.event,this._onUserInput=this.register(new m.EventEmitter),this.onUserInput=this._onUserInput.event,this._onBinary=this.register(new m.EventEmitter),this.onBinary=this._onBinary.event,this._onRequestScrollToBottom=this.register(new m.EventEmitter),this.onRequestScrollToBottom=this._onRequestScrollToBottom.event,this.modes=(0,u.clone)(_),this.decPrivateModes=(0,u.clone)(p)}reset(){this.modes=(0,u.clone)(_),this.decPrivateModes=(0,u.clone)(p)}triggerDataEvent(h,g=!1){if(this._optionsService.rawOptions.disableStdin)return;const S=this._bufferService.buffer;g&&this._optionsService.rawOptions.scrollOnUserInput&&S.ybase!==S.ydisp&&this._onRequestScrollToBottom.fire(),g&&this._onUserInput.fire(),this._logService.debug(`sending data "${h}"`,()=>h.split("").map(b=>b.charCodeAt(0))),this._onData.fire(h)}triggerBinaryEvent(h){this._optionsService.rawOptions.disableStdin||(this._logService.debug(`sending binary "${h}"`,()=>h.split("").map(g=>g.charCodeAt(0))),this._onBinary.fire(h))}};o.CoreService=f=c([d(0,y.IBufferService),d(1,y.ILogService),d(2,y.IOptionsService)],f)},9074:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.DecorationService=void 0;const c=l(8055),d=l(8460),u=l(844),m=l(6106);let v=0,y=0;class _ extends u.Disposable{get decorations(){return this._decorations.values()}constructor(){super(),this._decorations=new m.SortedList(h=>h==null?void 0:h.marker.line),this._onDecorationRegistered=this.register(new d.EventEmitter),this.onDecorationRegistered=this._onDecorationRegistered.event,this._onDecorationRemoved=this.register(new d.EventEmitter),this.onDecorationRemoved=this._onDecorationRemoved.event,this.register((0,u.toDisposable)(()=>this.reset()))}registerDecoration(h){if(h.marker.isDisposed)return;const g=new p(h);if(g){const S=g.marker.onDispose(()=>g.dispose());g.onDispose(()=>{g&&(this._decorations.delete(g)&&this._onDecorationRemoved.fire(g),S.dispose())}),this._decorations.insert(g),this._onDecorationRegistered.fire(g)}return g}reset(){for(const h of this._decorations.values())h.dispose();this._decorations.clear()}*getDecorationsAtCell(h,g,S){let b=0,w=0;for(const k of this._decorations.getKeyIterator(g))b=k.options.x??0,w=b+(k.options.width??1),h>=b&&h<w&&(!S||(k.options.layer??"bottom")===S)&&(yield k)}forEachDecorationAtCell(h,g,S,b){this._decorations.forEachByKey(g,w=>{v=w.options.x??0,y=v+(w.options.width??1),h>=v&&h<y&&(!S||(w.options.layer??"bottom")===S)&&b(w)})}}o.DecorationService=_;class p extends u.Disposable{get isDisposed(){return this._isDisposed}get backgroundColorRGB(){return this._cachedBg===null&&(this.options.backgroundColor?this._cachedBg=c.css.toColor(this.options.backgroundColor):this._cachedBg=void 0),this._cachedBg}get foregroundColorRGB(){return this._cachedFg===null&&(this.options.foregroundColor?this._cachedFg=c.css.toColor(this.options.foregroundColor):this._cachedFg=void 0),this._cachedFg}constructor(h){super(),this.options=h,this.onRenderEmitter=this.register(new d.EventEmitter),this.onRender=this.onRenderEmitter.event,this._onDispose=this.register(new d.EventEmitter),this.onDispose=this._onDispose.event,this._cachedBg=null,this._cachedFg=null,this.marker=h.marker,this.options.overviewRulerOptions&&!this.options.overviewRulerOptions.position&&(this.options.overviewRulerOptions.position="full")}dispose(){this._onDispose.fire(),super.dispose()}}},4348:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.InstantiationService=o.ServiceCollection=void 0;const c=l(2585),d=l(8343);class u{constructor(...v){this._entries=new Map;for(const[y,_]of v)this.set(y,_)}set(v,y){const _=this._entries.get(v);return this._entries.set(v,y),_}forEach(v){for(const[y,_]of this._entries.entries())v(y,_)}has(v){return this._entries.has(v)}get(v){return this._entries.get(v)}}o.ServiceCollection=u,o.InstantiationService=class{constructor(){this._services=new u,this._services.set(c.IInstantiationService,this)}setService(m,v){this._services.set(m,v)}getService(m){return this._services.get(m)}createInstance(m,...v){const y=(0,d.getServiceDependencies)(m).sort((f,h)=>f.index-h.index),_=[];for(const f of y){const h=this._services.get(f.id);if(!h)throw new Error(`[createInstance] ${m.name} depends on UNKNOWN service ${f.id}.`);_.push(h)}const p=y.length>0?y[0].index:v.length;if(v.length!==p)throw new Error(`[createInstance] First service dependency of ${m.name} at position ${p+1} conflicts with ${v.length} static arguments`);return new m(...v,..._)}}},7866:function(a,o,l){var c=this&&this.__decorate||function(p,f,h,g){var S,b=arguments.length,w=b<3?f:g===null?g=Object.getOwnPropertyDescriptor(f,h):g;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")w=Reflect.decorate(p,f,h,g);else for(var k=p.length-1;k>=0;k--)(S=p[k])&&(w=(b<3?S(w):b>3?S(f,h,w):S(f,h))||w);return b>3&&w&&Object.defineProperty(f,h,w),w},d=this&&this.__param||function(p,f){return function(h,g){f(h,g,p)}};Object.defineProperty(o,"__esModule",{value:!0}),o.traceCall=o.setTraceLogger=o.LogService=void 0;const u=l(844),m=l(2585),v={trace:m.LogLevelEnum.TRACE,debug:m.LogLevelEnum.DEBUG,info:m.LogLevelEnum.INFO,warn:m.LogLevelEnum.WARN,error:m.LogLevelEnum.ERROR,off:m.LogLevelEnum.OFF};let y,_=o.LogService=class extends u.Disposable{get logLevel(){return this._logLevel}constructor(p){super(),this._optionsService=p,this._logLevel=m.LogLevelEnum.OFF,this._updateLogLevel(),this.register(this._optionsService.onSpecificOptionChange("logLevel",()=>this._updateLogLevel())),y=this}_updateLogLevel(){this._logLevel=v[this._optionsService.rawOptions.logLevel]}_evalLazyOptionalParams(p){for(let f=0;f<p.length;f++)typeof p[f]=="function"&&(p[f]=p[f]())}_log(p,f,h){this._evalLazyOptionalParams(h),p.call(console,(this._optionsService.options.logger?"":"xterm.js: ")+f,...h)}trace(p,...f){var h;this._logLevel<=m.LogLevelEnum.TRACE&&this._log(((h=this._optionsService.options.logger)==null?void 0:h.trace.bind(this._optionsService.options.logger))??console.log,p,f)}debug(p,...f){var h;this._logLevel<=m.LogLevelEnum.DEBUG&&this._log(((h=this._optionsService.options.logger)==null?void 0:h.debug.bind(this._optionsService.options.logger))??console.log,p,f)}info(p,...f){var h;this._logLevel<=m.LogLevelEnum.INFO&&this._log(((h=this._optionsService.options.logger)==null?void 0:h.info.bind(this._optionsService.options.logger))??console.info,p,f)}warn(p,...f){var h;this._logLevel<=m.LogLevelEnum.WARN&&this._log(((h=this._optionsService.options.logger)==null?void 0:h.warn.bind(this._optionsService.options.logger))??console.warn,p,f)}error(p,...f){var h;this._logLevel<=m.LogLevelEnum.ERROR&&this._log(((h=this._optionsService.options.logger)==null?void 0:h.error.bind(this._optionsService.options.logger))??console.error,p,f)}};o.LogService=_=c([d(0,m.IOptionsService)],_),o.setTraceLogger=function(p){y=p},o.traceCall=function(p,f,h){if(typeof h.value!="function")throw new Error("not supported");const g=h.value;h.value=function(...S){if(y.logLevel!==m.LogLevelEnum.TRACE)return g.apply(this,S);y.trace(`GlyphRenderer#${g.name}(${S.map(w=>JSON.stringify(w)).join(", ")})`);const b=g.apply(this,S);return y.trace(`GlyphRenderer#${g.name} return`,b),b}}},7302:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.OptionsService=o.DEFAULT_OPTIONS=void 0;const c=l(8460),d=l(844),u=l(6114);o.DEFAULT_OPTIONS={cols:80,rows:24,cursorBlink:!1,cursorStyle:"block",cursorWidth:1,cursorInactiveStyle:"outline",customGlyphs:!0,drawBoldTextInBrightColors:!0,documentOverride:null,fastScrollModifier:"alt",fastScrollSensitivity:5,fontFamily:"courier-new, courier, monospace",fontSize:15,fontWeight:"normal",fontWeightBold:"bold",ignoreBracketedPasteMode:!1,lineHeight:1,letterSpacing:0,linkHandler:null,logLevel:"info",logger:null,scrollback:1e3,scrollOnUserInput:!0,scrollSensitivity:1,screenReaderMode:!1,smoothScrollDuration:0,macOptionIsMeta:!1,macOptionClickForcesSelection:!1,minimumContrastRatio:1,disableStdin:!1,allowProposedApi:!1,allowTransparency:!1,tabStopWidth:8,theme:{},rescaleOverlappingGlyphs:!1,rightClickSelectsWord:u.isMac,windowOptions:{},windowsMode:!1,windowsPty:{},wordSeparator:" ()[]{}',\"`",altClickMovesCursor:!0,convertEol:!1,termName:"xterm",cancelEvents:!1,overviewRulerWidth:0};const m=["normal","bold","100","200","300","400","500","600","700","800","900"];class v extends d.Disposable{constructor(_){super(),this._onOptionChange=this.register(new c.EventEmitter),this.onOptionChange=this._onOptionChange.event;const p={...o.DEFAULT_OPTIONS};for(const f in _)if(f in p)try{const h=_[f];p[f]=this._sanitizeAndValidateOption(f,h)}catch(h){console.error(h)}this.rawOptions=p,this.options={...p},this._setupOptions(),this.register((0,d.toDisposable)(()=>{this.rawOptions.linkHandler=null,this.rawOptions.documentOverride=null}))}onSpecificOptionChange(_,p){return this.onOptionChange(f=>{f===_&&p(this.rawOptions[_])})}onMultipleOptionChange(_,p){return this.onOptionChange(f=>{_.indexOf(f)!==-1&&p()})}_setupOptions(){const _=f=>{if(!(f in o.DEFAULT_OPTIONS))throw new Error(`No option with key "${f}"`);return this.rawOptions[f]},p=(f,h)=>{if(!(f in o.DEFAULT_OPTIONS))throw new Error(`No option with key "${f}"`);h=this._sanitizeAndValidateOption(f,h),this.rawOptions[f]!==h&&(this.rawOptions[f]=h,this._onOptionChange.fire(f))};for(const f in this.rawOptions){const h={get:_.bind(this,f),set:p.bind(this,f)};Object.defineProperty(this.options,f,h)}}_sanitizeAndValidateOption(_,p){switch(_){case"cursorStyle":if(p||(p=o.DEFAULT_OPTIONS[_]),!function(f){return f==="block"||f==="underline"||f==="bar"}(p))throw new Error(`"${p}" is not a valid value for ${_}`);break;case"wordSeparator":p||(p=o.DEFAULT_OPTIONS[_]);break;case"fontWeight":case"fontWeightBold":if(typeof p=="number"&&1<=p&&p<=1e3)break;p=m.includes(p)?p:o.DEFAULT_OPTIONS[_];break;case"cursorWidth":p=Math.floor(p);case"lineHeight":case"tabStopWidth":if(p<1)throw new Error(`${_} cannot be less than 1, value: ${p}`);break;case"minimumContrastRatio":p=Math.max(1,Math.min(21,Math.round(10*p)/10));break;case"scrollback":if((p=Math.min(p,4294967295))<0)throw new Error(`${_} cannot be less than 0, value: ${p}`);break;case"fastScrollSensitivity":case"scrollSensitivity":if(p<=0)throw new Error(`${_} cannot be less than or equal to 0, value: ${p}`);break;case"rows":case"cols":if(!p&&p!==0)throw new Error(`${_} must be numeric, value: ${p}`);break;case"windowsPty":p=p??{}}return p}}o.OptionsService=v},2660:function(a,o,l){var c=this&&this.__decorate||function(v,y,_,p){var f,h=arguments.length,g=h<3?y:p===null?p=Object.getOwnPropertyDescriptor(y,_):p;if(typeof Reflect=="object"&&typeof Reflect.decorate=="function")g=Reflect.decorate(v,y,_,p);else for(var S=v.length-1;S>=0;S--)(f=v[S])&&(g=(h<3?f(g):h>3?f(y,_,g):f(y,_))||g);return h>3&&g&&Object.defineProperty(y,_,g),g},d=this&&this.__param||function(v,y){return function(_,p){y(_,p,v)}};Object.defineProperty(o,"__esModule",{value:!0}),o.OscLinkService=void 0;const u=l(2585);let m=o.OscLinkService=class{constructor(v){this._bufferService=v,this._nextId=1,this._entriesWithId=new Map,this._dataByLinkId=new Map}registerLink(v){const y=this._bufferService.buffer;if(v.id===void 0){const S=y.addMarker(y.ybase+y.y),b={data:v,id:this._nextId++,lines:[S]};return S.onDispose(()=>this._removeMarkerFromLink(b,S)),this._dataByLinkId.set(b.id,b),b.id}const _=v,p=this._getEntryIdKey(_),f=this._entriesWithId.get(p);if(f)return this.addLineToLink(f.id,y.ybase+y.y),f.id;const h=y.addMarker(y.ybase+y.y),g={id:this._nextId++,key:this._getEntryIdKey(_),data:_,lines:[h]};return h.onDispose(()=>this._removeMarkerFromLink(g,h)),this._entriesWithId.set(g.key,g),this._dataByLinkId.set(g.id,g),g.id}addLineToLink(v,y){const _=this._dataByLinkId.get(v);if(_&&_.lines.every(p=>p.line!==y)){const p=this._bufferService.buffer.addMarker(y);_.lines.push(p),p.onDispose(()=>this._removeMarkerFromLink(_,p))}}getLinkData(v){var y;return(y=this._dataByLinkId.get(v))==null?void 0:y.data}_getEntryIdKey(v){return`${v.id};;${v.uri}`}_removeMarkerFromLink(v,y){const _=v.lines.indexOf(y);_!==-1&&(v.lines.splice(_,1),v.lines.length===0&&(v.data.id!==void 0&&this._entriesWithId.delete(v.key),this._dataByLinkId.delete(v.id)))}};o.OscLinkService=m=c([d(0,u.IBufferService)],m)},8343:(a,o)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.createDecorator=o.getServiceDependencies=o.serviceRegistry=void 0;const l="di$target",c="di$dependencies";o.serviceRegistry=new Map,o.getServiceDependencies=function(d){return d[c]||[]},o.createDecorator=function(d){if(o.serviceRegistry.has(d))return o.serviceRegistry.get(d);const u=function(m,v,y){if(arguments.length!==3)throw new Error("@IServiceName-decorator can only be used to decorate a parameter");(function(_,p,f){p[l]===p?p[c].push({id:_,index:f}):(p[c]=[{id:_,index:f}],p[l]=p)})(u,m,y)};return u.toString=()=>d,o.serviceRegistry.set(d,u),u}},2585:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.IDecorationService=o.IUnicodeService=o.IOscLinkService=o.IOptionsService=o.ILogService=o.LogLevelEnum=o.IInstantiationService=o.ICharsetService=o.ICoreService=o.ICoreMouseService=o.IBufferService=void 0;const c=l(8343);var d;o.IBufferService=(0,c.createDecorator)("BufferService"),o.ICoreMouseService=(0,c.createDecorator)("CoreMouseService"),o.ICoreService=(0,c.createDecorator)("CoreService"),o.ICharsetService=(0,c.createDecorator)("CharsetService"),o.IInstantiationService=(0,c.createDecorator)("InstantiationService"),function(u){u[u.TRACE=0]="TRACE",u[u.DEBUG=1]="DEBUG",u[u.INFO=2]="INFO",u[u.WARN=3]="WARN",u[u.ERROR=4]="ERROR",u[u.OFF=5]="OFF"}(d||(o.LogLevelEnum=d={})),o.ILogService=(0,c.createDecorator)("LogService"),o.IOptionsService=(0,c.createDecorator)("OptionsService"),o.IOscLinkService=(0,c.createDecorator)("OscLinkService"),o.IUnicodeService=(0,c.createDecorator)("UnicodeService"),o.IDecorationService=(0,c.createDecorator)("DecorationService")},1480:(a,o,l)=>{Object.defineProperty(o,"__esModule",{value:!0}),o.UnicodeService=void 0;const c=l(8460),d=l(225);class u{static extractShouldJoin(v){return(1&v)!=0}static extractWidth(v){return v>>1&3}static extractCharKind(v){return v>>3}static createPropertyValue(v,y,_=!1){return(16777215&v)<<3|(3&y)<<1|(_?1:0)}constructor(){this._providers=Object.create(null),this._active="",this._onChange=new c.EventEmitter,this.onChange=this._onChange.event;const v=new d.UnicodeV6;this.register(v),this._active=v.version,this._activeProvider=v}dispose(){this._onChange.dispose()}get versions(){return Object.keys(this._providers)}get activeVersion(){return this._active}set activeVersion(v){if(!this._providers[v])throw new Error(`unknown Unicode version "${v}"`);this._active=v,this._activeProvider=this._providers[v],this._onChange.fire(v)}register(v){this._providers[v.version]=v}wcwidth(v){return this._activeProvider.wcwidth(v)}getStringCellWidth(v){let y=0,_=0;const p=v.length;for(let f=0;f<p;++f){let h=v.charCodeAt(f);if(55296<=h&&h<=56319){if(++f>=p)return y+this.wcwidth(h);const b=v.charCodeAt(f);56320<=b&&b<=57343?h=1024*(h-55296)+b-56320+65536:y+=this.wcwidth(b)}const g=this.charProperties(h,_);let S=u.extractWidth(g);u.extractShouldJoin(g)&&(S-=u.extractWidth(_)),y+=S,_=g}return y}charProperties(v,y){return this._activeProvider.charProperties(v,y)}}o.UnicodeService=u}},i={};function r(a){var o=i[a];if(o!==void 0)return o.exports;var l=i[a]={exports:{}};return n[a].call(l.exports,l,l.exports,r),l.exports}var s={};return(()=>{var a=s;Object.defineProperty(a,"__esModule",{value:!0}),a.Terminal=void 0;const o=r(9042),l=r(3236),c=r(844),d=r(5741),u=r(8285),m=r(7975),v=r(7090),y=["cols","rows"];class _ extends c.Disposable{constructor(f){super(),this._core=this.register(new l.Terminal(f)),this._addonManager=this.register(new d.AddonManager),this._publicOptions={...this._core.options};const h=S=>this._core.options[S],g=(S,b)=>{this._checkReadonlyOptions(S),this._core.options[S]=b};for(const S in this._core.options){const b={get:h.bind(this,S),set:g.bind(this,S)};Object.defineProperty(this._publicOptions,S,b)}}_checkReadonlyOptions(f){if(y.includes(f))throw new Error(`Option "${f}" can only be set in the constructor`)}_checkProposedApi(){if(!this._core.optionsService.rawOptions.allowProposedApi)throw new Error("You must set the allowProposedApi option to true to use proposed API")}get onBell(){return this._core.onBell}get onBinary(){return this._core.onBinary}get onCursorMove(){return this._core.onCursorMove}get onData(){return this._core.onData}get onKey(){return this._core.onKey}get onLineFeed(){return this._core.onLineFeed}get onRender(){return this._core.onRender}get onResize(){return this._core.onResize}get onScroll(){return this._core.onScroll}get onSelectionChange(){return this._core.onSelectionChange}get onTitleChange(){return this._core.onTitleChange}get onWriteParsed(){return this._core.onWriteParsed}get element(){return this._core.element}get parser(){return this._parser||(this._parser=new m.ParserApi(this._core)),this._parser}get unicode(){return this._checkProposedApi(),new v.UnicodeApi(this._core)}get textarea(){return this._core.textarea}get rows(){return this._core.rows}get cols(){return this._core.cols}get buffer(){return this._buffer||(this._buffer=this.register(new u.BufferNamespaceApi(this._core))),this._buffer}get markers(){return this._checkProposedApi(),this._core.markers}get modes(){const f=this._core.coreService.decPrivateModes;let h="none";switch(this._core.coreMouseService.activeProtocol){case"X10":h="x10";break;case"VT200":h="vt200";break;case"DRAG":h="drag";break;case"ANY":h="any"}return{applicationCursorKeysMode:f.applicationCursorKeys,applicationKeypadMode:f.applicationKeypad,bracketedPasteMode:f.bracketedPasteMode,insertMode:this._core.coreService.modes.insertMode,mouseTrackingMode:h,originMode:f.origin,reverseWraparoundMode:f.reverseWraparound,sendFocusMode:f.sendFocus,wraparoundMode:f.wraparound}}get options(){return this._publicOptions}set options(f){for(const h in f)this._publicOptions[h]=f[h]}blur(){this._core.blur()}focus(){this._core.focus()}input(f,h=!0){this._core.input(f,h)}resize(f,h){this._verifyIntegers(f,h),this._core.resize(f,h)}open(f){this._core.open(f)}attachCustomKeyEventHandler(f){this._core.attachCustomKeyEventHandler(f)}attachCustomWheelEventHandler(f){this._core.attachCustomWheelEventHandler(f)}registerLinkProvider(f){return this._core.registerLinkProvider(f)}registerCharacterJoiner(f){return this._checkProposedApi(),this._core.registerCharacterJoiner(f)}deregisterCharacterJoiner(f){this._checkProposedApi(),this._core.deregisterCharacterJoiner(f)}registerMarker(f=0){return this._verifyIntegers(f),this._core.registerMarker(f)}registerDecoration(f){return this._checkProposedApi(),this._verifyPositiveIntegers(f.x??0,f.width??0,f.height??0),this._core.registerDecoration(f)}hasSelection(){return this._core.hasSelection()}select(f,h,g){this._verifyIntegers(f,h,g),this._core.select(f,h,g)}getSelection(){return this._core.getSelection()}getSelectionPosition(){return this._core.getSelectionPosition()}clearSelection(){this._core.clearSelection()}selectAll(){this._core.selectAll()}selectLines(f,h){this._verifyIntegers(f,h),this._core.selectLines(f,h)}dispose(){super.dispose()}scrollLines(f){this._verifyIntegers(f),this._core.scrollLines(f)}scrollPages(f){this._verifyIntegers(f),this._core.scrollPages(f)}scrollToTop(){this._core.scrollToTop()}scrollToBottom(){this._core.scrollToBottom()}scrollToLine(f){this._verifyIntegers(f),this._core.scrollToLine(f)}clear(){this._core.clear()}write(f,h){this._core.write(f,h)}writeln(f,h){this._core.write(f),this._core.write(`\r
`,h)}paste(f){this._core.paste(f)}refresh(f,h){this._verifyIntegers(f,h),this._core.refresh(f,h)}reset(){this._core.reset()}clearTextureAtlas(){this._core.clearTextureAtlas()}loadAddon(f){this._addonManager.loadAddon(this,f)}static get strings(){return o}_verifyIntegers(...f){for(const h of f)if(h===1/0||isNaN(h)||h%1!=0)throw new Error("This API only accepts integers")}_verifyPositiveIntegers(...f){for(const h of f)if(h&&(h===1/0||isNaN(h)||h%1!=0||h<0))throw new Error("This API only accepts positive integers")}}a.Terminal=_})(),s})())})(t1);var GA=t1.exports,i1={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(self,()=>(()=>{var n={};return(()=>{var i=n;Object.defineProperty(i,"__esModule",{value:!0}),i.FitAddon=void 0,i.FitAddon=class{activate(r){this._terminal=r}dispose(){}fit(){const r=this.proposeDimensions();if(!r||!this._terminal||isNaN(r.cols)||isNaN(r.rows))return;const s=this._terminal._core;this._terminal.rows===r.rows&&this._terminal.cols===r.cols||(s._renderService.clear(),this._terminal.resize(r.cols,r.rows))}proposeDimensions(){if(!this._terminal||!this._terminal.element||!this._terminal.element.parentElement)return;const r=this._terminal._core,s=r._renderService.dimensions;if(s.css.cell.width===0||s.css.cell.height===0)return;const a=this._terminal.options.scrollback===0?0:r.viewport.scrollBarWidth,o=window.getComputedStyle(this._terminal.element.parentElement),l=parseInt(o.getPropertyValue("height")),c=Math.max(0,parseInt(o.getPropertyValue("width"))),d=window.getComputedStyle(this._terminal.element),u=l-(parseInt(d.getPropertyValue("padding-top"))+parseInt(d.getPropertyValue("padding-bottom"))),m=c-(parseInt(d.getPropertyValue("padding-right"))+parseInt(d.getPropertyValue("padding-left")))-a;return{cols:Math.max(2,Math.floor(m/s.css.cell.width)),rows:Math.max(1,Math.floor(u/s.css.cell.height))}}}})(),n})())})(i1);var qA=i1.exports,r1={exports:{}};(function(t,e){(function(n,i){t.exports=i()})(self,()=>(()=>{var n={6:(a,o)=>{function l(d){try{const u=new URL(d),m=u.password&&u.username?`${u.protocol}//${u.username}:${u.password}@${u.host}`:u.username?`${u.protocol}//${u.username}@${u.host}`:`${u.protocol}//${u.host}`;return d.toLocaleLowerCase().startsWith(m.toLocaleLowerCase())}catch{return!1}}Object.defineProperty(o,"__esModule",{value:!0}),o.LinkComputer=o.WebLinkProvider=void 0,o.WebLinkProvider=class{constructor(d,u,m,v={}){this._terminal=d,this._regex=u,this._handler=m,this._options=v}provideLinks(d,u){const m=c.computeLink(d,this._regex,this._terminal,this._handler);u(this._addCallbacks(m))}_addCallbacks(d){return d.map(u=>(u.leave=this._options.leave,u.hover=(m,v)=>{if(this._options.hover){const{range:y}=u;this._options.hover(m,v,y)}},u))}};class c{static computeLink(u,m,v,y){const _=new RegExp(m.source,(m.flags||"")+"g"),[p,f]=c._getWindowedLineStrings(u-1,v),h=p.join("");let g;const S=[];for(;g=_.exec(h);){const b=g[0];if(!l(b))continue;const[w,k]=c._mapStrIdx(v,f,0,g.index),[C,E]=c._mapStrIdx(v,w,k,b.length);if(w===-1||k===-1||C===-1||E===-1)continue;const x={start:{x:k+1,y:w+1},end:{x:E,y:C+1}};S.push({range:x,text:b,activate:y})}return S}static _getWindowedLineStrings(u,m){let v,y=u,_=u,p=0,f="";const h=[];if(v=m.buffer.active.getLine(u)){const g=v.translateToString(!0);if(v.isWrapped&&g[0]!==" "){for(p=0;(v=m.buffer.active.getLine(--y))&&p<2048&&(f=v.translateToString(!0),p+=f.length,h.push(f),v.isWrapped&&f.indexOf(" ")===-1););h.reverse()}for(h.push(g),p=0;(v=m.buffer.active.getLine(++_))&&v.isWrapped&&p<2048&&(f=v.translateToString(!0),p+=f.length,h.push(f),f.indexOf(" ")===-1););}return[h,y]}static _mapStrIdx(u,m,v,y){const _=u.buffer.active,p=_.getNullCell();let f=v;for(;y;){const h=_.getLine(m);if(!h)return[-1,-1];for(let g=f;g<h.length;++g){h.getCell(g,p);const S=p.getChars();if(p.getWidth()&&(y-=S.length||1,g===h.length-1&&S==="")){const b=_.getLine(m+1);b&&b.isWrapped&&(b.getCell(0,p),p.getWidth()===2&&(y+=1))}if(y<0)return[m,g]}m++,f=0}return[m,f]}}o.LinkComputer=c}},i={};function r(a){var o=i[a];if(o!==void 0)return o.exports;var l=i[a]={exports:{}};return n[a](l,l.exports,r),l.exports}var s={};return(()=>{var a=s;Object.defineProperty(a,"__esModule",{value:!0}),a.WebLinksAddon=void 0;const o=r(6),l=/(https?|HTTPS?):[/]{2}[^\s"'!*(){}|\\\^<>`]*[^\s"':,.!?{}|\\\^~\[\]`()<>]/;function c(d,u){const m=window.open();if(m){try{m.opener=null}catch{}m.location.href=u}else console.warn("Opening link blocked as opener could not be cleared")}a.WebLinksAddon=class{constructor(d=c,u={}){this._handler=d,this._options=u}activate(d){this._terminal=d;const u=this._options,m=u.urlRegex||l;this._linkProvider=this._terminal.registerLinkProvider(new o.WebLinkProvider(this._terminal,m,this._handler,u))}dispose(){var d;(d=this._linkProvider)==null||d.dispose()}}})(),s})())})(r1);var JA=r1.exports;const KA="/api/terminal",QA=async()=>{try{return(await _s.post(`${KA}/sessions`)).data}catch(t){throw console.error("Error creating terminal session:",t),new Error("Failed to create terminal session")}};const XA=({sessionId:t})=>{const e=T.useRef(null),n=T.useRef(null),i=T.useRef(null),r=T.useRef(""),s=T.useRef(null);T.useEffect(()=>{const l=new GA.Terminal({cursorBlink:!0,theme:{background:"#1e1e1e",foreground:"#f0f0f0",cursor:"#ffffff"},fontFamily:'Menlo, Monaco, "Courier New", monospace',fontSize:14,lineHeight:1.2,convertEol:!0});n.current=l;const c=new qA.FitAddon;i.current=c,l.loadAddon(c);const d=new JA.WebLinksAddon;l.loadAddon(d),l.open(e.current),c.fit(),a(),l.writeln("Welcome to PodPlai Studio Terminal"),l.writeln('Type "help" for available commands'),l.write(`\r
$ `),l.onData(m=>{if(m==="\r"){const v=r.current.trim();l.writeln(""),o(v),r.current="",l.write("$ ")}else m===""?r.current.length>0&&(r.current=r.current.substring(0,r.current.length-1),l.write("\b \b")):(r.current+=m,l.write(m))});const u=()=>{i.current&&i.current.fit()};return window.addEventListener("resize",u),()=>{window.removeEventListener("resize",u),l.dispose(),s.current&&s.current.close()}},[t]);const a=l=>{console.log("Simulating terminal WebSocket connection"),s.current={readyState:WebSocket.OPEN,send:c=>{const d=JSON.parse(c);d.type==="command"&&setTimeout(()=>{const u=`Simulated output for: ${d.content}
`;n.current&&n.current.write(u)},100)},close:()=>console.log("Terminal WebSocket disconnected")}},o=async l=>{if(l){if(l==="clear"){n.current.clear();return}if(l==="help"){n.current.writeln("Available commands:"),n.current.writeln("  help     - Show this help message"),n.current.writeln("  clear    - Clear the terminal"),n.current.writeln("  python   - Execute Python code (simulated)"),n.current.writeln("  node     - Execute JavaScript code with Node.js (simulated)"),n.current.writeln("  ls       - List files in current directory (simulated)");return}try{s.current&&s.current.readyState===WebSocket.OPEN?s.current.send(JSON.stringify({type:"command",content:l})):n.current.writeln(`Simulated output for: ${l}`)}catch(c){n.current.writeln(`Error: ${c.message||"Failed to execute command"}`)}}};return te.createElement("div",{className:"terminal-container",ref:e,style:{height:"100%",width:"100%"},"aria-label":"Terminal",role:"region"})};function Je(t,e){if(!(t instanceof e))throw new TypeError("Cannot call a class as a function")}function Js(t){"@babel/helpers - typeof";return Js=typeof Symbol=="function"&&typeof Symbol.iterator=="symbol"?function(e){return typeof e}:function(e){return e&&typeof Symbol=="function"&&e.constructor===Symbol&&e!==Symbol.prototype?"symbol":typeof e},Js(t)}function YA(t,e){if(Js(t)!="object"||!t)return t;var n=t[Symbol.toPrimitive];if(n!==void 0){var i=n.call(t,e||"default");if(Js(i)!="object")return i;throw new TypeError("@@toPrimitive must return a primitive value.")}return(e==="string"?String:Number)(t)}function s1(t){var e=YA(t,"string");return Js(e)=="symbol"?e:e+""}function q0(t,e){for(var n=0;n<e.length;n++){var i=e[n];i.enumerable=i.enumerable||!1,i.configurable=!0,"value"in i&&(i.writable=!0),Object.defineProperty(t,s1(i.key),i)}}function Ke(t,e,n){return e&&q0(t.prototype,e),n&&q0(t,n),Object.defineProperty(t,"prototype",{writable:!1}),t}function ZA(t){if(t===void 0)throw new ReferenceError("this hasn't been initialised - super() hasn't been called");return t}function Bt(t,e){if(e&&(Js(e)=="object"||typeof e=="function"))return e;if(e!==void 0)throw new TypeError("Derived constructors may only return object or undefined");return ZA(t)}function be(t){return be=Object.setPrototypeOf?Object.getPrototypeOf.bind():function(e){return e.__proto__||Object.getPrototypeOf(e)},be(t)}function _p(t,e){return _p=Object.setPrototypeOf?Object.setPrototypeOf.bind():function(n,i){return n.__proto__=i,n},_p(t,e)}function Ft(t,e){if(typeof e!="function"&&e!==null)throw new TypeError("Super expression must either be null or a function");t.prototype=Object.create(e&&e.prototype,{constructor:{value:t,writable:!0,configurable:!0}}),Object.defineProperty(t,"prototype",{writable:!1}),e&&_p(t,e)}function W(t,e,n){return(e=s1(e))in t?Object.defineProperty(t,e,{value:n,enumerable:!0,configurable:!0,writable:!0}):t[e]=n,t}function o1(){var t=this.constructor.getDerivedStateFromProps(this.props,this.state);t!=null&&this.setState(t)}function a1(t){function e(n){var i=this.constructor.getDerivedStateFromProps(t,n);return i??null}this.setState(e.bind(this))}function l1(t,e){try{var n=this.props,i=this.state;this.props=t,this.state=e,this.__reactInternalSnapshotFlag=!0,this.__reactInternalSnapshot=this.getSnapshotBeforeUpdate(n,i)}finally{this.props=n,this.state=i}}o1.__suppressDeprecationWarning=!0;a1.__suppressDeprecationWarning=!0;l1.__suppressDeprecationWarning=!0;function Jl(t){var e=t.prototype;if(!e||!e.isReactComponent)throw new Error("Can only polyfill class components");if(typeof t.getDerivedStateFromProps!="function"&&typeof e.getSnapshotBeforeUpdate!="function")return t;var n=null,i=null,r=null;if(typeof e.componentWillMount=="function"?n="componentWillMount":typeof e.UNSAFE_componentWillMount=="function"&&(n="UNSAFE_componentWillMount"),typeof e.componentWillReceiveProps=="function"?i="componentWillReceiveProps":typeof e.UNSAFE_componentWillReceiveProps=="function"&&(i="UNSAFE_componentWillReceiveProps"),typeof e.componentWillUpdate=="function"?r="componentWillUpdate":typeof e.UNSAFE_componentWillUpdate=="function"&&(r="UNSAFE_componentWillUpdate"),n!==null||i!==null||r!==null){var s=t.displayName||t.name,a=typeof t.getDerivedStateFromProps=="function"?"getDerivedStateFromProps()":"getSnapshotBeforeUpdate()";throw Error(`Unsafe legacy lifecycles will not be called for components using new component APIs.

`+s+" uses "+a+" but also contains the following legacy lifecycles:"+(n!==null?`
  `+n:"")+(i!==null?`
  `+i:"")+(r!==null?`
  `+r:"")+`

The above lifecycles should be removed. Learn more about this warning here:
https://fb.me/react-async-component-lifecycle-hooks`)}if(typeof t.getDerivedStateFromProps=="function"&&(e.componentWillMount=o1,e.componentWillReceiveProps=a1),typeof e.getSnapshotBeforeUpdate=="function"){if(typeof e.componentDidUpdate!="function")throw new Error("Cannot polyfill getSnapshotBeforeUpdate() for components that do not define componentDidUpdate() on the prototype");e.componentWillUpdate=l1;var o=e.componentDidUpdate;e.componentDidUpdate=function(c,d,u){var m=this.__reactInternalSnapshotFlag?this.__reactInternalSnapshot:u;o.call(this,c,d,m)}}return t}function J0(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function K0(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?J0(Object(n),!0).forEach(function(i){W(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):J0(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function e5(t,e,n){return e=be(e),Bt(t,c1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function c1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(c1=function(){return!!t})()}var u1=function(t){function e(){var n;Je(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=e5(this,e,[].concat(r)),W(n,"state",{scrollToColumn:0,scrollToRow:0,instanceProps:{prevScrollToColumn:0,prevScrollToRow:0}}),W(n,"_columnStartIndex",0),W(n,"_columnStopIndex",0),W(n,"_rowStartIndex",0),W(n,"_rowStopIndex",0),W(n,"_onKeyDown",function(a){var o=n.props,l=o.columnCount,c=o.disabled,d=o.mode,u=o.rowCount;if(!c){var m=n._getScrollState(),v=m.scrollToColumn,y=m.scrollToRow,_=n._getScrollState(),p=_.scrollToColumn,f=_.scrollToRow;switch(a.key){case"ArrowDown":f=Math.min(d==="cells"?f+1:n._rowStopIndex+1,u-1);break;case"ArrowLeft":p=Math.max(d==="cells"?p-1:n._columnStartIndex-1,0);break;case"ArrowRight":p=Math.min(d==="cells"?p+1:n._columnStopIndex+1,l-1);break;case"ArrowUp":f=Math.max(d==="cells"?f-1:n._rowStartIndex-1,0);break}(p!==v||f!==y)&&(a.preventDefault(),n._updateScrollState({scrollToColumn:p,scrollToRow:f}))}}),W(n,"_onSectionRendered",function(a){var o=a.columnStartIndex,l=a.columnStopIndex,c=a.rowStartIndex,d=a.rowStopIndex;n._columnStartIndex=o,n._columnStopIndex=l,n._rowStartIndex=c,n._rowStopIndex=d}),n}return Ft(e,t),Ke(e,[{key:"setScrollIndexes",value:function(i){var r=i.scrollToColumn,s=i.scrollToRow;this.setState({scrollToRow:s,scrollToColumn:r})}},{key:"render",value:function(){var i=this.props,r=i.className,s=i.children,a=this._getScrollState(),o=a.scrollToColumn,l=a.scrollToRow;return T.createElement("div",{className:r,onKeyDown:this._onKeyDown},s({onSectionRendered:this._onSectionRendered,scrollToColumn:o,scrollToRow:l}))}},{key:"_getScrollState",value:function(){return this.props.isControlled?this.props:this.state}},{key:"_updateScrollState",value:function(i){var r=i.scrollToColumn,s=i.scrollToRow,a=this.props,o=a.isControlled,l=a.onScrollToChange;typeof l=="function"&&l({scrollToColumn:r,scrollToRow:s}),o||this.setState({scrollToColumn:r,scrollToRow:s})}}],[{key:"getDerivedStateFromProps",value:function(i,r){return i.isControlled?{}:i.scrollToColumn!==r.instanceProps.prevScrollToColumn||i.scrollToRow!==r.instanceProps.prevScrollToRow?K0(K0({},r),{},{scrollToColumn:i.scrollToColumn,scrollToRow:i.scrollToRow,instanceProps:{prevScrollToColumn:i.scrollToColumn,prevScrollToRow:i.scrollToRow}}):{}}}])}(T.PureComponent);W(u1,"defaultProps",{disabled:!1,isControlled:!1,mode:"edges",scrollToColumn:0,scrollToRow:0});Jl(u1);function d1(t,e){var n;typeof e<"u"?n=e:typeof window<"u"?n=window:typeof self<"u"?n=self:n=global;var i=typeof n.document<"u"&&n.document.attachEvent;if(!i){var r=function(){var k=n.requestAnimationFrame||n.mozRequestAnimationFrame||n.webkitRequestAnimationFrame||function(C){return n.setTimeout(C,20)};return function(C){return k(C)}}(),s=function(){var k=n.cancelAnimationFrame||n.mozCancelAnimationFrame||n.webkitCancelAnimationFrame||n.clearTimeout;return function(C){return k(C)}}(),a=function(C){var E=C.__resizeTriggers__,x=E.firstElementChild,I=E.lastElementChild,A=x.firstElementChild;I.scrollLeft=I.scrollWidth,I.scrollTop=I.scrollHeight,A.style.width=x.offsetWidth+1+"px",A.style.height=x.offsetHeight+1+"px",x.scrollLeft=x.scrollWidth,x.scrollTop=x.scrollHeight},o=function(C){return C.offsetWidth!=C.__resizeLast__.width||C.offsetHeight!=C.__resizeLast__.height},l=function(C){if(!(C.target.className&&typeof C.target.className.indexOf=="function"&&C.target.className.indexOf("contract-trigger")<0&&C.target.className.indexOf("expand-trigger")<0)){var E=this;a(this),this.__resizeRAF__&&s(this.__resizeRAF__),this.__resizeRAF__=r(function(){o(E)&&(E.__resizeLast__.width=E.offsetWidth,E.__resizeLast__.height=E.offsetHeight,E.__resizeListeners__.forEach(function(x){x.call(E,C)}))})}},c=!1,d="",u="animationstart",m="Webkit Moz O ms".split(" "),v="webkitAnimationStart animationstart oAnimationStart MSAnimationStart".split(" "),y="";{var _=n.document.createElement("fakeelement");if(_.style.animationName!==void 0&&(c=!0),c===!1){for(var p=0;p<m.length;p++)if(_.style[m[p]+"AnimationName"]!==void 0){y=m[p],d="-"+y.toLowerCase()+"-",u=v[p],c=!0;break}}}var f="resizeanim",h="@"+d+"keyframes "+f+" { from { opacity: 0; } to { opacity: 0; } } ",g=d+"animation: 1ms "+f+"; "}var S=function(C){if(!C.getElementById("detectElementResize")){var E=(h||"")+".resize-triggers { "+(g||"")+'visibility: hidden; opacity: 0; } .resize-triggers, .resize-triggers > div, .contract-trigger:before { content: " "; display: block; position: absolute; top: 0; left: 0; height: 100%; width: 100%; overflow: hidden; z-index: -1; } .resize-triggers > div { background: #eee; overflow: auto; } .contract-trigger:before { width: 200%; height: 200%; }',x=C.head||C.getElementsByTagName("head")[0],I=C.createElement("style");I.id="detectElementResize",I.type="text/css",t!=null&&I.setAttribute("nonce",t),I.styleSheet?I.styleSheet.cssText=E:I.appendChild(C.createTextNode(E)),x.appendChild(I)}},b=function(C,E){if(i)C.attachEvent("onresize",E);else{if(!C.__resizeTriggers__){var x=C.ownerDocument,I=n.getComputedStyle(C);I&&I.position=="static"&&(C.style.position="relative"),S(x),C.__resizeLast__={},C.__resizeListeners__=[],(C.__resizeTriggers__=x.createElement("div")).className="resize-triggers";var A=x.createElement("div");A.className="expand-trigger",A.appendChild(x.createElement("div"));var P=x.createElement("div");P.className="contract-trigger",C.__resizeTriggers__.appendChild(A),C.__resizeTriggers__.appendChild(P),C.appendChild(C.__resizeTriggers__),a(C),C.addEventListener("scroll",l,!0),u&&(C.__resizeTriggers__.__animationListener__=function(B){B.animationName==f&&a(C)},C.__resizeTriggers__.addEventListener(u,C.__resizeTriggers__.__animationListener__))}C.__resizeListeners__.push(E)}},w=function(C,E){if(i)C.detachEvent("onresize",E);else if(C.__resizeListeners__.splice(C.__resizeListeners__.indexOf(E),1),!C.__resizeListeners__.length){C.removeEventListener("scroll",l,!0),C.__resizeTriggers__.__animationListener__&&(C.__resizeTriggers__.removeEventListener(u,C.__resizeTriggers__.__animationListener__),C.__resizeTriggers__.__animationListener__=null);try{C.__resizeTriggers__=!C.removeChild(C.__resizeTriggers__)}catch{}}};return{addResizeListener:b,removeResizeListener:w}}function Q0(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function X0(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Q0(Object(n),!0).forEach(function(i){W(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Q0(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function t5(t,e,n){return e=be(e),Bt(t,h1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function h1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(h1=function(){return!!t})()}var n5=function(t){function e(){var n;Je(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=t5(this,e,[].concat(r)),W(n,"state",{height:n.props.defaultHeight||0,width:n.props.defaultWidth||0}),W(n,"_parentNode",void 0),W(n,"_autoSizer",void 0),W(n,"_window",void 0),W(n,"_detectElementResize",void 0),W(n,"_onResize",function(){var a=n.props,o=a.disableHeight,l=a.disableWidth,c=a.onResize;if(n._parentNode){var d=n._parentNode.offsetHeight||0,u=n._parentNode.offsetWidth||0,m=n._window||window,v=m.getComputedStyle(n._parentNode)||{},y=parseInt(v.paddingLeft,10)||0,_=parseInt(v.paddingRight,10)||0,p=parseInt(v.paddingTop,10)||0,f=parseInt(v.paddingBottom,10)||0,h=d-p-f,g=u-y-_;(!o&&n.state.height!==h||!l&&n.state.width!==g)&&(n.setState({height:d-p-f,width:u-y-_}),c({height:d,width:u}))}}),W(n,"_setRef",function(a){n._autoSizer=a}),n}return Ft(e,t),Ke(e,[{key:"componentDidMount",value:function(){var i=this.props.nonce;this._autoSizer&&this._autoSizer.parentNode&&this._autoSizer.parentNode.ownerDocument&&this._autoSizer.parentNode.ownerDocument.defaultView&&this._autoSizer.parentNode instanceof this._autoSizer.parentNode.ownerDocument.defaultView.HTMLElement&&(this._parentNode=this._autoSizer.parentNode,this._window=this._autoSizer.parentNode.ownerDocument.defaultView,this._detectElementResize=d1(i,this._window),this._detectElementResize.addResizeListener(this._parentNode,this._onResize),this._onResize())}},{key:"componentWillUnmount",value:function(){this._detectElementResize&&this._parentNode&&this._detectElementResize.removeResizeListener(this._parentNode,this._onResize)}},{key:"render",value:function(){var i=this.props,r=i.children,s=i.className,a=i.disableHeight,o=i.disableWidth,l=i.style,c=this.state,d=c.height,u=c.width,m={overflow:"visible"},v={};return a||(m.height=0,v.height=d),o||(m.width=0,v.width=u),T.createElement("div",{className:s,ref:this._setRef,style:X0(X0({},m),l)},r(v))}}])}(T.Component);W(n5,"defaultProps",{onResize:function(){},disableHeight:!1,disableWidth:!1,style:{}});function i5(t,e,n){return e=be(e),Bt(t,f1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function f1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(f1=function(){return!!t})()}var r5=function(t){function e(){var n;Je(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=i5(this,e,[].concat(r)),W(n,"_child",T.createRef()),W(n,"_measure",function(){var a=n.props,o=a.cache,l=a.columnIndex,c=l===void 0?0:l,d=a.parent,u=a.rowIndex,m=u===void 0?n.props.index||0:u,v=n._getCellMeasurements(),y=v.height,_=v.width;(y!==o.getHeight(m,c)||_!==o.getWidth(m,c))&&(o.set(m,c,_,y),d&&typeof d.recomputeGridSize=="function"&&d.recomputeGridSize({columnIndex:c,rowIndex:m}))}),W(n,"_registerChild",function(a){a&&!(a instanceof Element)&&console.warn("CellMeasurer registerChild expects to be passed Element or null"),n._child.current=a,a&&n._maybeMeasureCell()}),n}return Ft(e,t),Ke(e,[{key:"componentDidMount",value:function(){this._maybeMeasureCell()}},{key:"componentDidUpdate",value:function(){this._maybeMeasureCell()}},{key:"render",value:function(){var i=this,r=this.props.children,s=typeof r=="function"?r({measure:this._measure,registerChild:this._registerChild}):r;return s===null?s:T.cloneElement(s,{ref:function(o){typeof s.ref=="function"?s.ref(o):s.ref&&(s.ref.current=o),i._child.current=o}})}},{key:"_getCellMeasurements",value:function(){var i=this.props.cache,r=this._child.current;if(r&&r.ownerDocument&&r.ownerDocument.defaultView&&r instanceof r.ownerDocument.defaultView.HTMLElement){var s=r.style.width,a=r.style.height;i.hasFixedWidth()||(r.style.width="auto"),i.hasFixedHeight()||(r.style.height="auto");var o=Math.ceil(r.offsetHeight),l=Math.ceil(r.offsetWidth);return s&&(r.style.width=s),a&&(r.style.height=a),{height:o,width:l}}else return{height:0,width:0}}},{key:"_maybeMeasureCell",value:function(){var i=this.props,r=i.cache,s=i.columnIndex,a=s===void 0?0:s,o=i.parent,l=i.rowIndex,c=l===void 0?this.props.index||0:l;if(!r.has(c,a)){var d=this._getCellMeasurements(),u=d.height,m=d.width;r.set(c,a,m,u),o&&typeof o.invalidateCellSizeAfterRender=="function"&&o.invalidateCellSizeAfterRender({columnIndex:a,rowIndex:c})}}}])}(T.PureComponent);W(r5,"__internalCellMeasurerFlag",!1);function s5(t){if(t==null)throw new TypeError("Cannot destructure "+t)}function yn(){return yn=Object.assign?Object.assign.bind():function(t){for(var e=1;e<arguments.length;e++){var n=arguments[e];for(var i in n)({}).hasOwnProperty.call(n,i)&&(t[i]=n[i])}return t},yn.apply(null,arguments)}function p1(t){var e,n,i="";if(typeof t=="string"||typeof t=="number")i+=t;else if(typeof t=="object")if(Array.isArray(t))for(e=0;e<t.length;e++)t[e]&&(n=p1(t[e]))&&(i&&(i+=" "),i+=n);else for(e in t)t[e]&&(i&&(i+=" "),i+=e);return i}function Dn(){for(var t,e,n=0,i="";n<arguments.length;)(t=arguments[n++])&&(e=p1(t))&&(i&&(i+=" "),i+=e);return i}function na(){var t=arguments.length>0&&arguments[0]!==void 0?arguments[0]:!0,e={};return function(n){var i=n.callback,r=n.indices,s=Object.keys(r),a=!t||s.every(function(l){var c=r[l];return Array.isArray(c)?c.length>0:c>=0}),o=s.length!==Object.keys(e).length||s.some(function(l){var c=e[l],d=r[l];return Array.isArray(d)?c.join(",")!==d.join(","):c!==d});e=r,a&&o&&i(r)}}const o5=!!(typeof window<"u"&&window.document&&window.document.createElement);var bc;function yp(t){if((!bc&&bc!==0||t)&&o5){var e=document.createElement("div");e.style.position="absolute",e.style.top="-9999px",e.style.width="50px",e.style.height="50px",e.style.overflow="scroll",document.body.appendChild(e),bc=e.offsetWidth-e.clientWidth,document.body.removeChild(e)}return bc}function Y0(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Z0(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?Y0(Object(n),!0).forEach(function(i){W(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):Y0(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function a5(t,e,n){return e=be(e),Bt(t,m1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function m1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(m1=function(){return!!t})()}var l5=150,to={OBSERVED:"observed",REQUESTED:"requested"},Rd=function(t){function e(){var n;Je(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=a5(this,e,[].concat(r)),W(n,"state",{isScrolling:!1,scrollLeft:0,scrollTop:0}),W(n,"_calculateSizeAndPositionDataOnNextUpdate",!1),W(n,"_onSectionRenderedMemoizer",na()),W(n,"_onScrollMemoizer",na(!1)),W(n,"_invokeOnSectionRenderedHelper",function(){var a=n.props,o=a.cellLayoutManager,l=a.onSectionRendered;n._onSectionRenderedMemoizer({callback:l,indices:{indices:o.getLastRenderedIndices()}})}),W(n,"_setScrollingContainerRef",function(a){n._scrollingContainer=a}),W(n,"_updateScrollPositionForScrollToCell",function(){var a=n.props,o=a.cellLayoutManager,l=a.height,c=a.scrollToAlignment,d=a.scrollToCell,u=a.width,m=n.state,v=m.scrollLeft,y=m.scrollTop;if(d>=0){var _=o.getScrollPositionForCell({align:c,cellIndex:d,height:l,scrollLeft:v,scrollTop:y,width:u});(_.scrollLeft!==v||_.scrollTop!==y)&&n._setScrollPosition(_)}}),W(n,"_onScroll",function(a){if(a.target===n._scrollingContainer){n._enablePointerEventsAfterDelay();var o=n.props,l=o.cellLayoutManager,c=o.height,d=o.isScrollingChange,u=o.width,m=n._scrollbarSize,v=l.getTotalSize(),y=v.height,_=v.width,p=Math.max(0,Math.min(_-u+m,a.target.scrollLeft)),f=Math.max(0,Math.min(y-c+m,a.target.scrollTop));if(n.state.scrollLeft!==p||n.state.scrollTop!==f){var h=a.cancelable?to.OBSERVED:to.REQUESTED;n.state.isScrolling||d(!0),n.setState({isScrolling:!0,scrollLeft:p,scrollPositionChangeReason:h,scrollTop:f})}n._invokeOnScrollMemoizer({scrollLeft:p,scrollTop:f,totalWidth:_,totalHeight:y})}}),n._scrollbarSize=yp(),n._scrollbarSize===void 0?(n._scrollbarSizeMeasured=!1,n._scrollbarSize=0):n._scrollbarSizeMeasured=!0,n}return Ft(e,t),Ke(e,[{key:"recomputeCellSizesAndPositions",value:function(){this._calculateSizeAndPositionDataOnNextUpdate=!0,this.forceUpdate()}},{key:"componentDidMount",value:function(){var i=this.props,r=i.cellLayoutManager,s=i.scrollLeft,a=i.scrollToCell,o=i.scrollTop;this._scrollbarSizeMeasured||(this._scrollbarSize=yp(),this._scrollbarSizeMeasured=!0,this.setState({})),a>=0?this._updateScrollPositionForScrollToCell():(s>=0||o>=0)&&this._setScrollPosition({scrollLeft:s,scrollTop:o}),this._invokeOnSectionRenderedHelper();var l=r.getTotalSize(),c=l.height,d=l.width;this._invokeOnScrollMemoizer({scrollLeft:s||0,scrollTop:o||0,totalHeight:c,totalWidth:d})}},{key:"componentDidUpdate",value:function(i,r){var s=this.props,a=s.height,o=s.scrollToAlignment,l=s.scrollToCell,c=s.width,d=this.state,u=d.scrollLeft,m=d.scrollPositionChangeReason,v=d.scrollTop;m===to.REQUESTED&&(u>=0&&u!==r.scrollLeft&&u!==this._scrollingContainer.scrollLeft&&(this._scrollingContainer.scrollLeft=u),v>=0&&v!==r.scrollTop&&v!==this._scrollingContainer.scrollTop&&(this._scrollingContainer.scrollTop=v)),(a!==i.height||o!==i.scrollToAlignment||l!==i.scrollToCell||c!==i.width)&&this._updateScrollPositionForScrollToCell(),this._invokeOnSectionRenderedHelper()}},{key:"componentWillUnmount",value:function(){this._disablePointerEventsTimeoutId&&clearTimeout(this._disablePointerEventsTimeoutId)}},{key:"render",value:function(){var i=this.props,r=i.autoHeight,s=i.cellCount,a=i.cellLayoutManager,o=i.className,l=i.height,c=i.horizontalOverscanSize,d=i.id,u=i.noContentRenderer,m=i.style,v=i.verticalOverscanSize,y=i.width,_=this.state,p=_.isScrolling,f=_.scrollLeft,h=_.scrollTop;(this._lastRenderedCellCount!==s||this._lastRenderedCellLayoutManager!==a||this._calculateSizeAndPositionDataOnNextUpdate)&&(this._lastRenderedCellCount=s,this._lastRenderedCellLayoutManager=a,this._calculateSizeAndPositionDataOnNextUpdate=!1,a.calculateSizeAndPositionData());var g=a.getTotalSize(),S=g.height,b=g.width,w=Math.max(0,f-c),k=Math.max(0,h-v),C=Math.min(b,f+y+c),E=Math.min(S,h+l+v),x=l>0&&y>0?a.cellRenderers({height:E-k,isScrolling:p,width:C-w,x:w,y:k}):[],I={boxSizing:"border-box",direction:"ltr",height:r?"auto":l,position:"relative",WebkitOverflowScrolling:"touch",width:y,willChange:"transform"},A=S>l?this._scrollbarSize:0,P=b>y?this._scrollbarSize:0;return I.overflowX=b+A<=y?"hidden":"auto",I.overflowY=S+P<=l?"hidden":"auto",T.createElement("div",{ref:this._setScrollingContainerRef,"aria-label":this.props["aria-label"],className:Dn("ReactVirtualized__Collection",o),id:d,onScroll:this._onScroll,role:"grid",style:Z0(Z0({},I),m),tabIndex:0},s>0&&T.createElement("div",{className:"ReactVirtualized__Collection__innerScrollContainer",style:{height:S,maxHeight:S,maxWidth:b,overflow:"hidden",pointerEvents:p?"none":"",width:b}},x),s===0&&u())}},{key:"_enablePointerEventsAfterDelay",value:function(){var i=this;this._disablePointerEventsTimeoutId&&clearTimeout(this._disablePointerEventsTimeoutId),this._disablePointerEventsTimeoutId=setTimeout(function(){var r=i.props.isScrollingChange;r(!1),i._disablePointerEventsTimeoutId=null,i.setState({isScrolling:!1})},l5)}},{key:"_invokeOnScrollMemoizer",value:function(i){var r=this,s=i.scrollLeft,a=i.scrollTop,o=i.totalHeight,l=i.totalWidth;this._onScrollMemoizer({callback:function(d){var u=d.scrollLeft,m=d.scrollTop,v=r.props,y=v.height,_=v.onScroll,p=v.width;_({clientHeight:y,clientWidth:p,scrollHeight:o,scrollLeft:u,scrollTop:m,scrollWidth:l})},indices:{scrollLeft:s,scrollTop:a}})}},{key:"_setScrollPosition",value:function(i){var r=i.scrollLeft,s=i.scrollTop,a={scrollPositionChangeReason:to.REQUESTED};r>=0&&(a.scrollLeft=r),s>=0&&(a.scrollTop=s),(r>=0&&r!==this.state.scrollLeft||s>=0&&s!==this.state.scrollTop)&&this.setState(a)}}],[{key:"getDerivedStateFromProps",value:function(i,r){return i.cellCount===0&&(r.scrollLeft!==0||r.scrollTop!==0)?{scrollLeft:0,scrollTop:0,scrollPositionChangeReason:to.REQUESTED}:i.scrollLeft!==r.scrollLeft||i.scrollTop!==r.scrollTop?{scrollLeft:i.scrollLeft!=null?i.scrollLeft:r.scrollLeft,scrollTop:i.scrollTop!=null?i.scrollTop:r.scrollTop,scrollPositionChangeReason:to.REQUESTED}:null}}])}(T.PureComponent);W(Rd,"defaultProps",{"aria-label":"grid",horizontalOverscanSize:0,noContentRenderer:function(){return null},onScroll:function(){return null},onSectionRendered:function(){return null},scrollToAlignment:"auto",scrollToCell:-1,style:{},verticalOverscanSize:0});Rd.propTypes={};Jl(Rd);var c5=function(){function t(e){var n=e.height,i=e.width,r=e.x,s=e.y;Je(this,t),this.height=n,this.width=i,this.x=r,this.y=s,this._indexMap={},this._indices=[]}return Ke(t,[{key:"addCellIndex",value:function(n){var i=n.index;this._indexMap[i]||(this._indexMap[i]=!0,this._indices.push(i))}},{key:"getCellIndices",value:function(){return this._indices}},{key:"toString",value:function(){return"".concat(this.x,",").concat(this.y," ").concat(this.width,"x").concat(this.height)}}])}(),u5=100,d5=function(){function t(){var e=arguments.length>0&&arguments[0]!==void 0?arguments[0]:u5;Je(this,t),this._sectionSize=e,this._cellMetadata=[],this._sections={}}return Ke(t,[{key:"getCellIndices",value:function(n){var i=n.height,r=n.width,s=n.x,a=n.y,o={};return this.getSections({height:i,width:r,x:s,y:a}).forEach(function(l){return l.getCellIndices().forEach(function(c){o[c]=c})}),Object.keys(o).map(function(l){return o[l]})}},{key:"getCellMetadata",value:function(n){var i=n.index;return this._cellMetadata[i]}},{key:"getSections",value:function(n){for(var i=n.height,r=n.width,s=n.x,a=n.y,o=Math.floor(s/this._sectionSize),l=Math.floor((s+r-1)/this._sectionSize),c=Math.floor(a/this._sectionSize),d=Math.floor((a+i-1)/this._sectionSize),u=[],m=o;m<=l;m++)for(var v=c;v<=d;v++){var y="".concat(m,".").concat(v);this._sections[y]||(this._sections[y]=new c5({height:this._sectionSize,width:this._sectionSize,x:m*this._sectionSize,y:v*this._sectionSize})),u.push(this._sections[y])}return u}},{key:"getTotalSectionCount",value:function(){return Object.keys(this._sections).length}},{key:"toString",value:function(){var n=this;return Object.keys(this._sections).map(function(i){return n._sections[i].toString()})}},{key:"registerCell",value:function(n){var i=n.cellMetadatum,r=n.index;this._cellMetadata[r]=i,this.getSections(i).forEach(function(s){return s.addCellIndex({index:r})})}}])}();function h5(t){for(var e=t.cellCount,n=t.cellSizeAndPositionGetter,i=t.sectionSize,r=[],s=new d5(i),a=0,o=0,l=0;l<e;l++){var c=n({index:l});if(c.height==null||isNaN(c.height)||c.width==null||isNaN(c.width)||c.x==null||isNaN(c.x)||c.y==null||isNaN(c.y))throw Error("Invalid metadata returned for cell ".concat(l,`:
        x:`).concat(c.x,", y:").concat(c.y,", width:").concat(c.width,", height:").concat(c.height));a=Math.max(a,c.y+c.height),o=Math.max(o,c.x+c.width),r[l]=c,s.registerCell({cellMetadatum:c,index:l})}return{cellMetadata:r,height:a,sectionManager:s,width:o}}function e_(t){var e=t.align,n=e===void 0?"auto":e,i=t.cellOffset,r=t.cellSize,s=t.containerSize,a=t.currentOffset,o=i,l=o-s+r;switch(n){case"start":return o;case"end":return l;case"center":return o-(s-r)/2;default:return Math.max(l,Math.min(o,a))}}function f5(t,e,n){return e=be(e),Bt(t,g1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function g1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(g1=function(){return!!t})()}var v1=function(t){function e(n,i){var r;return Je(this,e),r=f5(this,e,[n,i]),r._cellMetadata=[],r._lastRenderedCellIndices=[],r._cellCache=[],r._isScrollingChange=r._isScrollingChange.bind(r),r._setCollectionViewRef=r._setCollectionViewRef.bind(r),r}return Ft(e,t),Ke(e,[{key:"forceUpdate",value:function(){this._collectionView!==void 0&&this._collectionView.forceUpdate()}},{key:"recomputeCellSizesAndPositions",value:function(){this._cellCache=[],this._collectionView.recomputeCellSizesAndPositions()}},{key:"render",value:function(){var i=yn({},(s5(this.props),this.props));return T.createElement(Rd,yn({cellLayoutManager:this,isScrollingChange:this._isScrollingChange,ref:this._setCollectionViewRef},i))}},{key:"calculateSizeAndPositionData",value:function(){var i=this.props,r=i.cellCount,s=i.cellSizeAndPositionGetter,a=i.sectionSize,o=h5({cellCount:r,cellSizeAndPositionGetter:s,sectionSize:a});this._cellMetadata=o.cellMetadata,this._sectionManager=o.sectionManager,this._height=o.height,this._width=o.width}},{key:"getLastRenderedIndices",value:function(){return this._lastRenderedCellIndices}},{key:"getScrollPositionForCell",value:function(i){var r=i.align,s=i.cellIndex,a=i.height,o=i.scrollLeft,l=i.scrollTop,c=i.width,d=this.props.cellCount;if(s>=0&&s<d){var u=this._cellMetadata[s];o=e_({align:r,cellOffset:u.x,cellSize:u.width,containerSize:c,currentOffset:o,targetIndex:s}),l=e_({align:r,cellOffset:u.y,cellSize:u.height,containerSize:a,currentOffset:l,targetIndex:s})}return{scrollLeft:o,scrollTop:l}}},{key:"getTotalSize",value:function(){return{height:this._height,width:this._width}}},{key:"cellRenderers",value:function(i){var r=this,s=i.height,a=i.isScrolling,o=i.width,l=i.x,c=i.y,d=this.props,u=d.cellGroupRenderer,m=d.cellRenderer;return this._lastRenderedCellIndices=this._sectionManager.getCellIndices({height:s,width:o,x:l,y:c}),u({cellCache:this._cellCache,cellRenderer:m,cellSizeAndPositionGetter:function(y){var _=y.index;return r._sectionManager.getCellMetadata({index:_})},indices:this._lastRenderedCellIndices,isScrolling:a})}},{key:"_isScrollingChange",value:function(i){i||(this._cellCache=[])}},{key:"_setCollectionViewRef",value:function(i){this._collectionView=i}}])}(T.PureComponent);W(v1,"defaultProps",{"aria-label":"grid",cellGroupRenderer:p5});v1.propTypes={};function p5(t){var e=t.cellCache,n=t.cellRenderer,i=t.cellSizeAndPositionGetter,r=t.indices,s=t.isScrolling;return r.map(function(a){var o=i({index:a}),l={index:a,isScrolling:s,key:a,style:{height:o.height,left:o.x,position:"absolute",top:o.y,width:o.width}};return s?(a in e||(e[a]=n(l)),e[a]):n(l)}).filter(function(a){return!!a})}function m5(t,e,n){return e=be(e),Bt(t,_1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function _1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(_1=function(){return!!t})()}var g5=function(t){function e(n,i){var r;return Je(this,e),r=m5(this,e,[n,i]),r._registerChild=r._registerChild.bind(r),r}return Ft(e,t),Ke(e,[{key:"componentDidUpdate",value:function(i){var r=this.props,s=r.columnMaxWidth,a=r.columnMinWidth,o=r.columnCount,l=r.width;(s!==i.columnMaxWidth||a!==i.columnMinWidth||o!==i.columnCount||l!==i.width)&&this._registeredChild&&this._registeredChild.recomputeGridSize()}},{key:"render",value:function(){var i=this.props,r=i.children,s=i.columnMaxWidth,a=i.columnMinWidth,o=i.columnCount,l=i.width,c=a||1,d=s?Math.min(s,l):l,u=l/o;u=Math.max(c,u),u=Math.min(d,u),u=Math.floor(u);var m=Math.min(l,u*o);return r({adjustedWidth:m,columnWidth:u,getColumnWidth:function(){return u},registerChild:this._registerChild})}},{key:"_registerChild",value:function(i){if(i&&typeof i.recomputeGridSize!="function")throw Error("Unexpected child type registered; only Grid/MultiGrid children are supported.");this._registeredChild=i,this._registeredChild&&this._registeredChild.recomputeGridSize()}}])}(T.PureComponent);g5.propTypes={};function t_(t){var e=t.cellCount,n=t.cellSize,i=t.computeMetadataCallback,r=t.computeMetadataCallbackProps,s=t.nextCellsCount,a=t.nextCellSize,o=t.nextScrollToIndex,l=t.scrollToIndex,c=t.updateScrollOffsetForScrollToIndex;(e!==s||(typeof n=="number"||typeof a=="number")&&n!==a)&&(i(r),l>=0&&l===o&&c())}function v5(t,e){if(t==null)return{};var n={};for(var i in t)if({}.hasOwnProperty.call(t,i)){if(e.includes(i))continue;n[i]=t[i]}return n}function Wa(t,e){if(t==null)return{};var n,i,r=v5(t,e);if(Object.getOwnPropertySymbols){var s=Object.getOwnPropertySymbols(t);for(i=0;i<s.length;i++)n=s[i],e.includes(n)||{}.propertyIsEnumerable.call(t,n)&&(r[n]=t[n])}return r}var _5=function(){function t(e){var n=e.cellCount,i=e.cellSizeGetter,r=e.estimatedCellSize;Je(this,t),W(this,"_cellSizeAndPositionData",{}),W(this,"_lastMeasuredIndex",-1),W(this,"_lastBatchedIndex",-1),W(this,"_cellCount",void 0),W(this,"_cellSizeGetter",void 0),W(this,"_estimatedCellSize",void 0),this._cellSizeGetter=i,this._cellCount=n,this._estimatedCellSize=r}return Ke(t,[{key:"areOffsetsAdjusted",value:function(){return!1}},{key:"configure",value:function(n){var i=n.cellCount,r=n.estimatedCellSize,s=n.cellSizeGetter;this._cellCount=i,this._estimatedCellSize=r,this._cellSizeGetter=s}},{key:"getCellCount",value:function(){return this._cellCount}},{key:"getEstimatedCellSize",value:function(){return this._estimatedCellSize}},{key:"getLastMeasuredIndex",value:function(){return this._lastMeasuredIndex}},{key:"getOffsetAdjustment",value:function(){return 0}},{key:"getSizeAndPositionOfCell",value:function(n){if(n<0||n>=this._cellCount)throw Error("Requested index ".concat(n," is outside of range 0..").concat(this._cellCount));if(n>this._lastMeasuredIndex)for(var i=this.getSizeAndPositionOfLastMeasuredCell(),r=i.offset+i.size,s=this._lastMeasuredIndex+1;s<=n;s++){var a=this._cellSizeGetter({index:s});if(a===void 0||isNaN(a))throw Error("Invalid size returned for cell ".concat(s," of value ").concat(a));a===null?(this._cellSizeAndPositionData[s]={offset:r,size:0},this._lastBatchedIndex=n):(this._cellSizeAndPositionData[s]={offset:r,size:a},r+=a,this._lastMeasuredIndex=n)}return this._cellSizeAndPositionData[n]}},{key:"getSizeAndPositionOfLastMeasuredCell",value:function(){return this._lastMeasuredIndex>=0?this._cellSizeAndPositionData[this._lastMeasuredIndex]:{offset:0,size:0}}},{key:"getTotalSize",value:function(){var n=this.getSizeAndPositionOfLastMeasuredCell(),i=n.offset+n.size,r=this._cellCount-this._lastMeasuredIndex-1,s=r*this._estimatedCellSize;return i+s}},{key:"getUpdatedOffsetForIndex",value:function(n){var i=n.align,r=i===void 0?"auto":i,s=n.containerSize,a=n.currentOffset,o=n.targetIndex;if(s<=0)return 0;var l=this.getSizeAndPositionOfCell(o),c=l.offset,d=c-s+l.size,u;switch(r){case"start":u=c;break;case"end":u=d;break;case"center":u=c-(s-l.size)/2;break;default:u=Math.max(d,Math.min(c,a));break}var m=this.getTotalSize();return Math.max(0,Math.min(m-s,u))}},{key:"getVisibleCellRange",value:function(n){var i=n.containerSize,r=n.offset,s=this.getTotalSize();if(s===0)return{};var a=r+i,o=this._findNearestCell(r),l=this.getSizeAndPositionOfCell(o);r=l.offset+l.size;for(var c=o;r<a&&c<this._cellCount-1;)c++,r+=this.getSizeAndPositionOfCell(c).size;return{start:o,stop:c}}},{key:"resetCell",value:function(n){this._lastMeasuredIndex=Math.min(this._lastMeasuredIndex,n-1)}},{key:"_binarySearch",value:function(n,i,r){for(;i<=n;){var s=i+Math.floor((n-i)/2),a=this.getSizeAndPositionOfCell(s).offset;if(a===r)return s;a<r?i=s+1:a>r&&(n=s-1)}return i>0?i-1:0}},{key:"_exponentialSearch",value:function(n,i){for(var r=1;n<this._cellCount&&this.getSizeAndPositionOfCell(n).offset<i;)n+=r,r*=2;return this._binarySearch(Math.min(n,this._cellCount-1),Math.floor(n/2),i)}},{key:"_findNearestCell",value:function(n){if(isNaN(n))throw Error("Invalid offset ".concat(n," specified"));n=Math.max(0,n);var i=this.getSizeAndPositionOfLastMeasuredCell(),r=Math.max(0,this._lastMeasuredIndex);return i.offset>=n?this._binarySearch(r,0,n):this._exponentialSearch(r,n)}}])}(),y5=15e5,S5=16777100,C5=function(){return typeof window<"u"},b5=function(){return!!window.chrome},w5=function(){return C5()&&b5()?S5:y5},k5=["maxScrollSize"],n_=function(){function t(e){var n=e.maxScrollSize,i=n===void 0?w5():n,r=Wa(e,k5);Je(this,t),W(this,"_cellSizeAndPositionManager",void 0),W(this,"_maxScrollSize",void 0),this._cellSizeAndPositionManager=new _5(r),this._maxScrollSize=i}return Ke(t,[{key:"areOffsetsAdjusted",value:function(){return this._cellSizeAndPositionManager.getTotalSize()>this._maxScrollSize}},{key:"configure",value:function(n){this._cellSizeAndPositionManager.configure(n)}},{key:"getCellCount",value:function(){return this._cellSizeAndPositionManager.getCellCount()}},{key:"getEstimatedCellSize",value:function(){return this._cellSizeAndPositionManager.getEstimatedCellSize()}},{key:"getLastMeasuredIndex",value:function(){return this._cellSizeAndPositionManager.getLastMeasuredIndex()}},{key:"getOffsetAdjustment",value:function(n){var i=n.containerSize,r=n.offset,s=this._cellSizeAndPositionManager.getTotalSize(),a=this.getTotalSize(),o=this._getOffsetPercentage({containerSize:i,offset:r,totalSize:a});return Math.round(o*(a-s))}},{key:"getSizeAndPositionOfCell",value:function(n){return this._cellSizeAndPositionManager.getSizeAndPositionOfCell(n)}},{key:"getSizeAndPositionOfLastMeasuredCell",value:function(){return this._cellSizeAndPositionManager.getSizeAndPositionOfLastMeasuredCell()}},{key:"getTotalSize",value:function(){return Math.min(this._maxScrollSize,this._cellSizeAndPositionManager.getTotalSize())}},{key:"getUpdatedOffsetForIndex",value:function(n){var i=n.align,r=i===void 0?"auto":i,s=n.containerSize,a=n.currentOffset,o=n.targetIndex;a=this._safeOffsetToOffset({containerSize:s,offset:a});var l=this._cellSizeAndPositionManager.getUpdatedOffsetForIndex({align:r,containerSize:s,currentOffset:a,targetIndex:o});return this._offsetToSafeOffset({containerSize:s,offset:l})}},{key:"getVisibleCellRange",value:function(n){var i=n.containerSize,r=n.offset;return r=this._safeOffsetToOffset({containerSize:i,offset:r}),this._cellSizeAndPositionManager.getVisibleCellRange({containerSize:i,offset:r})}},{key:"resetCell",value:function(n){this._cellSizeAndPositionManager.resetCell(n)}},{key:"_getOffsetPercentage",value:function(n){var i=n.containerSize,r=n.offset,s=n.totalSize;return s<=i?0:r/(s-i)}},{key:"_offsetToSafeOffset",value:function(n){var i=n.containerSize,r=n.offset,s=this._cellSizeAndPositionManager.getTotalSize(),a=this.getTotalSize();if(s===a)return r;var o=this._getOffsetPercentage({containerSize:i,offset:r,totalSize:s});return Math.round(o*(a-i))}},{key:"_safeOffsetToOffset",value:function(n){var i=n.containerSize,r=n.offset,s=this._cellSizeAndPositionManager.getTotalSize(),a=this.getTotalSize();if(s===a)return r;var o=this._getOffsetPercentage({containerSize:i,offset:r,totalSize:a});return Math.round(o*(s-i))}}])}(),wc=-1,Ii=1;function E5(t){var e=t.cellCount,n=t.overscanCellsCount,i=t.scrollDirection,r=t.startIndex,s=t.stopIndex;return i===Ii?{overscanStartIndex:Math.max(0,r),overscanStopIndex:Math.min(e-1,s+n)}:{overscanStartIndex:Math.max(0,r-n),overscanStopIndex:Math.min(e-1,s)}}function i_(t){var e=t.cellSize,n=t.cellSizeAndPositionManager,i=t.previousCellsCount,r=t.previousCellSize,s=t.previousScrollToAlignment,a=t.previousScrollToIndex,o=t.previousSize,l=t.scrollOffset,c=t.scrollToAlignment,d=t.scrollToIndex,u=t.size,m=t.sizeJustIncreasedFromZero,v=t.updateScrollIndexCallback,y=n.getCellCount(),_=d>=0&&d<y,p=u!==o||m||!r||typeof e=="number"&&e!==r;_&&(p||c!==s||d!==a)?v(d):!_&&y>0&&(u<o||y<i)&&l>n.getTotalSize()-u&&v(y-1)}function T5(t){for(var e=t.cellCache,n=t.cellRenderer,i=t.columnSizeAndPositionManager,r=t.columnStartIndex,s=t.columnStopIndex,a=t.deferredMeasurementCache,o=t.horizontalOffsetAdjustment,l=t.isScrolling,c=t.isScrollingOptOut,d=t.parent,u=t.rowSizeAndPositionManager,m=t.rowStartIndex,v=t.rowStopIndex,y=t.styleCache,_=t.verticalOffsetAdjustment,p=t.visibleColumnIndices,f=t.visibleRowIndices,h=[],g=i.areOffsetsAdjusted()||u.areOffsetsAdjusted(),S=!l&&!g,b=m;b<=v;b++)for(var w=u.getSizeAndPositionOfCell(b),k=r;k<=s;k++){var C=i.getSizeAndPositionOfCell(k),E=k>=p.start&&k<=p.stop&&b>=f.start&&b<=f.stop,x="".concat(b,"-").concat(k),I=void 0;S&&y[x]?I=y[x]:a&&!a.has(b,k)?I={height:"auto",left:0,position:"absolute",top:0,width:"auto"}:(I={height:w.size,left:C.offset+o,position:"absolute",top:w.offset+_,width:C.size},y[x]=I);var A={columnIndex:k,isScrolling:l,isVisible:E,key:x,parent:d,rowIndex:b,style:I},P=void 0;(c||l)&&!o&&!_?(e[x]||(e[x]=n(A)),P=e[x]):P=n(A),!(P==null||P===!1)&&(P.props.role||(P=te.cloneElement(P,{role:"gridcell"})),h.push(P))}return h}var Ot;typeof window<"u"?Ot=window:typeof self<"u"?Ot=self:Ot={};var R5=Ot.requestAnimationFrame||Ot.webkitRequestAnimationFrame||Ot.mozRequestAnimationFrame||Ot.oRequestAnimationFrame||Ot.msRequestAnimationFrame||function(t){return Ot.setTimeout(t,1e3/60)},x5=Ot.cancelAnimationFrame||Ot.webkitCancelAnimationFrame||Ot.mozCancelAnimationFrame||Ot.oCancelAnimationFrame||Ot.msCancelAnimationFrame||function(t){Ot.clearTimeout(t)},r_=R5,P5=x5,ia=function(e){return P5(e.id)},Ym=function(e,n){var i;Promise.resolve().then(function(){i=Date.now()});var r=function(){Date.now()-i>=n?e.call():s.id=r_(r)},s={id:r_(r)};return s};function s_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function zt(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?s_(Object(n),!0).forEach(function(i){W(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):s_(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function O5(t,e,n){return e=be(e),Bt(t,y1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function y1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(y1=function(){return!!t})()}var I5=150,Ih={OBSERVED:"observed",REQUESTED:"requested"},L5=function(){return null},qr=function(t){function e(n){var i;Je(this,e),i=O5(this,e,[n]),W(i,"_onGridRenderedMemoizer",na()),W(i,"_onScrollMemoizer",na(!1)),W(i,"_deferredInvalidateColumnIndex",null),W(i,"_deferredInvalidateRowIndex",null),W(i,"_recomputeScrollLeftFlag",!1),W(i,"_recomputeScrollTopFlag",!1),W(i,"_horizontalScrollBarSize",0),W(i,"_verticalScrollBarSize",0),W(i,"_scrollbarPresenceChanged",!1),W(i,"_scrollingContainer",void 0),W(i,"_childrenToDisplay",void 0),W(i,"_columnStartIndex",void 0),W(i,"_columnStopIndex",void 0),W(i,"_rowStartIndex",void 0),W(i,"_rowStopIndex",void 0),W(i,"_renderedColumnStartIndex",0),W(i,"_renderedColumnStopIndex",0),W(i,"_renderedRowStartIndex",0),W(i,"_renderedRowStopIndex",0),W(i,"_initialScrollTop",void 0),W(i,"_initialScrollLeft",void 0),W(i,"_disablePointerEventsTimeoutId",void 0),W(i,"_styleCache",{}),W(i,"_cellCache",{}),W(i,"_debounceScrollEndedCallback",function(){i._disablePointerEventsTimeoutId=null,i.setState({isScrolling:!1,needToResetStyleCache:!1})}),W(i,"_invokeOnGridRenderedHelper",function(){var a=i.props.onSectionRendered;i._onGridRenderedMemoizer({callback:a,indices:{columnOverscanStartIndex:i._columnStartIndex,columnOverscanStopIndex:i._columnStopIndex,columnStartIndex:i._renderedColumnStartIndex,columnStopIndex:i._renderedColumnStopIndex,rowOverscanStartIndex:i._rowStartIndex,rowOverscanStopIndex:i._rowStopIndex,rowStartIndex:i._renderedRowStartIndex,rowStopIndex:i._renderedRowStopIndex}})}),W(i,"_setScrollingContainerRef",function(a){i._scrollingContainer=a,typeof i.props.elementRef=="function"?i.props.elementRef(a):Js(i.props.elementRef)==="object"&&(i.props.elementRef.current=a)}),W(i,"_onScroll",function(a){a.target===i._scrollingContainer&&i.handleScrollEvent(a.target)});var r=new n_({cellCount:n.columnCount,cellSizeGetter:function(o){return e._wrapSizeGetter(n.columnWidth)(o)},estimatedCellSize:e._getEstimatedColumnSize(n)}),s=new n_({cellCount:n.rowCount,cellSizeGetter:function(o){return e._wrapSizeGetter(n.rowHeight)(o)},estimatedCellSize:e._getEstimatedRowSize(n)});return i.state={instanceProps:{columnSizeAndPositionManager:r,rowSizeAndPositionManager:s,prevColumnWidth:n.columnWidth,prevRowHeight:n.rowHeight,prevColumnCount:n.columnCount,prevRowCount:n.rowCount,prevIsScrolling:n.isScrolling===!0,prevScrollToColumn:n.scrollToColumn,prevScrollToRow:n.scrollToRow,scrollbarSize:0,scrollbarSizeMeasured:!1},isScrolling:!1,scrollDirectionHorizontal:Ii,scrollDirectionVertical:Ii,scrollLeft:0,scrollTop:0,scrollPositionChangeReason:null,needToResetStyleCache:!1},n.scrollToRow>0&&(i._initialScrollTop=i._getCalculatedScrollTop(n,i.state)),n.scrollToColumn>0&&(i._initialScrollLeft=i._getCalculatedScrollLeft(n,i.state)),i}return Ft(e,t),Ke(e,[{key:"getOffsetForCell",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=i.alignment,s=r===void 0?this.props.scrollToAlignment:r,a=i.columnIndex,o=a===void 0?this.props.scrollToColumn:a,l=i.rowIndex,c=l===void 0?this.props.scrollToRow:l,d=zt(zt({},this.props),{},{scrollToAlignment:s,scrollToColumn:o,scrollToRow:c});return{scrollLeft:this._getCalculatedScrollLeft(d),scrollTop:this._getCalculatedScrollTop(d)}}},{key:"getTotalRowsHeight",value:function(){return this.state.instanceProps.rowSizeAndPositionManager.getTotalSize()}},{key:"getTotalColumnsWidth",value:function(){return this.state.instanceProps.columnSizeAndPositionManager.getTotalSize()}},{key:"handleScrollEvent",value:function(i){var r=i.scrollLeft,s=r===void 0?0:r,a=i.scrollTop,o=a===void 0?0:a;if(!(o<0)){this._debounceScrollEnded();var l=this.props,c=l.autoHeight,d=l.autoWidth,u=l.height,m=l.width,v=this.state.instanceProps,y=v.scrollbarSize,_=v.rowSizeAndPositionManager.getTotalSize(),p=v.columnSizeAndPositionManager.getTotalSize(),f=Math.min(Math.max(0,p-m+y),s),h=Math.min(Math.max(0,_-u+y),o);if(this.state.scrollLeft!==f||this.state.scrollTop!==h){var g=f!==this.state.scrollLeft?f>this.state.scrollLeft?Ii:wc:this.state.scrollDirectionHorizontal,S=h!==this.state.scrollTop?h>this.state.scrollTop?Ii:wc:this.state.scrollDirectionVertical,b={isScrolling:!0,scrollDirectionHorizontal:g,scrollDirectionVertical:S,scrollPositionChangeReason:Ih.OBSERVED};c||(b.scrollTop=h),d||(b.scrollLeft=f),b.needToResetStyleCache=!1,this.setState(b)}this._invokeOnScrollMemoizer({scrollLeft:f,scrollTop:h,totalColumnsWidth:p,totalRowsHeight:_})}}},{key:"invalidateCellSizeAfterRender",value:function(i){var r=i.columnIndex,s=i.rowIndex;this._deferredInvalidateColumnIndex=typeof this._deferredInvalidateColumnIndex=="number"?Math.min(this._deferredInvalidateColumnIndex,r):r,this._deferredInvalidateRowIndex=typeof this._deferredInvalidateRowIndex=="number"?Math.min(this._deferredInvalidateRowIndex,s):s}},{key:"measureAllCells",value:function(){var i=this.props,r=i.columnCount,s=i.rowCount,a=this.state.instanceProps;a.columnSizeAndPositionManager.getSizeAndPositionOfCell(r-1),a.rowSizeAndPositionManager.getSizeAndPositionOfCell(s-1)}},{key:"recomputeGridSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=i.columnIndex,s=r===void 0?0:r,a=i.rowIndex,o=a===void 0?0:a,l=this.props,c=l.scrollToColumn,d=l.scrollToRow,u=this.state.instanceProps;u.columnSizeAndPositionManager.resetCell(s),u.rowSizeAndPositionManager.resetCell(o),this._recomputeScrollLeftFlag=c>=0&&(this.state.scrollDirectionHorizontal===Ii?s<=c:s>=c),this._recomputeScrollTopFlag=d>=0&&(this.state.scrollDirectionVertical===Ii?o<=d:o>=d),this._styleCache={},this._cellCache={},this.forceUpdate()}},{key:"scrollToCell",value:function(i){var r=i.columnIndex,s=i.rowIndex,a=this.props.columnCount,o=this.props;a>1&&r!==void 0&&this._updateScrollLeftForScrollToColumn(zt(zt({},o),{},{scrollToColumn:r})),s!==void 0&&this._updateScrollTopForScrollToRow(zt(zt({},o),{},{scrollToRow:s}))}},{key:"componentDidMount",value:function(){var i=this.props,r=i.getScrollbarSize,s=i.height,a=i.scrollLeft,o=i.scrollToColumn,l=i.scrollTop,c=i.scrollToRow,d=i.width,u=this.state.instanceProps;if(this._initialScrollTop=0,this._initialScrollLeft=0,this._handleInvalidatedGridSize(),u.scrollbarSizeMeasured||this.setState(function(y){var _=zt(zt({},y),{},{needToResetStyleCache:!1});return _.instanceProps.scrollbarSize=r(),_.instanceProps.scrollbarSizeMeasured=!0,_}),typeof a=="number"&&a>=0||typeof l=="number"&&l>=0){var m=e._getScrollToPositionStateUpdate({prevState:this.state,scrollLeft:a,scrollTop:l});m&&(m.needToResetStyleCache=!1,this.setState(m))}this._scrollingContainer&&(this._scrollingContainer.scrollLeft!==this.state.scrollLeft&&(this._scrollingContainer.scrollLeft=this.state.scrollLeft),this._scrollingContainer.scrollTop!==this.state.scrollTop&&(this._scrollingContainer.scrollTop=this.state.scrollTop));var v=s>0&&d>0;o>=0&&v&&this._updateScrollLeftForScrollToColumn(),c>=0&&v&&this._updateScrollTopForScrollToRow(),this._invokeOnGridRenderedHelper(),this._invokeOnScrollMemoizer({scrollLeft:a||0,scrollTop:l||0,totalColumnsWidth:u.columnSizeAndPositionManager.getTotalSize(),totalRowsHeight:u.rowSizeAndPositionManager.getTotalSize()}),this._maybeCallOnScrollbarPresenceChange()}},{key:"componentDidUpdate",value:function(i,r){var s=this,a=this.props,o=a.autoHeight,l=a.autoWidth,c=a.columnCount,d=a.height,u=a.rowCount,m=a.scrollToAlignment,v=a.scrollToColumn,y=a.scrollToRow,_=a.width,p=this.state,f=p.scrollLeft,h=p.scrollPositionChangeReason,g=p.scrollTop,S=p.instanceProps;this._handleInvalidatedGridSize();var b=c>0&&i.columnCount===0||u>0&&i.rowCount===0;h===Ih.REQUESTED&&(!l&&f>=0&&(f!==this._scrollingContainer.scrollLeft||b)&&(this._scrollingContainer.scrollLeft=f),!o&&g>=0&&(g!==this._scrollingContainer.scrollTop||b)&&(this._scrollingContainer.scrollTop=g));var w=(i.width===0||i.height===0)&&d>0&&_>0;if(this._recomputeScrollLeftFlag?(this._recomputeScrollLeftFlag=!1,this._updateScrollLeftForScrollToColumn(this.props)):i_({cellSizeAndPositionManager:S.columnSizeAndPositionManager,previousCellsCount:i.columnCount,previousCellSize:i.columnWidth,previousScrollToAlignment:i.scrollToAlignment,previousScrollToIndex:i.scrollToColumn,previousSize:i.width,scrollOffset:f,scrollToAlignment:m,scrollToIndex:v,size:_,sizeJustIncreasedFromZero:w,updateScrollIndexCallback:function(){return s._updateScrollLeftForScrollToColumn(s.props)}}),this._recomputeScrollTopFlag?(this._recomputeScrollTopFlag=!1,this._updateScrollTopForScrollToRow(this.props)):i_({cellSizeAndPositionManager:S.rowSizeAndPositionManager,previousCellsCount:i.rowCount,previousCellSize:i.rowHeight,previousScrollToAlignment:i.scrollToAlignment,previousScrollToIndex:i.scrollToRow,previousSize:i.height,scrollOffset:g,scrollToAlignment:m,scrollToIndex:y,size:d,sizeJustIncreasedFromZero:w,updateScrollIndexCallback:function(){return s._updateScrollTopForScrollToRow(s.props)}}),this._invokeOnGridRenderedHelper(),f!==r.scrollLeft||g!==r.scrollTop){var k=S.rowSizeAndPositionManager.getTotalSize(),C=S.columnSizeAndPositionManager.getTotalSize();this._invokeOnScrollMemoizer({scrollLeft:f,scrollTop:g,totalColumnsWidth:C,totalRowsHeight:k})}this._maybeCallOnScrollbarPresenceChange()}},{key:"componentWillUnmount",value:function(){this._disablePointerEventsTimeoutId&&ia(this._disablePointerEventsTimeoutId)}},{key:"render",value:function(){var i=this.props,r=i.autoContainerWidth,s=i.autoHeight,a=i.autoWidth,o=i.className,l=i.containerProps,c=i.containerRole,d=i.containerStyle,u=i.height,m=i.id,v=i.noContentRenderer,y=i.role,_=i.style,p=i.tabIndex,f=i.width,h=this.state,g=h.instanceProps,S=h.needToResetStyleCache,b=this._isScrolling(),w={boxSizing:"border-box",direction:"ltr",height:s?"auto":u,position:"relative",width:a?"auto":f,WebkitOverflowScrolling:"touch",willChange:"transform"};S&&(this._styleCache={}),this.state.isScrolling||this._resetStyleCache(),this._calculateChildrenToRender(this.props,this.state);var k=g.columnSizeAndPositionManager.getTotalSize(),C=g.rowSizeAndPositionManager.getTotalSize(),E=C>u?g.scrollbarSize:0,x=k>f?g.scrollbarSize:0;(x!==this._horizontalScrollBarSize||E!==this._verticalScrollBarSize)&&(this._horizontalScrollBarSize=x,this._verticalScrollBarSize=E,this._scrollbarPresenceChanged=!0),w.overflowX=k+E<=f?"hidden":"auto",w.overflowY=C+x<=u?"hidden":"auto";var I=this._childrenToDisplay,A=I.length===0&&u>0&&f>0;return T.createElement("div",yn({ref:this._setScrollingContainerRef},l,{"aria-label":this.props["aria-label"],"aria-readonly":this.props["aria-readonly"],className:Dn("ReactVirtualized__Grid",o),id:m,onScroll:this._onScroll,role:y,style:zt(zt({},w),_),tabIndex:p}),I.length>0&&T.createElement("div",{className:"ReactVirtualized__Grid__innerScrollContainer",role:c,style:zt({width:r?"auto":k,height:C,maxWidth:k,maxHeight:C,overflow:"hidden",pointerEvents:b?"none":"",position:"relative"},d)},I),A&&v())}},{key:"_calculateChildrenToRender",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.state,s=i.cellRenderer,a=i.cellRangeRenderer,o=i.columnCount,l=i.deferredMeasurementCache,c=i.height,d=i.overscanColumnCount,u=i.overscanIndicesGetter,m=i.overscanRowCount,v=i.rowCount,y=i.width,_=i.isScrollingOptOut,p=r.scrollDirectionHorizontal,f=r.scrollDirectionVertical,h=r.instanceProps,g=this._initialScrollTop>0?this._initialScrollTop:r.scrollTop,S=this._initialScrollLeft>0?this._initialScrollLeft:r.scrollLeft,b=this._isScrolling(i,r);if(this._childrenToDisplay=[],c>0&&y>0){var w=h.columnSizeAndPositionManager.getVisibleCellRange({containerSize:y,offset:S}),k=h.rowSizeAndPositionManager.getVisibleCellRange({containerSize:c,offset:g}),C=h.columnSizeAndPositionManager.getOffsetAdjustment({containerSize:y,offset:S}),E=h.rowSizeAndPositionManager.getOffsetAdjustment({containerSize:c,offset:g});this._renderedColumnStartIndex=w.start,this._renderedColumnStopIndex=w.stop,this._renderedRowStartIndex=k.start,this._renderedRowStopIndex=k.stop;var x=u({direction:"horizontal",cellCount:o,overscanCellsCount:d,scrollDirection:p,startIndex:typeof w.start=="number"?w.start:0,stopIndex:typeof w.stop=="number"?w.stop:-1}),I=u({direction:"vertical",cellCount:v,overscanCellsCount:m,scrollDirection:f,startIndex:typeof k.start=="number"?k.start:0,stopIndex:typeof k.stop=="number"?k.stop:-1}),A=x.overscanStartIndex,P=x.overscanStopIndex,F=I.overscanStartIndex,B=I.overscanStopIndex;if(l){if(!l.hasFixedHeight()){for(var j=F;j<=B;j++)if(!l.has(j,0)){A=0,P=o-1;break}}if(!l.hasFixedWidth()){for(var X=A;X<=P;X++)if(!l.has(0,X)){F=0,B=v-1;break}}}this._childrenToDisplay=a({cellCache:this._cellCache,cellRenderer:s,columnSizeAndPositionManager:h.columnSizeAndPositionManager,columnStartIndex:A,columnStopIndex:P,deferredMeasurementCache:l,horizontalOffsetAdjustment:C,isScrolling:b,isScrollingOptOut:_,parent:this,rowSizeAndPositionManager:h.rowSizeAndPositionManager,rowStartIndex:F,rowStopIndex:B,scrollLeft:S,scrollTop:g,styleCache:this._styleCache,verticalOffsetAdjustment:E,visibleColumnIndices:w,visibleRowIndices:k}),this._columnStartIndex=A,this._columnStopIndex=P,this._rowStartIndex=F,this._rowStopIndex=B}}},{key:"_debounceScrollEnded",value:function(){var i=this.props.scrollingResetTimeInterval;this._disablePointerEventsTimeoutId&&ia(this._disablePointerEventsTimeoutId),this._disablePointerEventsTimeoutId=Ym(this._debounceScrollEndedCallback,i)}},{key:"_handleInvalidatedGridSize",value:function(){if(typeof this._deferredInvalidateColumnIndex=="number"&&typeof this._deferredInvalidateRowIndex=="number"){var i=this._deferredInvalidateColumnIndex,r=this._deferredInvalidateRowIndex;this._deferredInvalidateColumnIndex=null,this._deferredInvalidateRowIndex=null,this.recomputeGridSize({columnIndex:i,rowIndex:r})}}},{key:"_invokeOnScrollMemoizer",value:function(i){var r=this,s=i.scrollLeft,a=i.scrollTop,o=i.totalColumnsWidth,l=i.totalRowsHeight;this._onScrollMemoizer({callback:function(d){var u=d.scrollLeft,m=d.scrollTop,v=r.props,y=v.height,_=v.onScroll,p=v.width;_({clientHeight:y,clientWidth:p,scrollHeight:l,scrollLeft:u,scrollTop:m,scrollWidth:o})},indices:{scrollLeft:s,scrollTop:a}})}},{key:"_isScrolling",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.state;return Object.hasOwnProperty.call(i,"isScrolling")?!!i.isScrolling:!!r.isScrolling}},{key:"_maybeCallOnScrollbarPresenceChange",value:function(){if(this._scrollbarPresenceChanged){var i=this.props.onScrollbarPresenceChange;this._scrollbarPresenceChanged=!1,i({horizontal:this._horizontalScrollBarSize>0,size:this.state.instanceProps.scrollbarSize,vertical:this._verticalScrollBarSize>0})}}},{key:"scrollToPosition",value:function(i){var r=i.scrollLeft,s=i.scrollTop,a=e._getScrollToPositionStateUpdate({prevState:this.state,scrollLeft:r,scrollTop:s});a&&(a.needToResetStyleCache=!1,this.setState(a))}},{key:"_getCalculatedScrollLeft",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.state;return e._getCalculatedScrollLeft(i,r)}},{key:"_updateScrollLeftForScrollToColumn",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.state,s=e._getScrollLeftForScrollToColumnStateUpdate(i,r);s&&(s.needToResetStyleCache=!1,this.setState(s))}},{key:"_getCalculatedScrollTop",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.state;return e._getCalculatedScrollTop(i,r)}},{key:"_resetStyleCache",value:function(){var i=this._styleCache,r=this._cellCache,s=this.props.isScrollingOptOut;this._cellCache={},this._styleCache={};for(var a=this._rowStartIndex;a<=this._rowStopIndex;a++)for(var o=this._columnStartIndex;o<=this._columnStopIndex;o++){var l="".concat(a,"-").concat(o);this._styleCache[l]=i[l],s&&(this._cellCache[l]=r[l])}}},{key:"_updateScrollTopForScrollToRow",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props,r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:this.state,s=e._getScrollTopForScrollToRowStateUpdate(i,r);s&&(s.needToResetStyleCache=!1,this.setState(s))}}],[{key:"getDerivedStateFromProps",value:function(i,r){var s={};i.columnCount===0&&r.scrollLeft!==0||i.rowCount===0&&r.scrollTop!==0?(s.scrollLeft=0,s.scrollTop=0):(i.scrollLeft!==r.scrollLeft&&i.scrollToColumn<0||i.scrollTop!==r.scrollTop&&i.scrollToRow<0)&&Object.assign(s,e._getScrollToPositionStateUpdate({prevState:r,scrollLeft:i.scrollLeft,scrollTop:i.scrollTop}));var a=r.instanceProps;s.needToResetStyleCache=!1,(i.columnWidth!==a.prevColumnWidth||i.rowHeight!==a.prevRowHeight)&&(s.needToResetStyleCache=!0),a.columnSizeAndPositionManager.configure({cellCount:i.columnCount,estimatedCellSize:e._getEstimatedColumnSize(i),cellSizeGetter:e._wrapSizeGetter(i.columnWidth)}),a.rowSizeAndPositionManager.configure({cellCount:i.rowCount,estimatedCellSize:e._getEstimatedRowSize(i),cellSizeGetter:e._wrapSizeGetter(i.rowHeight)}),(a.prevColumnCount===0||a.prevRowCount===0)&&(a.prevColumnCount=0,a.prevRowCount=0),i.autoHeight&&i.isScrolling===!1&&a.prevIsScrolling===!0&&Object.assign(s,{isScrolling:!1});var o,l;return t_({cellCount:a.prevColumnCount,cellSize:typeof a.prevColumnWidth=="number"?a.prevColumnWidth:null,computeMetadataCallback:function(){return a.columnSizeAndPositionManager.resetCell(0)},computeMetadataCallbackProps:i,nextCellsCount:i.columnCount,nextCellSize:typeof i.columnWidth=="number"?i.columnWidth:null,nextScrollToIndex:i.scrollToColumn,scrollToIndex:a.prevScrollToColumn,updateScrollOffsetForScrollToIndex:function(){o=e._getScrollLeftForScrollToColumnStateUpdate(i,r)}}),t_({cellCount:a.prevRowCount,cellSize:typeof a.prevRowHeight=="number"?a.prevRowHeight:null,computeMetadataCallback:function(){return a.rowSizeAndPositionManager.resetCell(0)},computeMetadataCallbackProps:i,nextCellsCount:i.rowCount,nextCellSize:typeof i.rowHeight=="number"?i.rowHeight:null,nextScrollToIndex:i.scrollToRow,scrollToIndex:a.prevScrollToRow,updateScrollOffsetForScrollToIndex:function(){l=e._getScrollTopForScrollToRowStateUpdate(i,r)}}),a.prevColumnCount=i.columnCount,a.prevColumnWidth=i.columnWidth,a.prevIsScrolling=i.isScrolling===!0,a.prevRowCount=i.rowCount,a.prevRowHeight=i.rowHeight,a.prevScrollToColumn=i.scrollToColumn,a.prevScrollToRow=i.scrollToRow,a.scrollbarSize=i.getScrollbarSize(),a.scrollbarSize===void 0?(a.scrollbarSizeMeasured=!1,a.scrollbarSize=0):a.scrollbarSizeMeasured=!0,s.instanceProps=a,zt(zt(zt({},s),o),l)}},{key:"_getEstimatedColumnSize",value:function(i){return typeof i.columnWidth=="number"?i.columnWidth:i.estimatedColumnSize}},{key:"_getEstimatedRowSize",value:function(i){return typeof i.rowHeight=="number"?i.rowHeight:i.estimatedRowSize}},{key:"_getScrollToPositionStateUpdate",value:function(i){var r=i.prevState,s=i.scrollLeft,a=i.scrollTop,o={scrollPositionChangeReason:Ih.REQUESTED};return typeof s=="number"&&s>=0&&(o.scrollDirectionHorizontal=s>r.scrollLeft?Ii:wc,o.scrollLeft=s),typeof a=="number"&&a>=0&&(o.scrollDirectionVertical=a>r.scrollTop?Ii:wc,o.scrollTop=a),typeof s=="number"&&s>=0&&s!==r.scrollLeft||typeof a=="number"&&a>=0&&a!==r.scrollTop?o:{}}},{key:"_wrapSizeGetter",value:function(i){return typeof i=="function"?i:function(){return i}}},{key:"_getCalculatedScrollLeft",value:function(i,r){var s=i.columnCount,a=i.height,o=i.scrollToAlignment,l=i.scrollToColumn,c=i.width,d=r.scrollLeft,u=r.instanceProps;if(s>0){var m=s-1,v=l<0?m:Math.min(m,l),y=u.rowSizeAndPositionManager.getTotalSize(),_=u.scrollbarSizeMeasured&&y>a?u.scrollbarSize:0;return u.columnSizeAndPositionManager.getUpdatedOffsetForIndex({align:o,containerSize:c-_,currentOffset:d,targetIndex:v})}return 0}},{key:"_getScrollLeftForScrollToColumnStateUpdate",value:function(i,r){var s=r.scrollLeft,a=e._getCalculatedScrollLeft(i,r);return typeof a=="number"&&a>=0&&s!==a?e._getScrollToPositionStateUpdate({prevState:r,scrollLeft:a,scrollTop:-1}):{}}},{key:"_getCalculatedScrollTop",value:function(i,r){var s=i.height,a=i.rowCount,o=i.scrollToAlignment,l=i.scrollToRow,c=i.width,d=r.scrollTop,u=r.instanceProps;if(a>0){var m=a-1,v=l<0?m:Math.min(m,l),y=u.columnSizeAndPositionManager.getTotalSize(),_=u.scrollbarSizeMeasured&&y>c?u.scrollbarSize:0;return u.rowSizeAndPositionManager.getUpdatedOffsetForIndex({align:o,containerSize:s-_,currentOffset:d,targetIndex:v})}return 0}},{key:"_getScrollTopForScrollToRowStateUpdate",value:function(i,r){var s=r.scrollTop,a=e._getCalculatedScrollTop(i,r);return typeof a=="number"&&a>=0&&s!==a?e._getScrollToPositionStateUpdate({prevState:r,scrollLeft:-1,scrollTop:a}):{}}}])}(T.PureComponent);W(qr,"defaultProps",{"aria-label":"grid","aria-readonly":!0,autoContainerWidth:!1,autoHeight:!1,autoWidth:!1,cellRangeRenderer:T5,containerRole:"row",containerStyle:{},estimatedColumnSize:100,estimatedRowSize:30,getScrollbarSize:yp,noContentRenderer:L5,onScroll:function(){},onScrollbarPresenceChange:function(){},onSectionRendered:function(){},overscanColumnCount:0,overscanIndicesGetter:E5,overscanRowCount:10,role:"grid",scrollingResetTimeInterval:I5,scrollToAlignment:"auto",scrollToColumn:-1,scrollToRow:-1,style:{},tabIndex:0,isScrollingOptOut:!1});Jl(qr);var M5=1;function S1(t){var e=t.cellCount,n=t.overscanCellsCount,i=t.scrollDirection,r=t.startIndex,s=t.stopIndex;return n=Math.max(1,n),i===M5?{overscanStartIndex:Math.max(0,r-1),overscanStopIndex:Math.min(e-1,s+n)}:{overscanStartIndex:Math.max(0,r-n),overscanStopIndex:Math.min(e-1,s+1)}}function Sp(t,e){(e==null||e>t.length)&&(e=t.length);for(var n=0,i=Array(e);n<e;n++)i[n]=t[n];return i}function D5(t){if(Array.isArray(t))return Sp(t)}function A5(t){if(typeof Symbol<"u"&&t[Symbol.iterator]!=null||t["@@iterator"]!=null)return Array.from(t)}function C1(t,e){if(t){if(typeof t=="string")return Sp(t,e);var n={}.toString.call(t).slice(8,-1);return n==="Object"&&t.constructor&&(n=t.constructor.name),n==="Map"||n==="Set"?Array.from(t):n==="Arguments"||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(n)?Sp(t,e):void 0}}function N5(){throw new TypeError(`Invalid attempt to spread non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function B5(t){return D5(t)||A5(t)||C1(t)||N5()}function F5(t,e,n){return e=be(e),Bt(t,b1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function b1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(b1=function(){return!!t})()}var w1=function(t){function e(n,i){var r;return Je(this,e),r=F5(this,e,[n,i]),r._loadMoreRowsMemoizer=na(),r._onRowsRendered=r._onRowsRendered.bind(r),r._registerChild=r._registerChild.bind(r),r}return Ft(e,t),Ke(e,[{key:"resetLoadMoreRowsCache",value:function(i){this._loadMoreRowsMemoizer=na(),i&&this._doStuff(this._lastRenderedStartIndex,this._lastRenderedStopIndex)}},{key:"render",value:function(){var i=this.props.children;return i({onRowsRendered:this._onRowsRendered,registerChild:this._registerChild})}},{key:"_loadUnloadedRanges",value:function(i){var r=this,s=this.props.loadMoreRows;i.forEach(function(a){var o=s(a);o&&o.then(function(){U5({lastRenderedStartIndex:r._lastRenderedStartIndex,lastRenderedStopIndex:r._lastRenderedStopIndex,startIndex:a.startIndex,stopIndex:a.stopIndex})&&r._registeredChild&&H5(r._registeredChild,r._lastRenderedStartIndex)})})}},{key:"_onRowsRendered",value:function(i){var r=i.startIndex,s=i.stopIndex;this._lastRenderedStartIndex=r,this._lastRenderedStopIndex=s,this._doStuff(r,s)}},{key:"_doStuff",value:function(i,r){var s,a=this,o=this.props,l=o.isRowLoaded,c=o.minimumBatchSize,d=o.rowCount,u=o.threshold,m=z5({isRowLoaded:l,minimumBatchSize:c,rowCount:d,startIndex:Math.max(0,i-u),stopIndex:Math.min(d-1,r+u)}),v=(s=[]).concat.apply(s,B5(m.map(function(y){var _=y.startIndex,p=y.stopIndex;return[_,p]})));this._loadMoreRowsMemoizer({callback:function(){a._loadUnloadedRanges(m)},indices:{squashedUnloadedRanges:v}})}},{key:"_registerChild",value:function(i){this._registeredChild=i}}])}(T.PureComponent);W(w1,"defaultProps",{minimumBatchSize:10,rowCount:0,threshold:15});w1.propTypes={};function U5(t){var e=t.lastRenderedStartIndex,n=t.lastRenderedStopIndex,i=t.startIndex,r=t.stopIndex;return!(i>n||r<e)}function z5(t){for(var e=t.isRowLoaded,n=t.minimumBatchSize,i=t.rowCount,r=t.startIndex,s=t.stopIndex,a=[],o=null,l=null,c=r;c<=s;c++){var d=e({index:c});d?l!==null&&(a.push({startIndex:o,stopIndex:l}),o=l=null):(l=c,o===null&&(o=c))}if(l!==null){for(var u=Math.min(Math.max(l,o+n-1),i-1),m=l+1;m<=u&&!e({index:m});m++)l=m;a.push({startIndex:o,stopIndex:l})}if(a.length)for(var v=a[0];v.stopIndex-v.startIndex+1<n&&v.startIndex>0;){var y=v.startIndex-1;if(!e({index:y}))v.startIndex=y;else break}return a}function H5(t){var e=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0,n=typeof t.recomputeGridSize=="function"?t.recomputeGridSize:t.recomputeRowHeights;n?n.call(t,e):t.forceUpdate()}function j5(t,e,n){return e=be(e),Bt(t,k1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function k1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(k1=function(){return!!t})()}var E1=function(t){function e(){var n;Je(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=j5(this,e,[].concat(r)),W(n,"Grid",void 0),W(n,"_cellRenderer",function(a){var o=a.parent,l=a.rowIndex,c=a.style,d=a.isScrolling,u=a.isVisible,m=a.key,v=n.props.rowRenderer,y=Object.getOwnPropertyDescriptor(c,"width");return y&&y.writable&&(c.width="100%"),v({index:l,style:c,isScrolling:d,isVisible:u,key:m,parent:o})}),W(n,"_setRef",function(a){n.Grid=a}),W(n,"_onScroll",function(a){var o=a.clientHeight,l=a.scrollHeight,c=a.scrollTop,d=n.props.onScroll;d({clientHeight:o,scrollHeight:l,scrollTop:c})}),W(n,"_onSectionRendered",function(a){var o=a.rowOverscanStartIndex,l=a.rowOverscanStopIndex,c=a.rowStartIndex,d=a.rowStopIndex,u=n.props.onRowsRendered;u({overscanStartIndex:o,overscanStopIndex:l,startIndex:c,stopIndex:d})}),n}return Ft(e,t),Ke(e,[{key:"forceUpdateGrid",value:function(){this.Grid&&this.Grid.forceUpdate()}},{key:"getOffsetForRow",value:function(i){var r=i.alignment,s=i.index;if(this.Grid){var a=this.Grid.getOffsetForCell({alignment:r,rowIndex:s,columnIndex:0}),o=a.scrollTop;return o}return 0}},{key:"invalidateCellSizeAfterRender",value:function(i){var r=i.columnIndex,s=i.rowIndex;this.Grid&&this.Grid.invalidateCellSizeAfterRender({rowIndex:s,columnIndex:r})}},{key:"measureAllRows",value:function(){this.Grid&&this.Grid.measureAllCells()}},{key:"recomputeGridSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=i.columnIndex,s=r===void 0?0:r,a=i.rowIndex,o=a===void 0?0:a;this.Grid&&this.Grid.recomputeGridSize({rowIndex:o,columnIndex:s})}},{key:"recomputeRowHeights",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.Grid&&this.Grid.recomputeGridSize({rowIndex:i,columnIndex:0})}},{key:"scrollToPosition",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.Grid&&this.Grid.scrollToPosition({scrollTop:i})}},{key:"scrollToRow",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.Grid&&this.Grid.scrollToCell({columnIndex:0,rowIndex:i})}},{key:"render",value:function(){var i=this.props,r=i.className,s=i.noRowsRenderer,a=i.scrollToIndex,o=i.width,l=Dn("ReactVirtualized__List",r);return T.createElement(qr,yn({},this.props,{autoContainerWidth:!0,cellRenderer:this._cellRenderer,className:l,columnWidth:o,columnCount:1,noContentRenderer:s,onScroll:this._onScroll,onSectionRendered:this._onSectionRendered,ref:this._setRef,scrollToRow:a}))}}])}(T.PureComponent);W(E1,"defaultProps",{autoHeight:!1,estimatedRowSize:30,onScroll:function(){},noRowsRenderer:function(){return null},onRowsRendered:function(){},overscanIndicesGetter:S1,overscanRowCount:10,scrollToAlignment:"auto",scrollToIndex:-1,style:{}});function W5(t){if(Array.isArray(t))return t}function $5(t,e){var n=t==null?null:typeof Symbol<"u"&&t[Symbol.iterator]||t["@@iterator"];if(n!=null){var i,r,s,a,o=[],l=!0,c=!1;try{if(s=(n=n.call(t)).next,e===0){if(Object(n)!==n)return;l=!1}else for(;!(l=(i=s.call(n)).done)&&(o.push(i.value),o.length!==e);l=!0);}catch(d){c=!0,r=d}finally{try{if(!l&&n.return!=null&&(a=n.return(),Object(a)!==a))return}finally{if(c)throw r}}return o}}function V5(){throw new TypeError(`Invalid attempt to destructure non-iterable instance.
In order to be iterable, non-array objects must have a [Symbol.iterator]() method.`)}function G5(t,e){return W5(t)||$5(t,e)||C1(t,e)||V5()}function q5(t,e,n,i){for(var r=n+1;e<=n;){var s=e+n>>>1,a=t[s];a>=i?(r=s,n=s-1):e=s+1}return r}function J5(t,e,n,i,r){for(var s=n+1;e<=n;){var a=e+n>>>1,o=t[a];r(o,i)>=0?(s=a,n=a-1):e=a+1}return s}function K5(t,e,n,i,r){return typeof n=="function"?J5(t,i===void 0?0:i|0,r===void 0?t.length-1:r|0,e,n):q5(t,n===void 0?0:n|0,i===void 0?t.length-1:i|0,e)}function Q5(t,e,n,i){for(var r=n+1;e<=n;){var s=e+n>>>1,a=t[s];a>i?(r=s,n=s-1):e=s+1}return r}function X5(t,e,n,i,r){for(var s=n+1;e<=n;){var a=e+n>>>1,o=t[a];r(o,i)>0?(s=a,n=a-1):e=a+1}return s}function Y5(t,e,n,i,r){return typeof n=="function"?X5(t,i===void 0?0:i|0,r===void 0?t.length-1:r|0,e,n):Q5(t,n===void 0?0:n|0,i===void 0?t.length-1:i|0,e)}function Z5(t,e,n,i){for(var r=e-1;e<=n;){var s=e+n>>>1,a=t[s];a<i?(r=s,e=s+1):n=s-1}return r}function e3(t,e,n,i,r){for(var s=e-1;e<=n;){var a=e+n>>>1,o=t[a];r(o,i)<0?(s=a,e=a+1):n=a-1}return s}function t3(t,e,n,i,r){return typeof n=="function"?e3(t,i===void 0?0:i|0,r===void 0?t.length-1:r|0,e,n):Z5(t,n===void 0?0:n|0,i===void 0?t.length-1:i|0,e)}function n3(t,e,n,i){for(var r=e-1;e<=n;){var s=e+n>>>1,a=t[s];a<=i?(r=s,e=s+1):n=s-1}return r}function i3(t,e,n,i,r){for(var s=e-1;e<=n;){var a=e+n>>>1,o=t[a];r(o,i)<=0?(s=a,e=a+1):n=a-1}return s}function r3(t,e,n,i,r){return typeof n=="function"?i3(t,i===void 0?0:i|0,r===void 0?t.length-1:r|0,e,n):n3(t,n===void 0?0:n|0,i===void 0?t.length-1:i|0,e)}function s3(t,e,n,i){for(;e<=n;){var r=e+n>>>1,s=t[r];if(s===i)return r;s<=i?e=r+1:n=r-1}return-1}function o3(t,e,n,i,r){for(;e<=n;){var s=e+n>>>1,a=t[s],o=r(a,i);if(o===0)return s;o<=0?e=s+1:n=s-1}return-1}function a3(t,e,n,i,r){return typeof n=="function"?o3(t,i===void 0?0:i|0,r===void 0?t.length-1:r|0,e,n):s3(t,n===void 0?0:n|0,i===void 0?t.length-1:i|0,e)}const Wu={ge:K5,gt:Y5,lt:t3,le:r3,eq:a3};var _o=0,bs=1,Yc=2;function Zm(t,e,n,i,r){this.mid=t,this.left=e,this.right=n,this.leftPoints=i,this.rightPoints=r,this.count=(e?e.count:0)+(n?n.count:0)+i.length}var Kl=Zm.prototype;function Lh(t,e){t.mid=e.mid,t.left=e.left,t.right=e.right,t.leftPoints=e.leftPoints,t.rightPoints=e.rightPoints,t.count=e.count}function T1(t,e){var n=ra(e);t.mid=n.mid,t.left=n.left,t.right=n.right,t.leftPoints=n.leftPoints,t.rightPoints=n.rightPoints,t.count=n.count}function o_(t,e){var n=t.intervals([]);n.push(e),T1(t,n)}function a_(t,e){var n=t.intervals([]),i=n.indexOf(e);return i<0?_o:(n.splice(i,1),T1(t,n),bs)}Kl.intervals=function(t){return t.push.apply(t,this.leftPoints),this.left&&this.left.intervals(t),this.right&&this.right.intervals(t),t};Kl.insert=function(t){var e=this.count-this.leftPoints.length;if(this.count+=1,t[1]<this.mid)this.left?4*(this.left.count+1)>3*(e+1)?o_(this,t):this.left.insert(t):this.left=ra([t]);else if(t[0]>this.mid)this.right?4*(this.right.count+1)>3*(e+1)?o_(this,t):this.right.insert(t):this.right=ra([t]);else{var n=Wu.ge(this.leftPoints,t,eg),i=Wu.ge(this.rightPoints,t,tg);this.leftPoints.splice(n,0,t),this.rightPoints.splice(i,0,t)}};Kl.remove=function(t){var e=this.count-this.leftPoints;if(t[1]<this.mid){if(!this.left)return _o;var n=this.right?this.right.count:0;if(4*n>3*(e-1))return a_(this,t);var i=this.left.remove(t);return i===Yc?(this.left=null,this.count-=1,bs):(i===bs&&(this.count-=1),i)}else if(t[0]>this.mid){if(!this.right)return _o;var r=this.left?this.left.count:0;if(4*r>3*(e-1))return a_(this,t);var i=this.right.remove(t);return i===Yc?(this.right=null,this.count-=1,bs):(i===bs&&(this.count-=1),i)}else{if(this.count===1)return this.leftPoints[0]===t?Yc:_o;if(this.leftPoints.length===1&&this.leftPoints[0]===t){if(this.left&&this.right){for(var s=this,a=this.left;a.right;)s=a,a=a.right;if(s===this)a.right=this.right;else{var o=this.left,i=this.right;s.count-=a.count,s.right=a.left,a.left=o,a.right=i}Lh(this,a),this.count=(this.left?this.left.count:0)+(this.right?this.right.count:0)+this.leftPoints.length}else this.left?Lh(this,this.left):Lh(this,this.right);return bs}for(var o=Wu.ge(this.leftPoints,t,eg);o<this.leftPoints.length&&this.leftPoints[o][0]===t[0];++o)if(this.leftPoints[o]===t){this.count-=1,this.leftPoints.splice(o,1);for(var i=Wu.ge(this.rightPoints,t,tg);i<this.rightPoints.length&&this.rightPoints[i][1]===t[1];++i)if(this.rightPoints[i]===t)return this.rightPoints.splice(i,1),bs}return _o}};function R1(t,e,n){for(var i=0;i<t.length&&t[i][0]<=e;++i){var r=n(t[i]);if(r)return r}}function x1(t,e,n){for(var i=t.length-1;i>=0&&t[i][1]>=e;--i){var r=n(t[i]);if(r)return r}}function P1(t,e){for(var n=0;n<t.length;++n){var i=e(t[n]);if(i)return i}}Kl.queryPoint=function(t,e){if(t<this.mid){if(this.left){var n=this.left.queryPoint(t,e);if(n)return n}return R1(this.leftPoints,t,e)}else if(t>this.mid){if(this.right){var n=this.right.queryPoint(t,e);if(n)return n}return x1(this.rightPoints,t,e)}else return P1(this.leftPoints,e)};Kl.queryInterval=function(t,e,n){if(t<this.mid&&this.left){var i=this.left.queryInterval(t,e,n);if(i)return i}if(e>this.mid&&this.right){var i=this.right.queryInterval(t,e,n);if(i)return i}return e<this.mid?R1(this.leftPoints,e,n):t>this.mid?x1(this.rightPoints,t,n):P1(this.leftPoints,n)};function l3(t,e){return t-e}function eg(t,e){var n=t[0]-e[0];return n||t[1]-e[1]}function tg(t,e){var n=t[1]-e[1];return n||t[0]-e[0]}function ra(t){if(t.length===0)return null;for(var e=[],n=0;n<t.length;++n)e.push(t[n][0],t[n][1]);e.sort(l3);for(var i=e[e.length>>1],r=[],s=[],a=[],n=0;n<t.length;++n){var o=t[n];o[1]<i?r.push(o):i<o[0]?s.push(o):a.push(o)}var l=a,c=a.slice();return l.sort(eg),c.sort(tg),new Zm(i,ra(r),ra(s),l,c)}function Cp(t){this.root=t}var pa=Cp.prototype;pa.insert=function(t){this.root?this.root.insert(t):this.root=new Zm(t[0],null,null,[t],[t])};pa.remove=function(t){if(this.root){var e=this.root.remove(t);return e===Yc&&(this.root=null),e!==_o}return!1};pa.queryPoint=function(t,e){if(this.root)return this.root.queryPoint(t,e)};pa.queryInterval=function(t,e,n){if(t<=e&&this.root)return this.root.queryInterval(t,e,n)};Object.defineProperty(pa,"count",{get:function(){return this.root?this.root.count:0}});Object.defineProperty(pa,"intervals",{get:function(){return this.root?this.root.intervals([]):[]}});function c3(t){return!t||t.length===0?new Cp(null):new Cp(ra(t))}var Mh=function(){function t(){Je(this,t),W(this,"_columnSizeMap",{}),W(this,"_intervalTree",c3()),W(this,"_leftMap",{})}return Ke(t,[{key:"estimateTotalHeight",value:function(n,i,r){var s=n-this.count;return this.tallestColumnSize+Math.ceil(s/i)*r}},{key:"range",value:function(n,i,r){var s=this;this._intervalTree.queryInterval(n,n+i,function(a){var o=G5(a,3),l=o[0];o[1];var c=o[2];return r(c,s._leftMap[c],l)})}},{key:"setPosition",value:function(n,i,r,s){this._intervalTree.insert([r,r+s,n]),this._leftMap[n]=i;var a=this._columnSizeMap,o=a[i];o===void 0?a[i]=r+s:a[i]=Math.max(o,r+s)}},{key:"count",get:function(){return this._intervalTree.count}},{key:"shortestColumnSize",get:function(){var n=this._columnSizeMap,i=0;for(var r in n){var s=n[r];i=i===0?s:Math.min(i,s)}return i}},{key:"tallestColumnSize",get:function(){var n=this._columnSizeMap,i=0;for(var r in n){var s=n[r];i=Math.max(i,s)}return i}}])}();function l_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function u3(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?l_(Object(n),!0).forEach(function(i){W(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):l_(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function d3(t,e,n){return e=be(e),Bt(t,O1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function O1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(O1=function(){return!!t})()}var h3={},f3=150,I1=function(t){function e(){var n;Je(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=d3(this,e,[].concat(r)),W(n,"state",{isScrolling:!1,scrollTop:0}),W(n,"_debounceResetIsScrollingId",void 0),W(n,"_invalidateOnUpdateStartIndex",null),W(n,"_invalidateOnUpdateStopIndex",null),W(n,"_positionCache",new Mh),W(n,"_startIndex",null),W(n,"_startIndexMemoized",null),W(n,"_stopIndex",null),W(n,"_stopIndexMemoized",null),W(n,"_debounceResetIsScrollingCallback",function(){n.setState({isScrolling:!1})}),W(n,"_setScrollingContainerRef",function(a){n._scrollingContainer=a}),W(n,"_onScroll",function(a){var o=n.props.height,l=a.currentTarget.scrollTop,c=Math.min(Math.max(0,n._getEstimatedTotalHeight()-o),l);l===c&&(n._debounceResetIsScrolling(),n.state.scrollTop!==c&&n.setState({isScrolling:!0,scrollTop:c}))}),n}return Ft(e,t),Ke(e,[{key:"clearCellPositions",value:function(){this._positionCache=new Mh,this.forceUpdate()}},{key:"invalidateCellSizeAfterRender",value:function(i){var r=i.rowIndex;this._invalidateOnUpdateStartIndex===null?(this._invalidateOnUpdateStartIndex=r,this._invalidateOnUpdateStopIndex=r):(this._invalidateOnUpdateStartIndex=Math.min(this._invalidateOnUpdateStartIndex,r),this._invalidateOnUpdateStopIndex=Math.max(this._invalidateOnUpdateStopIndex,r))}},{key:"recomputeCellPositions",value:function(){var i=this._positionCache.count-1;this._positionCache=new Mh,this._populatePositionCache(0,i),this.forceUpdate()}},{key:"componentDidMount",value:function(){this._checkInvalidateOnUpdate(),this._invokeOnScrollCallback(),this._invokeOnCellsRenderedCallback()}},{key:"componentDidUpdate",value:function(i,r){this._checkInvalidateOnUpdate(),this._invokeOnScrollCallback(),this._invokeOnCellsRenderedCallback(),this.props.scrollTop!==i.scrollTop&&this._debounceResetIsScrolling()}},{key:"componentWillUnmount",value:function(){this._debounceResetIsScrollingId&&ia(this._debounceResetIsScrollingId)}},{key:"render",value:function(){var i=this,r=this.props,s=r.autoHeight,a=r.cellCount,o=r.cellMeasurerCache,l=r.cellRenderer,c=r.className,d=r.height,u=r.id,m=r.keyMapper,v=r.overscanByPixels,y=r.role,_=r.style,p=r.tabIndex,f=r.width,h=r.rowDirection,g=this.state,S=g.isScrolling,b=g.scrollTop,w=[],k=this._getEstimatedTotalHeight(),C=this._positionCache.shortestColumnSize,E=this._positionCache.count,x=0,I;if(this._positionCache.range(Math.max(0,b-v),d+v*2,function(F,B,j){typeof I>"u"?(x=F,I=F):(x=Math.min(x,F),I=Math.max(I,F)),w.push(l({index:F,isScrolling:S,key:m(F),parent:i,style:W(W(W(W({height:o.getHeight(F)},h==="ltr"?"left":"right",B),"position","absolute"),"top",j),"width",o.getWidth(F))}))}),C<b+d+v&&E<a)for(var A=Math.min(a-E,Math.ceil((b+d+v-C)/o.defaultHeight*f/o.defaultWidth)),P=E;P<E+A;P++)I=P,w.push(l({index:P,isScrolling:S,key:m(P),parent:this,style:{width:o.getWidth(P)}}));return this._startIndex=x,this._stopIndex=I,T.createElement("div",{ref:this._setScrollingContainerRef,"aria-label":this.props["aria-label"],className:Dn("ReactVirtualized__Masonry",c),id:u,onScroll:this._onScroll,role:y,style:u3({boxSizing:"border-box",direction:"ltr",height:s?"auto":d,overflowX:"hidden",overflowY:k<d?"hidden":"auto",position:"relative",width:f,WebkitOverflowScrolling:"touch",willChange:"transform"},_),tabIndex:p},T.createElement("div",{className:"ReactVirtualized__Masonry__innerScrollContainer",style:{width:"100%",height:k,maxWidth:"100%",maxHeight:k,overflow:"hidden",pointerEvents:S?"none":"",position:"relative"}},w))}},{key:"_checkInvalidateOnUpdate",value:function(){if(typeof this._invalidateOnUpdateStartIndex=="number"){var i=this._invalidateOnUpdateStartIndex,r=this._invalidateOnUpdateStopIndex;this._invalidateOnUpdateStartIndex=null,this._invalidateOnUpdateStopIndex=null,this._populatePositionCache(i,r),this.forceUpdate()}}},{key:"_debounceResetIsScrolling",value:function(){var i=this.props.scrollingResetTimeInterval;this._debounceResetIsScrollingId&&ia(this._debounceResetIsScrollingId),this._debounceResetIsScrollingId=Ym(this._debounceResetIsScrollingCallback,i)}},{key:"_getEstimatedTotalHeight",value:function(){var i=this.props,r=i.cellCount,s=i.cellMeasurerCache,a=i.width,o=Math.max(1,Math.floor(a/s.defaultWidth));return this._positionCache.estimateTotalHeight(r,o,s.defaultHeight)}},{key:"_invokeOnScrollCallback",value:function(){var i=this.props,r=i.height,s=i.onScroll,a=this.state.scrollTop;this._onScrollMemoized!==a&&(s({clientHeight:r,scrollHeight:this._getEstimatedTotalHeight(),scrollTop:a}),this._onScrollMemoized=a)}},{key:"_invokeOnCellsRenderedCallback",value:function(){if(this._startIndexMemoized!==this._startIndex||this._stopIndexMemoized!==this._stopIndex){var i=this.props.onCellsRendered;i({startIndex:this._startIndex,stopIndex:this._stopIndex}),this._startIndexMemoized=this._startIndex,this._stopIndexMemoized=this._stopIndex}}},{key:"_populatePositionCache",value:function(i,r){for(var s=this.props,a=s.cellMeasurerCache,o=s.cellPositioner,l=i;l<=r;l++){var c=o(l),d=c.left,u=c.top;this._positionCache.setPosition(l,d,u,a.getHeight(l))}}}],[{key:"getDerivedStateFromProps",value:function(i,r){return i.scrollTop!==void 0&&r.scrollTop!==i.scrollTop?{isScrolling:!0,scrollTop:i.scrollTop}:null}}])}(T.PureComponent);W(I1,"defaultProps",{autoHeight:!1,keyMapper:p3,onCellsRendered:c_,onScroll:c_,overscanByPixels:20,role:"grid",scrollingResetTimeInterval:f3,style:h3,tabIndex:0,rowDirection:"ltr"});function p3(t){return t}function c_(){}Jl(I1);var Dh=function(){function t(){var e=this,n=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{};Je(this,t),W(this,"_cellMeasurerCache",void 0),W(this,"_columnIndexOffset",void 0),W(this,"_rowIndexOffset",void 0),W(this,"columnWidth",function(l){var c=l.index;e._cellMeasurerCache.columnWidth({index:c+e._columnIndexOffset})}),W(this,"rowHeight",function(l){var c=l.index;e._cellMeasurerCache.rowHeight({index:c+e._rowIndexOffset})});var i=n.cellMeasurerCache,r=n.columnIndexOffset,s=r===void 0?0:r,a=n.rowIndexOffset,o=a===void 0?0:a;this._cellMeasurerCache=i,this._columnIndexOffset=s,this._rowIndexOffset=o}return Ke(t,[{key:"clear",value:function(n,i){this._cellMeasurerCache.clear(n+this._rowIndexOffset,i+this._columnIndexOffset)}},{key:"clearAll",value:function(){this._cellMeasurerCache.clearAll()}},{key:"defaultHeight",get:function(){return this._cellMeasurerCache.defaultHeight}},{key:"defaultWidth",get:function(){return this._cellMeasurerCache.defaultWidth}},{key:"hasFixedHeight",value:function(){return this._cellMeasurerCache.hasFixedHeight()}},{key:"hasFixedWidth",value:function(){return this._cellMeasurerCache.hasFixedWidth()}},{key:"getHeight",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this._cellMeasurerCache.getHeight(n+this._rowIndexOffset,i+this._columnIndexOffset)}},{key:"getWidth",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this._cellMeasurerCache.getWidth(n+this._rowIndexOffset,i+this._columnIndexOffset)}},{key:"has",value:function(n){var i=arguments.length>1&&arguments[1]!==void 0?arguments[1]:0;return this._cellMeasurerCache.has(n+this._rowIndexOffset,i+this._columnIndexOffset)}},{key:"set",value:function(n,i,r,s){this._cellMeasurerCache.set(n+this._rowIndexOffset,i+this._columnIndexOffset,r,s)}}])}(),m3=["rowIndex"],g3=["columnIndex","rowIndex"],v3=["columnIndex"],_3=["onScroll","onSectionRendered","onScrollbarPresenceChange","scrollLeft","scrollToColumn","scrollTop","scrollToRow"];function u_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Re(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?u_(Object(n),!0).forEach(function(i){W(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):u_(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function y3(t,e,n){return e=be(e),Bt(t,L1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function L1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(L1=function(){return!!t})()}var d_=20,ng=function(t){function e(n,i){var r;Je(this,e),r=y3(this,e,[n,i]),W(r,"state",{scrollLeft:0,scrollTop:0,scrollbarSize:0,showHorizontalScrollbar:!1,showVerticalScrollbar:!1}),W(r,"_deferredInvalidateColumnIndex",null),W(r,"_deferredInvalidateRowIndex",null),W(r,"_bottomLeftGridRef",function(l){r._bottomLeftGrid=l}),W(r,"_bottomRightGridRef",function(l){r._bottomRightGrid=l}),W(r,"_cellRendererBottomLeftGrid",function(l){var c=l.rowIndex,d=Wa(l,m3),u=r.props,m=u.cellRenderer,v=u.fixedRowCount,y=u.rowCount;return c===y-v?T.createElement("div",{key:d.key,style:Re(Re({},d.style),{},{height:d_})}):m(Re(Re({},d),{},{parent:r,rowIndex:c+v}))}),W(r,"_cellRendererBottomRightGrid",function(l){var c=l.columnIndex,d=l.rowIndex,u=Wa(l,g3),m=r.props,v=m.cellRenderer,y=m.fixedColumnCount,_=m.fixedRowCount;return v(Re(Re({},u),{},{columnIndex:c+y,parent:r,rowIndex:d+_}))}),W(r,"_cellRendererTopRightGrid",function(l){var c=l.columnIndex,d=Wa(l,v3),u=r.props,m=u.cellRenderer,v=u.columnCount,y=u.fixedColumnCount;return c===v-y?T.createElement("div",{key:d.key,style:Re(Re({},d.style),{},{width:d_})}):m(Re(Re({},d),{},{columnIndex:c+y,parent:r}))}),W(r,"_columnWidthRightGrid",function(l){var c=l.index,d=r.props,u=d.columnCount,m=d.fixedColumnCount,v=d.columnWidth,y=r.state,_=y.scrollbarSize,p=y.showHorizontalScrollbar;return p&&c===u-m?_:typeof v=="function"?v({index:c+m}):v}),W(r,"_onScroll",function(l){var c=l.scrollLeft,d=l.scrollTop;r.setState({scrollLeft:c,scrollTop:d});var u=r.props.onScroll;u&&u(l)}),W(r,"_onScrollbarPresenceChange",function(l){var c=l.horizontal,d=l.size,u=l.vertical,m=r.state,v=m.showHorizontalScrollbar,y=m.showVerticalScrollbar;if(c!==v||u!==y){r.setState({scrollbarSize:d,showHorizontalScrollbar:c,showVerticalScrollbar:u});var _=r.props.onScrollbarPresenceChange;typeof _=="function"&&_({horizontal:c,size:d,vertical:u})}}),W(r,"_onScrollLeft",function(l){var c=l.scrollLeft;r._onScroll({scrollLeft:c,scrollTop:r.state.scrollTop})}),W(r,"_onScrollTop",function(l){var c=l.scrollTop;r._onScroll({scrollTop:c,scrollLeft:r.state.scrollLeft})}),W(r,"_rowHeightBottomGrid",function(l){var c=l.index,d=r.props,u=d.fixedRowCount,m=d.rowCount,v=d.rowHeight,y=r.state,_=y.scrollbarSize,p=y.showVerticalScrollbar;return p&&c===m-u?_:typeof v=="function"?v({index:c+u}):v}),W(r,"_topLeftGridRef",function(l){r._topLeftGrid=l}),W(r,"_topRightGridRef",function(l){r._topRightGrid=l});var s=n.deferredMeasurementCache,a=n.fixedColumnCount,o=n.fixedRowCount;return r._maybeCalculateCachedStyles(!0),s&&(r._deferredMeasurementCacheBottomLeftGrid=o>0?new Dh({cellMeasurerCache:s,columnIndexOffset:0,rowIndexOffset:o}):s,r._deferredMeasurementCacheBottomRightGrid=a>0||o>0?new Dh({cellMeasurerCache:s,columnIndexOffset:a,rowIndexOffset:o}):s,r._deferredMeasurementCacheTopRightGrid=a>0?new Dh({cellMeasurerCache:s,columnIndexOffset:a,rowIndexOffset:0}):s),r}return Ft(e,t),Ke(e,[{key:"forceUpdateGrids",value:function(){this._bottomLeftGrid&&this._bottomLeftGrid.forceUpdate(),this._bottomRightGrid&&this._bottomRightGrid.forceUpdate(),this._topLeftGrid&&this._topLeftGrid.forceUpdate(),this._topRightGrid&&this._topRightGrid.forceUpdate()}},{key:"invalidateCellSizeAfterRender",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=i.columnIndex,s=r===void 0?0:r,a=i.rowIndex,o=a===void 0?0:a;this._deferredInvalidateColumnIndex=typeof this._deferredInvalidateColumnIndex=="number"?Math.min(this._deferredInvalidateColumnIndex,s):s,this._deferredInvalidateRowIndex=typeof this._deferredInvalidateRowIndex=="number"?Math.min(this._deferredInvalidateRowIndex,o):o}},{key:"measureAllCells",value:function(){this._bottomLeftGrid&&this._bottomLeftGrid.measureAllCells(),this._bottomRightGrid&&this._bottomRightGrid.measureAllCells(),this._topLeftGrid&&this._topLeftGrid.measureAllCells(),this._topRightGrid&&this._topRightGrid.measureAllCells()}},{key:"recomputeGridSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=i.columnIndex,s=r===void 0?0:r,a=i.rowIndex,o=a===void 0?0:a,l=this.props,c=l.fixedColumnCount,d=l.fixedRowCount,u=Math.max(0,s-c),m=Math.max(0,o-d);this._bottomLeftGrid&&this._bottomLeftGrid.recomputeGridSize({columnIndex:s,rowIndex:m}),this._bottomRightGrid&&this._bottomRightGrid.recomputeGridSize({columnIndex:u,rowIndex:m}),this._topLeftGrid&&this._topLeftGrid.recomputeGridSize({columnIndex:s,rowIndex:o}),this._topRightGrid&&this._topRightGrid.recomputeGridSize({columnIndex:u,rowIndex:o}),this._leftGridWidth=null,this._topGridHeight=null,this._maybeCalculateCachedStyles(!0)}},{key:"componentDidMount",value:function(){var i=this.props,r=i.scrollLeft,s=i.scrollTop;if(r>0||s>0){var a={};r>0&&(a.scrollLeft=r),s>0&&(a.scrollTop=s),this.setState(a)}this._handleInvalidatedGridSize()}},{key:"componentDidUpdate",value:function(){this._handleInvalidatedGridSize()}},{key:"render",value:function(){var i=this.props,r=i.onScroll,s=i.onSectionRendered;i.onScrollbarPresenceChange,i.scrollLeft;var a=i.scrollToColumn;i.scrollTop;var o=i.scrollToRow,l=Wa(i,_3);if(this._prepareForRender(),this.props.width===0||this.props.height===0)return null;var c=this.state,d=c.scrollLeft,u=c.scrollTop;return T.createElement("div",{style:this._containerOuterStyle},T.createElement("div",{style:this._containerTopStyle},this._renderTopLeftGrid(l),this._renderTopRightGrid(Re(Re({},l),{},{onScroll:r,scrollLeft:d}))),T.createElement("div",{style:this._containerBottomStyle},this._renderBottomLeftGrid(Re(Re({},l),{},{onScroll:r,scrollTop:u})),this._renderBottomRightGrid(Re(Re({},l),{},{onScroll:r,onSectionRendered:s,scrollLeft:d,scrollToColumn:a,scrollToRow:o,scrollTop:u}))))}},{key:"_getBottomGridHeight",value:function(i){var r=i.height,s=this._getTopGridHeight(i);return r-s}},{key:"_getLeftGridWidth",value:function(i){var r=i.fixedColumnCount,s=i.columnWidth;if(this._leftGridWidth==null)if(typeof s=="function"){for(var a=0,o=0;o<r;o++)a+=s({index:o});this._leftGridWidth=a}else this._leftGridWidth=s*r;return this._leftGridWidth}},{key:"_getRightGridWidth",value:function(i){var r=i.width,s=this._getLeftGridWidth(i);return r-s}},{key:"_getTopGridHeight",value:function(i){var r=i.fixedRowCount,s=i.rowHeight;if(this._topGridHeight==null)if(typeof s=="function"){for(var a=0,o=0;o<r;o++)a+=s({index:o});this._topGridHeight=a}else this._topGridHeight=s*r;return this._topGridHeight}},{key:"_handleInvalidatedGridSize",value:function(){if(typeof this._deferredInvalidateColumnIndex=="number"){var i=this._deferredInvalidateColumnIndex,r=this._deferredInvalidateRowIndex;this._deferredInvalidateColumnIndex=null,this._deferredInvalidateRowIndex=null,this.recomputeGridSize({columnIndex:i,rowIndex:r}),this.forceUpdate()}}},{key:"_maybeCalculateCachedStyles",value:function(i){var r=this.props,s=r.columnWidth,a=r.enableFixedColumnScroll,o=r.enableFixedRowScroll,l=r.height,c=r.fixedColumnCount,d=r.fixedRowCount,u=r.rowHeight,m=r.style,v=r.styleBottomLeftGrid,y=r.styleBottomRightGrid,_=r.styleTopLeftGrid,p=r.styleTopRightGrid,f=r.width,h=i||l!==this._lastRenderedHeight||f!==this._lastRenderedWidth,g=i||s!==this._lastRenderedColumnWidth||c!==this._lastRenderedFixedColumnCount,S=i||d!==this._lastRenderedFixedRowCount||u!==this._lastRenderedRowHeight;(i||h||m!==this._lastRenderedStyle)&&(this._containerOuterStyle=Re({height:l,overflow:"visible",width:f},m)),(i||h||S)&&(this._containerTopStyle={height:this._getTopGridHeight(this.props),position:"relative",width:f},this._containerBottomStyle={height:l-this._getTopGridHeight(this.props),overflow:"visible",position:"relative",width:f}),(i||v!==this._lastRenderedStyleBottomLeftGrid)&&(this._bottomLeftGridStyle=Re({left:0,overflowX:"hidden",overflowY:a?"auto":"hidden",position:"absolute"},v)),(i||g||y!==this._lastRenderedStyleBottomRightGrid)&&(this._bottomRightGridStyle=Re({left:this._getLeftGridWidth(this.props),position:"absolute"},y)),(i||_!==this._lastRenderedStyleTopLeftGrid)&&(this._topLeftGridStyle=Re({left:0,overflowX:"hidden",overflowY:"hidden",position:"absolute",top:0},_)),(i||g||p!==this._lastRenderedStyleTopRightGrid)&&(this._topRightGridStyle=Re({left:this._getLeftGridWidth(this.props),overflowX:o?"auto":"hidden",overflowY:"hidden",position:"absolute",top:0},p)),this._lastRenderedColumnWidth=s,this._lastRenderedFixedColumnCount=c,this._lastRenderedFixedRowCount=d,this._lastRenderedHeight=l,this._lastRenderedRowHeight=u,this._lastRenderedStyle=m,this._lastRenderedStyleBottomLeftGrid=v,this._lastRenderedStyleBottomRightGrid=y,this._lastRenderedStyleTopLeftGrid=_,this._lastRenderedStyleTopRightGrid=p,this._lastRenderedWidth=f}},{key:"_prepareForRender",value:function(){(this._lastRenderedColumnWidth!==this.props.columnWidth||this._lastRenderedFixedColumnCount!==this.props.fixedColumnCount)&&(this._leftGridWidth=null),(this._lastRenderedFixedRowCount!==this.props.fixedRowCount||this._lastRenderedRowHeight!==this.props.rowHeight)&&(this._topGridHeight=null),this._maybeCalculateCachedStyles(),this._lastRenderedColumnWidth=this.props.columnWidth,this._lastRenderedFixedColumnCount=this.props.fixedColumnCount,this._lastRenderedFixedRowCount=this.props.fixedRowCount,this._lastRenderedRowHeight=this.props.rowHeight}},{key:"_renderBottomLeftGrid",value:function(i){var r=i.enableFixedColumnScroll,s=i.fixedColumnCount,a=i.fixedRowCount,o=i.rowCount,l=i.hideBottomLeftGridScrollbar,c=this.state.showVerticalScrollbar;if(!s)return null;var d=c?1:0,u=this._getBottomGridHeight(i),m=this._getLeftGridWidth(i),v=this.state.showVerticalScrollbar?this.state.scrollbarSize:0,y=l?m+v:m,_=T.createElement(qr,yn({},i,{cellRenderer:this._cellRendererBottomLeftGrid,className:this.props.classNameBottomLeftGrid,columnCount:s,deferredMeasurementCache:this._deferredMeasurementCacheBottomLeftGrid,height:u,onScroll:r?this._onScrollTop:void 0,ref:this._bottomLeftGridRef,rowCount:Math.max(0,o-a)+d,rowHeight:this._rowHeightBottomGrid,style:this._bottomLeftGridStyle,tabIndex:null,width:y}));return l?T.createElement("div",{className:"BottomLeftGrid_ScrollWrapper",style:Re(Re({},this._bottomLeftGridStyle),{},{height:u,width:m,overflowY:"hidden"})},_):_}},{key:"_renderBottomRightGrid",value:function(i){var r=i.columnCount,s=i.fixedColumnCount,a=i.fixedRowCount,o=i.rowCount,l=i.scrollToColumn,c=i.scrollToRow;return T.createElement(qr,yn({},i,{cellRenderer:this._cellRendererBottomRightGrid,className:this.props.classNameBottomRightGrid,columnCount:Math.max(0,r-s),columnWidth:this._columnWidthRightGrid,deferredMeasurementCache:this._deferredMeasurementCacheBottomRightGrid,height:this._getBottomGridHeight(i),onScroll:this._onScroll,onScrollbarPresenceChange:this._onScrollbarPresenceChange,ref:this._bottomRightGridRef,rowCount:Math.max(0,o-a),rowHeight:this._rowHeightBottomGrid,scrollToColumn:l-s,scrollToRow:c-a,style:this._bottomRightGridStyle,width:this._getRightGridWidth(i)}))}},{key:"_renderTopLeftGrid",value:function(i){var r=i.fixedColumnCount,s=i.fixedRowCount;return!r||!s?null:T.createElement(qr,yn({},i,{className:this.props.classNameTopLeftGrid,columnCount:r,height:this._getTopGridHeight(i),ref:this._topLeftGridRef,rowCount:s,style:this._topLeftGridStyle,tabIndex:null,width:this._getLeftGridWidth(i)}))}},{key:"_renderTopRightGrid",value:function(i){var r=i.columnCount,s=i.enableFixedRowScroll,a=i.fixedColumnCount,o=i.fixedRowCount,l=i.scrollLeft,c=i.hideTopRightGridScrollbar,d=this.state,u=d.showHorizontalScrollbar,m=d.scrollbarSize;if(!o)return null;var v=u?1:0,y=this._getTopGridHeight(i),_=this._getRightGridWidth(i),p=u?m:0,f=y,h=this._topRightGridStyle;c&&(f=y+p,h=Re(Re({},this._topRightGridStyle),{},{left:0}));var g=T.createElement(qr,yn({},i,{cellRenderer:this._cellRendererTopRightGrid,className:this.props.classNameTopRightGrid,columnCount:Math.max(0,r-a)+v,columnWidth:this._columnWidthRightGrid,deferredMeasurementCache:this._deferredMeasurementCacheTopRightGrid,height:f,onScroll:s?this._onScrollLeft:void 0,ref:this._topRightGridRef,rowCount:o,scrollLeft:l,style:h,tabIndex:null,width:_}));return c?T.createElement("div",{className:"TopRightGrid_ScrollWrapper",style:Re(Re({},this._topRightGridStyle),{},{height:y,width:_,overflowX:"hidden"})},g):g}}],[{key:"getDerivedStateFromProps",value:function(i,r){return i.scrollLeft!==r.scrollLeft||i.scrollTop!==r.scrollTop?{scrollLeft:i.scrollLeft!=null&&i.scrollLeft>=0?i.scrollLeft:r.scrollLeft,scrollTop:i.scrollTop!=null&&i.scrollTop>=0?i.scrollTop:r.scrollTop}:null}}])}(T.PureComponent);W(ng,"defaultProps",{classNameBottomLeftGrid:"",classNameBottomRightGrid:"",classNameTopLeftGrid:"",classNameTopRightGrid:"",enableFixedColumnScroll:!1,enableFixedRowScroll:!1,fixedColumnCount:0,fixedRowCount:0,scrollToColumn:-1,scrollToRow:-1,style:{},styleBottomLeftGrid:{},styleBottomRightGrid:{},styleTopLeftGrid:{},styleTopRightGrid:{},hideTopRightGridScrollbar:!1,hideBottomLeftGridScrollbar:!1});ng.propTypes={};Jl(ng);function S3(t,e,n){return e=be(e),Bt(t,M1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function M1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(M1=function(){return!!t})()}var C3=function(t){function e(n,i){var r;return Je(this,e),r=S3(this,e,[n,i]),r.state={clientHeight:0,clientWidth:0,scrollHeight:0,scrollLeft:0,scrollTop:0,scrollWidth:0},r._onScroll=r._onScroll.bind(r),r}return Ft(e,t),Ke(e,[{key:"render",value:function(){var i=this.props.children,r=this.state,s=r.clientHeight,a=r.clientWidth,o=r.scrollHeight,l=r.scrollLeft,c=r.scrollTop,d=r.scrollWidth;return i({clientHeight:s,clientWidth:a,onScroll:this._onScroll,scrollHeight:o,scrollLeft:l,scrollTop:c,scrollWidth:d})}},{key:"_onScroll",value:function(i){var r=i.clientHeight,s=i.clientWidth,a=i.scrollHeight,o=i.scrollLeft,l=i.scrollTop,c=i.scrollWidth;this.setState({clientHeight:r,clientWidth:s,scrollHeight:a,scrollLeft:o,scrollTop:l,scrollWidth:c})}}])}(T.PureComponent);C3.propTypes={};function b3(t){var e=t.dataKey,n=t.rowData;return typeof n.get=="function"?n.get(e):n[e]}function w3(t){var e=t.cellData;return e==null?"":String(e)}function k3(t){var e=t.className,n=t.columns,i=t.style;return T.createElement("div",{className:e,role:"row",style:i},n)}var Jr={ASC:"ASC",DESC:"DESC"};function D1(t){var e=t.sortDirection,n=Dn("ReactVirtualized__Table__sortableHeaderIcon",{"ReactVirtualized__Table__sortableHeaderIcon--ASC":e===Jr.ASC,"ReactVirtualized__Table__sortableHeaderIcon--DESC":e===Jr.DESC});return T.createElement("svg",{className:n,width:18,height:18,viewBox:"0 0 24 24"},e===Jr.ASC?T.createElement("path",{d:"M7 14l5-5 5 5z"}):T.createElement("path",{d:"M7 10l5 5 5-5z"}),T.createElement("path",{d:"M0 0h24v24H0z",fill:"none"}))}D1.propTypes={};function E3(t){var e=t.dataKey,n=t.label,i=t.sortBy,r=t.sortDirection,s=i===e,a=[T.createElement("span",{className:"ReactVirtualized__Table__headerTruncatedText",key:"label",title:typeof n=="string"?n:null},n)];return s&&a.push(T.createElement(D1,{key:"SortIndicator",sortDirection:r})),a}function T3(t){var e=t.className,n=t.columns,i=t.index,r=t.key,s=t.onRowClick,a=t.onRowDoubleClick,o=t.onRowMouseOut,l=t.onRowMouseOver,c=t.onRowRightClick,d=t.rowData,u=t.style,m={"aria-rowindex":i+1};return(s||a||o||l||c)&&(m["aria-label"]="row",m.tabIndex=0,s&&(m.onClick=function(v){return s({event:v,index:i,rowData:d})}),a&&(m.onDoubleClick=function(v){return a({event:v,index:i,rowData:d})}),o&&(m.onMouseOut=function(v){return o({event:v,index:i,rowData:d})}),l&&(m.onMouseOver=function(v){return l({event:v,index:i,rowData:d})}),c&&(m.onContextMenu=function(v){return c({event:v,index:i,rowData:d})})),T.createElement("div",yn({},m,{className:e,key:r,role:"row",style:u}),n)}function R3(t,e,n){return e=be(e),Bt(t,A1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function A1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(A1=function(){return!!t})()}var ig=function(t){function e(){return Je(this,e),R3(this,e,arguments)}return Ft(e,t),Ke(e)}(T.Component);W(ig,"defaultProps",{cellDataGetter:b3,cellRenderer:w3,defaultSortDirection:Jr.ASC,flexGrow:0,flexShrink:1,headerRenderer:E3,style:{}});ig.propTypes={};function h_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function Zn(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?h_(Object(n),!0).forEach(function(i){W(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):h_(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function x3(t,e,n){return e=be(e),Bt(t,N1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function N1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(N1=function(){return!!t})()}var B1=function(t){function e(n){var i;return Je(this,e),i=x3(this,e,[n]),i.state={scrollbarWidth:0},i._createColumn=i._createColumn.bind(i),i._createRow=i._createRow.bind(i),i._onScroll=i._onScroll.bind(i),i._onSectionRendered=i._onSectionRendered.bind(i),i._setRef=i._setRef.bind(i),i._setGridElementRef=i._setGridElementRef.bind(i),i}return Ft(e,t),Ke(e,[{key:"forceUpdateGrid",value:function(){this.Grid&&this.Grid.forceUpdate()}},{key:"getOffsetForRow",value:function(i){var r=i.alignment,s=i.index;if(this.Grid){var a=this.Grid.getOffsetForCell({alignment:r,rowIndex:s}),o=a.scrollTop;return o}return 0}},{key:"invalidateCellSizeAfterRender",value:function(i){var r=i.columnIndex,s=i.rowIndex;this.Grid&&this.Grid.invalidateCellSizeAfterRender({rowIndex:s,columnIndex:r})}},{key:"measureAllRows",value:function(){this.Grid&&this.Grid.measureAllCells()}},{key:"recomputeGridSize",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:{},r=i.columnIndex,s=r===void 0?0:r,a=i.rowIndex,o=a===void 0?0:a;this.Grid&&this.Grid.recomputeGridSize({rowIndex:o,columnIndex:s})}},{key:"recomputeRowHeights",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.Grid&&this.Grid.recomputeGridSize({rowIndex:i})}},{key:"scrollToPosition",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.Grid&&this.Grid.scrollToPosition({scrollTop:i})}},{key:"scrollToRow",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:0;this.Grid&&this.Grid.scrollToCell({columnIndex:0,rowIndex:i})}},{key:"getScrollbarWidth",value:function(){if(this.GridElement){var i=this.GridElement,r=i.clientWidth||0,s=i.offsetWidth||0;return s-r}return 0}},{key:"componentDidMount",value:function(){this._setScrollbarWidth()}},{key:"componentDidUpdate",value:function(){this._setScrollbarWidth()}},{key:"render",value:function(){var i=this,r=this.props,s=r.children,a=r.className,o=r.disableHeader,l=r.gridClassName,c=r.gridStyle,d=r.headerHeight,u=r.headerRowRenderer,m=r.height,v=r.id,y=r.noRowsRenderer,_=r.rowClassName,p=r.rowStyle,f=r.scrollToIndex,h=r.style,g=r.width,S=this.state.scrollbarWidth,b=o?m:m-d,w=typeof _=="function"?_({index:-1}):_,k=typeof p=="function"?p({index:-1}):p;return this._cachedColumnStyles=[],T.Children.toArray(s).forEach(function(C,E){var x=i._getFlexStyleForColumn(C,C.props.style||ig.defaultProps.style);i._cachedColumnStyles[E]=Zn({overflow:"hidden"},x)}),T.createElement("div",{"aria-label":this.props["aria-label"],"aria-labelledby":this.props["aria-labelledby"],"aria-colcount":T.Children.toArray(s).length,"aria-rowcount":this.props.rowCount,className:Dn("ReactVirtualized__Table",a),id:v,role:"grid",style:h},!o&&u({className:Dn("ReactVirtualized__Table__headerRow",w),columns:this._getHeaderColumns(),style:Zn({height:d,overflow:"hidden",paddingRight:S,width:g},k)}),T.createElement(qr,yn({},this.props,{elementRef:this._setGridElementRef,"aria-readonly":null,autoContainerWidth:!0,className:Dn("ReactVirtualized__Table__Grid",l),cellRenderer:this._createRow,columnWidth:g,columnCount:1,height:b,id:void 0,noContentRenderer:y,onScroll:this._onScroll,onSectionRendered:this._onSectionRendered,ref:this._setRef,role:"rowgroup",scrollbarWidth:S,scrollToRow:f,style:Zn(Zn({},c),{},{overflowX:"hidden"})})))}},{key:"_createColumn",value:function(i){var r=i.column,s=i.columnIndex,a=i.isScrolling,o=i.parent,l=i.rowData,c=i.rowIndex,d=this.props.onColumnClick,u=r.props,m=u.cellDataGetter,v=u.cellRenderer,y=u.className,_=u.columnData,p=u.dataKey,f=u.id,h=m({columnData:_,dataKey:p,rowData:l}),g=v({cellData:h,columnData:_,columnIndex:s,dataKey:p,isScrolling:a,parent:o,rowData:l,rowIndex:c}),S=function(C){d&&d({columnData:_,dataKey:p,event:C})},b=this._cachedColumnStyles[s],w=typeof g=="string"?g:null;return T.createElement("div",{"aria-colindex":s+1,"aria-describedby":f,className:Dn("ReactVirtualized__Table__rowColumn",y),key:"Row"+c+"-Col"+s,onClick:S,role:"gridcell",style:b,title:w},g)}},{key:"_createHeader",value:function(i){var r=i.column,s=i.index,a=this.props,o=a.headerClassName,l=a.headerStyle,c=a.onHeaderClick,d=a.sort,u=a.sortBy,m=a.sortDirection,v=r.props,y=v.columnData,_=v.dataKey,p=v.defaultSortDirection,f=v.disableSort,h=v.headerRenderer,g=v.id,S=v.label,b=!f&&d,w=Dn("ReactVirtualized__Table__headerColumn",o,r.props.headerClassName,{ReactVirtualized__Table__sortableHeaderColumn:b}),k=this._getFlexStyleForColumn(r,Zn(Zn({},l),r.props.headerStyle)),C=h({columnData:y,dataKey:_,disableSort:f,label:S,sortBy:u,sortDirection:m}),E,x,I,A,P;if(b||c){var F=u!==_,B=F?p:m===Jr.DESC?Jr.ASC:Jr.DESC,j=function(R){b&&d({defaultSortDirection:p,event:R,sortBy:_,sortDirection:B}),c&&c({columnData:y,dataKey:_,event:R})},X=function(R){(R.key==="Enter"||R.key===" ")&&j(R)};P=r.props["aria-label"]||S||_,A="none",I=0,E=j,x=X}return u===_&&(A=m===Jr.ASC?"ascending":"descending"),T.createElement("div",{"aria-label":P,"aria-sort":A,className:w,id:g,key:"Header-Col"+s,onClick:E,onKeyDown:x,role:"columnheader",style:k,tabIndex:I},C)}},{key:"_createRow",value:function(i){var r=this,s=i.rowIndex,a=i.isScrolling,o=i.key,l=i.parent,c=i.style,d=this.props,u=d.children,m=d.onRowClick,v=d.onRowDoubleClick,y=d.onRowRightClick,_=d.onRowMouseOver,p=d.onRowMouseOut,f=d.rowClassName,h=d.rowGetter,g=d.rowRenderer,S=d.rowStyle,b=this.state.scrollbarWidth,w=typeof f=="function"?f({index:s}):f,k=typeof S=="function"?S({index:s}):S,C=h({index:s}),E=T.Children.toArray(u).map(function(A,P){return r._createColumn({column:A,columnIndex:P,isScrolling:a,parent:l,rowData:C,rowIndex:s,scrollbarWidth:b})}),x=Dn("ReactVirtualized__Table__row",w),I=Zn(Zn({},c),{},{height:this._getRowHeight(s),overflow:"hidden",paddingRight:b},k);return g({className:x,columns:E,index:s,isScrolling:a,key:o,onRowClick:m,onRowDoubleClick:v,onRowRightClick:y,onRowMouseOver:_,onRowMouseOut:p,rowData:C,style:I})}},{key:"_getFlexStyleForColumn",value:function(i){var r=arguments.length>1&&arguments[1]!==void 0?arguments[1]:{},s="".concat(i.props.flexGrow," ").concat(i.props.flexShrink," ").concat(i.props.width,"px"),a=Zn(Zn({},r),{},{flex:s,msFlex:s,WebkitFlex:s});return i.props.maxWidth&&(a.maxWidth=i.props.maxWidth),i.props.minWidth&&(a.minWidth=i.props.minWidth),a}},{key:"_getHeaderColumns",value:function(){var i=this,r=this.props,s=r.children,a=r.disableHeader,o=a?[]:T.Children.toArray(s);return o.map(function(l,c){return i._createHeader({column:l,index:c})})}},{key:"_getRowHeight",value:function(i){var r=this.props.rowHeight;return typeof r=="function"?r({index:i}):r}},{key:"_onScroll",value:function(i){var r=i.clientHeight,s=i.scrollHeight,a=i.scrollTop,o=this.props.onScroll;o({clientHeight:r,scrollHeight:s,scrollTop:a})}},{key:"_onSectionRendered",value:function(i){var r=i.rowOverscanStartIndex,s=i.rowOverscanStopIndex,a=i.rowStartIndex,o=i.rowStopIndex,l=this.props.onRowsRendered;l({overscanStartIndex:r,overscanStopIndex:s,startIndex:a,stopIndex:o})}},{key:"_setRef",value:function(i){this.Grid=i}},{key:"_setGridElementRef",value:function(i){this.GridElement=i}},{key:"_setScrollbarWidth",value:function(){var i=this.getScrollbarWidth();this.setState({scrollbarWidth:i})}}])}(T.PureComponent);W(B1,"defaultProps",{disableHeader:!1,estimatedRowSize:30,headerHeight:0,headerStyle:{},noRowsRenderer:function(){return null},onRowsRendered:function(){return null},onScroll:function(){return null},overscanIndicesGetter:S1,overscanRowCount:10,rowRenderer:T3,headerRowRenderer:k3,rowStyle:{},scrollToAlignment:"auto",scrollToIndex:-1,style:{}});B1.propTypes={};var ss=[],sl=null,Ds=null;function F1(){Ds&&(Ds=null,document.body&&sl!=null&&(document.body.style.pointerEvents=sl),sl=null)}function P3(){F1(),ss.forEach(function(t){return t.__resetIsScrolling()})}function O3(){Ds&&ia(Ds);var t=0;ss.forEach(function(e){t=Math.max(t,e.props.scrollingResetTimeInterval)}),Ds=Ym(P3,t)}function U1(t){t.currentTarget===window&&sl==null&&document.body&&(sl=document.body.style.pointerEvents,document.body.style.pointerEvents="none"),O3(),ss.forEach(function(e){e.props.scrollElement===t.currentTarget&&e.__handleWindowScrollEvent()})}function f_(t,e){ss.some(function(n){return n.props.scrollElement===e})||e.addEventListener("scroll",U1),ss.push(t)}function p_(t,e){ss=ss.filter(function(n){return n!==t}),ss.length||(e.removeEventListener("scroll",U1),Ds&&(ia(Ds),F1()))}var rg=function(e){return e===window},$a=function(e){return e.getBoundingClientRect()};function m_(t,e){if(t)if(rg(t)){var n=window,i=n.innerHeight,r=n.innerWidth;return{height:typeof i=="number"?i:0,width:typeof r=="number"?r:0}}else return $a(t);else return{height:e.serverHeight,width:e.serverWidth}}function I3(t,e){if(rg(e)&&document.documentElement){var n=document.documentElement,i=$a(t),r=$a(n);return{top:i.top-r.top,left:i.left-r.left}}else{var s=z1(e),a=$a(t),o=$a(e);return{top:a.top+s.top-o.top,left:a.left+s.left-o.left}}}function z1(t){return rg(t)&&document.documentElement?{top:"scrollY"in window?window.scrollY:document.documentElement.scrollTop,left:"scrollX"in window?window.scrollX:document.documentElement.scrollLeft}:{top:t.scrollTop,left:t.scrollLeft}}function g_(t,e){var n=Object.keys(t);if(Object.getOwnPropertySymbols){var i=Object.getOwnPropertySymbols(t);e&&(i=i.filter(function(r){return Object.getOwnPropertyDescriptor(t,r).enumerable})),n.push.apply(n,i)}return n}function v_(t){for(var e=1;e<arguments.length;e++){var n=arguments[e]!=null?arguments[e]:{};e%2?g_(Object(n),!0).forEach(function(i){W(t,i,n[i])}):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(n)):g_(Object(n)).forEach(function(i){Object.defineProperty(t,i,Object.getOwnPropertyDescriptor(n,i))})}return t}function L3(t,e,n){return e=be(e),Bt(t,H1()?Reflect.construct(e,n||[],be(t).constructor):e.apply(t,n))}function H1(){try{var t=!Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],function(){}))}catch{}return(H1=function(){return!!t})()}var M3=150,j1=function(){return typeof window<"u"?window:void 0},D3=function(t){function e(){var n;Je(this,e);for(var i=arguments.length,r=new Array(i),s=0;s<i;s++)r[s]=arguments[s];return n=L3(this,e,[].concat(r)),W(n,"_window",j1()),W(n,"_isMounted",!1),W(n,"_positionFromTop",0),W(n,"_positionFromLeft",0),W(n,"_detectElementResize",void 0),W(n,"_child",void 0),W(n,"_windowScrollerRef",T.createRef()),W(n,"state",v_(v_({},m_(n.props.scrollElement,n.props)),{},{isScrolling:!1,scrollLeft:0,scrollTop:0})),W(n,"_registerChild",function(a){a&&!(a instanceof Element)&&console.warn("WindowScroller registerChild expects to be passed Element or null"),n._child=a,n.updatePosition()}),W(n,"_onChildScroll",function(a){var o=a.scrollTop;if(n.state.scrollTop!==o){var l=n.props.scrollElement;l&&(typeof l.scrollTo=="function"?l.scrollTo(0,o+n._positionFromTop):l.scrollTop=o+n._positionFromTop)}}),W(n,"_registerResizeListener",function(a){a===window?window.addEventListener("resize",n._onResize,!1):n._detectElementResize.addResizeListener(a,n._onResize)}),W(n,"_unregisterResizeListener",function(a){a===window?window.removeEventListener("resize",n._onResize,!1):a&&n._detectElementResize.removeResizeListener(a,n._onResize)}),W(n,"_onResize",function(){n.updatePosition()}),W(n,"__handleWindowScrollEvent",function(){if(n._isMounted){var a=n.props.onScroll,o=n.props.scrollElement;if(o){var l=z1(o),c=Math.max(0,l.left-n._positionFromLeft),d=Math.max(0,l.top-n._positionFromTop);n.setState({isScrolling:!0,scrollLeft:c,scrollTop:d}),a({scrollLeft:c,scrollTop:d})}}}),W(n,"__resetIsScrolling",function(){n.setState({isScrolling:!1})}),n}return Ft(e,t),Ke(e,[{key:"updatePosition",value:function(){var i=arguments.length>0&&arguments[0]!==void 0?arguments[0]:this.props.scrollElement,r=this.props.onResize,s=this.state,a=s.height,o=s.width,l=this._child||this._windowScrollerRef.current;if(l instanceof Element&&i){var c=I3(l,i);this._positionFromTop=c.top,this._positionFromLeft=c.left}var d=m_(i,this.props);(a!==d.height||o!==d.width)&&(this.setState({height:d.height,width:d.width}),r({height:d.height,width:d.width})),this.props.updateScrollTopOnUpdatePosition===!0&&(this.__handleWindowScrollEvent(),this.__resetIsScrolling())}},{key:"componentDidMount",value:function(){var i=this.props.scrollElement;this._detectElementResize=d1(),this.updatePosition(i),i&&(f_(this,i),this._registerResizeListener(i)),this._isMounted=!0}},{key:"componentDidUpdate",value:function(i,r){var s=this.props.scrollElement,a=i.scrollElement;a!==s&&a!=null&&s!=null&&(this.updatePosition(s),p_(this,a),f_(this,s),this._unregisterResizeListener(a),this._registerResizeListener(s))}},{key:"componentWillUnmount",value:function(){var i=this.props.scrollElement;i&&(p_(this,i),this._unregisterResizeListener(i)),this._isMounted=!1}},{key:"render",value:function(){var i=this.props.children,r=this.state,s=r.isScrolling,a=r.scrollTop,o=r.scrollLeft,l=r.height,c=r.width;return T.createElement("div",{ref:this._windowScrollerRef},i({onChildScroll:this._onChildScroll,registerChild:this._registerChild,height:l,isScrolling:s,scrollLeft:o,scrollTop:a,width:c}))}}])}(T.PureComponent);W(D3,"defaultProps",{onResize:function(){},onScroll:function(){},scrollingResetTimeInterval:M3,scrollElement:j1(),serverHeight:0,serverWidth:0});var W1={color:void 0,size:void 0,className:void 0,style:void 0,attr:void 0},__=te.createContext&&te.createContext(W1),os=globalThis&&globalThis.__assign||function(){return os=Object.assign||function(t){for(var e,n=1,i=arguments.length;n<i;n++){e=arguments[n];for(var r in e)Object.prototype.hasOwnProperty.call(e,r)&&(t[r]=e[r])}return t},os.apply(this,arguments)},A3=globalThis&&globalThis.__rest||function(t,e){var n={};for(var i in t)Object.prototype.hasOwnProperty.call(t,i)&&e.indexOf(i)<0&&(n[i]=t[i]);if(t!=null&&typeof Object.getOwnPropertySymbols=="function")for(var r=0,i=Object.getOwnPropertySymbols(t);r<i.length;r++)e.indexOf(i[r])<0&&Object.prototype.propertyIsEnumerable.call(t,i[r])&&(n[i[r]]=t[i[r]]);return n};function $1(t){return t&&t.map(function(e,n){return te.createElement(e.tag,os({key:n},e.attr),$1(e.child))})}function ma(t){return function(e){return te.createElement(N3,os({attr:os({},t.attr)},e),$1(t.child))}}function N3(t){var e=function(n){var i=t.attr,r=t.size,s=t.title,a=A3(t,["attr","size","title"]),o=r||n.size||"1em",l;return n.className&&(l=n.className),t.className&&(l=(l?l+" ":"")+t.className),te.createElement("svg",os({stroke:"currentColor",fill:"currentColor",strokeWidth:"0"},n.attr,i,a,{className:l,style:os(os({color:t.color||n.color},n.style),t.style),height:o,width:o,xmlns:"http://www.w3.org/2000/svg"}),s&&te.createElement("title",null,s),t.children)};return __!==void 0?te.createElement(__.Consumer,null,function(n){return e(n)}):e(W1)}function B3(t){return ma({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M402.6 83.2l90.2 90.2c3.8 3.8 3.8 10 0 13.8L274.4 405.6l-92.8 10.3c-12.4 1.4-22.9-9.1-21.5-21.5l10.3-92.8L388.8 83.2c3.8-3.8 10-3.8 13.8 0zm162-22.9l-48.8-48.8c-15.2-15.2-39.9-15.2-55.2 0l-35.4 35.4c-3.8 3.8-3.8 10 0 13.8l90.2 90.2c3.8 3.8 10 3.8 13.8 0l35.4-35.4c15.2-15.3 15.2-40 0-55.2zM384 346.2V448H64V128h229.8c3.2 0 6.2-1.3 8.5-3.5l40-40c7.6-7.6 2.2-20.5-8.5-20.5H48C21.5 64 0 85.5 0 112v352c0 26.5 21.5 48 48 48h352c26.5 0 48-21.5 48-48V306.2c0-10.7-12.9-16-20.5-8.5l-40 40c-2.2 2.3-3.5 5.3-3.5 8.5z"}}]})(t)}function F3(t){return ma({tag:"svg",attr:{viewBox:"0 0 384 512"},child:[{tag:"path",attr:{d:"M224 136V0H24C10.7 0 0 10.7 0 24v464c0 13.3 10.7 24 24 24h336c13.3 0 24-10.7 24-24V160H248c-13.2 0-24-10.8-24-24zm160-14.1v6.1H256V0h6.1c6.4 0 12.5 2.5 17 7l97.9 98c4.5 4.5 7 10.6 7 16.9z"}}]})(t)}function U3(t){return ma({tag:"svg",attr:{viewBox:"0 0 576 512"},child:[{tag:"path",attr:{d:"M572.694 292.093L500.27 416.248A63.997 63.997 0 0 1 444.989 448H45.025c-18.523 0-30.064-20.093-20.731-36.093l72.424-124.155A64 64 0 0 1 152 256h399.964c18.523 0 30.064 20.093 20.73 36.093zM152 224h328v-48c0-26.51-21.49-48-48-48H272l-64-64H48C21.49 64 0 85.49 0 112v278.046l69.077-118.418C86.214 242.25 117.989 224 152 224z"}}]})(t)}function z3(t){return ma({tag:"svg",attr:{viewBox:"0 0 512 512"},child:[{tag:"path",attr:{d:"M464 128H272l-64-64H48C21.49 64 0 85.49 0 112v288c0 26.51 21.49 48 48 48h416c26.51 0 48-21.49 48-48V176c0-26.51-21.49-48-48-48z"}}]})(t)}function y_(t){return ma({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M416 208H272V64c0-17.67-14.33-32-32-32h-32c-17.67 0-32 14.33-32 32v144H32c-17.67 0-32 14.33-32 32v32c0 17.67 14.33 32 32 32h144v144c0 17.67 14.33 32 32 32h32c17.67 0 32-14.33 32-32V304h144c17.67 0 32-14.33 32-32v-32c0-17.67-14.33-32-32-32z"}}]})(t)}function H3(t){return ma({tag:"svg",attr:{viewBox:"0 0 448 512"},child:[{tag:"path",attr:{d:"M432 32H312l-9.4-18.7A24 24 0 0 0 281.1 0H166.8a23.72 23.72 0 0 0-21.4 13.3L136 32H16A16 16 0 0 0 0 48v32a16 16 0 0 0 16 16h416a16 16 0 0 0 16-16V48a16 16 0 0 0-16-16zM53.2 467a48 48 0 0 0 47.9 45h245.8a48 48 0 0 0 47.9-45L416 128H32z"}}]})(t)}const ga="/api/files",j3=async()=>{try{return(await _s.get(`${ga}`)).data.files}catch(t){throw console.error("Error listing files:",t),new Error("Failed to list files")}},W3=async t=>{try{return(await _s.get(`${ga}/content`,{params:{path:t}})).data}catch(e){throw console.error("Error getting file content:",e),new Error("Failed to get file content")}},$3=async(t,e="")=>{try{return(await _s.post(`${ga}`,{path:t,content:e})).data}catch(n){throw console.error("Error creating file:",n),new Error("Failed to create file")}},V3=async(t,e)=>{try{return(await _s.put(`${ga}`,{path:t,content:e})).data}catch(n){throw console.error("Error updating file:",n),new Error("Failed to update file")}},G3=async t=>{try{return(await _s.delete(`${ga}`,{params:{path:t}})).data}catch(e){throw console.error("Error deleting file:",e),new Error("Failed to delete file")}},q3=async(t,e)=>{try{return(await _s.put(`${ga}/rename`,{oldPath:t,newPath:e})).data}catch(n){throw console.error("Error renaming file:",n),new Error("Failed to rename file")}},J3=({onFileSelect:t,currentFilePath:e})=>{const[n,i]=T.useState([]),[r,s]=T.useState({}),[a,o]=T.useState(!0),[l,c]=T.useState(""),[d,u]=T.useState(""),[m,v]=T.useState(!1),[y,_]=T.useState(""),[p,f]=T.useState(null),[h,g]=T.useState("");T.useEffect(()=>{S()},[]);const S=async()=>{try{o(!0),c("");const B=await j3();i(B)}catch(B){c("Failed to load files"),console.error("Error loading files:",B)}finally{o(!1)}},b=B=>{s(j=>({...j,[B]:!j[B]}))},w=B=>{B.type==="file"?t(B.path):b(B.path)},k=B=>{_(B),v(!0),u("")},C=B=>{f(B),g(B.name)},E=async()=>{if(d)try{const B=y?`${y}/${d}`:d;await $3(B,""),await S(),v(!1),u("")}catch(B){c("Failed to create file"),console.error("Error creating file:",B)}},x=async B=>{try{await G3(B.path),await S()}catch(j){c("Failed to delete file"),console.error("Error deleting file:",j)}},I=async()=>{if(!(!h||!p))try{const j=p.path.substring(0,p.path.lastIndexOf("/")+1)+h;await q3(p.path,j),await S(),f(null),g("")}catch(B){c("Failed to rename file"),console.error("Error renaming file:",B)}},A=T.useCallback(()=>{const B=[],j=(X,U)=>{X.forEach(R=>{B.push({...R,level:U}),R.type==="directory"&&r[R.path]&&j(R.children||[],U+1)})};return j(n,0),B},[n,r]),P=({index:B,style:j})=>{const U=A()[B],R=U.level*20,M=e===U.path;return p&&p.path===U.path?te.createElement("div",{style:{...j,paddingLeft:`${R}px`},className:"file-row editing"},te.createElement("input",{type:"text",value:h,onChange:D=>g(D.target.value),onKeyDown:D=>D.key==="Enter"&&I(),autoFocus:!0}),te.createElement("button",{onClick:I,"aria-label":"Save"},"✓"),te.createElement("button",{onClick:()=>f(null),"aria-label":"Cancel"},"✕")):te.createElement("div",{style:{...j,paddingLeft:`${R}px`},className:`file-row ${M?"selected":""}`,onClick:()=>w(U)},U.type==="directory"?r[U.path]?te.createElement(U3,null):te.createElement(z3,null):te.createElement(F3,null),te.createElement("span",{className:"file-name"},U.name),te.createElement("div",{className:"file-actions"},U.type==="directory"&&te.createElement("button",{onClick:D=>{D.stopPropagation(),k(U.path)},"aria-label":"Create new file"},te.createElement(y_,null)),te.createElement("button",{onClick:D=>{D.stopPropagation(),C(U)},"aria-label":"Rename file"},te.createElement(B3,null)),te.createElement("button",{onClick:D=>{D.stopPropagation(),x(U)},"aria-label":"Delete file"},te.createElement(H3,null))))};if(a)return te.createElement("div",null,"Loading files...");if(l)return te.createElement("div",{className:"error-message"},l);const F=A();return te.createElement("div",{className:"file-explorer"},te.createElement("div",{className:"file-explorer-header"},te.createElement("h3",null,"Files"),te.createElement("button",{onClick:()=>k(""),"aria-label":"Create new file at root",className:"new-file-button"},te.createElement(y_,null)," New File"),te.createElement("button",{onClick:S,"aria-label":"Refresh files"},"↻")),m&&te.createElement("div",{className:"new-file-form"},te.createElement("input",{type:"text",value:d,onChange:B=>u(B.target.value),placeholder:"Enter file name",onKeyDown:B=>B.key==="Enter"&&E(),autoFocus:!0}),te.createElement("button",{onClick:E},"Create"),te.createElement("button",{onClick:()=>v(!1)},"Cancel")),te.createElement(E1,{width:300,height:500,rowCount:F.length,rowHeight:30,rowRenderer:P,overscanRowCount:10}))},K3=()=>{const t=window.WebSocket,e=3e3,n=5;window.WebSocket=function(i,r){const s=new t(i,r);s.reconnectAttempts=0;const a=()=>{if(s.reconnectAttempts>=n){console.error("Maximum reconnection attempts reached. Giving up.");return}s.reconnectAttempts++,console.log(`Attempting to reconnect (${s.reconnectAttempts}/${n})...`);const l=new t(i,r);l.onopen=s.onopen,l.onclose=s.onclose,l.onmessage=s.onmessage,l.onerror=s.onerror,l.addEventListener("open",()=>{Object.assign(s,l),s.reconnectAttempts=0,console.log("WebSocket reconnected successfully")}),l.addEventListener("close",c=>{c.wasClean||setTimeout(a,e)})},o=s.onclose;return s.addEventListener("close",l=>{o&&o.call(s,l),l.wasClean||setTimeout(a,e)}),s}};const Q3=()=>{const[t,e]=T.useState(""),[n,i]=T.useState(""),[r,s]=T.useState(!1),[a,o]=T.useState(null),[l,c]=T.useState(""),[d,u]=T.useState(""),[m,v]=T.useState("javascript"),[y,_]=T.useState("vs-dark"),[p,f]=T.useState(!0),[h,g]=T.useState(!0),[S,b]=T.useState(300);T.useEffect(()=>((async()=>{try{const F=await QA();u(F.sessionId)}catch(F){console.error("Failed to create terminal session:",F)}})(),K3(),()=>{}),[]),T.useEffect(()=>{a&&w(a)},[a]);const w=async P=>{try{const F=await W3(P);switch(c(F.content),P.split(".").pop().toLowerCase()){case"js":v("javascript");break;case"ts":case"tsx":v("typescript");break;case"py":v("python");break;case"json":v("json");break;case"html":v("html");break;case"css":v("css");break;case"md":v("markdown");break;default:v("javascript")}}catch(F){console.error("Failed to load file content:",F)}},k=P=>{o(P)},C=P=>{c(P)},E=async()=>{if(a)try{await V3(a,l),console.log("File saved successfully")}catch(P){console.error("Failed to save file:",P)}},x=()=>{t&&n&&s(!0)},I=()=>{f(!p)},A=()=>{g(!h)};return te.createElement("div",{className:"app-container"},r?te.createElement("div",{className:"workspace"},te.createElement("header",{className:"app-header"},te.createElement("h1",null,"PodPlai Studio"),te.createElement("div",{className:"header-controls"},te.createElement("button",{onClick:I,className:"panel-toggle","aria-label":p?"Hide file explorer":"Show file explorer","aria-pressed":p},p?"◀":"▶"," Files"),te.createElement("button",{onClick:A,className:"panel-toggle","aria-label":h?"Hide video chat":"Show video chat","aria-pressed":h},"Video ",h?"▶":"◀"),te.createElement("button",{onClick:E,disabled:!a,"aria-label":"Save current file"},"Save"),te.createElement("select",{value:y,onChange:P=>_(P.target.value),"aria-label":"Editor theme"},te.createElement("option",{value:"vs-dark"},"Dark"),te.createElement("option",{value:"vs-light"},"Light"),te.createElement("option",{value:"hc-black"},"High Contrast")))),te.createElement("div",{className:"main-content"},p&&te.createElement("div",{className:"file-explorer-panel"},te.createElement(J3,{onFileSelect:k,currentFilePath:a})),te.createElement("div",{className:"editor-panel"},te.createElement("div",{className:"editor-container"},a?te.createElement(VA,{language:m,value:l,onChange:C,theme:y,filename:a}):te.createElement("div",{className:"no-file-selected"},te.createElement("p",null,"Select a file from the explorer to edit"))),te.createElement("div",{className:"terminal-panel",style:{height:`${S}px`}},te.createElement("div",{className:"panel-header"},te.createElement("h3",null,"Terminal"),te.createElement("div",{className:"drag-handle","aria-hidden":"true",onMouseDown:P=>{const F=P.clientY,B=S,j=U=>{const R=B-(U.clientY-F);R>100&&R<800&&b(R)},X=()=>{document.removeEventListener("mousemove",j),document.removeEventListener("mouseup",X)};document.addEventListener("mousemove",j),document.addEventListener("mouseup",X)}})),te.createElement(XA,{sessionId:d}))),h&&te.createElement("div",{className:"video-chat-panel"},te.createElement(DD,{roomName:t,username:n}),te.createElement("div",{className:"screen-share-controls"},te.createElement(AD,null))))):te.createElement("div",{className:"join-room-form",role:"form","aria-label":"Join video chat room"},te.createElement("h2",null,"Join Video Chat Room"),te.createElement("div",{className:"form-group"},te.createElement("label",{htmlFor:"room-name"},"Room Name:"),te.createElement("input",{id:"room-name",type:"text",value:t,onChange:P=>e(P.target.value),placeholder:"Enter room name","aria-required":"true"})),te.createElement("div",{className:"form-group"},te.createElement("label",{htmlFor:"username"},"Your Name:"),te.createElement("input",{id:"username",type:"text",value:n,onChange:P=>i(P.target.value),placeholder:"Enter your name","aria-required":"true"})),te.createElement("button",{onClick:x,disabled:!t||!n,"aria-label":"Join room"},"Join Room")))};var xd=class{constructor(){this.listeners=new Set,this.subscribe=this.subscribe.bind(this)}subscribe(t){return this.listeners.add(t),this.onSubscribe(),()=>{this.listeners.delete(t),this.onUnsubscribe()}}hasListeners(){return this.listeners.size>0}onSubscribe(){}onUnsubscribe(){}},Pd=typeof window>"u"||"Deno"in globalThis;function Pn(){}function X3(t,e){return typeof t=="function"?t(e):t}function Y3(t){return typeof t=="number"&&t>=0&&t!==1/0}function Z3(t,e){return Math.max(t+(e||0)-Date.now(),0)}function S_(t,e){return typeof t=="function"?t(e):t}function eN(t,e){return typeof t=="function"?t(e):t}function C_(t,e){const{type:n="all",exact:i,fetchStatus:r,predicate:s,queryKey:a,stale:o}=t;if(a){if(i){if(e.queryHash!==sg(a,e.options))return!1}else if(!Al(e.queryKey,a))return!1}if(n!=="all"){const l=e.isActive();if(n==="active"&&!l||n==="inactive"&&l)return!1}return!(typeof o=="boolean"&&e.isStale()!==o||r&&r!==e.state.fetchStatus||s&&!s(e))}function b_(t,e){const{exact:n,status:i,predicate:r,mutationKey:s}=t;if(s){if(!e.options.mutationKey)return!1;if(n){if(Dl(e.options.mutationKey)!==Dl(s))return!1}else if(!Al(e.options.mutationKey,s))return!1}return!(i&&e.state.status!==i||r&&!r(e))}function sg(t,e){return((e==null?void 0:e.queryKeyHashFn)||Dl)(t)}function Dl(t){return JSON.stringify(t,(e,n)=>bp(n)?Object.keys(n).sort().reduce((i,r)=>(i[r]=n[r],i),{}):n)}function Al(t,e){return t===e?!0:typeof t!=typeof e?!1:t&&e&&typeof t=="object"&&typeof e=="object"?!Object.keys(e).some(n=>!Al(t[n],e[n])):!1}function V1(t,e){if(t===e)return t;const n=w_(t)&&w_(e);if(n||bp(t)&&bp(e)){const i=n?t:Object.keys(t),r=i.length,s=n?e:Object.keys(e),a=s.length,o=n?[]:{};let l=0;for(let c=0;c<a;c++){const d=n?c:s[c];(!n&&i.includes(d)||n)&&t[d]===void 0&&e[d]===void 0?(o[d]=void 0,l++):(o[d]=V1(t[d],e[d]),o[d]===t[d]&&t[d]!==void 0&&l++)}return r===a&&l===r?t:o}return e}function w_(t){return Array.isArray(t)&&t.length===Object.keys(t).length}function bp(t){if(!k_(t))return!1;const e=t.constructor;if(e===void 0)return!0;const n=e.prototype;return!(!k_(n)||!n.hasOwnProperty("isPrototypeOf")||Object.getPrototypeOf(t)!==Object.prototype)}function k_(t){return Object.prototype.toString.call(t)==="[object Object]"}function tN(t){return new Promise(e=>{setTimeout(e,t)})}function nN(t,e,n){return typeof n.structuralSharing=="function"?n.structuralSharing(t,e):n.structuralSharing!==!1?V1(t,e):e}function iN(t,e,n=0){const i=[...t,e];return n&&i.length>n?i.slice(1):i}function rN(t,e,n=0){const i=[e,...t];return n&&i.length>n?i.slice(0,-1):i}var og=Symbol();function G1(t,e){return!t.queryFn&&(e!=null&&e.initialPromise)?()=>e.initialPromise:!t.queryFn||t.queryFn===og?()=>Promise.reject(new Error(`Missing queryFn: '${t.queryHash}'`)):t.queryFn}var Rs,Dr,Mo,R_,sN=(R_=class extends xd{constructor(){super();we(this,Rs,void 0);we(this,Dr,void 0);we(this,Mo,void 0);me(this,Mo,e=>{if(!Pd&&window.addEventListener){const n=()=>e();return window.addEventListener("visibilitychange",n,!1),()=>{window.removeEventListener("visibilitychange",n)}}})}onSubscribe(){K(this,Dr)||this.setEventListener(K(this,Mo))}onUnsubscribe(){var e;this.hasListeners()||((e=K(this,Dr))==null||e.call(this),me(this,Dr,void 0))}setEventListener(e){var n;me(this,Mo,e),(n=K(this,Dr))==null||n.call(this),me(this,Dr,e(i=>{typeof i=="boolean"?this.setFocused(i):this.onFocus()}))}setFocused(e){K(this,Rs)!==e&&(me(this,Rs,e),this.onFocus())}onFocus(){const e=this.isFocused();this.listeners.forEach(n=>{n(e)})}isFocused(){var e;return typeof K(this,Rs)=="boolean"?K(this,Rs):((e=globalThis.document)==null?void 0:e.visibilityState)!=="hidden"}},Rs=new WeakMap,Dr=new WeakMap,Mo=new WeakMap,R_),q1=new sN,Do,Ar,Ao,x_,oN=(x_=class extends xd{constructor(){super();we(this,Do,!0);we(this,Ar,void 0);we(this,Ao,void 0);me(this,Ao,e=>{if(!Pd&&window.addEventListener){const n=()=>e(!0),i=()=>e(!1);return window.addEventListener("online",n,!1),window.addEventListener("offline",i,!1),()=>{window.removeEventListener("online",n),window.removeEventListener("offline",i)}}})}onSubscribe(){K(this,Ar)||this.setEventListener(K(this,Ao))}onUnsubscribe(){var e;this.hasListeners()||((e=K(this,Ar))==null||e.call(this),me(this,Ar,void 0))}setEventListener(e){var n;me(this,Ao,e),(n=K(this,Ar))==null||n.call(this),me(this,Ar,e(this.setOnline.bind(this)))}setOnline(e){K(this,Do)!==e&&(me(this,Do,e),this.listeners.forEach(i=>{i(e)}))}isOnline(){return K(this,Do)}},Do=new WeakMap,Ar=new WeakMap,Ao=new WeakMap,x_),$u=new oN;function aN(){let t,e;const n=new Promise((r,s)=>{t=r,e=s});n.status="pending",n.catch(()=>{});function i(r){Object.assign(n,r),delete n.resolve,delete n.reject}return n.resolve=r=>{i({status:"fulfilled",value:r}),t(r)},n.reject=r=>{i({status:"rejected",reason:r}),e(r)},n}function lN(t){return Math.min(1e3*2**t,3e4)}function J1(t){return(t??"online")==="online"?$u.isOnline():!0}var K1=class extends Error{constructor(t){super("CancelledError"),this.revert=t==null?void 0:t.revert,this.silent=t==null?void 0:t.silent}};function Ah(t){return t instanceof K1}function Q1(t){let e=!1,n=0,i=!1,r;const s=aN(),a=_=>{var p;i||(m(new K1(_)),(p=t.abort)==null||p.call(t))},o=()=>{e=!0},l=()=>{e=!1},c=()=>q1.isFocused()&&(t.networkMode==="always"||$u.isOnline())&&t.canRun(),d=()=>J1(t.networkMode)&&t.canRun(),u=_=>{var p;i||(i=!0,(p=t.onSuccess)==null||p.call(t,_),r==null||r(),s.resolve(_))},m=_=>{var p;i||(i=!0,(p=t.onError)==null||p.call(t,_),r==null||r(),s.reject(_))},v=()=>new Promise(_=>{var p;r=f=>{(i||c())&&_(f)},(p=t.onPause)==null||p.call(t)}).then(()=>{var _;r=void 0,i||(_=t.onContinue)==null||_.call(t)}),y=()=>{if(i)return;let _;const p=n===0?t.initialPromise:void 0;try{_=p??t.fn()}catch(f){_=Promise.reject(f)}Promise.resolve(_).then(u).catch(f=>{var w;if(i)return;const h=t.retry??(Pd?0:3),g=t.retryDelay??lN,S=typeof g=="function"?g(n,f):g,b=h===!0||typeof h=="number"&&n<h||typeof h=="function"&&h(n,f);if(e||!b){m(f);return}n++,(w=t.onFail)==null||w.call(t,n,f),tN(S).then(()=>c()?void 0:v()).then(()=>{e?m(f):y()})})};return{promise:s,cancel:a,continue:()=>(r==null||r(),s),cancelRetry:o,continueRetry:l,canStart:d,start:()=>(d()?y():v().then(y),s)}}function cN(){let t=[],e=0,n=o=>{o()},i=o=>{o()},r=o=>setTimeout(o,0);const s=o=>{e?t.push(o):r(()=>{n(o)})},a=()=>{const o=t;t=[],o.length&&r(()=>{i(()=>{o.forEach(l=>{n(l)})})})};return{batch:o=>{let l;e++;try{l=o()}finally{e--,e||a()}return l},batchCalls:o=>(...l)=>{s(()=>{o(...l)})},schedule:s,setNotifyFunction:o=>{n=o},setBatchNotifyFunction:o=>{i=o},setScheduler:o=>{r=o}}}var It=cN(),xs,P_,X1=(P_=class{constructor(){we(this,xs,void 0)}destroy(){this.clearGcTimeout()}scheduleGc(){this.clearGcTimeout(),Y3(this.gcTime)&&me(this,xs,setTimeout(()=>{this.optionalRemove()},this.gcTime))}updateGcTime(t){this.gcTime=Math.max(this.gcTime||0,t??(Pd?1/0:5*60*1e3))}clearGcTimeout(){K(this,xs)&&(clearTimeout(K(this,xs)),me(this,xs,void 0))}},xs=new WeakMap,P_),No,Bo,hn,St,Nl,Ps,On,Li,O_,uN=(O_=class extends X1{constructor(e){super();we(this,On);we(this,No,void 0);we(this,Bo,void 0);we(this,hn,void 0);we(this,St,void 0);we(this,Nl,void 0);we(this,Ps,void 0);me(this,Ps,!1),me(this,Nl,e.defaultOptions),this.setOptions(e.options),this.observers=[],me(this,hn,e.cache),this.queryKey=e.queryKey,this.queryHash=e.queryHash,me(this,No,hN(this.options)),this.state=e.state??K(this,No),this.scheduleGc()}get meta(){return this.options.meta}get promise(){var e;return(e=K(this,St))==null?void 0:e.promise}setOptions(e){this.options={...K(this,Nl),...e},this.updateGcTime(this.options.gcTime)}optionalRemove(){!this.observers.length&&this.state.fetchStatus==="idle"&&K(this,hn).remove(this)}setData(e,n){const i=nN(this.state.data,e,this.options);return vt(this,On,Li).call(this,{data:i,type:"success",dataUpdatedAt:n==null?void 0:n.updatedAt,manual:n==null?void 0:n.manual}),i}setState(e,n){vt(this,On,Li).call(this,{type:"setState",state:e,setStateOptions:n})}cancel(e){var i,r;const n=(i=K(this,St))==null?void 0:i.promise;return(r=K(this,St))==null||r.cancel(e),n?n.then(Pn).catch(Pn):Promise.resolve()}destroy(){super.destroy(),this.cancel({silent:!0})}reset(){this.destroy(),this.setState(K(this,No))}isActive(){return this.observers.some(e=>eN(e.options.enabled,this)!==!1)}isDisabled(){return this.getObserversCount()>0?!this.isActive():this.options.queryFn===og||this.state.dataUpdateCount+this.state.errorUpdateCount===0}isStale(){return this.state.isInvalidated?!0:this.getObserversCount()>0?this.observers.some(e=>e.getCurrentResult().isStale):this.state.data===void 0}isStaleByTime(e=0){return this.state.isInvalidated||this.state.data===void 0||!Z3(this.state.dataUpdatedAt,e)}onFocus(){var n;const e=this.observers.find(i=>i.shouldFetchOnWindowFocus());e==null||e.refetch({cancelRefetch:!1}),(n=K(this,St))==null||n.continue()}onOnline(){var n;const e=this.observers.find(i=>i.shouldFetchOnReconnect());e==null||e.refetch({cancelRefetch:!1}),(n=K(this,St))==null||n.continue()}addObserver(e){this.observers.includes(e)||(this.observers.push(e),this.clearGcTimeout(),K(this,hn).notify({type:"observerAdded",query:this,observer:e}))}removeObserver(e){this.observers.includes(e)&&(this.observers=this.observers.filter(n=>n!==e),this.observers.length||(K(this,St)&&(K(this,Ps)?K(this,St).cancel({revert:!0}):K(this,St).cancelRetry()),this.scheduleGc()),K(this,hn).notify({type:"observerRemoved",query:this,observer:e}))}getObserversCount(){return this.observers.length}invalidate(){this.state.isInvalidated||vt(this,On,Li).call(this,{type:"invalidate"})}fetch(e,n){var l,c,d;if(this.state.fetchStatus!=="idle"){if(this.state.data!==void 0&&(n!=null&&n.cancelRefetch))this.cancel({silent:!0});else if(K(this,St))return K(this,St).continueRetry(),K(this,St).promise}if(e&&this.setOptions(e),!this.options.queryFn){const u=this.observers.find(m=>m.options.queryFn);u&&this.setOptions(u.options)}const i=new AbortController,r=u=>{Object.defineProperty(u,"signal",{enumerable:!0,get:()=>(me(this,Ps,!0),i.signal)})},s=()=>{const u=G1(this.options,n),m={queryKey:this.queryKey,meta:this.meta};return r(m),me(this,Ps,!1),this.options.persister?this.options.persister(u,m,this):u(m)},a={fetchOptions:n,options:this.options,queryKey:this.queryKey,state:this.state,fetchFn:s};r(a),(l=this.options.behavior)==null||l.onFetch(a,this),me(this,Bo,this.state),(this.state.fetchStatus==="idle"||this.state.fetchMeta!==((c=a.fetchOptions)==null?void 0:c.meta))&&vt(this,On,Li).call(this,{type:"fetch",meta:(d=a.fetchOptions)==null?void 0:d.meta});const o=u=>{var m,v,y,_;Ah(u)&&u.silent||vt(this,On,Li).call(this,{type:"error",error:u}),Ah(u)||((v=(m=K(this,hn).config).onError)==null||v.call(m,u,this),(_=(y=K(this,hn).config).onSettled)==null||_.call(y,this.state.data,u,this)),this.scheduleGc()};return me(this,St,Q1({initialPromise:n==null?void 0:n.initialPromise,fn:a.fetchFn,abort:i.abort.bind(i),onSuccess:u=>{var m,v,y,_;if(u===void 0){o(new Error(`${this.queryHash} data is undefined`));return}try{this.setData(u)}catch(p){o(p);return}(v=(m=K(this,hn).config).onSuccess)==null||v.call(m,u,this),(_=(y=K(this,hn).config).onSettled)==null||_.call(y,u,this.state.error,this),this.scheduleGc()},onError:o,onFail:(u,m)=>{vt(this,On,Li).call(this,{type:"failed",failureCount:u,error:m})},onPause:()=>{vt(this,On,Li).call(this,{type:"pause"})},onContinue:()=>{vt(this,On,Li).call(this,{type:"continue"})},retry:a.options.retry,retryDelay:a.options.retryDelay,networkMode:a.options.networkMode,canRun:()=>!0})),K(this,St).start()}},No=new WeakMap,Bo=new WeakMap,hn=new WeakMap,St=new WeakMap,Nl=new WeakMap,Ps=new WeakMap,On=new WeakSet,Li=function(e){const n=i=>{switch(e.type){case"failed":return{...i,fetchFailureCount:e.failureCount,fetchFailureReason:e.error};case"pause":return{...i,fetchStatus:"paused"};case"continue":return{...i,fetchStatus:"fetching"};case"fetch":return{...i,...dN(i.data,this.options),fetchMeta:e.meta??null};case"success":return{...i,data:e.data,dataUpdateCount:i.dataUpdateCount+1,dataUpdatedAt:e.dataUpdatedAt??Date.now(),error:null,isInvalidated:!1,status:"success",...!e.manual&&{fetchStatus:"idle",fetchFailureCount:0,fetchFailureReason:null}};case"error":const r=e.error;return Ah(r)&&r.revert&&K(this,Bo)?{...K(this,Bo),fetchStatus:"idle"}:{...i,error:r,errorUpdateCount:i.errorUpdateCount+1,errorUpdatedAt:Date.now(),fetchFailureCount:i.fetchFailureCount+1,fetchFailureReason:r,fetchStatus:"idle",status:"error"};case"invalidate":return{...i,isInvalidated:!0};case"setState":return{...i,...e.state}}};this.state=n(this.state),It.batch(()=>{this.observers.forEach(i=>{i.onQueryUpdate()}),K(this,hn).notify({query:this,type:"updated",action:e})})},O_);function dN(t,e){return{fetchFailureCount:0,fetchFailureReason:null,fetchStatus:J1(e.networkMode)?"fetching":"paused",...t===void 0&&{error:null,status:"pending"}}}function hN(t){const e=typeof t.initialData=="function"?t.initialData():t.initialData,n=e!==void 0,i=n?typeof t.initialDataUpdatedAt=="function"?t.initialDataUpdatedAt():t.initialDataUpdatedAt:0;return{data:e,dataUpdateCount:0,dataUpdatedAt:n?i??Date.now():0,error:null,errorUpdateCount:0,errorUpdatedAt:0,fetchFailureCount:0,fetchFailureReason:null,fetchMeta:null,isInvalidated:!1,status:n?"success":"pending",fetchStatus:"idle"}}var ti,I_,fN=(I_=class extends xd{constructor(e={}){super();we(this,ti,void 0);this.config=e,me(this,ti,new Map)}build(e,n,i){const r=n.queryKey,s=n.queryHash??sg(r,n);let a=this.get(s);return a||(a=new uN({cache:this,queryKey:r,queryHash:s,options:e.defaultQueryOptions(n),state:i,defaultOptions:e.getQueryDefaults(r)}),this.add(a)),a}add(e){K(this,ti).has(e.queryHash)||(K(this,ti).set(e.queryHash,e),this.notify({type:"added",query:e}))}remove(e){const n=K(this,ti).get(e.queryHash);n&&(e.destroy(),n===e&&K(this,ti).delete(e.queryHash),this.notify({type:"removed",query:e}))}clear(){It.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}get(e){return K(this,ti).get(e)}getAll(){return[...K(this,ti).values()]}find(e){const n={exact:!0,...e};return this.getAll().find(i=>C_(n,i))}findAll(e={}){const n=this.getAll();return Object.keys(e).length>0?n.filter(i=>C_(e,i)):n}notify(e){It.batch(()=>{this.listeners.forEach(n=>{n(e)})})}onFocus(){It.batch(()=>{this.getAll().forEach(e=>{e.onFocus()})})}onOnline(){It.batch(()=>{this.getAll().forEach(e=>{e.onOnline()})})}},ti=new WeakMap,I_),ni,Rt,Os,ii,Pr,L_,pN=(L_=class extends X1{constructor(e){super();we(this,ii);we(this,ni,void 0);we(this,Rt,void 0);we(this,Os,void 0);this.mutationId=e.mutationId,me(this,Rt,e.mutationCache),me(this,ni,[]),this.state=e.state||mN(),this.setOptions(e.options),this.scheduleGc()}setOptions(e){this.options=e,this.updateGcTime(this.options.gcTime)}get meta(){return this.options.meta}addObserver(e){K(this,ni).includes(e)||(K(this,ni).push(e),this.clearGcTimeout(),K(this,Rt).notify({type:"observerAdded",mutation:this,observer:e}))}removeObserver(e){me(this,ni,K(this,ni).filter(n=>n!==e)),this.scheduleGc(),K(this,Rt).notify({type:"observerRemoved",mutation:this,observer:e})}optionalRemove(){K(this,ni).length||(this.state.status==="pending"?this.scheduleGc():K(this,Rt).remove(this))}continue(){var e;return((e=K(this,Os))==null?void 0:e.continue())??this.execute(this.state.variables)}async execute(e){var r,s,a,o,l,c,d,u,m,v,y,_,p,f,h,g,S,b,w,k;me(this,Os,Q1({fn:()=>this.options.mutationFn?this.options.mutationFn(e):Promise.reject(new Error("No mutationFn found")),onFail:(C,E)=>{vt(this,ii,Pr).call(this,{type:"failed",failureCount:C,error:E})},onPause:()=>{vt(this,ii,Pr).call(this,{type:"pause"})},onContinue:()=>{vt(this,ii,Pr).call(this,{type:"continue"})},retry:this.options.retry??0,retryDelay:this.options.retryDelay,networkMode:this.options.networkMode,canRun:()=>K(this,Rt).canRun(this)}));const n=this.state.status==="pending",i=!K(this,Os).canStart();try{if(!n){vt(this,ii,Pr).call(this,{type:"pending",variables:e,isPaused:i}),await((s=(r=K(this,Rt).config).onMutate)==null?void 0:s.call(r,e,this));const E=await((o=(a=this.options).onMutate)==null?void 0:o.call(a,e));E!==this.state.context&&vt(this,ii,Pr).call(this,{type:"pending",context:E,variables:e,isPaused:i})}const C=await K(this,Os).start();return await((c=(l=K(this,Rt).config).onSuccess)==null?void 0:c.call(l,C,e,this.state.context,this)),await((u=(d=this.options).onSuccess)==null?void 0:u.call(d,C,e,this.state.context)),await((v=(m=K(this,Rt).config).onSettled)==null?void 0:v.call(m,C,null,this.state.variables,this.state.context,this)),await((_=(y=this.options).onSettled)==null?void 0:_.call(y,C,null,e,this.state.context)),vt(this,ii,Pr).call(this,{type:"success",data:C}),C}catch(C){try{throw await((f=(p=K(this,Rt).config).onError)==null?void 0:f.call(p,C,e,this.state.context,this)),await((g=(h=this.options).onError)==null?void 0:g.call(h,C,e,this.state.context)),await((b=(S=K(this,Rt).config).onSettled)==null?void 0:b.call(S,void 0,C,this.state.variables,this.state.context,this)),await((k=(w=this.options).onSettled)==null?void 0:k.call(w,void 0,C,e,this.state.context)),C}finally{vt(this,ii,Pr).call(this,{type:"error",error:C})}}finally{K(this,Rt).runNext(this)}}},ni=new WeakMap,Rt=new WeakMap,Os=new WeakMap,ii=new WeakSet,Pr=function(e){const n=i=>{switch(e.type){case"failed":return{...i,failureCount:e.failureCount,failureReason:e.error};case"pause":return{...i,isPaused:!0};case"continue":return{...i,isPaused:!1};case"pending":return{...i,context:e.context,data:void 0,failureCount:0,failureReason:null,error:null,isPaused:e.isPaused,status:"pending",variables:e.variables,submittedAt:Date.now()};case"success":return{...i,data:e.data,failureCount:0,failureReason:null,error:null,status:"success",isPaused:!1};case"error":return{...i,data:void 0,error:e.error,failureCount:i.failureCount+1,failureReason:e.error,isPaused:!1,status:"error"}}};this.state=n(this.state),It.batch(()=>{K(this,ni).forEach(i=>{i.onMutationUpdate(e)}),K(this,Rt).notify({mutation:this,type:"updated",action:e})})},L_);function mN(){return{context:void 0,data:void 0,error:null,failureCount:0,failureReason:null,isPaused:!1,status:"idle",variables:void 0,submittedAt:0}}var Xt,Bl,M_,gN=(M_=class extends xd{constructor(e={}){super();we(this,Xt,void 0);we(this,Bl,void 0);this.config=e,me(this,Xt,new Map),me(this,Bl,Date.now())}build(e,n,i){const r=new pN({mutationCache:this,mutationId:++Yl(this,Bl)._,options:e.defaultMutationOptions(n),state:i});return this.add(r),r}add(e){const n=kc(e),i=K(this,Xt).get(n)??[];i.push(e),K(this,Xt).set(n,i),this.notify({type:"added",mutation:e})}remove(e){var i;const n=kc(e);if(K(this,Xt).has(n)){const r=(i=K(this,Xt).get(n))==null?void 0:i.filter(s=>s!==e);r&&(r.length===0?K(this,Xt).delete(n):K(this,Xt).set(n,r))}this.notify({type:"removed",mutation:e})}canRun(e){var i;const n=(i=K(this,Xt).get(kc(e)))==null?void 0:i.find(r=>r.state.status==="pending");return!n||n===e}runNext(e){var i;const n=(i=K(this,Xt).get(kc(e)))==null?void 0:i.find(r=>r!==e&&r.state.isPaused);return(n==null?void 0:n.continue())??Promise.resolve()}clear(){It.batch(()=>{this.getAll().forEach(e=>{this.remove(e)})})}getAll(){return[...K(this,Xt).values()].flat()}find(e){const n={exact:!0,...e};return this.getAll().find(i=>b_(n,i))}findAll(e={}){return this.getAll().filter(n=>b_(e,n))}notify(e){It.batch(()=>{this.listeners.forEach(n=>{n(e)})})}resumePausedMutations(){const e=this.getAll().filter(n=>n.state.isPaused);return It.batch(()=>Promise.all(e.map(n=>n.continue().catch(Pn))))}},Xt=new WeakMap,Bl=new WeakMap,M_);function kc(t){var e;return((e=t.options.scope)==null?void 0:e.id)??String(t.mutationId)}function E_(t){return{onFetch:(e,n)=>{var d,u,m,v,y;const i=e.options,r=(m=(u=(d=e.fetchOptions)==null?void 0:d.meta)==null?void 0:u.fetchMore)==null?void 0:m.direction,s=((v=e.state.data)==null?void 0:v.pages)||[],a=((y=e.state.data)==null?void 0:y.pageParams)||[];let o={pages:[],pageParams:[]},l=0;const c=async()=>{let _=!1;const p=g=>{Object.defineProperty(g,"signal",{enumerable:!0,get:()=>(e.signal.aborted?_=!0:e.signal.addEventListener("abort",()=>{_=!0}),e.signal)})},f=G1(e.options,e.fetchOptions),h=async(g,S,b)=>{if(_)return Promise.reject();if(S==null&&g.pages.length)return Promise.resolve(g);const w={queryKey:e.queryKey,pageParam:S,direction:b?"backward":"forward",meta:e.options.meta};p(w);const k=await f(w),{maxPages:C}=e.options,E=b?rN:iN;return{pages:E(g.pages,k,C),pageParams:E(g.pageParams,S,C)}};if(r&&s.length){const g=r==="backward",S=g?vN:T_,b={pages:s,pageParams:a},w=S(i,b);o=await h(b,w,g)}else{const g=t??s.length;do{const S=l===0?a[0]??i.initialPageParam:T_(i,o);if(l>0&&S==null)break;o=await h(o,S),l++}while(l<g)}return o};e.options.persister?e.fetchFn=()=>{var _,p;return(p=(_=e.options).persister)==null?void 0:p.call(_,c,{queryKey:e.queryKey,meta:e.options.meta,signal:e.signal},n)}:e.fetchFn=c}}}function T_(t,{pages:e,pageParams:n}){const i=e.length-1;return e.length>0?t.getNextPageParam(e[i],e,n[i],n):void 0}function vN(t,{pages:e,pageParams:n}){var i;return e.length>0?(i=t.getPreviousPageParam)==null?void 0:i.call(t,e[0],e,n[0],n):void 0}var He,Nr,Br,Fo,Uo,Fr,zo,Ho,D_,_N=(D_=class{constructor(t={}){we(this,He,void 0);we(this,Nr,void 0);we(this,Br,void 0);we(this,Fo,void 0);we(this,Uo,void 0);we(this,Fr,void 0);we(this,zo,void 0);we(this,Ho,void 0);me(this,He,t.queryCache||new fN),me(this,Nr,t.mutationCache||new gN),me(this,Br,t.defaultOptions||{}),me(this,Fo,new Map),me(this,Uo,new Map),me(this,Fr,0)}mount(){Yl(this,Fr)._++,K(this,Fr)===1&&(me(this,zo,q1.subscribe(async t=>{t&&(await this.resumePausedMutations(),K(this,He).onFocus())})),me(this,Ho,$u.subscribe(async t=>{t&&(await this.resumePausedMutations(),K(this,He).onOnline())})))}unmount(){var t,e;Yl(this,Fr)._--,K(this,Fr)===0&&((t=K(this,zo))==null||t.call(this),me(this,zo,void 0),(e=K(this,Ho))==null||e.call(this),me(this,Ho,void 0))}isFetching(t){return K(this,He).findAll({...t,fetchStatus:"fetching"}).length}isMutating(t){return K(this,Nr).findAll({...t,status:"pending"}).length}getQueryData(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=K(this,He).get(e.queryHash))==null?void 0:n.state.data}ensureQueryData(t){const e=this.getQueryData(t.queryKey);if(e===void 0)return this.fetchQuery(t);{const n=this.defaultQueryOptions(t),i=K(this,He).build(this,n);return t.revalidateIfStale&&i.isStaleByTime(S_(n.staleTime,i))&&this.prefetchQuery(n),Promise.resolve(e)}}getQueriesData(t){return K(this,He).findAll(t).map(({queryKey:e,state:n})=>{const i=n.data;return[e,i]})}setQueryData(t,e,n){const i=this.defaultQueryOptions({queryKey:t}),r=K(this,He).get(i.queryHash),s=r==null?void 0:r.state.data,a=X3(e,s);if(a!==void 0)return K(this,He).build(this,i).setData(a,{...n,manual:!0})}setQueriesData(t,e,n){return It.batch(()=>K(this,He).findAll(t).map(({queryKey:i})=>[i,this.setQueryData(i,e,n)]))}getQueryState(t){var n;const e=this.defaultQueryOptions({queryKey:t});return(n=K(this,He).get(e.queryHash))==null?void 0:n.state}removeQueries(t){const e=K(this,He);It.batch(()=>{e.findAll(t).forEach(n=>{e.remove(n)})})}resetQueries(t,e){const n=K(this,He),i={type:"active",...t};return It.batch(()=>(n.findAll(t).forEach(r=>{r.reset()}),this.refetchQueries(i,e)))}cancelQueries(t={},e={}){const n={revert:!0,...e},i=It.batch(()=>K(this,He).findAll(t).map(r=>r.cancel(n)));return Promise.all(i).then(Pn).catch(Pn)}invalidateQueries(t={},e={}){return It.batch(()=>{if(K(this,He).findAll(t).forEach(i=>{i.invalidate()}),t.refetchType==="none")return Promise.resolve();const n={...t,type:t.refetchType??t.type??"active"};return this.refetchQueries(n,e)})}refetchQueries(t={},e){const n={...e,cancelRefetch:(e==null?void 0:e.cancelRefetch)??!0},i=It.batch(()=>K(this,He).findAll(t).filter(r=>!r.isDisabled()).map(r=>{let s=r.fetch(void 0,n);return n.throwOnError||(s=s.catch(Pn)),r.state.fetchStatus==="paused"?Promise.resolve():s}));return Promise.all(i).then(Pn)}fetchQuery(t){const e=this.defaultQueryOptions(t);e.retry===void 0&&(e.retry=!1);const n=K(this,He).build(this,e);return n.isStaleByTime(S_(e.staleTime,n))?n.fetch(e):Promise.resolve(n.state.data)}prefetchQuery(t){return this.fetchQuery(t).then(Pn).catch(Pn)}fetchInfiniteQuery(t){return t.behavior=E_(t.pages),this.fetchQuery(t)}prefetchInfiniteQuery(t){return this.fetchInfiniteQuery(t).then(Pn).catch(Pn)}ensureInfiniteQueryData(t){return t.behavior=E_(t.pages),this.ensureQueryData(t)}resumePausedMutations(){return $u.isOnline()?K(this,Nr).resumePausedMutations():Promise.resolve()}getQueryCache(){return K(this,He)}getMutationCache(){return K(this,Nr)}getDefaultOptions(){return K(this,Br)}setDefaultOptions(t){me(this,Br,t)}setQueryDefaults(t,e){K(this,Fo).set(Dl(t),{queryKey:t,defaultOptions:e})}getQueryDefaults(t){const e=[...K(this,Fo).values()];let n={};return e.forEach(i=>{Al(t,i.queryKey)&&(n={...n,...i.defaultOptions})}),n}setMutationDefaults(t,e){K(this,Uo).set(Dl(t),{mutationKey:t,defaultOptions:e})}getMutationDefaults(t){const e=[...K(this,Uo).values()];let n={};return e.forEach(i=>{Al(t,i.mutationKey)&&(n={...n,...i.defaultOptions})}),n}defaultQueryOptions(t){if(t._defaulted)return t;const e={...K(this,Br).queries,...this.getQueryDefaults(t.queryKey),...t,_defaulted:!0};return e.queryHash||(e.queryHash=sg(e.queryKey,e)),e.refetchOnReconnect===void 0&&(e.refetchOnReconnect=e.networkMode!=="always"),e.throwOnError===void 0&&(e.throwOnError=!!e.suspense),!e.networkMode&&e.persister&&(e.networkMode="offlineFirst"),e.enabled!==!0&&e.queryFn===og&&(e.enabled=!1),e}defaultMutationOptions(t){return t!=null&&t._defaulted?t:{...K(this,Br).mutations,...(t==null?void 0:t.mutationKey)&&this.getMutationDefaults(t.mutationKey),...t,_defaulted:!0}}clear(){K(this,He).clear(),K(this,Nr).clear()}},He=new WeakMap,Nr=new WeakMap,Br=new WeakMap,Fo=new WeakMap,Uo=new WeakMap,Fr=new WeakMap,zo=new WeakMap,Ho=new WeakMap,D_),Y1={exports:{}},Od={};/**
 * @license React
 * react-jsx-runtime.production.min.js
 *
 * Copyright (c) Facebook, Inc. and its affiliates.
 *
 * This source code is licensed under the MIT license found in the
 * LICENSE file in the root directory of this source tree.
 */var yN=T,SN=Symbol.for("react.element"),CN=Symbol.for("react.fragment"),bN=Object.prototype.hasOwnProperty,wN=yN.__SECRET_INTERNALS_DO_NOT_USE_OR_YOU_WILL_BE_FIRED.ReactCurrentOwner,kN={key:!0,ref:!0,__self:!0,__source:!0};function Z1(t,e,n){var i,r={},s=null,a=null;n!==void 0&&(s=""+n),e.key!==void 0&&(s=""+e.key),e.ref!==void 0&&(a=e.ref);for(i in e)bN.call(e,i)&&!kN.hasOwnProperty(i)&&(r[i]=e[i]);if(t&&t.defaultProps)for(i in e=t.defaultProps,e)r[i]===void 0&&(r[i]=e[i]);return{$$typeof:SN,type:t,key:s,ref:a,props:r,_owner:wN.current}}Od.Fragment=CN;Od.jsx=Z1;Od.jsxs=Z1;Y1.exports=Od;var EN=Y1.exports,TN=T.createContext(void 0),RN=({client:t,children:e})=>(T.useEffect(()=>(t.mount(),()=>{t.unmount()}),[t]),EN.jsx(TN.Provider,{value:t,children:e}));const xN=new _N({defaultOptions:{queries:{staleTime:1e3*60*5,gcTime:1e3*60*10,retry:1,refetchOnWindowFocus:!0,queryFn:async({queryKey:t})=>{const[e,...n]=Array.isArray(t)?t:[t];if(typeof e!="string")throw new Error("Invalid query key");let i=e;n.length>0&&n.length===2&&n[1]==="messages"&&(i=`${e}/${n[0]}/messages`);const r=await fetch(i);if(!r.ok)throw new Error(`Request failed with status ${r.status}`);const s=r.headers.get("content-type");return s!=null&&s.includes("application/json")?r.json():r.text()}}}});function PN(){return React.createElement(T.StrictMode,null,React.createElement(RN,{client:xN},React.createElement(Q3,null)))}GS(document.getElementById("root")).render(React.createElement(PN,null));
